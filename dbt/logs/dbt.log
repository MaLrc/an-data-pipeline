[0m14:55:20.413216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d3ca70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105739340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105738fb0>]}


============================== 14:55:20.436624 | 6cd17b24-8020-45bc-952b-6b439ecd3490 ==============================
[0m14:55:20.436624 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:55:20.436985 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'profiles_dir': '/Users/mael/.dbt', 'warn_error': 'None', 'partial_parse': 'True', 'target_path': 'None', 'log_format': 'default', 'empty': 'None', 'fail_fast': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt init', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'logs', 'quiet': 'False', 'no_print': 'None', 'write_json': 'True', 'introspect': 'True', 'use_colors': 'True', 'version_check': 'True'}
[0m14:55:38.695512 [debug] [MainThread]: Starter project path: /Users/mael/DEV/an-data-pipeline/.venv/lib/python3.12/site-packages/dbt/include/starter_project
[0m14:55:38.716141 [info ] [MainThread]: 
Your new dbt project "dbt_an_data" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m14:55:38.717927 [info ] [MainThread]: Setting up your profile.
[0m14:55:44.485939 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 24.11675, "process_in_blocks": "0", "process_kernel_time": 0.388396, "process_mem_max_rss": "132759552", "process_out_blocks": "0", "process_user_time": 1.489985}
[0m14:55:44.486353 [debug] [MainThread]: Command `dbt init` succeeded at 14:55:44.486273 after 24.12 seconds
[0m14:55:44.486621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105502360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ffb740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057391c0>]}
[0m14:55:44.486872 [debug] [MainThread]: Flushing usage events
[0m14:55:44.924546 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:15:28.393094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101194650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a97740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a973e0>]}


============================== 20:15:28.396556 | fb9f483b-8fd2-444d-adcd-cbd755651327 ==============================
[0m20:15:28.396556 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:15:28.396852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'version_check': 'True', 'invocation_command': 'dbt build', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'debug': 'False', 'introspect': 'True', 'log_format': 'default', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'quiet': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'no_print': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'write_json': 'True'}
[0m20:15:28.574020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb9f483b-8fd2-444d-adcd-cbd755651327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b02c90>]}
[0m20:15:28.601295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb9f483b-8fd2-444d-adcd-cbd755651327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10308ef60>]}
[0m20:15:28.603065 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:15:28.660949 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:15:28.661392 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:15:28.661574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fb9f483b-8fd2-444d-adcd-cbd755651327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a654c0>]}
[0m20:15:29.203738 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_an_data.int
- models.dbt_an_data.stg
- models.dbt_an_data.mart
[0m20:15:29.206127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb9f483b-8fd2-444d-adcd-cbd755651327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f45400>]}
[0m20:15:29.270716 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m20:15:29.272451 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m20:15:29.387042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb9f483b-8fd2-444d-adcd-cbd755651327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10524cc80>]}
[0m20:15:29.387379 [info ] [MainThread]: Found 2 models, 4 data tests, 468 macros
[0m20:15:29.388522 [info ] [MainThread]: 
[0m20:15:29.388735 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:15:29.388882 [info ] [MainThread]: 
[0m20:15:29.389150 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:15:29.391919 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m20:15:29.496316 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m20:15:29.496562 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m20:15:29.496714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:15:29.515911 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m20:15:29.516687 [debug] [ThreadPool]: On list_database: Close
[0m20:15:29.517034 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m20:15:29.517276 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m20:15:29.520402 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m20:15:29.520560 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m20:15:29.520687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:15:29.521289 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:15:29.521870 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m20:15:29.521999 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m20:15:29.522185 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:15:29.522305 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m20:15:29.522420 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m20:15:29.523217 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:15:29.523574 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m20:15:29.523700 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m20:15:29.523806 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m20:15:29.523970 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:15:29.524089 [debug] [ThreadPool]: On create_database_main: Close
[0m20:15:29.524558 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_main, now list_database_main)
[0m20:15:29.527007 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m20:15:29.527150 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m20:15:29.527262 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:15:29.527462 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:15:29.527583 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m20:15:29.527705 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m20:15:29.535646 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m20:15:29.536494 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m20:15:29.537373 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m20:15:29.537505 [debug] [ThreadPool]: On list_database_main: Close
[0m20:15:29.537898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb9f483b-8fd2-444d-adcd-cbd755651327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10515f380>]}
[0m20:15:29.538132 [debug] [MainThread]: Using duckdb connection "master"
[0m20:15:29.538262 [debug] [MainThread]: On master: BEGIN
[0m20:15:29.538373 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:15:29.538590 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:15:29.538714 [debug] [MainThread]: On master: COMMIT
[0m20:15:29.538830 [debug] [MainThread]: Using duckdb connection "master"
[0m20:15:29.538941 [debug] [MainThread]: On master: COMMIT
[0m20:15:29.539106 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:15:29.539223 [debug] [MainThread]: On master: Close
[0m20:15:29.540704 [debug] [Thread-1 (]: Began running node model.dbt_an_data.my_first_dbt_model
[0m20:15:29.540990 [info ] [Thread-1 (]: 1 of 6 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m20:15:29.541213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_database_main, now model.dbt_an_data.my_first_dbt_model)
[0m20:15:29.541377 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.my_first_dbt_model
[0m20:15:29.545804 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.my_first_dbt_model"
[0m20:15:29.546318 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.my_first_dbt_model
[0m20:15:29.561197 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.my_first_dbt_model"
[0m20:15:29.561861 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.my_first_dbt_model"
[0m20:15:29.562039 [debug] [Thread-1 (]: On model.dbt_an_data.my_first_dbt_model: BEGIN
[0m20:15:29.562179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:29.562504 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:29.562656 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.my_first_dbt_model"
[0m20:15:29.562811 [debug] [Thread-1 (]: On model.dbt_an_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.my_first_dbt_model"} */

  
    
    

    create  table
      "database"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m20:15:29.565138 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:15:29.568216 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.my_first_dbt_model"
[0m20:15:29.568434 [debug] [Thread-1 (]: On model.dbt_an_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.my_first_dbt_model"} */
alter table "database"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:15:29.569500 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:15:29.576088 [debug] [Thread-1 (]: On model.dbt_an_data.my_first_dbt_model: COMMIT
[0m20:15:29.576372 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.my_first_dbt_model"
[0m20:15:29.576521 [debug] [Thread-1 (]: On model.dbt_an_data.my_first_dbt_model: COMMIT
[0m20:15:29.577633 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:15:29.580239 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.my_first_dbt_model"
[0m20:15:29.580412 [debug] [Thread-1 (]: On model.dbt_an_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.my_first_dbt_model"} */

      drop table if exists "database"."main"."my_first_dbt_model__dbt_backup" cascade
    
[0m20:15:29.580706 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:29.581808 [debug] [Thread-1 (]: On model.dbt_an_data.my_first_dbt_model: Close
[0m20:15:29.582943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb9f483b-8fd2-444d-adcd-cbd755651327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e8650>]}
[0m20:15:29.583242 [info ] [Thread-1 (]: 1 of 6 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m20:15:29.583485 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.my_first_dbt_model
[0m20:15:29.583825 [debug] [Thread-1 (]: Began running node test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:15:29.584034 [info ] [Thread-1 (]: 2 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m20:15:29.584241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.my_first_dbt_model, now test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710)
[0m20:15:29.584390 [debug] [Thread-1 (]: Began compiling node test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:15:29.589465 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:15:29.590109 [debug] [Thread-1 (]: Began executing node test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:15:29.597929 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:15:29.598366 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:15:29.598534 [debug] [Thread-1 (]: On test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m20:15:29.598675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:29.598991 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:29.599132 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:15:29.599280 [debug] [Thread-1 (]: On test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "database"."main"."my_first_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m20:15:29.601190 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:15:29.603545 [debug] [Thread-1 (]: On test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m20:15:29.604117 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710'
[0m20:15:29.604277 [debug] [Thread-1 (]: On test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m20:15:29.604570 [error] [Thread-1 (]: 2 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.02s]
[0m20:15:29.604823 [debug] [Thread-1 (]: Finished running node test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:15:29.604999 [debug] [Thread-1 (]: Began running node test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321
[0m20:15:29.605239 [debug] [Thread-4 (]: Marking all children of 'test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m20:15:29.605432 [info ] [Thread-1 (]: 3 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m20:15:29.605848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321)
[0m20:15:29.606014 [debug] [Thread-1 (]: Began compiling node test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321
[0m20:15:29.609169 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321"
[0m20:15:29.609562 [debug] [Thread-1 (]: Began executing node test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321
[0m20:15:29.610697 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321"
[0m20:15:29.611012 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321"
[0m20:15:29.611163 [debug] [Thread-1 (]: On test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m20:15:29.611292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:29.611627 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:15:29.611766 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321"
[0m20:15:29.611913 [debug] [Thread-1 (]: On test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "database"."main"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:15:29.614629 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:15:29.615369 [debug] [Thread-1 (]: On test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m20:15:29.615809 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321'
[0m20:15:29.615959 [debug] [Thread-1 (]: On test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:15:29.616207 [info ] [Thread-1 (]: 3 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.01s]
[0m20:15:29.616440 [debug] [Thread-1 (]: Finished running node test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321
[0m20:15:29.616750 [debug] [Thread-1 (]: Began running node model.dbt_an_data.my_second_dbt_model
[0m20:15:29.616988 [info ] [Thread-1 (]: 4 of 6 SKIP relation main.my_second_dbt_model .................................. [[33mSKIP[0m]
[0m20:15:29.617224 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.my_second_dbt_model
[0m20:15:29.617377 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.my_second_dbt_model' to be skipped because of status 'skipped'. 
[0m20:15:29.617636 [debug] [Thread-1 (]: Began running node test.dbt_an_data.not_null_my_second_dbt_model_id.151b76d778
[0m20:15:29.617816 [info ] [Thread-1 (]: 5 of 6 SKIP test not_null_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m20:15:29.618014 [debug] [Thread-1 (]: Finished running node test.dbt_an_data.not_null_my_second_dbt_model_id.151b76d778
[0m20:15:29.618185 [debug] [Thread-1 (]: Began running node test.dbt_an_data.unique_my_second_dbt_model_id.57a0f8c493
[0m20:15:29.618313 [debug] [Thread-4 (]: Marking all children of 'test.dbt_an_data.not_null_my_second_dbt_model_id.151b76d778' to be skipped because of status 'skipped'. 
[0m20:15:29.618460 [info ] [Thread-1 (]: 6 of 6 SKIP test unique_my_second_dbt_model_id ................................. [[33mSKIP[0m]
[0m20:15:29.618671 [debug] [Thread-1 (]: Finished running node test.dbt_an_data.unique_my_second_dbt_model_id.57a0f8c493
[0m20:15:29.618809 [debug] [Thread-4 (]: Marking all children of 'test.dbt_an_data.unique_my_second_dbt_model_id.57a0f8c493' to be skipped because of status 'skipped'. 
[0m20:15:29.619256 [debug] [MainThread]: Using duckdb connection "master"
[0m20:15:29.619387 [debug] [MainThread]: On master: BEGIN
[0m20:15:29.619501 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:15:29.619732 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:15:29.619853 [debug] [MainThread]: On master: COMMIT
[0m20:15:29.619965 [debug] [MainThread]: Using duckdb connection "master"
[0m20:15:29.620073 [debug] [MainThread]: On master: COMMIT
[0m20:15:29.620232 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:15:29.620348 [debug] [MainThread]: On master: Close
[0m20:15:29.620499 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:15:29.620609 [debug] [MainThread]: Connection 'test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m20:15:29.620739 [info ] [MainThread]: 
[0m20:15:29.620868 [info ] [MainThread]: Finished running 1 table model, 4 data tests, 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m20:15:29.621288 [debug] [MainThread]: Command end result
[0m20:15:29.632546 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m20:15:29.634125 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m20:15:29.636917 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m20:15:29.637151 [info ] [MainThread]: 
[0m20:15:29.637358 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:15:29.637652 [info ] [MainThread]: 
[0m20:15:29.637894 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m20:15:29.638060 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:15:29.638179 [info ] [MainThread]: 
[0m20:15:29.638324 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m20:15:29.638456 [info ] [MainThread]: 
[0m20:15:29.638614 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 NO-OP=0 TOTAL=6
[0m20:15:29.638988 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.2877424, "process_in_blocks": "0", "process_kernel_time": 0.19734, "process_mem_max_rss": "169902080", "process_out_blocks": "0", "process_user_time": 1.545668}
[0m20:15:29.639213 [debug] [MainThread]: Command `dbt build` failed at 20:15:29.639172 after 1.29 seconds
[0m20:15:29.639418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035592e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044a2240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a978f0>]}
[0m20:15:29.639592 [debug] [MainThread]: Flushing usage events
[0m20:15:30.170031 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:16:54.243188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061580b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c53530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c531a0>]}


============================== 20:16:54.246866 | 26829967-20a4-4dcf-b19b-049f03a48ca6 ==============================
[0m20:16:54.246866 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:16:54.247245 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'partial_parse': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'quiet': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'debug': 'False', 'target_path': 'None', 'no_print': 'None', 'log_format': 'default', 'empty': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'use_colors': 'True', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None'}
[0m20:16:54.397241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26829967-20a4-4dcf-b19b-049f03a48ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ff2480>]}
[0m20:16:54.424028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26829967-20a4-4dcf-b19b-049f03a48ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ff2c90>]}
[0m20:17:14.189262 [error] [MainThread]: Encountered an error:

[0m20:17:14.214642 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/mael/DEV/an-data-pipeline/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mael/DEV/an-data-pipeline/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mael/DEV/an-data-pipeline/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mael/DEV/an-data-pipeline/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mael/DEV/an-data-pipeline/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mael/DEV/an-data-pipeline/.venv/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/mael/DEV/an-data-pipeline/.venv/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Users/mael/.local/share/uv/python/cpython-3.12.9-macos-aarch64-none/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mael/.local/share/uv/python/cpython-3.12.9-macos-aarch64-none/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m20:17:14.229520 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 20.028824, "process_in_blocks": "0", "process_kernel_time": 0.145595, "process_mem_max_rss": "126369792", "process_out_blocks": "0", "process_user_time": 0.743215}
[0m20:17:14.232599 [debug] [MainThread]: Command `dbt docs serve` failed at 20:17:14.232171 after 20.04 seconds
[0m20:17:14.235509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c53680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11099cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f21b0>]}
[0m20:17:14.237633 [debug] [MainThread]: Flushing usage events
[0m20:17:14.811924 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:19:52.597768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064ff6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dab710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dab380>]}


============================== 20:19:52.600960 | c9ca87c1-1eab-4949-81e3-9fdb365bf367 ==============================
[0m20:19:52.600960 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:19:52.601273 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'target_path': 'None', 'quiet': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'use_colors': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'version_check': 'True', 'static_parser': 'True', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'introspect': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'fail_fast': 'False'}
[0m20:19:52.795339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9ca87c1-1eab-4949-81e3-9fdb365bf367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f527e0>]}
[0m20:19:52.822573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9ca87c1-1eab-4949-81e3-9fdb365bf367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057d6ba0>]}
[0m20:19:52.824110 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:19:52.881543 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:19:52.944517 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:19:52.944831 [debug] [MainThread]: Partial parsing: added file: dbt_an_data://models/int/test.sql
[0m20:19:53.059704 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_an_data.stg
- models.dbt_an_data.mart
[0m20:19:53.062519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9ca87c1-1eab-4949-81e3-9fdb365bf367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074fbdd0>]}
[0m20:19:53.092593 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m20:19:53.094094 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m20:19:53.113455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9ca87c1-1eab-4949-81e3-9fdb365bf367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070582f0>]}
[0m20:19:53.113730 [info ] [MainThread]: Found 3 models, 4 data tests, 468 macros
[0m20:19:53.114666 [info ] [MainThread]: 
[0m20:19:53.114846 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:19:53.114981 [info ] [MainThread]: 
[0m20:19:53.115215 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:19:53.117308 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m20:19:53.202038 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m20:19:53.202262 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m20:19:53.202400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:53.218237 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m20:19:53.218969 [debug] [ThreadPool]: On list_database: Close
[0m20:19:53.219313 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m20:19:53.219550 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m20:19:53.222671 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m20:19:53.222830 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m20:19:53.222959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:19:53.223585 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:19:53.224150 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m20:19:53.224275 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m20:19:53.224454 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:19:53.224570 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m20:19:53.224684 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m20:19:53.225248 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:19:53.225612 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m20:19:53.225739 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m20:19:53.225851 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m20:19:53.226013 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:19:53.226134 [debug] [ThreadPool]: On create_database_main: Close
[0m20:19:53.226640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_main, now list_database_main)
[0m20:19:53.229099 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m20:19:53.229241 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m20:19:53.229353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:19:53.229561 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:19:53.229681 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m20:19:53.229802 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m20:19:53.236695 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m20:19:53.237281 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m20:19:53.238138 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m20:19:53.238276 [debug] [ThreadPool]: On list_database_main: Close
[0m20:19:53.238512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9ca87c1-1eab-4949-81e3-9fdb365bf367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ea0140>]}
[0m20:19:53.238749 [debug] [MainThread]: Using duckdb connection "master"
[0m20:19:53.238878 [debug] [MainThread]: On master: BEGIN
[0m20:19:53.238988 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:19:53.239202 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:19:53.239331 [debug] [MainThread]: On master: COMMIT
[0m20:19:53.239447 [debug] [MainThread]: Using duckdb connection "master"
[0m20:19:53.239561 [debug] [MainThread]: On master: COMMIT
[0m20:19:53.239740 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:19:53.239861 [debug] [MainThread]: On master: Close
[0m20:19:53.241279 [debug] [Thread-1 (]: Began running node model.dbt_an_data.my_first_dbt_model
[0m20:19:53.241514 [info ] [Thread-1 (]: 1 of 7 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m20:19:53.241706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_database_main, now model.dbt_an_data.my_first_dbt_model)
[0m20:19:53.241849 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.my_first_dbt_model
[0m20:19:53.245070 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.my_first_dbt_model"
[0m20:19:53.245405 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.my_first_dbt_model
[0m20:19:53.259340 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.my_first_dbt_model"
[0m20:19:53.259669 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.my_first_dbt_model"
[0m20:19:53.259829 [debug] [Thread-1 (]: On model.dbt_an_data.my_first_dbt_model: BEGIN
[0m20:19:53.259971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:53.260256 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:19:53.260399 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.my_first_dbt_model"
[0m20:19:53.260550 [debug] [Thread-1 (]: On model.dbt_an_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.my_first_dbt_model"} */

  
    
    

    create  table
      "database"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m20:19:53.262683 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:19:53.265460 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.my_first_dbt_model"
[0m20:19:53.265632 [debug] [Thread-1 (]: On model.dbt_an_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.my_first_dbt_model"} */
alter table "database"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:19:53.266299 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:19:53.272208 [debug] [Thread-1 (]: On model.dbt_an_data.my_first_dbt_model: COMMIT
[0m20:19:53.272408 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.my_first_dbt_model"
[0m20:19:53.272566 [debug] [Thread-1 (]: On model.dbt_an_data.my_first_dbt_model: COMMIT
[0m20:19:53.274362 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:19:53.277331 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.my_first_dbt_model"
[0m20:19:53.277510 [debug] [Thread-1 (]: On model.dbt_an_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.my_first_dbt_model"} */

      drop table if exists "database"."main"."my_first_dbt_model__dbt_backup" cascade
    
[0m20:19:53.277893 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:19:53.278996 [debug] [Thread-1 (]: On model.dbt_an_data.my_first_dbt_model: Close
[0m20:19:53.279917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9ca87c1-1eab-4949-81e3-9fdb365bf367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10358cf80>]}
[0m20:19:53.280236 [info ] [Thread-1 (]: 1 of 7 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m20:19:53.280488 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.my_first_dbt_model
[0m20:19:53.280670 [debug] [Thread-1 (]: Began running node model.dbt_an_data.test
[0m20:19:53.280913 [info ] [Thread-1 (]: 2 of 7 START sql view model main.test .......................................... [RUN]
[0m20:19:53.281148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.my_first_dbt_model, now model.dbt_an_data.test)
[0m20:19:53.281302 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.test
[0m20:19:53.282157 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.test"
[0m20:19:53.282500 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.test
[0m20:19:53.291237 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.test"
[0m20:19:53.291750 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.test"
[0m20:19:53.291913 [debug] [Thread-1 (]: On model.dbt_an_data.test: BEGIN
[0m20:19:53.292054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:53.292370 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:19:53.292516 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.test"
[0m20:19:53.292657 [debug] [Thread-1 (]: On model.dbt_an_data.test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.test"} */

  
  create view "database"."main"."test__dbt_tmp" as (
    SELECT * FROM stg.raw_acteurs;
  );

[0m20:19:53.295950 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.test"} */

  
  create view "database"."main"."test__dbt_tmp" as (
    SELECT * FROM stg.raw_acteurs;
  );

[0m20:19:53.296159 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:19:53.296384 [debug] [Thread-1 (]: On model.dbt_an_data.test: ROLLBACK
[0m20:19:53.303774 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_an_data.test'
[0m20:19:53.303962 [debug] [Thread-1 (]: On model.dbt_an_data.test: Close
[0m20:19:53.305119 [debug] [Thread-1 (]: Runtime Error in model test (models/int/test.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 5:     SELECT * FROM stg.raw_acteurs;
                                           ^
[0m20:19:53.305342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9ca87c1-1eab-4949-81e3-9fdb365bf367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a5fc50>]}
[0m20:19:53.305637 [error] [Thread-1 (]: 2 of 7 ERROR creating sql view model main.test ................................. [[31mERROR[0m in 0.02s]
[0m20:19:53.305885 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.test
[0m20:19:53.306071 [debug] [Thread-1 (]: Began running node test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:19:53.306305 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.test' to be skipped because of status 'error'.  Reason: Runtime Error in model test (models/int/test.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 5:     SELECT * FROM stg.raw_acteurs;
                                           ^.
[0m20:19:53.306488 [info ] [Thread-1 (]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m20:19:53.306871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.test, now test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710)
[0m20:19:53.307020 [debug] [Thread-1 (]: Began compiling node test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:19:53.345924 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:19:53.346418 [debug] [Thread-1 (]: Began executing node test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:19:53.354072 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:19:53.354409 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:19:53.354572 [debug] [Thread-1 (]: On test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m20:19:53.354719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:53.355076 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:19:53.355226 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:19:53.355378 [debug] [Thread-1 (]: On test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "database"."main"."my_first_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m20:19:53.357078 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:19:53.358601 [debug] [Thread-1 (]: On test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m20:19:53.359039 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710'
[0m20:19:53.359188 [debug] [Thread-1 (]: On test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m20:19:53.359451 [error] [Thread-1 (]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.05s]
[0m20:19:53.359689 [debug] [Thread-1 (]: Finished running node test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:19:53.359850 [debug] [Thread-1 (]: Began running node test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321
[0m20:19:53.360057 [debug] [Thread-4 (]: Marking all children of 'test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m20:19:53.360218 [info ] [Thread-1 (]: 4 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m20:19:53.360439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_an_data.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321)
[0m20:19:53.360577 [debug] [Thread-1 (]: Began compiling node test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321
[0m20:19:53.363457 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321"
[0m20:19:53.363793 [debug] [Thread-1 (]: Began executing node test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321
[0m20:19:53.364868 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321"
[0m20:19:53.365312 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321"
[0m20:19:53.365458 [debug] [Thread-1 (]: On test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m20:19:53.365591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:53.365849 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:19:53.365993 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321"
[0m20:19:53.366141 [debug] [Thread-1 (]: On test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "database"."main"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:19:53.367953 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:19:53.368639 [debug] [Thread-1 (]: On test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m20:19:53.369052 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321'
[0m20:19:53.369193 [debug] [Thread-1 (]: On test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:19:53.369435 [info ] [Thread-1 (]: 4 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.01s]
[0m20:19:53.369667 [debug] [Thread-1 (]: Finished running node test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321
[0m20:19:53.370001 [debug] [Thread-1 (]: Began running node model.dbt_an_data.my_second_dbt_model
[0m20:19:53.370192 [info ] [Thread-1 (]: 5 of 7 SKIP relation main.my_second_dbt_model .................................. [[33mSKIP[0m]
[0m20:19:53.370361 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.my_second_dbt_model
[0m20:19:53.370505 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.my_second_dbt_model' to be skipped because of status 'skipped'. 
[0m20:19:53.370793 [debug] [Thread-1 (]: Began running node test.dbt_an_data.not_null_my_second_dbt_model_id.151b76d778
[0m20:19:53.371023 [info ] [Thread-1 (]: 6 of 7 SKIP test not_null_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m20:19:53.371225 [debug] [Thread-1 (]: Finished running node test.dbt_an_data.not_null_my_second_dbt_model_id.151b76d778
[0m20:19:53.371382 [debug] [Thread-1 (]: Began running node test.dbt_an_data.unique_my_second_dbt_model_id.57a0f8c493
[0m20:19:53.371512 [debug] [Thread-4 (]: Marking all children of 'test.dbt_an_data.not_null_my_second_dbt_model_id.151b76d778' to be skipped because of status 'skipped'. 
[0m20:19:53.371666 [info ] [Thread-1 (]: 7 of 7 SKIP test unique_my_second_dbt_model_id ................................. [[33mSKIP[0m]
[0m20:19:53.371875 [debug] [Thread-1 (]: Finished running node test.dbt_an_data.unique_my_second_dbt_model_id.57a0f8c493
[0m20:19:53.372011 [debug] [Thread-4 (]: Marking all children of 'test.dbt_an_data.unique_my_second_dbt_model_id.57a0f8c493' to be skipped because of status 'skipped'. 
[0m20:19:53.372450 [debug] [MainThread]: Using duckdb connection "master"
[0m20:19:53.372584 [debug] [MainThread]: On master: BEGIN
[0m20:19:53.372698 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:19:53.372934 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:19:53.373055 [debug] [MainThread]: On master: COMMIT
[0m20:19:53.373169 [debug] [MainThread]: Using duckdb connection "master"
[0m20:19:53.373280 [debug] [MainThread]: On master: COMMIT
[0m20:19:53.373447 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:19:53.373562 [debug] [MainThread]: On master: Close
[0m20:19:53.373714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:19:53.373828 [debug] [MainThread]: Connection 'test.dbt_an_data.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m20:19:53.373968 [info ] [MainThread]: 
[0m20:19:53.374104 [info ] [MainThread]: Finished running 1 table model, 4 data tests, 2 view models in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m20:19:53.374568 [debug] [MainThread]: Command end result
[0m20:19:53.384831 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m20:19:53.385755 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m20:19:53.388439 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m20:19:53.388590 [info ] [MainThread]: 
[0m20:19:53.388748 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m20:19:53.388882 [info ] [MainThread]: 
[0m20:19:53.389046 [error] [MainThread]: [31mFailure in model test (models/int/test.sql)[0m
[0m20:19:53.389195 [error] [MainThread]:   Runtime Error in model test (models/int/test.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 5:     SELECT * FROM stg.raw_acteurs;
                                           ^
[0m20:19:53.389309 [info ] [MainThread]: 
[0m20:19:53.389442 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/int/test.sql
[0m20:19:53.389562 [info ] [MainThread]: 
[0m20:19:53.389701 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m20:19:53.389838 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:19:53.389945 [info ] [MainThread]: 
[0m20:19:53.390074 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m20:19:53.390188 [info ] [MainThread]: 
[0m20:19:53.390323 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=3 NO-OP=0 TOTAL=7
[0m20:19:53.390608 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.83214223, "process_in_blocks": "0", "process_kernel_time": 0.202588, "process_mem_max_rss": "148373504", "process_out_blocks": "0", "process_user_time": 1.129778}
[0m20:19:53.390802 [debug] [MainThread]: Command `dbt build` failed at 20:19:53.390766 after 0.83 seconds
[0m20:19:53.390959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064aaf30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a557f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a550d0>]}
[0m20:19:53.391114 [debug] [MainThread]: Flushing usage events
[0m20:19:53.913906 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:24:13.996254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069bde20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10730b740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10730b3b0>]}


============================== 20:24:13.999453 | 59ce24f9-fb88-472d-a075-325ed3e94499 ==============================
[0m20:24:13.999453 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:24:13.999769 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_format': 'default', 'partial_parse': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'empty': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'debug': 'False', 'use_colors': 'True', 'introspect': 'True', 'write_json': 'True', 'invocation_command': 'dbt build', 'indirect_selection': 'eager', 'fail_fast': 'False', 'quiet': 'False'}
[0m20:24:14.191734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59ce24f9-fb88-472d-a075-325ed3e94499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107382db0>]}
[0m20:24:14.218933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59ce24f9-fb88-472d-a075-325ed3e94499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104efce90>]}
[0m20:24:14.220233 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:24:14.278533 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:24:14.350283 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 1 files added, 1 files changed.
[0m20:24:14.350686 [debug] [MainThread]: Partial parsing: added file: dbt_an_data://models/sources.yml
[0m20:24:14.350932 [debug] [MainThread]: Partial parsing: deleted file: dbt_an_data://models/example/my_first_dbt_model.sql
[0m20:24:14.351256 [debug] [MainThread]: Partial parsing: deleted file: dbt_an_data://models/example/my_second_dbt_model.sql
[0m20:24:14.351709 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/test.sql
[0m20:24:14.505963 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_an_data.stg
- models.dbt_an_data.mart
[0m20:24:14.510266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59ce24f9-fb88-472d-a075-325ed3e94499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c62c60>]}
[0m20:24:14.539139 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m20:24:14.540638 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m20:24:14.560157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59ce24f9-fb88-472d-a075-325ed3e94499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cfb440>]}
[0m20:24:14.560446 [info ] [MainThread]: Found 1 model, 9 sources, 468 macros
[0m20:24:14.561331 [info ] [MainThread]: 
[0m20:24:14.561505 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:24:14.561636 [info ] [MainThread]: 
[0m20:24:14.561858 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:24:14.562260 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m20:24:14.677302 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m20:24:14.677530 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m20:24:14.677664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:24:14.693676 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m20:24:14.694650 [debug] [ThreadPool]: On list_database: Close
[0m20:24:14.694985 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m20:24:14.695204 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m20:24:14.698334 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m20:24:14.698495 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m20:24:14.698623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:24:14.699185 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:24:14.699770 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m20:24:14.699906 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m20:24:14.700104 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:24:14.700221 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m20:24:14.700337 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m20:24:14.700868 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:24:14.701232 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m20:24:14.701365 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m20:24:14.701477 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m20:24:14.701645 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:24:14.701765 [debug] [ThreadPool]: On create_database_main: Close
[0m20:24:14.702181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_main, now list_database_main)
[0m20:24:14.704728 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m20:24:14.704878 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m20:24:14.704999 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:24:14.705194 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:24:14.705310 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m20:24:14.705432 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m20:24:14.712973 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m20:24:14.713620 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m20:24:14.714501 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m20:24:14.714635 [debug] [ThreadPool]: On list_database_main: Close
[0m20:24:14.714968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59ce24f9-fb88-472d-a075-325ed3e94499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c620c0>]}
[0m20:24:14.715185 [debug] [MainThread]: Using duckdb connection "master"
[0m20:24:14.715314 [debug] [MainThread]: On master: BEGIN
[0m20:24:14.715426 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:24:14.715639 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:24:14.715761 [debug] [MainThread]: On master: COMMIT
[0m20:24:14.715877 [debug] [MainThread]: Using duckdb connection "master"
[0m20:24:14.715989 [debug] [MainThread]: On master: COMMIT
[0m20:24:14.716160 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:24:14.716280 [debug] [MainThread]: On master: Close
[0m20:24:14.717572 [debug] [Thread-1 (]: Began running node model.dbt_an_data.test
[0m20:24:14.717800 [info ] [Thread-1 (]: 1 of 1 START sql view model main.test .......................................... [RUN]
[0m20:24:14.717990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_database_main, now model.dbt_an_data.test)
[0m20:24:14.718130 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.test
[0m20:24:14.721434 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.test"
[0m20:24:14.721783 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.test
[0m20:24:14.736720 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.test"
[0m20:24:14.737081 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.test"
[0m20:24:14.737239 [debug] [Thread-1 (]: On model.dbt_an_data.test: BEGIN
[0m20:24:14.737375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:14.737673 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:14.737812 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.test"
[0m20:24:14.737946 [debug] [Thread-1 (]: On model.dbt_an_data.test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.test"} */

  
  create view "database"."main"."test__dbt_tmp" as (
    SELECT * FROM "database"."stg"."raw_agenda"
  );

[0m20:24:14.738240 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:14.741056 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.test"
[0m20:24:14.741233 [debug] [Thread-1 (]: On model.dbt_an_data.test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.test"} */
alter view "database"."main"."test__dbt_tmp" rename to "test"
[0m20:24:14.742084 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:14.747052 [debug] [Thread-1 (]: On model.dbt_an_data.test: COMMIT
[0m20:24:14.747290 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.test"
[0m20:24:14.747441 [debug] [Thread-1 (]: On model.dbt_an_data.test: COMMIT
[0m20:24:14.748463 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:14.751911 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.test"
[0m20:24:14.752114 [debug] [Thread-1 (]: On model.dbt_an_data.test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.test"} */

      drop view if exists "database"."main"."test__dbt_backup" cascade
    
[0m20:24:14.752457 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:14.753600 [debug] [Thread-1 (]: On model.dbt_an_data.test: Close
[0m20:24:14.754521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59ce24f9-fb88-472d-a075-325ed3e94499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078fdb80>]}
[0m20:24:14.754818 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.test ..................................... [[32mOK[0m in 0.04s]
[0m20:24:14.755071 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.test
[0m20:24:14.755584 [debug] [MainThread]: Using duckdb connection "master"
[0m20:24:14.755718 [debug] [MainThread]: On master: BEGIN
[0m20:24:14.755827 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:24:14.756049 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:24:14.756169 [debug] [MainThread]: On master: COMMIT
[0m20:24:14.756282 [debug] [MainThread]: Using duckdb connection "master"
[0m20:24:14.756387 [debug] [MainThread]: On master: COMMIT
[0m20:24:14.756546 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:24:14.756660 [debug] [MainThread]: On master: Close
[0m20:24:14.756809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:24:14.756915 [debug] [MainThread]: Connection 'model.dbt_an_data.test' was properly closed.
[0m20:24:14.757027 [info ] [MainThread]: 
[0m20:24:14.757151 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m20:24:14.757427 [debug] [MainThread]: Command end result
[0m20:24:14.766700 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m20:24:14.767648 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m20:24:14.770559 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m20:24:14.770812 [info ] [MainThread]: 
[0m20:24:14.771024 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:24:14.771159 [info ] [MainThread]: 
[0m20:24:14.771321 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:24:14.771716 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.81338686, "process_in_blocks": "0", "process_kernel_time": 0.196534, "process_mem_max_rss": "144785408", "process_out_blocks": "0", "process_user_time": 1.124999}
[0m20:24:14.771942 [debug] [MainThread]: Command `dbt build` succeeded at 20:24:14.771900 after 0.81 seconds
[0m20:24:14.772108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10730b5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10730b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10730b5f0>]}
[0m20:24:14.772271 [debug] [MainThread]: Flushing usage events
[0m20:24:15.286114 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:25:32.210164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cfaf00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094db770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094db3e0>]}


============================== 20:25:32.213351 | 917fe159-35ae-4bc8-abab-bcb795269cf5 ==============================
[0m20:25:32.213351 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:25:32.213655 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'static_parser': 'True', 'fail_fast': 'False', 'quiet': 'False', 'no_print': 'None', 'invocation_command': 'dbt build', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'target_path': 'None', 'write_json': 'True', 'warn_error': 'None', 'printer_width': '80'}
[0m20:25:32.399006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '917fe159-35ae-4bc8-abab-bcb795269cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109672960>]}
[0m20:25:32.426108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '917fe159-35ae-4bc8-abab-bcb795269cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094daea0>]}
[0m20:25:32.427527 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:25:32.485654 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:25:32.557409 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:25:32.557689 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:25:32.560672 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_an_data.mart
- models.dbt_an_data.stg
[0m20:25:32.572991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '917fe159-35ae-4bc8-abab-bcb795269cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109759af0>]}
[0m20:25:32.605706 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m20:25:32.607190 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m20:25:32.626436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '917fe159-35ae-4bc8-abab-bcb795269cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a5bc20>]}
[0m20:25:32.626707 [info ] [MainThread]: Found 1 model, 9 sources, 468 macros
[0m20:25:32.627671 [info ] [MainThread]: 
[0m20:25:32.627855 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:25:32.627988 [info ] [MainThread]: 
[0m20:25:32.628230 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:25:32.628694 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m20:25:32.714641 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m20:25:32.714873 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m20:25:32.715019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:32.732699 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m20:25:32.733699 [debug] [ThreadPool]: On list_database: Close
[0m20:25:32.734045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m20:25:32.734289 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m20:25:32.737534 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m20:25:32.737696 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m20:25:32.737829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:32.738471 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:25:32.739062 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m20:25:32.739192 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m20:25:32.739384 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:25:32.739506 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m20:25:32.739624 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m20:25:32.740528 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:25:32.740904 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m20:25:32.741034 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m20:25:32.741140 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m20:25:32.741302 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:25:32.741427 [debug] [ThreadPool]: On create_database_main: Close
[0m20:25:32.741869 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_main, now list_database_main)
[0m20:25:32.744371 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m20:25:32.744521 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m20:25:32.744639 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:32.744854 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:25:32.744979 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m20:25:32.745115 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m20:25:32.753391 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m20:25:32.754245 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m20:25:32.755177 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m20:25:32.755302 [debug] [ThreadPool]: On list_database_main: Close
[0m20:25:32.755534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '917fe159-35ae-4bc8-abab-bcb795269cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097a8fe0>]}
[0m20:25:32.755764 [debug] [MainThread]: Using duckdb connection "master"
[0m20:25:32.755895 [debug] [MainThread]: On master: BEGIN
[0m20:25:32.756007 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:25:32.756226 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:25:32.756354 [debug] [MainThread]: On master: COMMIT
[0m20:25:32.756472 [debug] [MainThread]: Using duckdb connection "master"
[0m20:25:32.756583 [debug] [MainThread]: On master: COMMIT
[0m20:25:32.756751 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:25:32.756867 [debug] [MainThread]: On master: Close
[0m20:25:32.758182 [debug] [Thread-1 (]: Began running node model.dbt_an_data.test
[0m20:25:32.758419 [info ] [Thread-1 (]: 1 of 1 START sql view model main.test .......................................... [RUN]
[0m20:25:32.758611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_database_main, now model.dbt_an_data.test)
[0m20:25:32.758764 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.test
[0m20:25:32.762058 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.test"
[0m20:25:32.762404 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.test
[0m20:25:32.777586 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.test"
[0m20:25:32.778177 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.test"
[0m20:25:32.778341 [debug] [Thread-1 (]: On model.dbt_an_data.test: BEGIN
[0m20:25:32.778484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:32.778804 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:32.778944 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.test"
[0m20:25:32.779082 [debug] [Thread-1 (]: On model.dbt_an_data.test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.test"} */

  
  create view "database"."main"."test__dbt_tmp" as (
    SELECT * FROM "database"."stg"."raw_agenda"
  );

[0m20:25:32.779382 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:32.782213 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.test"
[0m20:25:32.782389 [debug] [Thread-1 (]: On model.dbt_an_data.test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.test"} */
alter view "database"."main"."test__dbt_tmp" rename to "test"
[0m20:25:32.783696 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:25:32.789828 [debug] [Thread-1 (]: On model.dbt_an_data.test: COMMIT
[0m20:25:32.790076 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.test"
[0m20:25:32.790232 [debug] [Thread-1 (]: On model.dbt_an_data.test: COMMIT
[0m20:25:32.791408 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:25:32.793930 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.test"
[0m20:25:32.794096 [debug] [Thread-1 (]: On model.dbt_an_data.test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.test"} */

      drop view if exists "database"."main"."test__dbt_backup" cascade
    
[0m20:25:32.794554 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:25:32.795644 [debug] [Thread-1 (]: On model.dbt_an_data.test: Close
[0m20:25:32.796530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '917fe159-35ae-4bc8-abab-bcb795269cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fa6c90>]}
[0m20:25:32.796824 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.test ..................................... [[32mOK[0m in 0.04s]
[0m20:25:32.797078 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.test
[0m20:25:32.797642 [debug] [MainThread]: Using duckdb connection "master"
[0m20:25:32.797804 [debug] [MainThread]: On master: BEGIN
[0m20:25:32.797925 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:25:32.798145 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:25:32.798270 [debug] [MainThread]: On master: COMMIT
[0m20:25:32.798386 [debug] [MainThread]: Using duckdb connection "master"
[0m20:25:32.798494 [debug] [MainThread]: On master: COMMIT
[0m20:25:32.798655 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:25:32.798771 [debug] [MainThread]: On master: Close
[0m20:25:32.798920 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:25:32.799030 [debug] [MainThread]: Connection 'model.dbt_an_data.test' was properly closed.
[0m20:25:32.799146 [info ] [MainThread]: 
[0m20:25:32.799277 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m20:25:32.799550 [debug] [MainThread]: Command end result
[0m20:25:32.809638 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m20:25:32.810671 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m20:25:32.813585 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m20:25:32.813727 [info ] [MainThread]: 
[0m20:25:32.813903 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:25:32.814033 [info ] [MainThread]: 
[0m20:25:32.814182 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:25:32.814473 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.6457948, "process_in_blocks": "0", "process_kernel_time": 0.199988, "process_mem_max_rss": "141344768", "process_out_blocks": "0", "process_user_time": 0.961941}
[0m20:25:32.814699 [debug] [MainThread]: Command `dbt build` succeeded at 20:25:32.814660 after 0.65 seconds
[0m20:25:32.814879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cfaf00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094db3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094db620>]}
[0m20:25:32.815045 [debug] [MainThread]: Flushing usage events
[0m20:25:33.338129 [debug] [MainThread]: An error was encountered while trying to flush usage events
{"data":{"log_version":3,"version":"2.0.0-preview.72"},"info":{"category":"","code":"","extra":{},"invocation_id":"019ab75f-b2f9-7550-b737-bb0817442218","level":"error","msg":"error: dbt1005: Failed to parse profiles.yml: unknown variant `duckdb`, expected one of `redshift`, `snowflake`, `postgres`, `bigquery`, `trino`, `datafusion`, `databricks`, `salesforce`","name":"Generic","pid":54756,"thread":"tokio-runtime-worker","ts":"2025-11-24T19:38:13.632192Z"}}
{"data":{"completed_at":"2025-11-24T19:38:13.782591Z","elapsed":0.15514199435710907,"log_version":3,"success":false,"version":"2.0.0-preview.72"},"info":{"category":"","code":"Q039","extra":{},"invocation_id":"019ab75f-b2f9-7550-b737-bb0817442218","level":"info","msg":"\n==================== Execution Summary =====================\nFinished 'show' with 1 error [155ms]","name":"CommandCompleted","pid":54756,"thread":"tokio-runtime-worker","ts":"2025-11-24T19:38:13.782666Z"}}
==================== 2025-11-24 19:39:20.649232 | 019ab760-b8bd-75f2-8024-d7386b760994 ====================
==================== 2025-11-24 19:40:13.928702 | 019ab761-88e7-7fd2-af0f-0e94f125061b ====================
dbt-fusion 2.0.0-preview.72
   Loading profiles.yml
19:40:13.961705 [error]: dbt1005: Failed to parse profiles.yml: unknown variant `duckdb`, expected one of `redshift`, `snowflake`, `postgres`, `bigquery`, `trino`, `datafusion`, `databricks`, `salesforce`
19:40:14.108561 [info ]: 
==================== Execution Summary =====================
Finished 'debug' with 1 error [179ms]
19:40:14.143401 [info ]: 
==================== Execution Summary =====================
Finished 'init' successfully [53.5s]
[0m20:40:39.941202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a90b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088574a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108857110>]}


============================== 20:40:39.944437 | bdb015d1-4c3e-4d1b-82ab-1f82906cdc77 ==============================
[0m20:40:39.944437 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:40:39.944791 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'quiet': 'False', 'fail_fast': 'False', 'write_json': 'True', 'log_format': 'default', 'partial_parse': 'True', 'empty': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'target_path': 'None', 'debug': 'False', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'use_experimental_parser': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'invocation_command': 'dbt debug', 'printer_width': '80', 'warn_error': 'None'}
[0m20:40:39.958858 [info ] [MainThread]: dbt version: 1.10.15
[0m20:40:39.959161 [info ] [MainThread]: python version: 3.12.9
[0m20:40:39.959322 [info ] [MainThread]: python path: /Users/mael/DEV/an-data-pipeline/.venv/bin/python3
[0m20:40:39.959466 [info ] [MainThread]: os info: macOS-15.3.1-arm64-arm-64bit
[0m20:40:40.093118 [info ] [MainThread]: Using profiles dir at /Users/mael/DEV/an-data-pipeline/dbt
[0m20:40:40.093399 [info ] [MainThread]: Using profiles.yml file at /Users/mael/DEV/an-data-pipeline/dbt/profiles.yml
[0m20:40:40.093557 [info ] [MainThread]: Using dbt_project.yml file at /Users/mael/DEV/an-data-pipeline/dbt/dbt_project.yml
[0m20:40:40.094822 [info ] [MainThread]: adapter type: duckdb
[0m20:40:40.094985 [info ] [MainThread]: adapter version: 1.10.0
[0m20:40:40.140514 [info ] [MainThread]: Configuration:
[0m20:40:40.140796 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:40:40.140986 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:40:40.141205 [info ] [MainThread]: Required dependencies:
[0m20:40:40.141436 [debug] [MainThread]: Executing "git --help"
[0m20:40:40.158072 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:40:40.158642 [debug] [MainThread]: STDERR: "b''"
[0m20:40:40.158868 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:40:40.159061 [info ] [MainThread]: Connection:
[0m20:40:40.159250 [info ] [MainThread]:   database: database
[0m20:40:40.159388 [info ] [MainThread]:   schema: main
[0m20:40:40.159519 [info ] [MainThread]:   path: ../data/database/database.duckdb
[0m20:40:40.159649 [info ] [MainThread]:   config_options: None
[0m20:40:40.159777 [info ] [MainThread]:   extensions: None
[0m20:40:40.159904 [info ] [MainThread]:   settings: {}
[0m20:40:40.160028 [info ] [MainThread]:   external_root: .
[0m20:40:40.160156 [info ] [MainThread]:   use_credential_provider: None
[0m20:40:40.160276 [info ] [MainThread]:   attach: None
[0m20:40:40.160479 [info ] [MainThread]:   filesystems: None
[0m20:40:40.160756 [info ] [MainThread]:   remote: None
[0m20:40:40.160923 [info ] [MainThread]:   plugins: None
[0m20:40:40.161060 [info ] [MainThread]:   disable_transactions: False
[0m20:40:40.161451 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:40:40.216066 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m20:40:40.302388 [debug] [MainThread]: Using duckdb connection "debug"
[0m20:40:40.302647 [debug] [MainThread]: On debug: select 1 as id
[0m20:40:40.302798 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:40:40.319563 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m20:40:40.320166 [debug] [MainThread]: On debug: Close
[0m20:40:40.320384 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:40:40.320567 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:40:40.320935 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.42207313, "process_in_blocks": "0", "process_kernel_time": 0.214263, "process_mem_max_rss": "128745472", "process_out_blocks": "0", "process_user_time": 0.767153}
[0m20:40:40.321189 [debug] [MainThread]: Command `dbt debug` succeeded at 20:40:40.321142 after 0.42 seconds
[0m20:40:40.321356 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:40:40.321541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108810590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10864e1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a02c2c0>]}
[0m20:40:40.321756 [debug] [MainThread]: Flushing usage events
[0m20:40:40.839463 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:44:31.026913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dca7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096af440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096af0b0>]}


============================== 20:44:31.030075 | 139ef1ef-de93-4d50-946f-db7b23558441 ==============================
[0m20:44:31.030075 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:44:31.030432 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'cache_selected_only': 'False', 'quiet': 'False', 'empty': 'None', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'no_print': 'None', 'introspect': 'True', 'printer_width': '80', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False', 'target_path': 'None', 'invocation_command': 'dbt debug', 'log_cache_events': 'False'}
[0m20:44:31.040183 [info ] [MainThread]: dbt version: 1.10.15
[0m20:44:31.040486 [info ] [MainThread]: python version: 3.12.9
[0m20:44:31.040644 [info ] [MainThread]: python path: /Users/mael/DEV/an-data-pipeline/.venv/bin/python3
[0m20:44:31.040790 [info ] [MainThread]: os info: macOS-15.3.1-arm64-arm-64bit
[0m20:44:31.170892 [info ] [MainThread]: Using profiles dir at /Users/mael/DEV/an-data-pipeline/dbt
[0m20:44:31.171175 [info ] [MainThread]: Using profiles.yml file at /Users/mael/DEV/an-data-pipeline/dbt/profiles.yml
[0m20:44:31.171343 [info ] [MainThread]: Using dbt_project.yml file at /Users/mael/DEV/an-data-pipeline/dbt/dbt_project.yml
[0m20:44:31.172595 [info ] [MainThread]: adapter type: duckdb
[0m20:44:31.172801 [info ] [MainThread]: adapter version: 1.10.0
[0m20:44:31.218040 [info ] [MainThread]: Configuration:
[0m20:44:31.218328 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:44:31.218490 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:44:31.218636 [info ] [MainThread]: Required dependencies:
[0m20:44:31.218846 [debug] [MainThread]: Executing "git --help"
[0m20:44:31.237562 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:44:31.238097 [debug] [MainThread]: STDERR: "b''"
[0m20:44:31.238321 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:44:31.238638 [info ] [MainThread]: Connection:
[0m20:44:31.238838 [info ] [MainThread]:   database: database
[0m20:44:31.238990 [info ] [MainThread]:   schema: main
[0m20:44:31.239126 [info ] [MainThread]:   path: ../data/database/database.duckdb
[0m20:44:31.239263 [info ] [MainThread]:   config_options: None
[0m20:44:31.239401 [info ] [MainThread]:   extensions: None
[0m20:44:31.239536 [info ] [MainThread]:   settings: {}
[0m20:44:31.239759 [info ] [MainThread]:   external_root: .
[0m20:44:31.240182 [info ] [MainThread]:   use_credential_provider: None
[0m20:44:31.240427 [info ] [MainThread]:   attach: None
[0m20:44:31.240687 [info ] [MainThread]:   filesystems: None
[0m20:44:31.240881 [info ] [MainThread]:   remote: None
[0m20:44:31.241042 [info ] [MainThread]:   plugins: None
[0m20:44:31.241202 [info ] [MainThread]:   disable_transactions: False
[0m20:44:31.241689 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:44:31.336671 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m20:44:31.415323 [debug] [MainThread]: Using duckdb connection "debug"
[0m20:44:31.415577 [debug] [MainThread]: On debug: select 1 as id
[0m20:44:31.415731 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:44:31.432334 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m20:44:31.432913 [debug] [MainThread]: On debug: Close
[0m20:44:31.433317 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:44:31.433504 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:44:31.433886 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.4423392, "process_in_blocks": "0", "process_kernel_time": 0.176146, "process_mem_max_rss": "128565248", "process_out_blocks": "0", "process_user_time": 0.777193}
[0m20:44:31.434153 [debug] [MainThread]: Command `dbt debug` succeeded at 20:44:31.434101 after 0.44 seconds
[0m20:44:31.434311 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:44:31.434500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075ef440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d5d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10977cf20>]}
[0m20:44:31.434719 [debug] [MainThread]: Flushing usage events
[0m20:44:31.877487 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:45:45.792450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f6cda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aa2d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ffb3e0>]}


============================== 20:45:45.795833 | b58bd79d-2b3a-4660-b379-0bd22a76454c ==============================
[0m20:45:45.795833 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:45:45.796189 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'printer_width': '80', 'static_parser': 'True', 'quiet': 'False', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'empty': 'None', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'invocation_command': 'dbt show', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'version_check': 'True', 'log_format': 'default', 'use_colors': 'True', 'write_json': 'True', 'warn_error': 'None', 'cache_selected_only': 'False'}
[0m20:45:45.984706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b58bd79d-2b3a-4660-b379-0bd22a76454c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071a60f0>]}
[0m20:45:46.012086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b58bd79d-2b3a-4660-b379-0bd22a76454c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071a6a80>]}
[0m20:45:46.026031 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:45:46.088117 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:45:46.147383 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m20:45:46.147697 [debug] [MainThread]: Partial parsing: added file: dbt_an_data://models/int/int_agenda.sql
[0m20:45:46.147868 [debug] [MainThread]: Partial parsing: added file: dbt_an_data://models/int/int_scrutins.sql
[0m20:45:46.148006 [debug] [MainThread]: Partial parsing: deleted file: dbt_an_data://models/int/test.sql
[0m20:45:46.257356 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_an_data.stg
- models.dbt_an_data.mart
[0m20:45:46.263210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b58bd79d-2b3a-4660-b379-0bd22a76454c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076f1010>]}
[0m20:45:46.297306 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m20:45:46.299074 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m20:45:46.299368 [error] [MainThread]: Encountered an error:
Runtime Error
  Either --select or --inline must be passed to show
[0m20:45:46.299744 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.54572666, "process_in_blocks": "0", "process_kernel_time": 0.173413, "process_mem_max_rss": "126894080", "process_out_blocks": "0", "process_user_time": 0.95874}
[0m20:45:46.300002 [debug] [MainThread]: Command `dbt show` failed at 20:45:46.299954 after 0.55 seconds
[0m20:45:46.300216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077db800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077db8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077db770>]}
[0m20:45:46.300406 [debug] [MainThread]: Flushing usage events
[0m20:45:46.836649 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:46:15.373592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d6b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d87bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d856a0>]}


============================== 20:46:15.376883 | e6fcbd70-d119-4397-8f10-6ecea78b4729 ==============================
[0m20:46:15.376883 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:46:15.377243 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'empty': 'None', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'debug': 'False', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'static_parser': 'True', 'printer_width': '80', 'invocation_command': 'dbt show --select raw_scrutins', 'quiet': 'False', 'log_format': 'default', 'warn_error': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'no_print': 'None', 'target_path': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'introspect': 'True', 'log_cache_events': 'False'}
[0m20:46:15.561766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6fcbd70-d119-4397-8f10-6ecea78b4729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a6f950>]}
[0m20:46:15.589458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6fcbd70-d119-4397-8f10-6ecea78b4729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b889e0>]}
[0m20:46:15.603117 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:46:15.674383 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:46:15.729504 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:46:15.729751 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:46:15.732582 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_an_data.mart
- models.dbt_an_data.stg
[0m20:46:15.745910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6fcbd70-d119-4397-8f10-6ecea78b4729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cedca0>]}
[0m20:46:15.777961 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m20:46:15.779393 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m20:46:15.780777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6fcbd70-d119-4397-8f10-6ecea78b4729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f238c0>]}
[0m20:46:15.781029 [info ] [MainThread]: Found 2 models, 9 sources, 468 macros
[0m20:46:15.781208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6fcbd70-d119-4397-8f10-6ecea78b4729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f23d40>]}
[0m20:46:15.781505 [warn ] [MainThread]: The selection criterion 'raw_scrutins' does not match any enabled nodes
[0m20:46:15.782046 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:46:15.782900 [debug] [MainThread]: Command end result
[0m20:46:15.792115 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m20:46:15.792967 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m20:46:15.794739 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m20:46:15.795099 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 0.45837024, "process_in_blocks": "0", "process_kernel_time": 0.167954, "process_mem_max_rss": "129220608", "process_out_blocks": "0", "process_user_time": 0.873022}
[0m20:46:15.795336 [debug] [MainThread]: Command `dbt show` succeeded at 20:46:15.795295 after 0.46 seconds
[0m20:46:15.795524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055695e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d2ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105385bb0>]}
[0m20:46:15.795697 [debug] [MainThread]: Flushing usage events
[0m20:46:16.236850 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:48:00.625085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089e9d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea4860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea5580>]}


============================== 20:48:00.628484 | 8cf386fe-fc96-4b0b-a77e-826324e4832a ==============================
[0m20:48:00.628484 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:48:00.628852 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'printer_width': '80', 'partial_parse': 'True', 'quiet': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'log_cache_events': 'False', 'debug': 'False', 'warn_error': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'version_check': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'empty': 'None', 'invocation_command': 'dbt show --select int_scrutins.sql', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None'}
[0m20:48:00.799283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cf386fe-fc96-4b0b-a77e-826324e4832a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d72ab0>]}
[0m20:48:00.826867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cf386fe-fc96-4b0b-a77e-826324e4832a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c516a0>]}
[0m20:48:00.840670 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:48:00.899238 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:48:00.955717 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:48:00.955960 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:48:00.958790 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_an_data.stg
- models.dbt_an_data.mart
[0m20:48:00.972654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cf386fe-fc96-4b0b-a77e-826324e4832a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d73f50>]}
[0m20:48:01.004462 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m20:48:01.005745 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m20:48:01.007052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cf386fe-fc96-4b0b-a77e-826324e4832a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091d3980>]}
[0m20:48:01.007290 [info ] [MainThread]: Found 2 models, 9 sources, 468 macros
[0m20:48:01.007470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cf386fe-fc96-4b0b-a77e-826324e4832a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091d3c50>]}
[0m20:48:01.008282 [info ] [MainThread]: 
[0m20:48:01.008465 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:48:01.008604 [info ] [MainThread]: 
[0m20:48:01.008845 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:48:01.010868 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m20:48:01.096636 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m20:48:01.096883 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m20:48:01.097041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:48:01.109853 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m20:48:01.110081 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m20:48:01.110250 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m20:48:01.125485 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m20:48:01.126487 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m20:48:01.127441 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m20:48:01.127598 [debug] [ThreadPool]: On list_database_main: Close
[0m20:48:01.127898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cf386fe-fc96-4b0b-a77e-826324e4832a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c53890>]}
[0m20:48:01.129338 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins
[0m20:48:01.129544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_database_main, now model.dbt_an_data.int_scrutins)
[0m20:48:01.129716 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins
[0m20:48:01.133270 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins"
[0m20:48:01.133644 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins
[0m20:48:01.137073 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:48:01.137320 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

  
  SELECT
filename,
json_extract_string(json, '$.scrutin.uid') AS uid,
json_extract_string(json, '$.scrutin.numero') AS numero,
json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
json_extract_string(json, '$.scrutin.legislature') AS legislature,
json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
json_extract_string(json, '$.scrutin.titre') AS titre,
json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote
FROM "database"."stg"."raw_scrutins";
  
  limit 5

[0m20:48:01.137531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:01.140932 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

  
  SELECT
filename,
json_extract_string(json, '$.scrutin.uid') AS uid,
json_extract_string(json, '$.scrutin.numero') AS numero,
json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
json_extract_string(json, '$.scrutin.legislature') AS legislature,
json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
json_extract_string(json, '$.scrutin.titre') AS titre,
json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote
FROM "database"."stg"."raw_scrutins";
  
  limit 5

[0m20:48:01.141155 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:48:01.141361 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: Close
[0m20:48:01.144290 [debug] [Thread-1 (]: Runtime Error in model int_scrutins (models/int/int_scrutins.sql)
  Parser Error: syntax error at or near "limit"
  
  LINE 20:   limit 5
             ^
[0m20:48:01.144567 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins
[0m20:48:01.144830 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.int_scrutins' to be skipped because of status 'error'.  Reason: Runtime Error in model int_scrutins (models/int/int_scrutins.sql)
  Parser Error: syntax error at or near "limit"
  
  LINE 20:   limit 5
             ^.
[0m20:48:01.145314 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:48:01.145536 [debug] [MainThread]: Connection 'model.dbt_an_data.int_scrutins' was properly closed.
[0m20:48:01.145803 [error] [MainThread]: Encountered an error:
Runtime Error
  Runtime Error in model int_scrutins (models/int/int_scrutins.sql)
    Parser Error: syntax error at or near "limit"
    
    LINE 20:   limit 5
               ^
[0m20:48:01.146161 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.5619546, "process_in_blocks": "0", "process_kernel_time": 0.199082, "process_mem_max_rss": "138067968", "process_out_blocks": "0", "process_user_time": 0.918804}
[0m20:48:01.146439 [debug] [MainThread]: Command `dbt show` failed at 20:48:01.146387 after 0.56 seconds
[0m20:48:01.146652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b7baa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091d3d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094a46b0>]}
[0m20:48:01.146846 [debug] [MainThread]: Flushing usage events
[0m20:48:01.601155 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:49:51.655313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10660c140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f31460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f31430>]}


============================== 20:49:51.658433 | 58317b27-a928-45e1-b684-9f274ead4c1f ==============================
[0m20:49:51.658433 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:49:51.658788 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'printer_width': '80', 'invocation_command': 'dbt show --select int_scrutins.sql', 'introspect': 'True', 'target_path': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'log_format': 'default', 'quiet': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt'}
[0m20:49:51.810698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58317b27-a928-45e1-b684-9f274ead4c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ca6e70>]}
[0m20:49:51.838008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58317b27-a928-45e1-b684-9f274ead4c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106403260>]}
[0m20:49:51.851649 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:49:51.910449 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:49:51.966879 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m20:49:51.967201 [debug] [MainThread]: Partial parsing: added file: dbt_an_data://models/stg/stg_scrutins.sql
[0m20:49:51.967408 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_scrutins.sql
[0m20:49:52.053626 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_an_data.int_scrutins' (models/int/int_scrutins.sql) depends on a node named 'stg_raw_scrutins' which was not found
[0m20:49:52.054119 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.43622375, "process_in_blocks": "0", "process_kernel_time": 0.165477, "process_mem_max_rss": "129695744", "process_out_blocks": "0", "process_user_time": 0.901088}
[0m20:49:52.054385 [debug] [MainThread]: Command `dbt show` failed at 20:49:52.054335 after 0.44 seconds
[0m20:49:52.054600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c1f170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf06b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f3de50>]}
[0m20:49:52.054796 [debug] [MainThread]: Flushing usage events
[0m20:49:52.501315 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:50:16.732571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c549e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c77b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080f15b0>]}


============================== 20:50:16.736017 | 671ac63f-46f7-4290-8124-f15421b25431 ==============================
[0m20:50:16.736017 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:50:16.736388 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt show --select int_scrutins.sql', 'static_parser': 'True', 'partial_parse': 'True', 'printer_width': '80', 'target_path': 'None', 'version_check': 'True', 'write_json': 'True', 'warn_error': 'None', 'no_print': 'None', 'quiet': 'False', 'debug': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'empty': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'use_experimental_parser': 'False', 'introspect': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs'}
[0m20:50:16.893847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '671ac63f-46f7-4290-8124-f15421b25431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f6e450>]}
[0m20:50:16.920987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '671ac63f-46f7-4290-8124-f15421b25431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e59010>]}
[0m20:50:16.933338 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:50:16.991514 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:50:17.046570 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m20:50:17.046889 [debug] [MainThread]: Partial parsing: added file: dbt_an_data://models/stg/stg_scrutins.sql
[0m20:50:17.047093 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_scrutins.sql
[0m20:50:17.156658 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_an_data.mart
[0m20:50:17.162635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '671ac63f-46f7-4290-8124-f15421b25431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10945abd0>]}
[0m20:50:17.194528 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m20:50:17.195997 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m20:50:17.197310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '671ac63f-46f7-4290-8124-f15421b25431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10959b980>]}
[0m20:50:17.197545 [info ] [MainThread]: Found 3 models, 9 sources, 468 macros
[0m20:50:17.197724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '671ac63f-46f7-4290-8124-f15421b25431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10959b8f0>]}
[0m20:50:17.198564 [info ] [MainThread]: 
[0m20:50:17.198752 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:50:17.198894 [info ] [MainThread]: 
[0m20:50:17.199140 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:50:17.201284 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m20:50:17.284708 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m20:50:17.285002 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m20:50:17.285177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:17.297309 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m20:50:17.297555 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m20:50:17.297720 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m20:50:17.312413 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m20:50:17.313433 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m20:50:17.314388 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m20:50:17.314570 [debug] [ThreadPool]: On list_database_main: Close
[0m20:50:17.314905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '671ac63f-46f7-4290-8124-f15421b25431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec01d0>]}
[0m20:50:17.316310 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins
[0m20:50:17.316525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_database_main, now model.dbt_an_data.int_scrutins)
[0m20:50:17.316703 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins
[0m20:50:17.320370 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins"
[0m20:50:17.320900 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins
[0m20:50:17.324843 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:50:17.325070 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

  
  SELECT
filename,
json_extract_string(json, '$.scrutin.uid') AS uid,
json_extract_string(json, '$.scrutin.numero') AS numero,
json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
json_extract_string(json, '$.scrutin.legislature') AS legislature,
json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
json_extract_string(json, '$.scrutin.titre') AS titre,
json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote
FROM "database"."main"."stg_scrutins";
  
  limit 5

[0m20:50:17.325258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:50:17.328543 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

  
  SELECT
filename,
json_extract_string(json, '$.scrutin.uid') AS uid,
json_extract_string(json, '$.scrutin.numero') AS numero,
json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
json_extract_string(json, '$.scrutin.legislature') AS legislature,
json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
json_extract_string(json, '$.scrutin.titre') AS titre,
json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote
FROM "database"."main"."stg_scrutins";
  
  limit 5

[0m20:50:17.328757 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:50:17.328958 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: Close
[0m20:50:17.331778 [debug] [Thread-1 (]: Runtime Error in model int_scrutins (models/int/int_scrutins.sql)
  Parser Error: syntax error at or near "limit"
  
  LINE 20:   limit 5
             ^
[0m20:50:17.332074 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins
[0m20:50:17.332372 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.int_scrutins' to be skipped because of status 'error'.  Reason: Runtime Error in model int_scrutins (models/int/int_scrutins.sql)
  Parser Error: syntax error at or near "limit"
  
  LINE 20:   limit 5
             ^.
[0m20:50:17.332896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:50:17.333176 [debug] [MainThread]: Connection 'model.dbt_an_data.int_scrutins' was properly closed.
[0m20:50:17.333468 [error] [MainThread]: Encountered an error:
Runtime Error
  Runtime Error in model int_scrutins (models/int/int_scrutins.sql)
    Parser Error: syntax error at or near "limit"
    
    LINE 20:   limit 5
               ^
[0m20:50:17.333887 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.63837975, "process_in_blocks": "0", "process_kernel_time": 0.182598, "process_mem_max_rss": "141852672", "process_out_blocks": "0", "process_user_time": 1.016871}
[0m20:50:17.334172 [debug] [MainThread]: Command `dbt show` failed at 20:50:17.334123 after 0.64 seconds
[0m20:50:17.334406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080f15b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a66c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a64e0>]}
[0m20:50:17.334612 [debug] [MainThread]: Flushing usage events
[0m20:50:17.765525 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:50:51.660587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ac9880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ef14c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ef13d0>]}


============================== 20:50:51.663706 | 2db89688-8146-44db-b92f-2e43d87ba287 ==============================
[0m20:50:51.663706 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:50:51.664056 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt show --select int_scrutins.sql', 'log_format': 'default', 'static_parser': 'True', 'partial_parse': 'True', 'version_check': 'True', 'no_print': 'None', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'fail_fast': 'False', 'debug': 'False', 'empty': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'use_colors': 'True', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt'}
[0m20:50:51.844355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2db89688-8146-44db-b92f-2e43d87ba287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c71730>]}
[0m20:50:51.872203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2db89688-8146-44db-b92f-2e43d87ba287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c02600>]}
[0m20:50:51.886744 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:50:51.943385 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:50:52.000097 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:50:52.000445 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_scrutins.sql
[0m20:50:52.107236 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_an_data.mart
[0m20:50:52.113292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2db89688-8146-44db-b92f-2e43d87ba287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e75280>]}
[0m20:50:52.144864 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m20:50:52.146218 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m20:50:52.147302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2db89688-8146-44db-b92f-2e43d87ba287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10539bbc0>]}
[0m20:50:52.147547 [info ] [MainThread]: Found 3 models, 9 sources, 468 macros
[0m20:50:52.147730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2db89688-8146-44db-b92f-2e43d87ba287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e51400>]}
[0m20:50:52.148544 [info ] [MainThread]: 
[0m20:50:52.148727 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:50:52.148869 [info ] [MainThread]: 
[0m20:50:52.149110 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:50:52.151247 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m20:50:52.236022 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m20:50:52.236279 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m20:50:52.236438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:52.250031 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m20:50:52.250288 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m20:50:52.250456 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m20:50:52.263228 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m20:50:52.264215 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m20:50:52.265159 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m20:50:52.265318 [debug] [ThreadPool]: On list_database_main: Close
[0m20:50:52.265624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2db89688-8146-44db-b92f-2e43d87ba287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027c1340>]}
[0m20:50:52.267020 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins
[0m20:50:52.267226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_database_main, now model.dbt_an_data.int_scrutins)
[0m20:50:52.267401 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins
[0m20:50:52.270944 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins"
[0m20:50:52.271338 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins
[0m20:50:52.275257 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:50:52.275486 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

  
  SELECT
filename,
json_extract_string(json, '$.scrutin.uid') AS uid,
json_extract_string(json, '$.scrutin.numero') AS numero,
json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
json_extract_string(json, '$.scrutin.legislature') AS legislature,
json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
json_extract_string(json, '$.scrutin.titre') AS titre,
json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote
FROM "database"."main"."stg_scrutins"
  
  limit 5

[0m20:50:52.275682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:50:52.280320 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

  
  SELECT
filename,
json_extract_string(json, '$.scrutin.uid') AS uid,
json_extract_string(json, '$.scrutin.numero') AS numero,
json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
json_extract_string(json, '$.scrutin.legislature') AS legislature,
json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
json_extract_string(json, '$.scrutin.titre') AS titre,
json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote
FROM "database"."main"."stg_scrutins"
  
  limit 5

[0m20:50:52.280528 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:50:52.280729 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: Close
[0m20:50:52.283552 [debug] [Thread-1 (]: Runtime Error in model int_scrutins (models/int/int_scrutins.sql)
  Catalog Error: Table with name stg_scrutins does not exist!
  Did you mean "stg.raw_scrutins"?
  
  LINE 18: FROM "database"."main"."stg_scrutins"
                ^
[0m20:50:52.283849 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins
[0m20:50:52.284167 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.int_scrutins' to be skipped because of status 'error'.  Reason: Runtime Error in model int_scrutins (models/int/int_scrutins.sql)
  Catalog Error: Table with name stg_scrutins does not exist!
  Did you mean "stg.raw_scrutins"?
  
  LINE 18: FROM "database"."main"."stg_scrutins"
                ^.
[0m20:50:52.284722 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:50:52.284927 [debug] [MainThread]: Connection 'model.dbt_an_data.int_scrutins' was properly closed.
[0m20:50:52.285210 [error] [MainThread]: Encountered an error:
Runtime Error
  Runtime Error in model int_scrutins (models/int/int_scrutins.sql)
    Catalog Error: Table with name stg_scrutins does not exist!
    Did you mean "stg.raw_scrutins"?
    
    LINE 18: FROM "database"."main"."stg_scrutins"
                  ^
[0m20:50:52.285598 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.6617602, "process_in_blocks": "0", "process_kernel_time": 0.191931, "process_mem_max_rss": "140230656", "process_out_blocks": "0", "process_user_time": 1.01358}
[0m20:50:52.285878 [debug] [MainThread]: Command `dbt show` failed at 20:50:52.285832 after 0.66 seconds
[0m20:50:52.286097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc36b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10567cec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10567d010>]}
[0m20:50:52.286290 [debug] [MainThread]: Flushing usage events
[0m20:50:52.808017 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:51:50.653636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043368a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10506b6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10506b320>]}


============================== 20:51:50.656929 | cd01aca2-9f81-45d9-b7b9-1367bbbef3d9 ==============================
[0m20:51:50.656929 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:51:50.657285 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'introspect': 'True', 'printer_width': '80', 'quiet': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'static_parser': 'True', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'invocation_command': 'dbt show --select int_scrutins.sql', 'write_json': 'True', 'empty': 'None', 'indirect_selection': 'eager', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'no_print': 'None'}
[0m20:51:50.843878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd01aca2-9f81-45d9-b7b9-1367bbbef3d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050fcb90>]}
[0m20:51:50.871120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd01aca2-9f81-45d9-b7b9-1367bbbef3d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050a66f0>]}
[0m20:51:50.884814 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:51:50.942530 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:51:51.000044 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:51:51.000440 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/stg/stg_scrutins.sql
[0m20:51:51.109719 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_an_data.mart
[0m20:51:51.115684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd01aca2-9f81-45d9-b7b9-1367bbbef3d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105817bf0>]}
[0m20:51:51.147470 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m20:51:51.148720 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m20:51:51.149848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd01aca2-9f81-45d9-b7b9-1367bbbef3d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10586b980>]}
[0m20:51:51.150094 [info ] [MainThread]: Found 3 models, 9 sources, 468 macros
[0m20:51:51.150275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd01aca2-9f81-45d9-b7b9-1367bbbef3d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10586bc50>]}
[0m20:51:51.151198 [info ] [MainThread]: 
[0m20:51:51.151409 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:51:51.151559 [info ] [MainThread]: 
[0m20:51:51.151818 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:51:51.153966 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m20:51:51.238749 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m20:51:51.238999 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m20:51:51.239156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:51.252458 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m20:51:51.252684 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m20:51:51.252851 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m20:51:51.269760 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m20:51:51.270898 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m20:51:51.271827 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m20:51:51.271990 [debug] [ThreadPool]: On list_database_main: Close
[0m20:51:51.272304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd01aca2-9f81-45d9-b7b9-1367bbbef3d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10562b500>]}
[0m20:51:51.273703 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins
[0m20:51:51.273919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_database_main, now model.dbt_an_data.int_scrutins)
[0m20:51:51.274098 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins
[0m20:51:51.277619 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins"
[0m20:51:51.278319 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins
[0m20:51:51.282156 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:51:51.282373 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

  
  SELECT
filename,
json_extract_string(json, '$.scrutin.uid') AS uid,
json_extract_string(json, '$.scrutin.numero') AS numero,
json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
json_extract_string(json, '$.scrutin.legislature') AS legislature,
json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
json_extract_string(json, '$.scrutin.titre') AS titre,
json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote
FROM "database"."main"."stg_scrutins"
  
  limit 5

[0m20:51:51.282556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:51.287183 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

  
  SELECT
filename,
json_extract_string(json, '$.scrutin.uid') AS uid,
json_extract_string(json, '$.scrutin.numero') AS numero,
json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
json_extract_string(json, '$.scrutin.legislature') AS legislature,
json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
json_extract_string(json, '$.scrutin.titre') AS titre,
json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote
FROM "database"."main"."stg_scrutins"
  
  limit 5

[0m20:51:51.287423 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:51:51.287633 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: Close
[0m20:51:51.290513 [debug] [Thread-1 (]: Runtime Error in model int_scrutins (models/int/int_scrutins.sql)
  Catalog Error: Table with name stg_scrutins does not exist!
  Did you mean "stg.raw_scrutins"?
  
  LINE 18: FROM "database"."main"."stg_scrutins"
                ^
[0m20:51:51.290825 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins
[0m20:51:51.291143 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.int_scrutins' to be skipped because of status 'error'.  Reason: Runtime Error in model int_scrutins (models/int/int_scrutins.sql)
  Catalog Error: Table with name stg_scrutins does not exist!
  Did you mean "stg.raw_scrutins"?
  
  LINE 18: FROM "database"."main"."stg_scrutins"
                ^.
[0m20:51:51.291666 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:51:51.291846 [debug] [MainThread]: Connection 'model.dbt_an_data.int_scrutins' was properly closed.
[0m20:51:51.292135 [error] [MainThread]: Encountered an error:
Runtime Error
  Runtime Error in model int_scrutins (models/int/int_scrutins.sql)
    Catalog Error: Table with name stg_scrutins does not exist!
    Did you mean "stg.raw_scrutins"?
    
    LINE 18: FROM "database"."main"."stg_scrutins"
                  ^
[0m20:51:51.292483 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.6753451, "process_in_blocks": "0", "process_kernel_time": 0.190833, "process_mem_max_rss": "142409728", "process_out_blocks": "0", "process_user_time": 1.014392}
[0m20:51:51.292726 [debug] [MainThread]: Command `dbt show` failed at 20:51:51.292686 after 0.68 seconds
[0m20:51:51.292910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104825550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b20b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a24a10>]}
[0m20:51:51.293085 [debug] [MainThread]: Flushing usage events
[0m20:51:51.740311 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:52:41.337197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045b9640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056c3b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056c3710>]}


============================== 20:52:41.340695 | 58190d29-65b4-4d83-95d4-7b8c46af7119 ==============================
[0m20:52:41.340695 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:52:41.341050 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'introspect': 'True', 'warn_error': 'None', 'version_check': 'True', 'quiet': 'False', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'log_format': 'default', 'empty': 'False', 'printer_width': '80', 'fail_fast': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'no_print': 'None'}
[0m20:52:41.529826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58190d29-65b4-4d83-95d4-7b8c46af7119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040c31d0>]}
[0m20:52:41.557691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58190d29-65b4-4d83-95d4-7b8c46af7119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056f2180>]}
[0m20:52:41.559241 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:52:41.622364 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:52:41.681571 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:52:41.681936 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/sources.yml
[0m20:52:41.715570 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_an_data.mart
[0m20:52:41.721812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58190d29-65b4-4d83-95d4-7b8c46af7119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105763e90>]}
[0m20:52:41.753513 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m20:52:41.755236 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m20:52:41.776082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58190d29-65b4-4d83-95d4-7b8c46af7119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c9a0c0>]}
[0m20:52:41.776386 [info ] [MainThread]: Found 3 models, 9 sources, 468 macros
[0m20:52:41.777400 [info ] [MainThread]: 
[0m20:52:41.777613 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:52:41.777770 [info ] [MainThread]: 
[0m20:52:41.778023 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:52:41.780136 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m20:52:41.864327 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m20:52:41.864581 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m20:52:41.864737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:41.884940 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m20:52:41.885917 [debug] [ThreadPool]: On list_database: Close
[0m20:52:41.886277 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m20:52:41.886511 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m20:52:41.889703 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m20:52:41.889888 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m20:52:41.890031 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:41.890718 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:52:41.891325 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m20:52:41.891470 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m20:52:41.891703 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:52:41.891839 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m20:52:41.891973 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m20:52:41.892585 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:52:41.892982 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m20:52:41.893123 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m20:52:41.893248 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m20:52:41.893454 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:52:41.893594 [debug] [ThreadPool]: On create_database_main: Close
[0m20:52:41.894103 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_main, now list_database_main)
[0m20:52:41.896604 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m20:52:41.896769 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m20:52:41.896900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:41.897147 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:52:41.897295 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m20:52:41.897442 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m20:52:41.907495 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m20:52:41.908161 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m20:52:41.909121 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m20:52:41.909296 [debug] [ThreadPool]: On list_database_main: Close
[0m20:52:41.909574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58190d29-65b4-4d83-95d4-7b8c46af7119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10574ae10>]}
[0m20:52:41.909852 [debug] [MainThread]: Using duckdb connection "master"
[0m20:52:41.910018 [debug] [MainThread]: On master: BEGIN
[0m20:52:41.910162 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:52:41.910440 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:52:41.910599 [debug] [MainThread]: On master: COMMIT
[0m20:52:41.910743 [debug] [MainThread]: Using duckdb connection "master"
[0m20:52:41.910881 [debug] [MainThread]: On master: COMMIT
[0m20:52:41.911095 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:52:41.911239 [debug] [MainThread]: On master: Close
[0m20:52:41.912698 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_agenda
[0m20:52:41.912977 [info ] [Thread-1 (]: 1 of 3 START sql view model main.int_agenda .................................... [RUN]
[0m20:52:41.913202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_database_main, now model.dbt_an_data.int_agenda)
[0m20:52:41.913382 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_agenda
[0m20:52:41.916680 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_agenda"
[0m20:52:41.917057 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_agenda
[0m20:52:41.931542 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_agenda"
[0m20:52:41.932456 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:52:41.932663 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m20:52:41.932825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:41.933186 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:52:41.933421 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:52:41.933635 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */

  
  create view "database"."main"."int_agenda__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_agenda"
  );

[0m20:52:41.934152 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:52:41.937190 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:52:41.937405 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */
alter view "database"."main"."int_agenda__dbt_tmp" rename to "int_agenda"
[0m20:52:41.938421 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:52:41.942998 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m20:52:41.943200 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:52:41.943361 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m20:52:41.944648 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:52:41.947750 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:52:41.947944 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */

      drop view if exists "database"."main"."int_agenda__dbt_backup" cascade
    
[0m20:52:41.948318 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:52:41.949438 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: Close
[0m20:52:41.950618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58190d29-65b4-4d83-95d4-7b8c46af7119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049812b0>]}
[0m20:52:41.950950 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.int_agenda ............................... [[32mOK[0m in 0.04s]
[0m20:52:41.951224 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_agenda
[0m20:52:41.951423 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_scrutins
[0m20:52:41.951668 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_scrutins .................................. [RUN]
[0m20:52:41.951904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_agenda, now model.dbt_an_data.stg_scrutins)
[0m20:52:41.952094 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_scrutins
[0m20:52:41.953338 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_scrutins"
[0m20:52:41.953734 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_scrutins
[0m20:52:41.955215 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_scrutins"
[0m20:52:41.955553 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m20:52:41.955728 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: BEGIN
[0m20:52:41.955879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:41.956178 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:52:41.956339 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m20:52:41.956499 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins"} */

  
  create view "database"."main"."stg_scrutins__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_scrutins"
  );

[0m20:52:41.956822 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:52:41.958344 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m20:52:41.958615 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins"} */
alter view "database"."main"."stg_scrutins__dbt_tmp" rename to "stg_scrutins"
[0m20:52:41.959018 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:52:41.959878 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: COMMIT
[0m20:52:41.960082 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m20:52:41.960249 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: COMMIT
[0m20:52:41.960794 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:52:41.961955 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m20:52:41.962123 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins"} */

      drop view if exists "database"."main"."stg_scrutins__dbt_backup" cascade
    
[0m20:52:41.962410 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:52:41.963024 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: Close
[0m20:52:41.963300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58190d29-65b4-4d83-95d4-7b8c46af7119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106233b30>]}
[0m20:52:41.963584 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_scrutins ............................. [[32mOK[0m in 0.01s]
[0m20:52:41.963841 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_scrutins
[0m20:52:41.964195 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins
[0m20:52:41.964479 [info ] [Thread-1 (]: 3 of 3 START sql view model main.int_scrutins .................................. [RUN]
[0m20:52:41.964727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_scrutins, now model.dbt_an_data.int_scrutins)
[0m20:52:41.964913 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins
[0m20:52:41.966236 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins"
[0m20:52:41.966859 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins
[0m20:52:41.968548 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins"
[0m20:52:41.968945 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:52:41.969116 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m20:52:41.969265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:41.969640 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:52:41.969898 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:52:41.970120 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

  
  create view "database"."main"."int_scrutins__dbt_tmp" as (
    SELECT
filename,
json_extract_string(json, '$.scrutin.uid') AS uid,
json_extract_string(json, '$.scrutin.numero') AS numero,
json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
json_extract_string(json, '$.scrutin.legislature') AS legislature,
json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
json_extract_string(json, '$.scrutin.titre') AS titre,
json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote
FROM "database"."main"."stg_scrutins"
  );

[0m20:52:41.970755 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:52:41.972188 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:52:41.972363 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */
alter view "database"."main"."int_scrutins__dbt_tmp" rename to "int_scrutins"
[0m20:52:41.972664 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:52:41.973311 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m20:52:41.973474 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:52:41.973622 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m20:52:41.973993 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:52:41.975016 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:52:41.975179 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop view if exists "database"."main"."int_scrutins__dbt_backup" cascade
    
[0m20:52:41.975448 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:52:41.976058 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: Close
[0m20:52:41.976322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58190d29-65b4-4d83-95d4-7b8c46af7119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062a9a00>]}
[0m20:52:41.976603 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.int_scrutins ............................. [[32mOK[0m in 0.01s]
[0m20:52:41.976852 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins
[0m20:52:41.977354 [debug] [MainThread]: Using duckdb connection "master"
[0m20:52:41.977518 [debug] [MainThread]: On master: BEGIN
[0m20:52:41.977649 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:52:41.977905 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:52:41.978051 [debug] [MainThread]: On master: COMMIT
[0m20:52:41.978189 [debug] [MainThread]: Using duckdb connection "master"
[0m20:52:41.978316 [debug] [MainThread]: On master: COMMIT
[0m20:52:41.978518 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:52:41.978658 [debug] [MainThread]: On master: Close
[0m20:52:41.978837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:52:41.978962 [debug] [MainThread]: Connection 'model.dbt_an_data.int_scrutins' was properly closed.
[0m20:52:41.979128 [info ] [MainThread]: 
[0m20:52:41.979312 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m20:52:41.979723 [debug] [MainThread]: Command end result
[0m20:52:42.021195 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m20:52:42.022113 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m20:52:42.024962 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m20:52:42.025152 [info ] [MainThread]: 
[0m20:52:42.025357 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:52:42.025510 [info ] [MainThread]: 
[0m20:52:42.025678 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m20:52:42.025993 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.7279142, "process_in_blocks": "0", "process_kernel_time": 0.197053, "process_mem_max_rss": "143556608", "process_out_blocks": "0", "process_user_time": 1.047446}
[0m20:52:42.026213 [debug] [MainThread]: Command `dbt build` succeeded at 20:52:42.026175 after 0.73 seconds
[0m20:52:42.026386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10535eff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105caefc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1021f3740>]}
[0m20:52:42.026558 [debug] [MainThread]: Flushing usage events
[0m20:52:42.520281 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:56:13.490270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10679f8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e89280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e89370>]}


============================== 20:56:13.493494 | fd89a957-33a5-44d3-a956-b189a7257cc6 ==============================
[0m20:56:13.493494 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:56:13.493866 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'quiet': 'False', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'warn_error': 'None', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'static_parser': 'True', 'fail_fast': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'cache_selected_only': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'printer_width': '80', 'use_colors': 'True', 'no_print': 'None', 'partial_parse': 'True', 'empty': 'False', 'log_cache_events': 'False'}
[0m20:56:13.685042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd89a957-33a5-44d3-a956-b189a7257cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d556a0>]}
[0m20:56:13.712278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd89a957-33a5-44d3-a956-b189a7257cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034212e0>]}
[0m20:56:13.713820 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:56:13.771363 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:56:13.832902 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m20:56:13.833231 [debug] [MainThread]: Partial parsing: added file: dbt_an_data://models/stg/stg_scrutins_votes.sql
[0m20:56:13.833404 [debug] [MainThread]: Partial parsing: added file: dbt_an_data://models/stg/stg_agenda.sql
[0m20:56:13.833585 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_agenda.sql
[0m20:56:13.942018 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_an_data.mart
[0m20:56:13.947953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd89a957-33a5-44d3-a956-b189a7257cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107275400>]}
[0m20:56:13.981039 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m20:56:13.982915 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m20:56:14.003858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd89a957-33a5-44d3-a956-b189a7257cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072d3470>]}
[0m20:56:14.004156 [info ] [MainThread]: Found 5 models, 9 sources, 468 macros
[0m20:56:14.005222 [info ] [MainThread]: 
[0m20:56:14.005434 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:56:14.005594 [info ] [MainThread]: 
[0m20:56:14.005846 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:56:14.007996 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m20:56:14.093340 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m20:56:14.093598 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m20:56:14.093756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:14.113756 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m20:56:14.114546 [debug] [ThreadPool]: On list_database: Close
[0m20:56:14.114945 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m20:56:14.115206 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m20:56:14.118355 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m20:56:14.118533 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m20:56:14.118680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:14.119358 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:56:14.119962 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m20:56:14.120113 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m20:56:14.120357 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:56:14.120498 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m20:56:14.120632 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m20:56:14.121265 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:56:14.121704 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m20:56:14.121859 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m20:56:14.121999 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m20:56:14.122225 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:56:14.122372 [debug] [ThreadPool]: On create_database_main: Close
[0m20:56:14.122971 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_main, now list_database_main)
[0m20:56:14.125443 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m20:56:14.125607 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m20:56:14.125739 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:14.125988 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:56:14.126127 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m20:56:14.126269 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m20:56:14.137015 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m20:56:14.137891 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m20:56:14.138815 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m20:56:14.138988 [debug] [ThreadPool]: On list_database_main: Close
[0m20:56:14.139456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd89a957-33a5-44d3-a956-b189a7257cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10714b6e0>]}
[0m20:56:14.139691 [debug] [MainThread]: Using duckdb connection "master"
[0m20:56:14.139830 [debug] [MainThread]: On master: BEGIN
[0m20:56:14.139958 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:56:14.140213 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:56:14.140353 [debug] [MainThread]: On master: COMMIT
[0m20:56:14.140487 [debug] [MainThread]: Using duckdb connection "master"
[0m20:56:14.140613 [debug] [MainThread]: On master: COMMIT
[0m20:56:14.140819 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:56:14.140951 [debug] [MainThread]: On master: Close
[0m20:56:14.142379 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_agenda
[0m20:56:14.142630 [info ] [Thread-1 (]: 1 of 5 START sql view model main.stg_agenda .................................... [RUN]
[0m20:56:14.142838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_database_main, now model.dbt_an_data.stg_agenda)
[0m20:56:14.143006 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_agenda
[0m20:56:14.146299 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_agenda"
[0m20:56:14.146763 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_agenda
[0m20:56:14.161100 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_agenda"
[0m20:56:14.161671 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m20:56:14.161854 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: BEGIN
[0m20:56:14.162009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:14.162386 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:14.162539 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m20:56:14.162691 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_agenda"} */

  
  create view "database"."main"."stg_agenda__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_agenda"
  );

[0m20:56:14.163045 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:14.166146 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m20:56:14.166389 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_agenda"} */
alter view "database"."main"."stg_agenda__dbt_tmp" rename to "stg_agenda"
[0m20:56:14.167233 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:14.171653 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: COMMIT
[0m20:56:14.171847 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m20:56:14.172019 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: COMMIT
[0m20:56:14.173142 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:14.175652 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m20:56:14.175843 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_agenda"} */

      drop view if exists "database"."main"."stg_agenda__dbt_backup" cascade
    
[0m20:56:14.176409 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:14.177598 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: Close
[0m20:56:14.178556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd89a957-33a5-44d3-a956-b189a7257cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033413d0>]}
[0m20:56:14.178872 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.stg_agenda ............................... [[32mOK[0m in 0.04s]
[0m20:56:14.179152 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_agenda
[0m20:56:14.179352 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_scrutins
[0m20:56:14.179605 [info ] [Thread-1 (]: 2 of 5 START sql view model main.stg_scrutins .................................. [RUN]
[0m20:56:14.179864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_agenda, now model.dbt_an_data.stg_scrutins)
[0m20:56:14.180046 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_scrutins
[0m20:56:14.181990 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_scrutins"
[0m20:56:14.182495 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_scrutins
[0m20:56:14.217635 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_scrutins"
[0m20:56:14.218157 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m20:56:14.218331 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: BEGIN
[0m20:56:14.218479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:14.218846 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:14.218997 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m20:56:14.219147 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins"} */

  
  create view "database"."main"."stg_scrutins__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_scrutins"
  );

[0m20:56:14.219488 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:14.220860 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m20:56:14.221035 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins"} */
alter view "database"."main"."stg_scrutins" rename to "stg_scrutins__dbt_backup"
[0m20:56:14.221324 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:14.222603 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m20:56:14.222772 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins"} */
alter view "database"."main"."stg_scrutins__dbt_tmp" rename to "stg_scrutins"
[0m20:56:14.223047 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:14.224820 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: COMMIT
[0m20:56:14.225000 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m20:56:14.225158 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: COMMIT
[0m20:56:14.225515 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:14.226589 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m20:56:14.226755 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins"} */

      drop view if exists "database"."main"."stg_scrutins__dbt_backup" cascade
    
[0m20:56:14.227119 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:14.227723 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: Close
[0m20:56:14.227980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd89a957-33a5-44d3-a956-b189a7257cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e2cef0>]}
[0m20:56:14.228265 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.stg_scrutins ............................. [[32mOK[0m in 0.05s]
[0m20:56:14.228518 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_scrutins
[0m20:56:14.228703 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_agenda
[0m20:56:14.228936 [info ] [Thread-1 (]: 3 of 5 START sql view model main.int_agenda .................................... [RUN]
[0m20:56:14.229162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_scrutins, now model.dbt_an_data.int_agenda)
[0m20:56:14.229328 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_agenda
[0m20:56:14.230482 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_agenda"
[0m20:56:14.230832 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_agenda
[0m20:56:14.232345 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_agenda"
[0m20:56:14.232805 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:56:14.232985 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m20:56:14.233142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:14.233429 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:14.233596 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:56:14.233760 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */

  
  create view "database"."main"."int_agenda__dbt_tmp" as (
    SELECT * 
FROM "database"."main"."stg_agenda"
  );

[0m20:56:14.234113 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:14.235606 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:56:14.235788 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */
alter view "database"."main"."int_agenda" rename to "int_agenda__dbt_backup"
[0m20:56:14.236082 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:14.237347 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:56:14.237503 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */
alter view "database"."main"."int_agenda__dbt_tmp" rename to "int_agenda"
[0m20:56:14.237765 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:14.238534 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m20:56:14.238694 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:56:14.238836 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m20:56:14.239184 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:14.240233 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:56:14.240407 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */

      drop view if exists "database"."main"."int_agenda__dbt_backup" cascade
    
[0m20:56:14.240764 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:14.241345 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: Close
[0m20:56:14.241582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd89a957-33a5-44d3-a956-b189a7257cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071bcb30>]}
[0m20:56:14.241853 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.int_agenda ............................... [[32mOK[0m in 0.01s]
[0m20:56:14.242100 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_agenda
[0m20:56:14.242282 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins
[0m20:56:14.242482 [info ] [Thread-1 (]: 4 of 5 START sql view model main.int_scrutins .................................. [RUN]
[0m20:56:14.242725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_agenda, now model.dbt_an_data.int_scrutins)
[0m20:56:14.242899 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins
[0m20:56:14.245014 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins"
[0m20:56:14.245378 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins
[0m20:56:14.246846 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins"
[0m20:56:14.247145 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:56:14.247312 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m20:56:14.247470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:14.247773 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:14.248056 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:56:14.248290 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

  
  create view "database"."main"."int_scrutins__dbt_tmp" as (
    SELECT
filename,
json_extract_string(json, '$.scrutin.uid') AS uid,
json_extract_string(json, '$.scrutin.numero') AS numero,
json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
json_extract_string(json, '$.scrutin.legislature') AS legislature,
json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
json_extract_string(json, '$.scrutin.titre') AS titre,
json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote
FROM "database"."main"."stg_scrutins"
  );

[0m20:56:14.248950 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:14.250829 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:56:14.251097 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */
alter view "database"."main"."int_scrutins" rename to "int_scrutins__dbt_backup"
[0m20:56:14.251531 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:14.252870 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:56:14.253040 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */
alter view "database"."main"."int_scrutins__dbt_tmp" rename to "int_scrutins"
[0m20:56:14.253337 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:14.254047 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m20:56:14.254212 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:56:14.254360 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m20:56:14.254779 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:14.255892 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:56:14.256069 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop view if exists "database"."main"."int_scrutins__dbt_backup" cascade
    
[0m20:56:14.256423 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:14.257018 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: Close
[0m20:56:14.257280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd89a957-33a5-44d3-a956-b189a7257cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107783050>]}
[0m20:56:14.257564 [info ] [Thread-1 (]: 4 of 5 OK created sql view model main.int_scrutins ............................. [[32mOK[0m in 0.01s]
[0m20:56:14.257809 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins
[0m20:56:14.257995 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_scrutins_votes
[0m20:56:14.258222 [info ] [Thread-1 (]: 5 of 5 START sql view model main.stg_scrutins_votes ............................ [RUN]
[0m20:56:14.258416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_scrutins, now model.dbt_an_data.stg_scrutins_votes)
[0m20:56:14.258586 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_scrutins_votes
[0m20:56:14.260273 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_scrutins_votes"
[0m20:56:14.260662 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_scrutins_votes
[0m20:56:14.262222 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_scrutins_votes"
[0m20:56:14.262732 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins_votes"
[0m20:56:14.262900 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins_votes: BEGIN
[0m20:56:14.263051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:14.263363 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:14.263526 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins_votes"
[0m20:56:14.263828 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins_votes"} */

  
  create view "database"."main"."stg_scrutins_votes__dbt_tmp" as (
    WITH grp AS (
      -- explode les groupes (1 par groupe)
      SELECT
          json_extract_string(j.json, '$.scrutin.uid') AS uid,
          json_extract_string(g.value, '$.organeRef') AS groupe_organe,
          g.value AS groupe_json
      FROM "database"."main"."stg_scrutins" j,
           json_each(json->'scrutin'->'ventilationVotes'->'organe'->'groupes'->'groupe') g
  ),

  positions_array AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          p.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'pours'->'votant') p
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          c.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'contres'->'votant') c
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          a.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'abstentions'->'votant') a
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          n.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'nonVotants'->'votant') n
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[ARRAY]'
  ),
  positions_object AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[OBJECT]'
  ),

  clean AS (
      -- sécurise les champs (souvent string ou null)
      SELECT
          uid,
          groupe_organe,
          type_vote,
          json_extract_string(vote_json, '$.acteurRef') AS acteurRef,
          json_extract_string(vote_json, '$.mandatRef') AS mandatRef,
          json_extract_string(vote_json, '$.parDelegation') AS parDelegation,
          json_extract_string(vote_json, '$.numPlace') AS numPlace,
          json_extract_string(vote_json, '$.causePositionVote') AS cause
      FROM positions_array
      UNION ALL
      SELECT * 
      FROM positions_object
  )

  SELECT * FROM clean
  );

[0m20:56:14.270886 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:56:14.272604 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins_votes"
[0m20:56:14.272788 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins_votes"} */
alter view "database"."main"."stg_scrutins_votes__dbt_tmp" rename to "stg_scrutins_votes"
[0m20:56:14.273240 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:14.273898 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins_votes: COMMIT
[0m20:56:14.274062 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins_votes"
[0m20:56:14.274209 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins_votes: COMMIT
[0m20:56:14.274967 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:14.276060 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins_votes"
[0m20:56:14.276232 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins_votes"} */

      drop view if exists "database"."main"."stg_scrutins_votes__dbt_backup" cascade
    
[0m20:56:14.276526 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:14.277143 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins_votes: Close
[0m20:56:14.277418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd89a957-33a5-44d3-a956-b189a7257cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107150620>]}
[0m20:56:14.277713 [info ] [Thread-1 (]: 5 of 5 OK created sql view model main.stg_scrutins_votes ....................... [[32mOK[0m in 0.02s]
[0m20:56:14.277959 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_scrutins_votes
[0m20:56:14.278537 [debug] [MainThread]: Using duckdb connection "master"
[0m20:56:14.278695 [debug] [MainThread]: On master: BEGIN
[0m20:56:14.278829 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:56:14.279098 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:56:14.279244 [debug] [MainThread]: On master: COMMIT
[0m20:56:14.279380 [debug] [MainThread]: Using duckdb connection "master"
[0m20:56:14.279509 [debug] [MainThread]: On master: COMMIT
[0m20:56:14.279713 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:56:14.279848 [debug] [MainThread]: On master: Close
[0m20:56:14.280017 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:56:14.280143 [debug] [MainThread]: Connection 'model.dbt_an_data.stg_scrutins_votes' was properly closed.
[0m20:56:14.280305 [info ] [MainThread]: 
[0m20:56:14.280457 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m20:56:14.280949 [debug] [MainThread]: Command end result
[0m20:56:14.292704 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m20:56:14.293731 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m20:56:14.296749 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m20:56:14.296924 [info ] [MainThread]: 
[0m20:56:14.297105 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:56:14.297252 [info ] [MainThread]: 
[0m20:56:14.297412 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m20:56:14.297714 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.8482241, "process_in_blocks": "0", "process_kernel_time": 0.203019, "process_mem_max_rss": "146341888", "process_out_blocks": "0", "process_user_time": 1.161699}
[0m20:56:14.297990 [debug] [MainThread]: Command `dbt build` succeeded at 20:56:14.297940 after 0.85 seconds
[0m20:56:14.298191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ffa570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e2fcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072fd370>]}
[0m20:56:14.298379 [debug] [MainThread]: Flushing usage events
[0m20:56:14.792730 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:00:50.023161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c1310>]}


============================== 21:00:50.026426 | 4b2d0b0e-a58f-43ae-a0be-a8777889f634 ==============================
[0m21:00:50.026426 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:00:50.026775 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'quiet': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'static_parser': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'target_path': 'None', 'version_check': 'True', 'fail_fast': 'False', 'debug': 'False', 'invocation_command': 'dbt build', 'partial_parse': 'True', 'cache_selected_only': 'False'}
[0m21:00:50.200955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b2d0b0e-a58f-43ae-a0be-a8777889f634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075d3110>]}
[0m21:00:50.229462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b2d0b0e-a58f-43ae-a0be-a8777889f634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d50800>]}
[0m21:00:50.230890 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:00:50.291521 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:00:50.330497 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:00:50.330812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4b2d0b0e-a58f-43ae-a0be-a8777889f634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107690710>]}
[0m21:00:50.869323 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_an_data.mart
[0m21:00:50.874059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b2d0b0e-a58f-43ae-a0be-a8777889f634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d8230>]}
[0m21:00:50.904376 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m21:00:50.905701 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m21:00:50.926466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b2d0b0e-a58f-43ae-a0be-a8777889f634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c24560>]}
[0m21:00:50.926764 [info ] [MainThread]: Found 5 models, 9 sources, 468 macros
[0m21:00:50.927806 [info ] [MainThread]: 
[0m21:00:50.928015 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:00:50.928176 [info ] [MainThread]: 
[0m21:00:50.928464 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:00:50.930648 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m21:00:51.046253 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m21:00:51.046539 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m21:00:51.046698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:51.063044 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m21:00:51.063816 [debug] [ThreadPool]: On list_database: Close
[0m21:00:51.065035 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m21:00:51.065225 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m21:00:51.065374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:51.065830 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:00:51.066385 [debug] [ThreadPool]: On list_database: Close
[0m21:00:51.066677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main_stg)
[0m21:00:51.066918 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main_stg"
"
[0m21:00:51.069998 [debug] [ThreadPool]: Using duckdb connection "create_database_main_stg"
[0m21:00:51.070186 [debug] [ThreadPool]: On create_database_main_stg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "create_database_main_stg"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m21:00:51.070332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:51.071077 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:00:51.071652 [debug] [ThreadPool]: Using duckdb connection "create_database_main_stg"
[0m21:00:51.071790 [debug] [ThreadPool]: On create_database_main_stg: BEGIN
[0m21:00:51.072012 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:00:51.072140 [debug] [ThreadPool]: Using duckdb connection "create_database_main_stg"
[0m21:00:51.072272 [debug] [ThreadPool]: On create_database_main_stg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "create_database_main_stg"} */

    
    
        create schema if not exists "database"."main_stg"
    
[0m21:00:51.072568 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:00:51.072947 [debug] [ThreadPool]: On create_database_main_stg: COMMIT
[0m21:00:51.073086 [debug] [ThreadPool]: Using duckdb connection "create_database_main_stg"
[0m21:00:51.073213 [debug] [ThreadPool]: On create_database_main_stg: COMMIT
[0m21:00:51.073644 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:00:51.073806 [debug] [ThreadPool]: On create_database_main_stg: Close
[0m21:00:51.074061 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_main_stg, now create_database_main_int)
[0m21:00:51.074268 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main_int"
"
[0m21:00:51.075226 [debug] [ThreadPool]: Using duckdb connection "create_database_main_int"
[0m21:00:51.075390 [debug] [ThreadPool]: On create_database_main_int: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "create_database_main_int"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m21:00:51.075583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:51.076016 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:00:51.076686 [debug] [ThreadPool]: Using duckdb connection "create_database_main_int"
[0m21:00:51.076843 [debug] [ThreadPool]: On create_database_main_int: BEGIN
[0m21:00:51.077083 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:00:51.077220 [debug] [ThreadPool]: Using duckdb connection "create_database_main_int"
[0m21:00:51.077360 [debug] [ThreadPool]: On create_database_main_int: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "create_database_main_int"} */

    
    
        create schema if not exists "database"."main_int"
    
[0m21:00:51.077617 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:00:51.078067 [debug] [ThreadPool]: On create_database_main_int: COMMIT
[0m21:00:51.078220 [debug] [ThreadPool]: Using duckdb connection "create_database_main_int"
[0m21:00:51.078382 [debug] [ThreadPool]: On create_database_main_int: COMMIT
[0m21:00:51.078662 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:00:51.078802 [debug] [ThreadPool]: On create_database_main_int: Close
[0m21:00:51.079399 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_main_int, now list_database_main_stg)
[0m21:00:51.082118 [debug] [ThreadPool]: Using duckdb connection "list_database_main_stg"
[0m21:00:51.082291 [debug] [ThreadPool]: On list_database_main_stg: BEGIN
[0m21:00:51.082431 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:51.082703 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:00:51.082853 [debug] [ThreadPool]: Using duckdb connection "list_database_main_stg"
[0m21:00:51.083001 [debug] [ThreadPool]: On list_database_main_stg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database_main_stg"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'database'
  
[0m21:00:51.093576 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m21:00:51.094431 [debug] [ThreadPool]: On list_database_main_stg: ROLLBACK
[0m21:00:51.095403 [debug] [ThreadPool]: Failed to rollback 'list_database_main_stg'
[0m21:00:51.095569 [debug] [ThreadPool]: On list_database_main_stg: Close
[0m21:00:51.095816 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database_main_stg, now list_database_main_int)
[0m21:00:51.096771 [debug] [ThreadPool]: Using duckdb connection "list_database_main_int"
[0m21:00:51.096916 [debug] [ThreadPool]: On list_database_main_int: BEGIN
[0m21:00:51.097038 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:51.097299 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:00:51.097433 [debug] [ThreadPool]: Using duckdb connection "list_database_main_int"
[0m21:00:51.097572 [debug] [ThreadPool]: On list_database_main_int: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database_main_int"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_int'
    and lower(table_catalog) = 'database'
  
[0m21:00:51.099368 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:00:51.099950 [debug] [ThreadPool]: On list_database_main_int: ROLLBACK
[0m21:00:51.100359 [debug] [ThreadPool]: Failed to rollback 'list_database_main_int'
[0m21:00:51.100492 [debug] [ThreadPool]: On list_database_main_int: Close
[0m21:00:51.100735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b2d0b0e-a58f-43ae-a0be-a8777889f634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081a5790>]}
[0m21:00:51.100997 [debug] [MainThread]: Using duckdb connection "master"
[0m21:00:51.101153 [debug] [MainThread]: On master: BEGIN
[0m21:00:51.101287 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:00:51.101534 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:00:51.101680 [debug] [MainThread]: On master: COMMIT
[0m21:00:51.101818 [debug] [MainThread]: Using duckdb connection "master"
[0m21:00:51.101952 [debug] [MainThread]: On master: COMMIT
[0m21:00:51.102159 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:00:51.102297 [debug] [MainThread]: On master: Close
[0m21:00:51.103614 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_agenda
[0m21:00:51.103871 [info ] [Thread-1 (]: 1 of 5 START sql view model main_stg.stg_agenda ................................ [RUN]
[0m21:00:51.104086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_database_main_int, now model.dbt_an_data.stg_agenda)
[0m21:00:51.104254 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_agenda
[0m21:00:51.107658 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_agenda"
[0m21:00:51.108173 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_agenda
[0m21:00:51.123388 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_agenda"
[0m21:00:51.123940 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m21:00:51.124123 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: BEGIN
[0m21:00:51.124288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:51.124700 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:51.124864 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m21:00:51.125016 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_agenda"} */

  
  create view "database"."main_stg"."stg_agenda__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_agenda"
  );

[0m21:00:51.125385 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:51.128258 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m21:00:51.128507 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_agenda"} */
alter view "database"."main_stg"."stg_agenda__dbt_tmp" rename to "stg_agenda"
[0m21:00:51.129142 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:51.133748 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: COMMIT
[0m21:00:51.133941 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m21:00:51.134108 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: COMMIT
[0m21:00:51.134521 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:51.137074 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m21:00:51.137263 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_agenda"} */

      drop view if exists "database"."main_stg"."stg_agenda__dbt_backup" cascade
    
[0m21:00:51.137576 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:51.138681 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: Close
[0m21:00:51.139641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b2d0b0e-a58f-43ae-a0be-a8777889f634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106864f50>]}
[0m21:00:51.139952 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main_stg.stg_agenda ........................... [[32mOK[0m in 0.03s]
[0m21:00:51.140230 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_agenda
[0m21:00:51.140430 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_scrutins
[0m21:00:51.140685 [info ] [Thread-1 (]: 2 of 5 START sql view model main_stg.stg_scrutins .............................. [RUN]
[0m21:00:51.140971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_agenda, now model.dbt_an_data.stg_scrutins)
[0m21:00:51.141172 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_scrutins
[0m21:00:51.142477 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_scrutins"
[0m21:00:51.142811 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_scrutins
[0m21:00:51.144309 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_scrutins"
[0m21:00:51.144609 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m21:00:51.144776 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: BEGIN
[0m21:00:51.144932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:51.145300 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:51.145460 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m21:00:51.145617 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins"} */

  
  create view "database"."main_stg"."stg_scrutins__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_scrutins"
  );

[0m21:00:51.145959 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:51.147433 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m21:00:51.147621 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins"} */
alter view "database"."main_stg"."stg_scrutins__dbt_tmp" rename to "stg_scrutins"
[0m21:00:51.147934 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:51.148616 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: COMMIT
[0m21:00:51.148924 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m21:00:51.149094 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: COMMIT
[0m21:00:51.149497 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:51.150712 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m21:00:51.150879 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins"} */

      drop view if exists "database"."main_stg"."stg_scrutins__dbt_backup" cascade
    
[0m21:00:51.151159 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:51.151762 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: Close
[0m21:00:51.152020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b2d0b0e-a58f-43ae-a0be-a8777889f634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081bb950>]}
[0m21:00:51.152299 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main_stg.stg_scrutins ......................... [[32mOK[0m in 0.01s]
[0m21:00:51.152552 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_scrutins
[0m21:00:51.152743 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_agenda
[0m21:00:51.153023 [info ] [Thread-1 (]: 3 of 5 START sql view model main_int.int_agenda ................................ [RUN]
[0m21:00:51.153300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_scrutins, now model.dbt_an_data.int_agenda)
[0m21:00:51.153477 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_agenda
[0m21:00:51.154741 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_agenda"
[0m21:00:51.155065 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_agenda
[0m21:00:51.156572 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_agenda"
[0m21:00:51.156875 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m21:00:51.157040 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m21:00:51.157185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:51.157526 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:51.157684 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m21:00:51.157844 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */

  
  create view "database"."main_int"."int_agenda__dbt_tmp" as (
    SELECT * 
FROM "database"."main_stg"."stg_agenda"
  );

[0m21:00:51.158245 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:51.159664 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m21:00:51.159845 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */
alter view "database"."main_int"."int_agenda__dbt_tmp" rename to "int_agenda"
[0m21:00:51.160164 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:51.160797 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m21:00:51.160958 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m21:00:51.161103 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m21:00:51.161414 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:51.163446 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m21:00:51.163761 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */

      drop view if exists "database"."main_int"."int_agenda__dbt_backup" cascade
    
[0m21:00:51.164227 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:51.164987 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: Close
[0m21:00:51.165249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b2d0b0e-a58f-43ae-a0be-a8777889f634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d81d0>]}
[0m21:00:51.165534 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main_int.int_agenda ........................... [[32mOK[0m in 0.01s]
[0m21:00:51.165786 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_agenda
[0m21:00:51.165973 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins
[0m21:00:51.166213 [info ] [Thread-1 (]: 4 of 5 START sql view model main_int.int_scrutins .............................. [RUN]
[0m21:00:51.166439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_agenda, now model.dbt_an_data.int_scrutins)
[0m21:00:51.166618 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins
[0m21:00:51.167978 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins"
[0m21:00:51.168353 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins
[0m21:00:51.169772 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins"
[0m21:00:51.170067 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:00:51.170237 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m21:00:51.170386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:51.170700 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:51.170862 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:00:51.171090 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

  
  create view "database"."main_int"."int_scrutins__dbt_tmp" as (
    SELECT
filename,
json_extract_string(json, '$.scrutin.uid') AS uid,
json_extract_string(json, '$.scrutin.numero') AS numero,
json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
json_extract_string(json, '$.scrutin.legislature') AS legislature,
json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
json_extract_string(json, '$.scrutin.titre') AS titre,
json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote
FROM "database"."main_stg"."stg_scrutins"
  );

[0m21:00:51.171779 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:51.173165 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:00:51.173396 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */
alter view "database"."main_int"."int_scrutins__dbt_tmp" rename to "int_scrutins"
[0m21:00:51.173723 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:51.174361 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m21:00:51.174522 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:00:51.174667 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m21:00:51.175073 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:51.176125 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:00:51.176292 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop view if exists "database"."main_int"."int_scrutins__dbt_backup" cascade
    
[0m21:00:51.176564 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:51.177140 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: Close
[0m21:00:51.177386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b2d0b0e-a58f-43ae-a0be-a8777889f634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082db710>]}
[0m21:00:51.177702 [info ] [Thread-1 (]: 4 of 5 OK created sql view model main_int.int_scrutins ......................... [[32mOK[0m in 0.01s]
[0m21:00:51.178003 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins
[0m21:00:51.178212 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins_votes
[0m21:00:51.178480 [info ] [Thread-1 (]: 5 of 5 START sql view model main_int.int_scrutins_votes ........................ [RUN]
[0m21:00:51.178698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_scrutins, now model.dbt_an_data.int_scrutins_votes)
[0m21:00:51.178869 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins_votes
[0m21:00:51.180786 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins_votes"
[0m21:00:51.181373 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins_votes
[0m21:00:51.182938 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins_votes"
[0m21:00:51.183284 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:00:51.183458 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m21:00:51.183610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:51.184077 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:51.184243 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:00:51.184535 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

  
  create view "database"."main_int"."int_scrutins_votes__dbt_tmp" as (
    WITH grp AS (
      -- explode les groupes (1 par groupe)
      SELECT
          json_extract_string(j.json, '$.scrutin.uid') AS uid,
          json_extract_string(g.value, '$.organeRef') AS groupe_organe,
          g.value AS groupe_json
      FROM "database"."main_stg"."stg_scrutins" j,
           json_each(json->'scrutin'->'ventilationVotes'->'organe'->'groupes'->'groupe') g
  ),

  positions_array AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          p.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'pours'->'votant') p
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          c.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'contres'->'votant') c
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          a.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'abstentions'->'votant') a
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          n.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'nonVotants'->'votant') n
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[ARRAY]'
  ),
  positions_object AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[OBJECT]'
  ),

  clean AS (
      -- sécurise les champs (souvent string ou null)
      SELECT
          uid,
          groupe_organe,
          type_vote,
          json_extract_string(vote_json, '$.acteurRef') AS acteurRef,
          json_extract_string(vote_json, '$.mandatRef') AS mandatRef,
          json_extract_string(vote_json, '$.parDelegation') AS parDelegation,
          json_extract_string(vote_json, '$.numPlace') AS numPlace,
          json_extract_string(vote_json, '$.causePositionVote') AS cause
      FROM positions_array
      UNION ALL
      SELECT * 
      FROM positions_object
  )

  SELECT * FROM clean
  );

[0m21:00:51.187813 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:00:51.189271 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:00:51.189461 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins_votes"} */
alter view "database"."main_int"."int_scrutins_votes__dbt_tmp" rename to "int_scrutins_votes"
[0m21:00:51.189896 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:51.190572 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m21:00:51.190750 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:00:51.190901 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m21:00:51.191692 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:00:51.192771 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:00:51.192931 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop view if exists "database"."main_int"."int_scrutins_votes__dbt_backup" cascade
    
[0m21:00:51.193206 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:51.193794 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: Close
[0m21:00:51.194070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b2d0b0e-a58f-43ae-a0be-a8777889f634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10824f1a0>]}
[0m21:00:51.194346 [info ] [Thread-1 (]: 5 of 5 OK created sql view model main_int.int_scrutins_votes ................... [[32mOK[0m in 0.02s]
[0m21:00:51.194599 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins_votes
[0m21:00:51.195175 [debug] [MainThread]: Using duckdb connection "master"
[0m21:00:51.195334 [debug] [MainThread]: On master: BEGIN
[0m21:00:51.195469 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:00:51.195761 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:00:51.195903 [debug] [MainThread]: On master: COMMIT
[0m21:00:51.196041 [debug] [MainThread]: Using duckdb connection "master"
[0m21:00:51.196168 [debug] [MainThread]: On master: COMMIT
[0m21:00:51.196380 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:00:51.196517 [debug] [MainThread]: On master: Close
[0m21:00:51.196689 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:00:51.196816 [debug] [MainThread]: Connection 'model.dbt_an_data.int_scrutins_votes' was properly closed.
[0m21:00:51.196992 [info ] [MainThread]: 
[0m21:00:51.197157 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m21:00:51.197662 [debug] [MainThread]: Command end result
[0m21:00:51.208493 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m21:00:51.209388 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m21:00:51.212306 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m21:00:51.212484 [info ] [MainThread]: 
[0m21:00:51.212673 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:00:51.212822 [info ] [MainThread]: 
[0m21:00:51.212987 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m21:00:51.213310 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.2303843, "process_in_blocks": "0", "process_kernel_time": 0.221244, "process_mem_max_rss": "144605184", "process_out_blocks": "0", "process_user_time": 1.557268}
[0m21:00:51.213729 [debug] [MainThread]: Command `dbt build` succeeded at 21:00:51.213603 after 1.23 seconds
[0m21:00:51.214049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706fc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075a3830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075a37a0>]}
[0m21:00:51.214350 [debug] [MainThread]: Flushing usage events
[0m21:00:51.947203 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:08:28.181154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108892840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d8b9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d8b5f0>]}


============================== 21:08:28.184479 | 32e44609-f6a7-4370-ab0e-509fb19d60c6 ==============================
[0m21:08:28.184479 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:08:28.184831 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'invocation_command': 'dbt build', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'static_parser': 'True', 'printer_width': '80', 'target_path': 'None', 'log_cache_events': 'False', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'indirect_selection': 'eager', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'debug': 'False', 'use_colors': 'True', 'empty': 'False'}
[0m21:08:28.375678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32e44609-f6a7-4370-ab0e-509fb19d60c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e699d0>]}
[0m21:08:28.403140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32e44609-f6a7-4370-ab0e-509fb19d60c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f4cec0>]}
[0m21:08:28.404658 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:08:28.463646 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:08:28.500535 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:08:28.500850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '32e44609-f6a7-4370-ab0e-509fb19d60c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108702780>]}
[0m21:08:29.019513 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_an_data.mart
[0m21:08:29.024442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32e44609-f6a7-4370-ab0e-509fb19d60c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10901a930>]}
[0m21:08:29.055100 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m21:08:29.056477 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m21:08:29.077704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32e44609-f6a7-4370-ab0e-509fb19d60c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e92840>]}
[0m21:08:29.078011 [info ] [MainThread]: Found 5 models, 9 sources, 468 macros
[0m21:08:29.079054 [info ] [MainThread]: 
[0m21:08:29.079254 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:08:29.079411 [info ] [MainThread]: 
[0m21:08:29.079658 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:08:29.081834 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m21:08:29.167186 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m21:08:29.167435 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m21:08:29.167597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:08:29.190274 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m21:08:29.191285 [debug] [ThreadPool]: On list_database: Close
[0m21:08:29.191647 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m21:08:29.191911 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m21:08:29.195138 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m21:08:29.195338 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m21:08:29.195496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:08:29.196224 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:08:29.196830 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m21:08:29.196979 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m21:08:29.197210 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:08:29.197346 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m21:08:29.197486 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m21:08:29.198120 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:08:29.198511 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m21:08:29.198653 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m21:08:29.198778 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m21:08:29.198981 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:08:29.199122 [debug] [ThreadPool]: On create_database_main: Close
[0m21:08:29.199694 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_main, now list_database_main)
[0m21:08:29.202290 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m21:08:29.202472 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m21:08:29.202612 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:08:29.202872 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:08:29.203013 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m21:08:29.203156 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m21:08:29.213261 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m21:08:29.214049 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m21:08:29.214905 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m21:08:29.215081 [debug] [ThreadPool]: On list_database_main: Close
[0m21:08:29.215603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32e44609-f6a7-4370-ab0e-509fb19d60c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109205760>]}
[0m21:08:29.215836 [debug] [MainThread]: Using duckdb connection "master"
[0m21:08:29.215979 [debug] [MainThread]: On master: BEGIN
[0m21:08:29.216109 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:08:29.216373 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:08:29.216525 [debug] [MainThread]: On master: COMMIT
[0m21:08:29.216669 [debug] [MainThread]: Using duckdb connection "master"
[0m21:08:29.216804 [debug] [MainThread]: On master: COMMIT
[0m21:08:29.217018 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:08:29.217156 [debug] [MainThread]: On master: Close
[0m21:08:29.218482 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_agenda
[0m21:08:29.218734 [info ] [Thread-1 (]: 1 of 5 START sql view model main.stg_agenda .................................... [RUN]
[0m21:08:29.218947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_database_main, now model.dbt_an_data.stg_agenda)
[0m21:08:29.219117 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_agenda
[0m21:08:29.222742 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_agenda"
[0m21:08:29.223158 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_agenda
[0m21:08:29.236815 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_agenda"
[0m21:08:29.237308 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m21:08:29.237506 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: BEGIN
[0m21:08:29.237673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:08:29.238053 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:08:29.238222 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m21:08:29.238390 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_agenda"} */

  
  create view "database"."main"."stg_agenda__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_agenda"
  );

[0m21:08:29.238924 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:08:29.242405 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m21:08:29.242623 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_agenda"} */
alter view "database"."main"."stg_agenda" rename to "stg_agenda__dbt_backup"
[0m21:08:29.243714 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:08:29.245082 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m21:08:29.245253 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_agenda"} */
alter view "database"."main"."stg_agenda__dbt_tmp" rename to "stg_agenda"
[0m21:08:29.245537 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:08:29.251709 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: COMMIT
[0m21:08:29.251912 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m21:08:29.252074 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: COMMIT
[0m21:08:29.253161 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:08:29.255875 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m21:08:29.256085 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_agenda"} */

      drop view if exists "database"."main"."stg_agenda__dbt_backup" cascade
    
[0m21:08:29.256565 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:08:29.257721 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: Close
[0m21:08:29.258692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32e44609-f6a7-4370-ab0e-509fb19d60c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108114b30>]}
[0m21:08:29.259018 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.stg_agenda ............................... [[32mOK[0m in 0.04s]
[0m21:08:29.259294 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_agenda
[0m21:08:29.259495 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_scrutins
[0m21:08:29.259751 [info ] [Thread-1 (]: 2 of 5 START sql view model main.stg_scrutins .................................. [RUN]
[0m21:08:29.260013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_agenda, now model.dbt_an_data.stg_scrutins)
[0m21:08:29.260208 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_scrutins
[0m21:08:29.261469 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_scrutins"
[0m21:08:29.261790 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_scrutins
[0m21:08:29.263363 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_scrutins"
[0m21:08:29.263774 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m21:08:29.263956 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: BEGIN
[0m21:08:29.264180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:08:29.264657 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:08:29.264879 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m21:08:29.265054 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins"} */

  
  create view "database"."main"."stg_scrutins__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_scrutins"
  );

[0m21:08:29.265435 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:08:29.267035 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m21:08:29.267216 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins"} */
alter view "database"."main"."stg_scrutins" rename to "stg_scrutins__dbt_backup"
[0m21:08:29.267531 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:08:29.268877 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m21:08:29.269052 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins"} */
alter view "database"."main"."stg_scrutins__dbt_tmp" rename to "stg_scrutins"
[0m21:08:29.269340 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:08:29.270081 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: COMMIT
[0m21:08:29.270257 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m21:08:29.270413 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: COMMIT
[0m21:08:29.270853 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:08:29.272121 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m21:08:29.272317 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins"} */

      drop view if exists "database"."main"."stg_scrutins__dbt_backup" cascade
    
[0m21:08:29.272803 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:08:29.273599 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: Close
[0m21:08:29.273874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32e44609-f6a7-4370-ab0e-509fb19d60c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a32de0>]}
[0m21:08:29.274181 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.stg_scrutins ............................. [[32mOK[0m in 0.01s]
[0m21:08:29.274447 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_scrutins
[0m21:08:29.274643 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_agenda
[0m21:08:29.274891 [info ] [Thread-1 (]: 3 of 5 START sql view model main.int_agenda .................................... [RUN]
[0m21:08:29.275138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_scrutins, now model.dbt_an_data.int_agenda)
[0m21:08:29.275312 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_agenda
[0m21:08:29.276613 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_agenda"
[0m21:08:29.276968 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_agenda
[0m21:08:29.278512 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_agenda"
[0m21:08:29.278875 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m21:08:29.279050 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m21:08:29.279209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:08:29.279595 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:08:29.279757 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m21:08:29.279917 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */

  
  create view "database"."main"."int_agenda__dbt_tmp" as (
    SELECT * 
FROM "database"."main"."stg_agenda"
  );

[0m21:08:29.280415 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:08:29.282059 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m21:08:29.282251 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */
alter view "database"."main"."int_agenda" rename to "int_agenda__dbt_backup"
[0m21:08:29.282581 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:08:29.283915 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m21:08:29.284084 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */
alter view "database"."main"."int_agenda__dbt_tmp" rename to "int_agenda"
[0m21:08:29.284364 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:08:29.285076 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m21:08:29.285234 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m21:08:29.285378 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m21:08:29.285707 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:08:29.287827 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m21:08:29.288034 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */

      drop view if exists "database"."main"."int_agenda__dbt_backup" cascade
    
[0m21:08:29.288450 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:08:29.289344 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: Close
[0m21:08:29.289701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32e44609-f6a7-4370-ab0e-509fb19d60c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aedaf0>]}
[0m21:08:29.290059 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.int_agenda ............................... [[32mOK[0m in 0.01s]
[0m21:08:29.290326 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_agenda
[0m21:08:29.290515 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins
[0m21:08:29.290741 [info ] [Thread-1 (]: 4 of 5 START sql view model main.int_scrutins .................................. [RUN]
[0m21:08:29.290942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_agenda, now model.dbt_an_data.int_scrutins)
[0m21:08:29.291107 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins
[0m21:08:29.292459 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins"
[0m21:08:29.292826 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins
[0m21:08:29.294367 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins"
[0m21:08:29.294700 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:08:29.294875 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m21:08:29.295037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:08:29.295419 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:08:29.295587 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:08:29.295772 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

  
  create view "database"."main"."int_scrutins__dbt_tmp" as (
    SELECT
filename,
json_extract_string(json, '$.scrutin.uid') AS uid,
json_extract_string(json, '$.scrutin.numero') AS numero,
json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
json_extract_string(json, '$.scrutin.legislature') AS legislature,
json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
json_extract_string(json, '$.scrutin.titre') AS titre,
json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote
FROM "database"."main"."stg_scrutins"
  );

[0m21:08:29.296634 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:08:29.298416 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:08:29.298618 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */
alter view "database"."main"."int_scrutins" rename to "int_scrutins__dbt_backup"
[0m21:08:29.298975 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:08:29.300327 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:08:29.300496 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */
alter view "database"."main"."int_scrutins__dbt_tmp" rename to "int_scrutins"
[0m21:08:29.300788 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:08:29.301530 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m21:08:29.301695 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:08:29.301843 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m21:08:29.302248 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:08:29.303371 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:08:29.303551 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop view if exists "database"."main"."int_scrutins__dbt_backup" cascade
    
[0m21:08:29.303933 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:08:29.304561 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: Close
[0m21:08:29.304846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32e44609-f6a7-4370-ab0e-509fb19d60c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ae85f0>]}
[0m21:08:29.305227 [info ] [Thread-1 (]: 4 of 5 OK created sql view model main.int_scrutins ............................. [[32mOK[0m in 0.01s]
[0m21:08:29.305621 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins
[0m21:08:29.305853 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins_votes
[0m21:08:29.306150 [info ] [Thread-1 (]: 5 of 5 START sql view model main.int_scrutins_votes ............................ [RUN]
[0m21:08:29.306450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_scrutins, now model.dbt_an_data.int_scrutins_votes)
[0m21:08:29.306642 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins_votes
[0m21:08:29.308405 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins_votes"
[0m21:08:29.309001 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins_votes
[0m21:08:29.310491 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins_votes"
[0m21:08:29.311072 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:08:29.311259 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m21:08:29.311418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:08:29.311826 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:08:29.312002 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:08:29.312310 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

  
  create view "database"."main"."int_scrutins_votes__dbt_tmp" as (
    WITH grp AS (
      -- explode les groupes (1 par groupe)
      SELECT
          json_extract_string(j.json, '$.scrutin.uid') AS uid,
          json_extract_string(g.value, '$.organeRef') AS groupe_organe,
          g.value AS groupe_json
      FROM "database"."main"."stg_scrutins" j,
           json_each(json->'scrutin'->'ventilationVotes'->'organe'->'groupes'->'groupe') g
  ),

  positions_array AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          p.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'pours'->'votant') p
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          c.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'contres'->'votant') c
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          a.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'abstentions'->'votant') a
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          n.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'nonVotants'->'votant') n
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[ARRAY]'
  ),
  positions_object AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[OBJECT]'
  ),

  clean AS (
      -- sécurise les champs (souvent string ou null)
      SELECT
          uid,
          groupe_organe,
          type_vote,
          json_extract_string(vote_json, '$.acteurRef') AS acteurRef,
          json_extract_string(vote_json, '$.mandatRef') AS mandatRef,
          json_extract_string(vote_json, '$.parDelegation') AS parDelegation,
          json_extract_string(vote_json, '$.numPlace') AS numPlace,
          json_extract_string(vote_json, '$.causePositionVote') AS cause
      FROM positions_array
      UNION ALL
      SELECT * 
      FROM positions_object
  )

  SELECT * FROM clean
  );

[0m21:08:29.315872 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:08:29.317474 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:08:29.317654 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins_votes"} */
alter view "database"."main"."int_scrutins_votes__dbt_tmp" rename to "int_scrutins_votes"
[0m21:08:29.318060 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:08:29.318724 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m21:08:29.318884 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:08:29.319032 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m21:08:29.319777 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:08:29.321021 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:08:29.321208 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop view if exists "database"."main"."int_scrutins_votes__dbt_backup" cascade
    
[0m21:08:29.321515 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:08:29.322374 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: Close
[0m21:08:29.322738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32e44609-f6a7-4370-ab0e-509fb19d60c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109af02c0>]}
[0m21:08:29.323108 [info ] [Thread-1 (]: 5 of 5 OK created sql view model main.int_scrutins_votes ....................... [[32mOK[0m in 0.02s]
[0m21:08:29.323397 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins_votes
[0m21:08:29.323990 [debug] [MainThread]: Using duckdb connection "master"
[0m21:08:29.324156 [debug] [MainThread]: On master: BEGIN
[0m21:08:29.324292 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:08:29.324603 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:08:29.324747 [debug] [MainThread]: On master: COMMIT
[0m21:08:29.324884 [debug] [MainThread]: Using duckdb connection "master"
[0m21:08:29.325017 [debug] [MainThread]: On master: COMMIT
[0m21:08:29.325220 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:08:29.325363 [debug] [MainThread]: On master: Close
[0m21:08:29.325537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:08:29.325670 [debug] [MainThread]: Connection 'model.dbt_an_data.int_scrutins_votes' was properly closed.
[0m21:08:29.325833 [info ] [MainThread]: 
[0m21:08:29.325984 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m21:08:29.326494 [debug] [MainThread]: Command end result
[0m21:08:29.337877 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m21:08:29.338860 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m21:08:29.342395 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m21:08:29.342603 [info ] [MainThread]: 
[0m21:08:29.342793 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:08:29.342939 [info ] [MainThread]: 
[0m21:08:29.343102 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m21:08:29.343423 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.2011218, "process_in_blocks": "0", "process_kernel_time": 0.218948, "process_mem_max_rss": "146292736", "process_out_blocks": "0", "process_user_time": 1.510282}
[0m21:08:29.343644 [debug] [MainThread]: Command `dbt build` succeeded at 21:08:29.343605 after 1.20 seconds
[0m21:08:29.343822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d8bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d8b830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d8b8c0>]}
[0m21:08:29.343993 [debug] [MainThread]: Flushing usage events
[0m21:08:29.958051 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:13:59.723562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123d4530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123794f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112379400>]}


============================== 21:13:59.727019 | ef357c48-ddec-4de5-be01-91456f4eed97 ==============================
[0m21:13:59.727019 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:13:59.727395 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'target_path': 'None', 'static_parser': 'True', 'debug': 'False', 'invocation_command': 'dbt docs serve', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'write_json': 'True', 'quiet': 'False', 'fail_fast': 'False', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'log_cache_events': 'False', 'empty': 'None', 'use_colors': 'True', 'introspect': 'True', 'version_check': 'True', 'partial_parse': 'True', 'no_print': 'None'}
[0m21:13:59.877638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef357c48-ddec-4de5-be01-91456f4eed97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113de1670>]}
[0m21:13:59.904670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef357c48-ddec-4de5-be01-91456f4eed97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bc3ad0>]}
[0m21:14:25.018393 [error] [MainThread]: Encountered an error:

[0m21:14:25.026628 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/mael/DEV/an-data-pipeline/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mael/DEV/an-data-pipeline/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mael/DEV/an-data-pipeline/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mael/DEV/an-data-pipeline/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mael/DEV/an-data-pipeline/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mael/DEV/an-data-pipeline/.venv/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/mael/DEV/an-data-pipeline/.venv/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Users/mael/.local/share/uv/python/cpython-3.12.9-macos-aarch64-none/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mael/.local/share/uv/python/cpython-3.12.9-macos-aarch64-none/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m21:14:25.031029 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 25.34478, "process_in_blocks": "0", "process_kernel_time": 0.139325, "process_mem_max_rss": "124764160", "process_out_blocks": "0", "process_user_time": 0.75414}
[0m21:14:25.032026 [debug] [MainThread]: Command `dbt docs serve` failed at 21:14:25.031866 after 25.35 seconds
[0m21:14:25.033019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a3fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113dc57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114050530>]}
[0m21:14:25.033496 [debug] [MainThread]: Flushing usage events
[0m21:14:25.545852 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:14:32.151024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104971dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104745430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104745340>]}


============================== 21:14:32.154034 | 154a60ba-88f5-4f6b-b9e5-ddf3a242ed27 ==============================
[0m21:14:32.154034 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:14:32.154371 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'no_print': 'None', 'empty': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'target_path': 'None', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'quiet': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'invocation_command': 'dbt docs generate', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'version_check': 'True', 'printer_width': '80'}
[0m21:14:32.257832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '154a60ba-88f5-4f6b-b9e5-ddf3a242ed27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054297f0>]}
[0m21:14:32.291144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '154a60ba-88f5-4f6b-b9e5-ddf3a242ed27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049b6ae0>]}
[0m21:14:32.293202 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:14:32.362071 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:14:32.420825 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:14:32.421077 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:14:32.424013 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_an_data.mart
[0m21:14:32.438039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '154a60ba-88f5-4f6b-b9e5-ddf3a242ed27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056facf0>]}
[0m21:14:32.452289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '154a60ba-88f5-4f6b-b9e5-ddf3a242ed27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056a8ef0>]}
[0m21:14:32.452580 [info ] [MainThread]: Found 5 models, 9 sources, 468 macros
[0m21:14:32.452819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '154a60ba-88f5-4f6b-b9e5-ddf3a242ed27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105495fd0>]}
[0m21:14:32.453848 [info ] [MainThread]: 
[0m21:14:32.454073 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:14:32.454232 [info ] [MainThread]: 
[0m21:14:32.454487 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:14:32.456701 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_main'
[0m21:14:32.542533 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m21:14:32.542784 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m21:14:32.542939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:14:32.557253 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m21:14:32.557487 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m21:14:32.557648 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m21:14:32.573740 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m21:14:32.574770 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m21:14:32.575695 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m21:14:32.575855 [debug] [ThreadPool]: On list_database_main: Close
[0m21:14:32.576488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '154a60ba-88f5-4f6b-b9e5-ddf3a242ed27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056fa600>]}
[0m21:14:32.577966 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_agenda
[0m21:14:32.578174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_database_main, now model.dbt_an_data.stg_agenda)
[0m21:14:32.578337 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_agenda
[0m21:14:32.581885 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_agenda"
[0m21:14:32.582505 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_agenda
[0m21:14:32.582826 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_agenda
[0m21:14:32.583008 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_scrutins
[0m21:14:32.583215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_agenda, now model.dbt_an_data.stg_scrutins)
[0m21:14:32.583393 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_scrutins
[0m21:14:32.584555 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_scrutins"
[0m21:14:32.584859 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_scrutins
[0m21:14:32.585132 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_scrutins
[0m21:14:32.585298 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_agenda
[0m21:14:32.585480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_scrutins, now model.dbt_an_data.int_agenda)
[0m21:14:32.585651 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_agenda
[0m21:14:32.586841 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_agenda"
[0m21:14:32.587162 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_agenda
[0m21:14:32.587467 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_agenda
[0m21:14:32.587642 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins
[0m21:14:32.587836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_agenda, now model.dbt_an_data.int_scrutins)
[0m21:14:32.588051 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins
[0m21:14:32.589258 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins"
[0m21:14:32.589561 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins
[0m21:14:32.589849 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins
[0m21:14:32.590026 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins_votes
[0m21:14:32.590205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_scrutins, now model.dbt_an_data.int_scrutins_votes)
[0m21:14:32.590363 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins_votes
[0m21:14:32.591812 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins_votes"
[0m21:14:32.592242 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins_votes
[0m21:14:32.592524 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins_votes
[0m21:14:32.592960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:14:32.593110 [debug] [MainThread]: Connection 'model.dbt_an_data.int_scrutins_votes' was properly closed.
[0m21:14:32.593558 [debug] [MainThread]: Command end result
[0m21:14:32.624557 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m21:14:32.626076 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m21:14:32.628978 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m21:14:32.631036 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m21:14:32.631209 [info ] [MainThread]: Building catalog
[0m21:14:32.635832 [debug] [ThreadPool]: Acquiring new duckdb connection 'database.information_schema'
[0m21:14:32.639030 [debug] [ThreadPool]: Using duckdb connection "database.information_schema"
[0m21:14:32.639248 [debug] [ThreadPool]: On database.information_schema: BEGIN
[0m21:14:32.639404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:14:32.640127 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:14:32.640369 [debug] [ThreadPool]: Using duckdb connection "database.information_schema"
[0m21:14:32.640588 [debug] [ThreadPool]: On database.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "database.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'database'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'database'
    )
    select
        'database' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        NULL as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main') or upper(r.schema_name) = upper('stg'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m21:14:32.647886 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m21:14:32.650227 [debug] [ThreadPool]: On database.information_schema: ROLLBACK
[0m21:14:32.650735 [debug] [ThreadPool]: Failed to rollback 'database.information_schema'
[0m21:14:32.650897 [debug] [ThreadPool]: On database.information_schema: Close
[0m21:14:32.657287 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/mael/DEV/an-data-pipeline/dbt/target/catalog.json
[0m21:14:32.666843 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m21:14:32.667688 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m21:14:32.667851 [info ] [MainThread]: Catalog written to /Users/mael/DEV/an-data-pipeline/dbt/target/catalog.json
[0m21:14:32.668217 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.55544007, "process_in_blocks": "0", "process_kernel_time": 0.181314, "process_mem_max_rss": "145948672", "process_out_blocks": "0", "process_user_time": 1.008036}
[0m21:14:32.668475 [debug] [MainThread]: Command `dbt docs generate` succeeded at 21:14:32.668435 after 0.56 seconds
[0m21:14:32.668632 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:14:32.668762 [debug] [MainThread]: Connection 'database.information_schema' was properly closed.
[0m21:14:32.668920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10542b920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10542b8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ea72f0>]}
[0m21:14:32.669089 [debug] [MainThread]: Flushing usage events
[0m21:14:33.114982 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:14:35.789034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110be4350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a576b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a572f0>]}


============================== 21:14:35.791624 | 6af1a5e7-c839-4be7-be33-76f7d876b7a6 ==============================
[0m21:14:35.791624 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:14:35.791950 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt docs serve', 'no_print': 'None', 'partial_parse': 'True', 'log_format': 'default', 'target_path': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'empty': 'None', 'debug': 'False', 'printer_width': '80', 'introspect': 'True', 'fail_fast': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False'}
[0m21:14:35.892068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6af1a5e7-c839-4be7-be33-76f7d876b7a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10573a660>]}
[0m21:14:35.918939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6af1a5e7-c839-4be7-be33-76f7d876b7a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d479e0>]}
[0m21:15:55.563483 [error] [MainThread]: Encountered an error:

[0m21:15:55.576442 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/mael/DEV/an-data-pipeline/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mael/DEV/an-data-pipeline/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mael/DEV/an-data-pipeline/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mael/DEV/an-data-pipeline/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mael/DEV/an-data-pipeline/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mael/DEV/an-data-pipeline/.venv/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/mael/DEV/an-data-pipeline/.venv/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Users/mael/.local/share/uv/python/cpython-3.12.9-macos-aarch64-none/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mael/.local/share/uv/python/cpython-3.12.9-macos-aarch64-none/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m21:15:55.578799 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 79.8255, "process_in_blocks": "0", "process_kernel_time": 0.114735, "process_mem_max_rss": "126615552", "process_out_blocks": "0", "process_user_time": 0.741061}
[0m21:15:55.579932 [debug] [MainThread]: Command `dbt docs serve` failed at 21:15:55.579745 after 79.83 seconds
[0m21:15:55.581020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a575c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ac6960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d45790>]}
[0m21:15:55.581723 [debug] [MainThread]: Flushing usage events
[0m21:15:56.123354 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:32:37.815926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f1ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e3b6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e3b350>]}


============================== 12:32:37.819380 | d3083047-dd24-4771-86db-dcd0dee16b47 ==============================
[0m12:32:37.819380 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:32:37.819680 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'target_path': 'None', 'version_check': 'True', 'log_format': 'default', 'invocation_command': 'dbt build', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'empty': 'False', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'use_colors': 'True', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'quiet': 'False', 'write_json': 'True'}
[0m12:32:37.971383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3083047-dd24-4771-86db-dcd0dee16b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fda750>]}
[0m12:32:37.998295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3083047-dd24-4771-86db-dcd0dee16b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f1ca0>]}
[0m12:32:37.999638 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:32:38.055306 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:32:38.092185 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:32:38.092457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd3083047-dd24-4771-86db-dcd0dee16b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb2300>]}
[0m12:32:38.571910 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_an_data.stg_reunions' (models/stg/stg_reunions.sql) depends on a source named 'local_duckdb.raw_renuions' which was not found
[0m12:32:38.572326 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.7986385, "process_in_blocks": "0", "process_kernel_time": 0.189306, "process_mem_max_rss": "131072000", "process_out_blocks": "0", "process_user_time": 1.257938}
[0m12:32:38.572543 [debug] [MainThread]: Command `dbt build` failed at 12:32:38.572499 after 0.80 seconds
[0m12:32:38.572717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e3b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e3adb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070886e0>]}
[0m12:32:38.572878 [debug] [MainThread]: Flushing usage events
[0m12:32:39.064647 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:33:36.788581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053e7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a335f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a33290>]}


============================== 12:33:36.791872 | e8aad569-b26a-4cf2-87de-03158d2f55c5 ==============================
[0m12:33:36.791872 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:33:36.792182 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'fail_fast': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'use_colors': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'write_json': 'True', 'invocation_command': 'dbt build', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'quiet': 'False', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'log_format': 'default', 'empty': 'False'}
[0m12:33:36.954012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8aad569-b26a-4cf2-87de-03158d2f55c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b64920>]}
[0m12:33:36.981095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8aad569-b26a-4cf2-87de-03158d2f55c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10236aa50>]}
[0m12:33:36.982430 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:33:37.038487 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:33:37.074957 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:33:37.075226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e8aad569-b26a-4cf2-87de-03158d2f55c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f17b30>]}
[0m12:33:37.553230 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_an_data.stg_reunions' (models/stg/stg_reunions.sql) depends on a source named 'local_duckdb.raw_reuions' which was not found
[0m12:33:37.553644 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.8046845, "process_in_blocks": "0", "process_kernel_time": 0.163228, "process_mem_max_rss": "129712128", "process_out_blocks": "0", "process_user_time": 1.264584}
[0m12:33:37.553858 [debug] [MainThread]: Command `dbt build` failed at 12:33:37.553811 after 0.80 seconds
[0m12:33:37.554030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e1cda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a33440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a31d90>]}
[0m12:33:37.554190 [debug] [MainThread]: Flushing usage events
[0m12:33:37.972121 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:33:53.280147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081014c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e13710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e133b0>]}


============================== 12:33:53.283357 | 7b616209-6428-42c0-b759-2931b85294ad ==============================
[0m12:33:53.283357 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:33:53.283716 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'target_path': 'None', 'quiet': 'False', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'introspect': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'write_json': 'True', 'version_check': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'warn_error': 'None'}
[0m12:33:53.438527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b616209-6428-42c0-b759-2931b85294ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e497f0>]}
[0m12:33:53.465493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b616209-6428-42c0-b759-2931b85294ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f3c500>]}
[0m12:33:53.466833 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:33:53.524709 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:33:53.560912 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:33:53.561181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7b616209-6428-42c0-b759-2931b85294ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10930c110>]}
[0m12:33:54.041523 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_an_data.stg_mandats' (models/stg/stg_mandats.sql) depends on a source named 'local_duckdb.raw_mandats' which was not found
[0m12:33:54.041948 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.79765445, "process_in_blocks": "0", "process_kernel_time": 0.154911, "process_mem_max_rss": "127025152", "process_out_blocks": "0", "process_user_time": 1.256056}
[0m12:33:54.042172 [debug] [MainThread]: Command `dbt build` failed at 12:33:54.042120 after 0.80 seconds
[0m12:33:54.042344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088b6f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090eacc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104703e90>]}
[0m12:33:54.042498 [debug] [MainThread]: Flushing usage events
[0m12:33:54.450857 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:35:06.746474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa6000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10965b6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10965b380>]}


============================== 12:35:06.751475 | 8376c326-ec41-4c6f-9897-8ca0872ec4e1 ==============================
[0m12:35:06.751475 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:35:06.751793 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'warn_error': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'write_json': 'True', 'no_print': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'log_format': 'default', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'empty': 'False', 'quiet': 'False', 'target_path': 'None', 'invocation_command': 'dbt build', 'use_experimental_parser': 'False', 'version_check': 'True'}
[0m12:35:06.937262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8376c326-ec41-4c6f-9897-8ca0872ec4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10961b800>]}
[0m12:35:06.967025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8376c326-ec41-4c6f-9897-8ca0872ec4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108062e70>]}
[0m12:35:06.968534 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:35:07.024123 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:35:07.059965 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:35:07.060231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8376c326-ec41-4c6f-9897-8ca0872ec4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b3bd10>]}
[0m12:35:07.574277 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_an_data.mart
[0m12:35:07.578668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8376c326-ec41-4c6f-9897-8ca0872ec4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cdf2c0>]}
[0m12:35:07.609737 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m12:35:07.611164 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m12:35:07.634767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8376c326-ec41-4c6f-9897-8ca0872ec4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109848ef0>]}
[0m12:35:07.635054 [info ] [MainThread]: Found 17 models, 9 sources, 469 macros
[0m12:35:07.636292 [info ] [MainThread]: 
[0m12:35:07.636468 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:35:07.636603 [info ] [MainThread]: 
[0m12:35:07.636820 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:35:07.639194 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m12:35:07.726630 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m12:35:07.727090 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m12:35:07.727239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:07.747328 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m12:35:07.748109 [debug] [ThreadPool]: On list_database: Close
[0m12:35:07.748449 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m12:35:07.748680 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m12:35:07.751772 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m12:35:07.751933 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m12:35:07.752060 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:07.752640 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:35:07.753223 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m12:35:07.753343 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m12:35:07.753523 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:35:07.753637 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m12:35:07.753752 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m12:35:07.754674 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:35:07.755046 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m12:35:07.755177 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m12:35:07.755291 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m12:35:07.755455 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:35:07.755575 [debug] [ThreadPool]: On create_database_main: Close
[0m12:35:07.756410 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_main, now list_database_main)
[0m12:35:07.758904 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m12:35:07.759057 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m12:35:07.759176 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:07.759398 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:35:07.759520 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m12:35:07.759644 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m12:35:07.767504 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m12:35:07.769051 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m12:35:07.769974 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m12:35:07.770114 [debug] [ThreadPool]: On list_database_main: Close
[0m12:35:07.770649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8376c326-ec41-4c6f-9897-8ca0872ec4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10972be60>]}
[0m12:35:07.770852 [debug] [MainThread]: Using duckdb connection "master"
[0m12:35:07.770976 [debug] [MainThread]: On master: BEGIN
[0m12:35:07.771086 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:35:07.771317 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:35:07.771435 [debug] [MainThread]: On master: COMMIT
[0m12:35:07.771549 [debug] [MainThread]: Using duckdb connection "master"
[0m12:35:07.771658 [debug] [MainThread]: On master: COMMIT
[0m12:35:07.771827 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:35:07.771942 [debug] [MainThread]: On master: Close
[0m12:35:07.773416 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_acteurs
[0m12:35:07.773639 [info ] [Thread-1 (]: 1 of 17 START sql view model main.stg_acteurs .................................. [RUN]
[0m12:35:07.773825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_database_main, now model.dbt_an_data.stg_acteurs)
[0m12:35:07.773965 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_acteurs
[0m12:35:07.777228 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_acteurs"
[0m12:35:07.777574 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_acteurs
[0m12:35:07.790443 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_acteurs"
[0m12:35:07.790793 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m12:35:07.790947 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: BEGIN
[0m12:35:07.791083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:07.791367 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.791505 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m12:35:07.791639 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_acteurs"} */

  
  create view "database"."main"."stg_acteurs__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_acteurs"
  );

[0m12:35:07.791927 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.794600 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m12:35:07.794786 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_acteurs"} */
alter view "database"."main"."stg_acteurs__dbt_tmp" rename to "stg_acteurs"
[0m12:35:07.795640 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:35:07.800346 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: COMMIT
[0m12:35:07.800572 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m12:35:07.800725 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: COMMIT
[0m12:35:07.801968 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:35:07.804704 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m12:35:07.804896 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_acteurs"} */

      drop view if exists "database"."main"."stg_acteurs__dbt_backup" cascade
    
[0m12:35:07.805238 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.806370 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: Close
[0m12:35:07.807346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8376c326-ec41-4c6f-9897-8ca0872ec4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bacc80>]}
[0m12:35:07.807666 [info ] [Thread-1 (]: 1 of 17 OK created sql view model main.stg_acteurs ............................. [[32mOK[0m in 0.03s]
[0m12:35:07.807933 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_acteurs
[0m12:35:07.808127 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_agenda
[0m12:35:07.808375 [info ] [Thread-1 (]: 2 of 17 START sql view model main.stg_agenda ................................... [RUN]
[0m12:35:07.808615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_acteurs, now model.dbt_an_data.stg_agenda)
[0m12:35:07.808773 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_agenda
[0m12:35:07.810054 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_agenda"
[0m12:35:07.810350 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_agenda
[0m12:35:07.811638 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_agenda"
[0m12:35:07.812061 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m12:35:07.812217 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: BEGIN
[0m12:35:07.812348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:07.812633 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.812773 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m12:35:07.812912 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_agenda"} */

  
  create view "database"."main"."stg_agenda__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_agenda"
  );

[0m12:35:07.813200 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.814499 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m12:35:07.814648 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_agenda"} */
alter view "database"."main"."stg_agenda" rename to "stg_agenda__dbt_backup"
[0m12:35:07.814889 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.816056 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m12:35:07.816196 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_agenda"} */
alter view "database"."main"."stg_agenda__dbt_tmp" rename to "stg_agenda"
[0m12:35:07.816415 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.818709 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: COMMIT
[0m12:35:07.818882 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m12:35:07.819022 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: COMMIT
[0m12:35:07.819339 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.820403 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m12:35:07.820577 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_agenda"} */

      drop view if exists "database"."main"."stg_agenda__dbt_backup" cascade
    
[0m12:35:07.820915 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.821587 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: Close
[0m12:35:07.821902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8376c326-ec41-4c6f-9897-8ca0872ec4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a39f5f0>]}
[0m12:35:07.822192 [info ] [Thread-1 (]: 2 of 17 OK created sql view model main.stg_agenda .............................. [[32mOK[0m in 0.01s]
[0m12:35:07.822436 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_agenda
[0m12:35:07.822612 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_amendements
[0m12:35:07.822836 [info ] [Thread-1 (]: 3 of 17 START sql view model main.stg_amendements .............................. [RUN]
[0m12:35:07.823095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_agenda, now model.dbt_an_data.stg_amendements)
[0m12:35:07.823259 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_amendements
[0m12:35:07.824667 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_amendements"
[0m12:35:07.825077 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_amendements
[0m12:35:07.826413 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_amendements"
[0m12:35:07.826722 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m12:35:07.826874 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: BEGIN
[0m12:35:07.827007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:07.827316 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.827460 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m12:35:07.827607 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_amendements"} */

  
  create view "database"."main"."stg_amendements__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_amendements"
  );

[0m12:35:07.827894 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.829276 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m12:35:07.829442 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_amendements"} */
alter view "database"."main"."stg_amendements__dbt_tmp" rename to "stg_amendements"
[0m12:35:07.829725 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.830308 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: COMMIT
[0m12:35:07.830462 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m12:35:07.830601 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: COMMIT
[0m12:35:07.830935 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.831973 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m12:35:07.832140 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_amendements"} */

      drop view if exists "database"."main"."stg_amendements__dbt_backup" cascade
    
[0m12:35:07.832390 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.833057 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: Close
[0m12:35:07.833334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8376c326-ec41-4c6f-9897-8ca0872ec4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3ac4a0>]}
[0m12:35:07.833613 [info ] [Thread-1 (]: 3 of 17 OK created sql view model main.stg_amendements ......................... [[32mOK[0m in 0.01s]
[0m12:35:07.833898 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_amendements
[0m12:35:07.834118 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_organes
[0m12:35:07.834361 [info ] [Thread-1 (]: 4 of 17 START sql view model main.stg_organes .................................. [RUN]
[0m12:35:07.834610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_amendements, now model.dbt_an_data.stg_organes)
[0m12:35:07.834771 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_organes
[0m12:35:07.836136 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_organes"
[0m12:35:07.836508 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_organes
[0m12:35:07.837855 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_organes"
[0m12:35:07.838189 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m12:35:07.838338 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: BEGIN
[0m12:35:07.838473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:07.838787 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.838928 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m12:35:07.839065 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_organes"} */

  
  create view "database"."main"."stg_organes__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_organes"
  );

[0m12:35:07.839358 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.840643 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m12:35:07.840797 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_organes"} */
alter view "database"."main"."stg_organes__dbt_tmp" rename to "stg_organes"
[0m12:35:07.841047 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.841549 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: COMMIT
[0m12:35:07.841694 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m12:35:07.841821 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: COMMIT
[0m12:35:07.842110 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.843082 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m12:35:07.843237 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_organes"} */

      drop view if exists "database"."main"."stg_organes__dbt_backup" cascade
    
[0m12:35:07.843474 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.844036 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: Close
[0m12:35:07.844256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8376c326-ec41-4c6f-9897-8ca0872ec4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3d01a0>]}
[0m12:35:07.844530 [info ] [Thread-1 (]: 4 of 17 OK created sql view model main.stg_organes ............................. [[32mOK[0m in 0.01s]
[0m12:35:07.844764 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_organes
[0m12:35:07.844932 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_pays
[0m12:35:07.845131 [info ] [Thread-1 (]: 5 of 17 START sql view model main.stg_pays ..................................... [RUN]
[0m12:35:07.845348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_organes, now model.dbt_an_data.stg_pays)
[0m12:35:07.845492 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_pays
[0m12:35:07.846666 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_pays"
[0m12:35:07.846984 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_pays
[0m12:35:07.849141 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_pays"
[0m12:35:07.849448 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m12:35:07.849599 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: BEGIN
[0m12:35:07.849732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:07.849991 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.850134 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m12:35:07.850272 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_pays"} */

  
  create view "database"."main"."stg_pays__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_pays"
  );

[0m12:35:07.850541 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.851786 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m12:35:07.851942 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_pays"} */
alter view "database"."main"."stg_pays__dbt_tmp" rename to "stg_pays"
[0m12:35:07.852179 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.852674 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: COMMIT
[0m12:35:07.852811 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m12:35:07.852936 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: COMMIT
[0m12:35:07.853175 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.854071 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m12:35:07.854211 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_pays"} */

      drop view if exists "database"."main"."stg_pays__dbt_backup" cascade
    
[0m12:35:07.854423 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.854939 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: Close
[0m12:35:07.855156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8376c326-ec41-4c6f-9897-8ca0872ec4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3f2300>]}
[0m12:35:07.855423 [info ] [Thread-1 (]: 5 of 17 OK created sql view model main.stg_pays ................................ [[32mOK[0m in 0.01s]
[0m12:35:07.855633 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_pays
[0m12:35:07.855788 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_reunions
[0m12:35:07.855981 [info ] [Thread-1 (]: 6 of 17 START sql view model main.stg_reunions ................................. [RUN]
[0m12:35:07.856173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_pays, now model.dbt_an_data.stg_reunions)
[0m12:35:07.856311 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_reunions
[0m12:35:07.857462 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_reunions"
[0m12:35:07.857747 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_reunions
[0m12:35:07.858977 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_reunions"
[0m12:35:07.859252 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m12:35:07.859392 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: BEGIN
[0m12:35:07.859519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:07.859743 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.859881 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m12:35:07.860016 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_reunions"} */

  
  create view "database"."main"."stg_reunions__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_reunions"
  );

[0m12:35:07.860260 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.861440 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m12:35:07.861586 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_reunions"} */
alter view "database"."main"."stg_reunions__dbt_tmp" rename to "stg_reunions"
[0m12:35:07.861819 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.862317 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: COMMIT
[0m12:35:07.862457 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m12:35:07.862584 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: COMMIT
[0m12:35:07.862834 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.863787 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m12:35:07.863939 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_reunions"} */

      drop view if exists "database"."main"."stg_reunions__dbt_backup" cascade
    
[0m12:35:07.864162 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.864744 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: Close
[0m12:35:07.864982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8376c326-ec41-4c6f-9897-8ca0872ec4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3e01a0>]}
[0m12:35:07.865264 [info ] [Thread-1 (]: 6 of 17 OK created sql view model main.stg_reunions ............................ [[32mOK[0m in 0.01s]
[0m12:35:07.865539 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_reunions
[0m12:35:07.865717 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_scrutins
[0m12:35:07.865940 [info ] [Thread-1 (]: 7 of 17 START sql view model main.stg_scrutins ................................. [RUN]
[0m12:35:07.866230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_reunions, now model.dbt_an_data.stg_scrutins)
[0m12:35:07.866418 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_scrutins
[0m12:35:07.867912 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_scrutins"
[0m12:35:07.868312 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_scrutins
[0m12:35:07.869823 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_scrutins"
[0m12:35:07.870176 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m12:35:07.870332 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: BEGIN
[0m12:35:07.870470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:07.870800 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.870943 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m12:35:07.871083 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins"} */

  
  create view "database"."main"."stg_scrutins__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_scrutins"
  );

[0m12:35:07.871401 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.872935 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m12:35:07.873119 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins"} */
alter view "database"."main"."stg_scrutins" rename to "stg_scrutins__dbt_backup"
[0m12:35:07.873409 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.875650 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m12:35:07.875815 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins"} */
alter view "database"."main"."stg_scrutins__dbt_tmp" rename to "stg_scrutins"
[0m12:35:07.876061 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.876606 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: COMMIT
[0m12:35:07.876753 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m12:35:07.876883 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: COMMIT
[0m12:35:07.877233 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.878280 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m12:35:07.878436 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins"} */

      drop view if exists "database"."main"."stg_scrutins__dbt_backup" cascade
    
[0m12:35:07.878726 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.879288 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: Close
[0m12:35:07.879520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8376c326-ec41-4c6f-9897-8ca0872ec4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a411970>]}
[0m12:35:07.879791 [info ] [Thread-1 (]: 7 of 17 OK created sql view model main.stg_scrutins ............................ [[32mOK[0m in 0.01s]
[0m12:35:07.880017 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_scrutins
[0m12:35:07.880182 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_acteurs
[0m12:35:07.880388 [info ] [Thread-1 (]: 8 of 17 START sql table model main.int_acteurs ................................. [RUN]
[0m12:35:07.880657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_scrutins, now model.dbt_an_data.int_acteurs)
[0m12:35:07.880835 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_acteurs
[0m12:35:07.882171 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_acteurs"
[0m12:35:07.882505 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_acteurs
[0m12:35:07.891084 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_acteurs"
[0m12:35:07.891454 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m12:35:07.891615 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m12:35:07.891755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:07.892058 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:07.892203 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m12:35:07.892369 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_acteurs"} */

  
    
    

    create  table
      "database"."main"."int_acteurs__dbt_tmp"
  
    as (
      SELECT 
json_extract_string(json, '$.acteur.uid.#text') as uid,
json_extract_string(json, '$.acteur.etatCivil.ident.civ') as civ,
json_extract_string(json, '$.acteur.etatCivil.ident.prenom') as prenom,
json_extract_string(json, '$.acteur.etatCivil.ident.nom') as nom,
json_extract_string(json, '$.acteur.etatCivil.ident.trigramme') as trigramme,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.dateNais') as dateNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.villeNais') as villeNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.depNais') as depNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.paysNais') as paysNais,
json_extract_string(json, '$.acteur.etatCivil.dateDeces') as dateDeces,
json_extract_string(json, '$.acteur.profession.libelleCourant') as libelleCourant,
json_extract_string(json, '$.acteur.profession.socProcINSEE.catSocPro') as catSocPro,
json_extract_string(json, '$.acteur.profession.socProcINSEE.famSocPro') as famSocPro,
json_extract_string(json, '$.acteur.uri_hatvp') as uri_hatvp
FROM "database"."main"."stg_acteurs"
    );
  
  
[0m12:35:08.022391 [debug] [Thread-1 (]: SQL status: OK in 0.130 seconds
[0m12:35:08.024133 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m12:35:08.024305 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_acteurs"} */
alter table "database"."main"."int_acteurs__dbt_tmp" rename to "int_acteurs"
[0m12:35:08.024643 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:08.026823 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m12:35:08.026997 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m12:35:08.027138 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m12:35:08.028089 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:35:08.029155 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m12:35:08.029313 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "database"."main"."int_acteurs__dbt_backup" cascade
    
[0m12:35:08.029559 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:08.030185 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: Close
[0m12:35:08.030436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8376c326-ec41-4c6f-9897-8ca0872ec4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109811f10>]}
[0m12:35:08.030711 [info ] [Thread-1 (]: 8 of 17 OK created sql table model main.int_acteurs ............................ [[32mOK[0m in 0.15s]
[0m12:35:08.030933 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_acteurs
[0m12:35:08.031092 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_mandats
[0m12:35:08.031316 [info ] [Thread-1 (]: 9 of 17 START sql table model main.int_mandats ................................. [RUN]
[0m12:35:08.031491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_acteurs, now model.dbt_an_data.int_mandats)
[0m12:35:08.031630 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_mandats
[0m12:35:08.032861 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_mandats"
[0m12:35:08.033187 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_mandats
[0m12:35:08.034453 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_mandats"
[0m12:35:08.034727 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m12:35:08.034872 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m12:35:08.035003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:08.035246 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:08.035384 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m12:35:08.035544 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_mandats"} */

  
    
    

    create  table
      "database"."main"."int_mandats__dbt_tmp"
  
    as (
      SELECT 
json_extract_string(mandat.value, '$.uid') as uid,
json_extract_string(mandat.value, '$.acteurRef') as acteurRef,
json_extract_string(mandat.value, '$.legislature') as legislature,
json_extract_string(mandat.value, '$.typeOrgane') as typeOrgane,
json_extract_string(mandat.value, '$.dateDebut') as dateDebut,
json_extract_string(mandat.value, '$.dateFin') as dateFin,
json_extract_string(mandat.value, '$.preseance') as preseance,
json_extract_string(mandat.value, '$.nominPrincipale') as nominPrincipale,
json_extract_string(mandat.value, '$.infosQualite.codeQualite') as codeQualite,
json_extract_string(mandat.value, '$.organes.organeRef') as organeRef,
FROM "database"."main"."stg_acteurs" act, json_each(json->'acteur'->'mandats'->'mandat') mandat
    );
  
  
[0m12:35:08.306515 [debug] [Thread-1 (]: SQL status: OK in 0.270 seconds
[0m12:35:08.310736 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m12:35:08.311283 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_mandats"} */
alter table "database"."main"."int_mandats__dbt_tmp" rename to "int_mandats"
[0m12:35:08.312274 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:35:08.313307 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m12:35:08.313675 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m12:35:08.313922 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m12:35:08.324313 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m12:35:08.325763 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m12:35:08.325949 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "database"."main"."int_mandats__dbt_backup" cascade
    
[0m12:35:08.326308 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:08.327141 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: Close
[0m12:35:08.327614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8376c326-ec41-4c6f-9897-8ca0872ec4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a36a7b0>]}
[0m12:35:08.328067 [info ] [Thread-1 (]: 9 of 17 OK created sql table model main.int_mandats ............................ [[32mOK[0m in 0.30s]
[0m12:35:08.328375 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_mandats
[0m12:35:08.328581 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_agenda
[0m12:35:08.328870 [info ] [Thread-1 (]: 10 of 17 START sql table model main.int_agenda ................................. [RUN]
[0m12:35:08.329098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_mandats, now model.dbt_an_data.int_agenda)
[0m12:35:08.329261 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_agenda
[0m12:35:08.332126 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_agenda"
[0m12:35:08.332988 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_agenda
[0m12:35:08.334443 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_agenda"
[0m12:35:08.334750 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m12:35:08.334899 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m12:35:08.335034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:08.335355 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:08.335500 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m12:35:08.335643 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */

  
    
    

    create  table
      "database"."main"."int_agenda__dbt_tmp"
  
    as (
      SELECT * 
FROM "database"."main"."stg_agenda"
    );
  
  
[0m12:35:08.337192 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:35:08.340074 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m12:35:08.340287 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_agenda'
  
[0m12:35:08.340771 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:08.341451 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m12:35:08.341608 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_agenda'
  
[0m12:35:08.342005 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:08.343595 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m12:35:08.343799 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */
alter view "database"."main"."int_agenda" rename to "int_agenda__dbt_backup"
[0m12:35:08.344106 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:08.345495 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m12:35:08.345744 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */
alter table "database"."main"."int_agenda__dbt_tmp" rename to "int_agenda"
[0m12:35:08.346117 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:08.346793 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m12:35:08.346956 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m12:35:08.347091 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m12:35:08.347541 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:08.348785 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m12:35:08.348959 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */

      drop view if exists "database"."main"."int_agenda__dbt_backup" cascade
    
[0m12:35:08.349335 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:08.349956 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: Close
[0m12:35:08.350215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8376c326-ec41-4c6f-9897-8ca0872ec4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3eda60>]}
[0m12:35:08.350497 [info ] [Thread-1 (]: 10 of 17 OK created sql table model main.int_agenda ............................ [[32mOK[0m in 0.02s]
[0m12:35:08.350731 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_agenda
[0m12:35:08.350907 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements
[0m12:35:08.351119 [info ] [Thread-1 (]: 11 of 17 START sql table model main.int_amendements ............................ [RUN]
[0m12:35:08.351303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_agenda, now model.dbt_an_data.int_amendements)
[0m12:35:08.351456 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements
[0m12:35:08.352975 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements"
[0m12:35:08.353363 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements
[0m12:35:08.354924 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements"
[0m12:35:08.355309 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m12:35:08.355470 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m12:35:08.355614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:08.355957 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:08.356103 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m12:35:08.356303 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements"} */

  
    
    

    create  table
      "database"."main"."int_amendements__dbt_tmp"
  
    as (
      SELECT
json_extract_string(json, '$.amendement.uid') AS uid,
json_extract_string(json, '$.amendement.chronotag') AS chronotag,
json_extract_string(json, '$.amendement.examenRef') AS examenRef,
json_extract_string(json, '$.amendement.amendementParentRef') AS amendementParentRef,
json_extract_string(json, '$.amendement.signataires.auteur.typeAuteur') AS typeAuteur,
json_extract_string(json, '$.amendement.signataires.auteur.acteurRef') AS refAuteur,
json_extract_string(json, '$.amendement.signataires.auteur.groupePolitique') AS groupePolitiqueAuteur,
json_extract_string(json, '$.amendement.cycleDeVie.dateDepot') AS dateDepot,
json_extract_string(json, '$.amendement.cycleDeVie.datePublication') AS datePublication,
json_extract_string(json, '$.amendement.cycleDeVie.soumisArticle40') AS soumisArticle40,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.code') AS codeEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.libelle') AS libelleEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.code') AS codeSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.dateSort') AS dateSort,
json_extract_string(json, '$.amendement.cycleDeVie.sort') AS sort,
split_part(replace(filename, '.json', ''), '/', -1) AS id_amendement,
split_part(replace(filename, '.json', ''), '/', -2) AS id_texte,
split_part(replace(filename, '.json', ''), '/', -3) AS id_dossier_legislatif,
id_texte[:4] AS nature_texte,
id_texte[5:6] AS source_texte,
regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 1) AS prefix_bibard,
regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 2) AS numero_bibard,
regexp_extract(id_amendement, '(SEA|PO\d*)', 1) AS code_organe,
regexp_extract(id_amendement, '(P)(\d*)(D)', 2) AS numero_partie,
regexp_extract(id_amendement, '(D)(\d*)(N)', 2) AS numero_deliberation,
regexp_extract(id_amendement, '(D)(\d*)(N)(\d*)', 4) AS numero_court
from "database"."main"."stg_amendements"
    );
  
  
[0m12:35:08.359494 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:35:08.360884 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m12:35:08.361053 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements"} */
alter table "database"."main"."int_amendements__dbt_tmp" rename to "int_amendements"
[0m12:35:08.361336 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:08.361876 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m12:35:08.362018 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m12:35:08.362146 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m12:35:08.362441 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:08.363391 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m12:35:08.363541 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "database"."main"."int_amendements__dbt_backup" cascade
    
[0m12:35:08.363776 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:08.364376 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: Close
[0m12:35:08.364681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8376c326-ec41-4c6f-9897-8ca0872ec4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a36aed0>]}
[0m12:35:08.365330 [info ] [Thread-1 (]: 11 of 17 OK created sql table model main.int_amendements ....................... [[32mOK[0m in 0.01s]
[0m12:35:08.365672 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements
[0m12:35:08.365881 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements_cosignataires
[0m12:35:08.366129 [info ] [Thread-1 (]: 12 of 17 START sql table model main.int_amendements_cosignataires .............. [RUN]
[0m12:35:08.366364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements, now model.dbt_an_data.int_amendements_cosignataires)
[0m12:35:08.366531 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements_cosignataires
[0m12:35:08.368492 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements_cosignataires"
[0m12:35:08.368981 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements_cosignataires
[0m12:35:08.370613 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements_cosignataires"
[0m12:35:08.371103 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m12:35:08.371287 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m12:35:08.371446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:08.371824 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:08.371994 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m12:35:08.372165 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

  
    
    

    create  table
      "database"."main"."int_amendements_cosignataires__dbt_tmp"
  
    as (
      WITH cosignataires_arr AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef[*]') AS acteurRef
  FROM "database"."main"."stg_amendements"
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') == 'ARRAY' AND acteurRef IS NOT NULL
), cosignataires_str AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef') AS acteurRef
  FROM "database"."main"."stg_amendements"
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') <> 'ARRAY' AND acteurRef IS NOT NULL
)
SELECT 
  uid, 
  unnest(acteurRef) as acteurRef
FROM cosignataires_arr
UNION ALL
SELECT 
  uid, 
  acteurRef
FROM cosignataires_str
    );
  
  
[0m12:35:08.373049 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:35:08.375697 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m12:35:08.375897 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */
alter table "database"."main"."int_amendements_cosignataires__dbt_tmp" rename to "int_amendements_cosignataires"
[0m12:35:08.376260 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:08.376881 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m12:35:08.377040 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m12:35:08.377180 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m12:35:08.377498 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:08.378453 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m12:35:08.378617 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "database"."main"."int_amendements_cosignataires__dbt_backup" cascade
    
[0m12:35:08.378859 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:08.379408 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: Close
[0m12:35:08.379632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8376c326-ec41-4c6f-9897-8ca0872ec4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a45fc50>]}
[0m12:35:08.379900 [info ] [Thread-1 (]: 12 of 17 OK created sql table model main.int_amendements_cosignataires ......... [[32mOK[0m in 0.01s]
[0m12:35:08.380137 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements_cosignataires
[0m12:35:08.380302 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_organes
[0m12:35:08.380508 [info ] [Thread-1 (]: 13 of 17 START sql table model main.int_organes ................................ [RUN]
[0m12:35:08.380709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements_cosignataires, now model.dbt_an_data.int_organes)
[0m12:35:08.380857 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_organes
[0m12:35:08.382172 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_organes"
[0m12:35:08.382534 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_organes
[0m12:35:08.384249 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_organes"
[0m12:35:08.384674 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m12:35:08.384839 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m12:35:08.384983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:08.385389 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:08.385575 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m12:35:08.385754 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_organes"} */

  
    
    

    create  table
      "database"."main"."int_organes__dbt_tmp"
  
    as (
      SELECT 
json_extract_string(json, '$.organe.uid') as uid,
json_extract_string(json, '$.organe.codeType') as codeType,
json_extract_string(json, '$.organe.libelle') as libelle,
json_extract_string(json, '$.organe.libelleEdition') as libelleEdition,
json_extract_string(json, '$.organe.libelleAbrege') as libelleAbrege,
json_extract_string(json, '$.organe.libelleAbrev') as libelleAbrev,
json_extract_string(json, '$.organe.viMoDe.dateDebut') as dateDebut,
json_extract_string(json, '$.organe.viMoDe.dateAgrement') as dateAgrement,
json_extract_string(json, '$.organe.viMoDe.dateFin') as dateFin,
json_extract_string(json, '$.organe.organeParent') as organeParent,
json_extract_string(json, '$.organe.chambre') as chambre,
json_extract_string(json, '$.organe.regime') as regime,
json_extract_string(json, '$.organe.legislature') as legislature
FROM "database"."main"."stg_organes"
    );
  
  
[0m12:35:08.471470 [debug] [Thread-1 (]: SQL status: OK in 0.085 seconds
[0m12:35:08.473177 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m12:35:08.473349 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_organes"} */
alter table "database"."main"."int_organes__dbt_tmp" rename to "int_organes"
[0m12:35:08.473676 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:08.474211 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m12:35:08.474360 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m12:35:08.474488 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m12:35:08.478187 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:35:08.479311 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m12:35:08.479476 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "database"."main"."int_organes__dbt_backup" cascade
    
[0m12:35:08.479738 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:08.480361 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: Close
[0m12:35:08.480618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8376c326-ec41-4c6f-9897-8ca0872ec4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2d5280>]}
[0m12:35:08.480887 [info ] [Thread-1 (]: 13 of 17 OK created sql table model main.int_organes ........................... [[32mOK[0m in 0.10s]
[0m12:35:08.481135 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_organes
[0m12:35:08.481321 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_pays
[0m12:35:08.481508 [info ] [Thread-1 (]: 14 of 17 START sql table model main.int_pays ................................... [RUN]
[0m12:35:08.481739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_organes, now model.dbt_an_data.int_pays)
[0m12:35:08.481896 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_pays
[0m12:35:08.483384 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_pays"
[0m12:35:08.483839 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_pays
[0m12:35:08.485444 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_pays"
[0m12:35:08.485851 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m12:35:08.486013 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m12:35:08.486154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:08.486534 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:08.486682 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m12:35:08.486846 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_pays"} */

  
    
    

    create  table
      "database"."main"."int_pays__dbt_tmp"
  
    as (
      SELECT
json_extract_string(json, '$.pays.uid') as uid,
json_extract_string(json, '$.pays.code_insee') as code_insee,
json_extract_string(json, '$.pays.libelleInsee') as libelleInsee,
json_extract_string(json, '$.pays.nomCourant') as nomCourant,
json_extract_string(json, '$.pays.code_iso2A') as code_iso2A,
json_extract_string(json, '$.pays.code_iso3A') as code_iso3A,
json_extract_string(json, '$.pays.code_iso3N') as code_iso3N,
json_extract_string(json, '$.pays.libelleIso') as libelleIso,
json_extract_string(json, '$.pays.libelleANCourt') as libelleANCourt,
json_extract_string(json, '$.pays.libelleANLong') as libelleANLong,
json_extract_string(json, '$.pays.sourceJuridique') as sourceJuridique,
json_extract_string(json, '$.pays.activ') as activ
FROM "database"."main"."stg_pays"
    );
  
  
[0m12:35:08.488809 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:35:08.490294 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m12:35:08.490451 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_pays"} */
alter table "database"."main"."int_pays__dbt_tmp" rename to "int_pays"
[0m12:35:08.490747 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:08.491351 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m12:35:08.491493 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m12:35:08.491619 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m12:35:08.492070 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:08.493004 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m12:35:08.493144 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "database"."main"."int_pays__dbt_backup" cascade
    
[0m12:35:08.493357 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:08.493908 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: Close
[0m12:35:08.494142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8376c326-ec41-4c6f-9897-8ca0872ec4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3e32c0>]}
[0m12:35:08.494427 [info ] [Thread-1 (]: 14 of 17 OK created sql table model main.int_pays .............................. [[32mOK[0m in 0.01s]
[0m12:35:08.494662 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_pays
[0m12:35:08.494825 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_reunions
[0m12:35:08.495028 [info ] [Thread-1 (]: 15 of 17 START sql table model main.int_reunions ............................... [RUN]
[0m12:35:08.495200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_pays, now model.dbt_an_data.int_reunions)
[0m12:35:08.495341 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_reunions
[0m12:35:08.497556 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_reunions"
[0m12:35:08.497899 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_reunions
[0m12:35:08.499222 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_reunions"
[0m12:35:08.499567 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m12:35:08.499727 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m12:35:08.499867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:08.500167 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:08.500307 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m12:35:08.500477 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_reunions"} */

  
    
    

    create  table
      "database"."main"."int_reunions__dbt_tmp"
  
    as (
      SELECT
json_extract_string(json, '$.reunion.uid') AS uid,
json_extract_string(json, '$.reunion.timeStampDebut') AS timeStampDebut,
json_extract_string(json, '$.reunion.lieu.lieuRef') AS lieuRef,
json_extract_string(json, '$.reunion.lieu.libelleLong') AS lieuLibelle,
json_extract_string(json, '$.reunion.cycleDeVie.etat') AS cycleDeVieEtat,
json_extract_string(json, '$.reunion.demandeur') AS demandeur,
json_extract_string(json, '$.reunion.organeReuniRef') AS organeReuniRef,
json_extract_string(json, '$.reunion.visioConference') AS visioConference,
json_extract_string(json, '$.reunion.sessionRef') AS sessionRef,
json_extract_string(json, '$.reunion.ouverturePresse') AS ouverturePresse,
json_extract_string(json, '$.reunion.captationVideo') AS captationVideo,
json_extract_string(json, '$.reunion.ODJ.convocationODJ.item') AS convocationODJ,
json_extract_string(json, '$.reunion.ODJ.resumeODJ.item') AS resumeODJ,
json_extract_string(json, '$.reunion.compteRenduRef') AS compteRenduRef,
json_extract_string(json, '$.reunion.identifiants.numSeanceJO') AS numSeanceJO,
json_extract_string(json, '$.reunion.identifiants.idJO') AS idJO,
json_extract_string(json, '$.reunion.identifiants.quantieme') AS quantieme,
json_extract_string(json, '$.reunion.identifiants.DataSeance') AS DataSeance
FROM "database"."main"."stg_reunions"
    );
  
  
[0m12:35:08.786230 [debug] [Thread-1 (]: SQL status: OK in 0.286 seconds
[0m12:35:08.788007 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m12:35:08.788222 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_reunions"} */
alter table "database"."main"."int_reunions__dbt_tmp" rename to "int_reunions"
[0m12:35:08.788597 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:08.789175 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m12:35:08.789327 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m12:35:08.789460 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m12:35:08.793573 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:35:08.794798 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m12:35:08.794965 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "database"."main"."int_reunions__dbt_backup" cascade
    
[0m12:35:08.795259 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:08.795857 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: Close
[0m12:35:08.796093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8376c326-ec41-4c6f-9897-8ca0872ec4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a451100>]}
[0m12:35:08.796359 [info ] [Thread-1 (]: 15 of 17 OK created sql table model main.int_reunions .......................... [[32mOK[0m in 0.30s]
[0m12:35:08.796582 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_reunions
[0m12:35:08.796741 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins
[0m12:35:08.796914 [info ] [Thread-1 (]: 16 of 17 START sql table model main.int_scrutins ............................... [RUN]
[0m12:35:08.797089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_reunions, now model.dbt_an_data.int_scrutins)
[0m12:35:08.797232 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins
[0m12:35:08.798522 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins"
[0m12:35:08.798930 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins
[0m12:35:08.800280 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins"
[0m12:35:08.800581 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m12:35:08.800736 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m12:35:08.800869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:08.801126 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:08.801263 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m12:35:08.801419 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

  
    
    

    create  table
      "database"."main"."int_scrutins__dbt_tmp"
  
    as (
      SELECT
filename,
json_extract_string(json, '$.scrutin.uid') AS uid,
json_extract_string(json, '$.scrutin.numero') AS numero,
json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
json_extract_string(json, '$.scrutin.legislature') AS legislature,
json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
json_extract_string(json, '$.scrutin.titre') AS titre,
json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote
FROM "database"."main"."stg_scrutins"
    );
  
  
[0m12:35:09.898861 [debug] [Thread-1 (]: SQL status: OK in 1.097 seconds
[0m12:35:09.902571 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m12:35:09.902777 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_scrutins'
  
[0m12:35:09.903367 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:09.904057 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m12:35:09.904215 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_scrutins'
  
[0m12:35:09.904644 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:09.907885 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m12:35:09.908079 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */
alter view "database"."main"."int_scrutins" rename to "int_scrutins__dbt_backup"
[0m12:35:09.908414 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:09.909667 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m12:35:09.909823 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */
alter table "database"."main"."int_scrutins__dbt_tmp" rename to "int_scrutins"
[0m12:35:09.910073 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:09.910752 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m12:35:09.910903 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m12:35:09.911032 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m12:35:09.916434 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:35:09.917636 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m12:35:09.917798 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop view if exists "database"."main"."int_scrutins__dbt_backup" cascade
    
[0m12:35:09.918136 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:09.919025 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: Close
[0m12:35:09.919774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8376c326-ec41-4c6f-9897-8ca0872ec4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a21d2b0>]}
[0m12:35:09.920355 [info ] [Thread-1 (]: 16 of 17 OK created sql table model main.int_scrutins .......................... [[32mOK[0m in 1.12s]
[0m12:35:09.920686 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins
[0m12:35:09.920929 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins_votes
[0m12:35:09.921420 [info ] [Thread-1 (]: 17 of 17 START sql table model main.int_scrutins_votes ......................... [RUN]
[0m12:35:09.921677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_scrutins, now model.dbt_an_data.int_scrutins_votes)
[0m12:35:09.921838 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins_votes
[0m12:35:09.924295 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins_votes"
[0m12:35:09.925492 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins_votes
[0m12:35:09.927096 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins_votes"
[0m12:35:09.927580 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m12:35:09.927734 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m12:35:09.927872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:09.928200 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:09.928341 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m12:35:09.928620 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

  
    
    

    create  table
      "database"."main"."int_scrutins_votes__dbt_tmp"
  
    as (
      WITH grp AS (
      -- explode les groupes (1 par groupe)
      SELECT
          json_extract_string(j.json, '$.scrutin.uid') AS uid,
          json_extract_string(g.value, '$.organeRef') AS groupe_organe,
          g.value AS groupe_json
      FROM "database"."main"."stg_scrutins" j,
           json_each(json->'scrutin'->'ventilationVotes'->'organe'->'groupes'->'groupe') g
  ),

  positions_array AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          p.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'pours'->'votant') p
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          c.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'contres'->'votant') c
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          a.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'abstentions'->'votant') a
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          n.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'nonVotants'->'votant') n
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[ARRAY]'
  ),
  positions_object AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[OBJECT]'
  ),

  clean AS (
      -- sécurise les champs (souvent string ou null)
      SELECT
          uid,
          groupe_organe,
          type_vote,
          json_extract_string(vote_json, '$.acteurRef') AS acteurRef,
          json_extract_string(vote_json, '$.mandatRef') AS mandatRef,
          json_extract_string(vote_json, '$.parDelegation') AS parDelegation,
          json_extract_string(vote_json, '$.numPlace') AS numPlace,
          json_extract_string(vote_json, '$.causePositionVote') AS cause
      FROM positions_array
      UNION ALL
      SELECT * 
      FROM positions_object
  )

  SELECT * FROM clean
    );
  
  
[0m12:35:19.019457 [debug] [Thread-1 (]: SQL status: OK in 9.090 seconds
[0m12:35:19.022281 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m12:35:19.022492 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_scrutins_votes'
  
[0m12:35:19.028535 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:35:19.031655 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m12:35:19.031846 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_scrutins_votes'
  
[0m12:35:19.032511 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:35:19.035290 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m12:35:19.035472 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins_votes"} */
alter view "database"."main"."int_scrutins_votes" rename to "int_scrutins_votes__dbt_backup"
[0m12:35:19.037248 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:35:19.038512 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m12:35:19.038667 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins_votes"} */
alter table "database"."main"."int_scrutins_votes__dbt_tmp" rename to "int_scrutins_votes"
[0m12:35:19.038933 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:19.039624 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m12:35:19.039777 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m12:35:19.039906 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m12:35:19.186048 [debug] [Thread-1 (]: SQL status: OK in 0.146 seconds
[0m12:35:19.187365 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m12:35:19.187528 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop view if exists "database"."main"."int_scrutins_votes__dbt_backup" cascade
    
[0m12:35:19.188243 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:35:19.189150 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: Close
[0m12:35:19.189734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8376c326-ec41-4c6f-9897-8ca0872ec4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2b0080>]}
[0m12:35:19.190204 [info ] [Thread-1 (]: 17 of 17 OK created sql table model main.int_scrutins_votes .................... [[32mOK[0m in 9.27s]
[0m12:35:19.190502 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins_votes
[0m12:35:19.193457 [debug] [MainThread]: Using duckdb connection "master"
[0m12:35:19.193600 [debug] [MainThread]: On master: BEGIN
[0m12:35:19.193723 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:35:19.193988 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:35:19.194109 [debug] [MainThread]: On master: COMMIT
[0m12:35:19.194223 [debug] [MainThread]: Using duckdb connection "master"
[0m12:35:19.194332 [debug] [MainThread]: On master: COMMIT
[0m12:35:19.194490 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:35:19.194605 [debug] [MainThread]: On master: Close
[0m12:35:19.194753 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:19.194862 [debug] [MainThread]: Connection 'model.dbt_an_data.int_scrutins_votes' was properly closed.
[0m12:35:19.195334 [info ] [MainThread]: 
[0m12:35:19.195485 [info ] [MainThread]: Finished running 10 table models, 7 view models in 0 hours 0 minutes and 11.56 seconds (11.56s).
[0m12:35:19.196523 [debug] [MainThread]: Command end result
[0m12:35:19.254711 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m12:35:19.255961 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m12:35:19.259532 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m12:35:19.259695 [info ] [MainThread]: 
[0m12:35:19.259865 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:35:19.259990 [info ] [MainThread]: 
[0m12:35:19.260512 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=17
[0m12:35:19.261218 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 12.563461, "process_in_blocks": "0", "process_kernel_time": 5.619221, "process_mem_max_rss": "3007528960", "process_out_blocks": "0", "process_user_time": 13.499168}
[0m12:35:19.261414 [debug] [MainThread]: Command `dbt build` succeeded at 12:35:19.261378 after 12.56 seconds
[0m12:35:19.261587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a291c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2931a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a292150>]}
[0m12:35:19.261740 [debug] [MainThread]: Flushing usage events
[0m12:35:19.848424 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:44:21.232911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c76960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092a7740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092a73e0>]}


============================== 22:44:21.236330 | 5d470c21-9b26-4f20-9473-c6173cb24845 ==============================
[0m22:44:21.236330 [info ] [MainThread]: Running with dbt=1.10.15
[0m22:44:21.236668 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'no_print': 'None', 'empty': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'log_format': 'default', 'invocation_command': 'dbt build', 'printer_width': '80', 'fail_fast': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'use_experimental_parser': 'False'}
[0m22:44:21.426448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d470c21-9b26-4f20-9473-c6173cb24845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093d1250>]}
[0m22:44:21.453641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d470c21-9b26-4f20-9473-c6173cb24845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee3530>]}
[0m22:44:21.455071 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:44:21.512352 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m22:44:21.550219 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:44:21.550490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5d470c21-9b26-4f20-9473-c6173cb24845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10931e3c0>]}
[0m22:44:22.069975 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_an_data.mart
[0m22:44:22.074355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d470c21-9b26-4f20-9473-c6173cb24845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109281910>]}
[0m22:44:22.104951 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m22:44:22.106461 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m22:44:22.129575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d470c21-9b26-4f20-9473-c6173cb24845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109280c50>]}
[0m22:44:22.129869 [info ] [MainThread]: Found 17 models, 9 sources, 469 macros
[0m22:44:22.131127 [info ] [MainThread]: 
[0m22:44:22.131299 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:44:22.131429 [info ] [MainThread]: 
[0m22:44:22.131656 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:44:22.134084 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m22:44:22.220202 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m22:44:22.220433 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m22:44:22.220575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:44:22.240726 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m22:44:22.241746 [debug] [ThreadPool]: On list_database: Close
[0m22:44:22.242090 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m22:44:22.242305 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m22:44:22.245416 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:44:22.245577 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m22:44:22.245710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:44:22.246290 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:44:22.246857 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:44:22.246988 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m22:44:22.247178 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:44:22.247297 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:44:22.247411 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m22:44:22.248126 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:44:22.248531 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m22:44:22.248657 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:44:22.248767 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m22:44:22.248940 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:44:22.249061 [debug] [ThreadPool]: On create_database_main: Close
[0m22:44:22.249908 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_main, now list_database_main)
[0m22:44:22.253051 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:44:22.253207 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m22:44:22.253324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:44:22.253539 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:44:22.253659 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:44:22.253783 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m22:44:22.261628 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m22:44:22.262468 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m22:44:22.263323 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m22:44:22.263460 [debug] [ThreadPool]: On list_database_main: Close
[0m22:44:22.264510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d470c21-9b26-4f20-9473-c6173cb24845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ef66c0>]}
[0m22:44:22.264738 [debug] [MainThread]: Using duckdb connection "master"
[0m22:44:22.264866 [debug] [MainThread]: On master: BEGIN
[0m22:44:22.264974 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:44:22.265189 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:44:22.265308 [debug] [MainThread]: On master: COMMIT
[0m22:44:22.265422 [debug] [MainThread]: Using duckdb connection "master"
[0m22:44:22.265532 [debug] [MainThread]: On master: COMMIT
[0m22:44:22.265699 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:44:22.265814 [debug] [MainThread]: On master: Close
[0m22:44:22.267216 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_acteurs
[0m22:44:22.267437 [info ] [Thread-1 (]: 1 of 17 START sql view model main.stg_acteurs .................................. [RUN]
[0m22:44:22.267622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_database_main, now model.dbt_an_data.stg_acteurs)
[0m22:44:22.267762 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_acteurs
[0m22:44:22.271012 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_acteurs"
[0m22:44:22.271616 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_acteurs
[0m22:44:22.284949 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_acteurs"
[0m22:44:22.285637 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m22:44:22.285800 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: BEGIN
[0m22:44:22.285944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:22.286286 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.286436 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m22:44:22.286582 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_acteurs"} */

  
  create view "database"."main"."stg_acteurs__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_acteurs"
  );

[0m22:44:22.286890 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.289812 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m22:44:22.289988 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_acteurs"} */
alter view "database"."main"."stg_acteurs" rename to "stg_acteurs__dbt_backup"
[0m22:44:22.290892 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:22.292192 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m22:44:22.292353 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_acteurs"} */
alter view "database"."main"."stg_acteurs__dbt_tmp" rename to "stg_acteurs"
[0m22:44:22.292628 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.298623 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: COMMIT
[0m22:44:22.298905 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m22:44:22.299069 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: COMMIT
[0m22:44:22.300051 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:22.302522 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m22:44:22.302692 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_acteurs"} */

      drop view if exists "database"."main"."stg_acteurs__dbt_backup" cascade
    
[0m22:44:22.303037 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.304125 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: Close
[0m22:44:22.305053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d470c21-9b26-4f20-9473-c6173cb24845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a850d0>]}
[0m22:44:22.305357 [info ] [Thread-1 (]: 1 of 17 OK created sql view model main.stg_acteurs ............................. [[32mOK[0m in 0.04s]
[0m22:44:22.305608 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_acteurs
[0m22:44:22.305786 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_agenda
[0m22:44:22.306030 [info ] [Thread-1 (]: 2 of 17 START sql view model main.stg_agenda ................................... [RUN]
[0m22:44:22.306259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_acteurs, now model.dbt_an_data.stg_agenda)
[0m22:44:22.306409 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_agenda
[0m22:44:22.307629 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_agenda"
[0m22:44:22.307943 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_agenda
[0m22:44:22.309279 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_agenda"
[0m22:44:22.309561 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m22:44:22.309704 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: BEGIN
[0m22:44:22.309834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:22.310087 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.310225 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m22:44:22.310363 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_agenda"} */

  
  create view "database"."main"."stg_agenda__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_agenda"
  );

[0m22:44:22.310647 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.312845 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m22:44:22.313027 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_agenda"} */
alter view "database"."main"."stg_agenda" rename to "stg_agenda__dbt_backup"
[0m22:44:22.313326 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.314581 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m22:44:22.314732 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_agenda"} */
alter view "database"."main"."stg_agenda__dbt_tmp" rename to "stg_agenda"
[0m22:44:22.314968 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.315498 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: COMMIT
[0m22:44:22.315646 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m22:44:22.315776 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: COMMIT
[0m22:44:22.316107 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.317185 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m22:44:22.317349 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_agenda"} */

      drop view if exists "database"."main"."stg_agenda__dbt_backup" cascade
    
[0m22:44:22.317674 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.318268 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: Close
[0m22:44:22.318514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d470c21-9b26-4f20-9473-c6173cb24845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fac890>]}
[0m22:44:22.318789 [info ] [Thread-1 (]: 2 of 17 OK created sql view model main.stg_agenda .............................. [[32mOK[0m in 0.01s]
[0m22:44:22.319026 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_agenda
[0m22:44:22.319191 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_amendements
[0m22:44:22.319416 [info ] [Thread-1 (]: 3 of 17 START sql view model main.stg_amendements .............................. [RUN]
[0m22:44:22.319634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_agenda, now model.dbt_an_data.stg_amendements)
[0m22:44:22.319790 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_amendements
[0m22:44:22.321175 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_amendements"
[0m22:44:22.321678 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_amendements
[0m22:44:22.323311 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_amendements"
[0m22:44:22.323622 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m22:44:22.323768 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: BEGIN
[0m22:44:22.323901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:22.324206 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.324341 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m22:44:22.324480 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_amendements"} */

  
  create view "database"."main"."stg_amendements__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_amendements"
  );

[0m22:44:22.324774 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.326111 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m22:44:22.326268 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_amendements"} */
alter view "database"."main"."stg_amendements" rename to "stg_amendements__dbt_backup"
[0m22:44:22.326533 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.327820 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m22:44:22.327981 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_amendements"} */
alter view "database"."main"."stg_amendements__dbt_tmp" rename to "stg_amendements"
[0m22:44:22.328231 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.328763 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: COMMIT
[0m22:44:22.328907 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m22:44:22.329038 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: COMMIT
[0m22:44:22.329314 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.330353 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m22:44:22.330504 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_amendements"} */

      drop view if exists "database"."main"."stg_amendements__dbt_backup" cascade
    
[0m22:44:22.330798 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.331388 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: Close
[0m22:44:22.331621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d470c21-9b26-4f20-9473-c6173cb24845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f986b0>]}
[0m22:44:22.331907 [info ] [Thread-1 (]: 3 of 17 OK created sql view model main.stg_amendements ......................... [[32mOK[0m in 0.01s]
[0m22:44:22.332146 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_amendements
[0m22:44:22.332316 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_organes
[0m22:44:22.332543 [info ] [Thread-1 (]: 4 of 17 START sql view model main.stg_organes .................................. [RUN]
[0m22:44:22.332801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_amendements, now model.dbt_an_data.stg_organes)
[0m22:44:22.332957 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_organes
[0m22:44:22.334264 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_organes"
[0m22:44:22.334623 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_organes
[0m22:44:22.335966 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_organes"
[0m22:44:22.336261 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m22:44:22.336410 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: BEGIN
[0m22:44:22.336546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:22.336821 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.336959 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m22:44:22.337104 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_organes"} */

  
  create view "database"."main"."stg_organes__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_organes"
  );

[0m22:44:22.337435 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.340181 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m22:44:22.340365 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_organes"} */
alter view "database"."main"."stg_organes" rename to "stg_organes__dbt_backup"
[0m22:44:22.340665 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.341916 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m22:44:22.342065 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_organes"} */
alter view "database"."main"."stg_organes__dbt_tmp" rename to "stg_organes"
[0m22:44:22.342288 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.342827 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: COMMIT
[0m22:44:22.342969 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m22:44:22.343099 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: COMMIT
[0m22:44:22.343390 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.344352 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m22:44:22.344495 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_organes"} */

      drop view if exists "database"."main"."stg_organes__dbt_backup" cascade
    
[0m22:44:22.344765 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.345328 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: Close
[0m22:44:22.345561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d470c21-9b26-4f20-9473-c6173cb24845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bd21e0>]}
[0m22:44:22.345827 [info ] [Thread-1 (]: 4 of 17 OK created sql view model main.stg_organes ............................. [[32mOK[0m in 0.01s]
[0m22:44:22.346055 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_organes
[0m22:44:22.346217 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_pays
[0m22:44:22.346424 [info ] [Thread-1 (]: 5 of 17 START sql view model main.stg_pays ..................................... [RUN]
[0m22:44:22.346642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_organes, now model.dbt_an_data.stg_pays)
[0m22:44:22.346791 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_pays
[0m22:44:22.348000 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_pays"
[0m22:44:22.348318 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_pays
[0m22:44:22.349659 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_pays"
[0m22:44:22.349936 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m22:44:22.350086 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: BEGIN
[0m22:44:22.350223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:22.350516 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.350648 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m22:44:22.350788 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_pays"} */

  
  create view "database"."main"."stg_pays__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_pays"
  );

[0m22:44:22.351073 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.352414 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m22:44:22.352569 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_pays"} */
alter view "database"."main"."stg_pays" rename to "stg_pays__dbt_backup"
[0m22:44:22.352834 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.354067 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m22:44:22.354222 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_pays"} */
alter view "database"."main"."stg_pays__dbt_tmp" rename to "stg_pays"
[0m22:44:22.354469 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.355013 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: COMMIT
[0m22:44:22.355153 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m22:44:22.355279 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: COMMIT
[0m22:44:22.355561 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.356492 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m22:44:22.356636 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_pays"} */

      drop view if exists "database"."main"."stg_pays__dbt_backup" cascade
    
[0m22:44:22.356909 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.357448 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: Close
[0m22:44:22.357654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d470c21-9b26-4f20-9473-c6173cb24845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bd4b00>]}
[0m22:44:22.357904 [info ] [Thread-1 (]: 5 of 17 OK created sql view model main.stg_pays ................................ [[32mOK[0m in 0.01s]
[0m22:44:22.358127 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_pays
[0m22:44:22.358287 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_reunions
[0m22:44:22.358491 [info ] [Thread-1 (]: 6 of 17 START sql view model main.stg_reunions ................................. [RUN]
[0m22:44:22.358736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_pays, now model.dbt_an_data.stg_reunions)
[0m22:44:22.358930 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_reunions
[0m22:44:22.360179 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_reunions"
[0m22:44:22.360656 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_reunions
[0m22:44:22.362028 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_reunions"
[0m22:44:22.362374 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m22:44:22.362529 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: BEGIN
[0m22:44:22.362666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:22.362934 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.363078 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m22:44:22.363222 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_reunions"} */

  
  create view "database"."main"."stg_reunions__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_reunions"
  );

[0m22:44:22.363506 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.364919 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m22:44:22.365086 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_reunions"} */
alter view "database"."main"."stg_reunions" rename to "stg_reunions__dbt_backup"
[0m22:44:22.365352 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.367510 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m22:44:22.367670 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_reunions"} */
alter view "database"."main"."stg_reunions__dbt_tmp" rename to "stg_reunions"
[0m22:44:22.367923 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.368526 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: COMMIT
[0m22:44:22.368680 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m22:44:22.368817 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: COMMIT
[0m22:44:22.369151 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.370158 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m22:44:22.370312 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_reunions"} */

      drop view if exists "database"."main"."stg_reunions__dbt_backup" cascade
    
[0m22:44:22.370608 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.371177 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: Close
[0m22:44:22.371398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d470c21-9b26-4f20-9473-c6173cb24845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fc8980>]}
[0m22:44:22.371666 [info ] [Thread-1 (]: 6 of 17 OK created sql view model main.stg_reunions ............................ [[32mOK[0m in 0.01s]
[0m22:44:22.371906 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_reunions
[0m22:44:22.372135 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_scrutins
[0m22:44:22.372374 [info ] [Thread-1 (]: 7 of 17 START sql view model main.stg_scrutins ................................. [RUN]
[0m22:44:22.372650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_reunions, now model.dbt_an_data.stg_scrutins)
[0m22:44:22.372830 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_scrutins
[0m22:44:22.374764 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_scrutins"
[0m22:44:22.375133 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_scrutins
[0m22:44:22.376503 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_scrutins"
[0m22:44:22.376791 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m22:44:22.376939 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: BEGIN
[0m22:44:22.377076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:22.377402 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.377547 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m22:44:22.377696 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins"} */

  
  create view "database"."main"."stg_scrutins__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_scrutins"
  );

[0m22:44:22.378007 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.379414 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m22:44:22.379574 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins"} */
alter view "database"."main"."stg_scrutins" rename to "stg_scrutins__dbt_backup"
[0m22:44:22.379847 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.381106 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m22:44:22.381260 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins"} */
alter view "database"."main"."stg_scrutins__dbt_tmp" rename to "stg_scrutins"
[0m22:44:22.381514 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.382051 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: COMMIT
[0m22:44:22.382200 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m22:44:22.382353 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: COMMIT
[0m22:44:22.382657 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.383643 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m22:44:22.383790 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins"} */

      drop view if exists "database"."main"."stg_scrutins__dbt_backup" cascade
    
[0m22:44:22.384086 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.384695 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: Close
[0m22:44:22.384926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d470c21-9b26-4f20-9473-c6173cb24845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bd3170>]}
[0m22:44:22.385193 [info ] [Thread-1 (]: 7 of 17 OK created sql view model main.stg_scrutins ............................ [[32mOK[0m in 0.01s]
[0m22:44:22.385428 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_scrutins
[0m22:44:22.385594 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_acteurs
[0m22:44:22.385809 [info ] [Thread-1 (]: 8 of 17 START sql incremental model main.int_acteurs ........................... [RUN]
[0m22:44:22.386046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_scrutins, now model.dbt_an_data.int_acteurs)
[0m22:44:22.386209 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_acteurs
[0m22:44:22.387587 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_acteurs"
[0m22:44:22.388067 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_acteurs
[0m22:44:22.408330 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m22:44:22.408602 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_acteurs"} */

    
  
    
    

    create temporary table
      "int_acteurs__dbt_tmp20251201224422401492"
  
    as (
      

SELECT 
json_extract_string(json, '$.acteur.uid.#text') as uid,
json_extract_string(json, '$.acteur.etatCivil.ident.civ') as civ,
json_extract_string(json, '$.acteur.etatCivil.ident.prenom') as prenom,
json_extract_string(json, '$.acteur.etatCivil.ident.nom') as nom,
json_extract_string(json, '$.acteur.etatCivil.ident.trigramme') as trigramme,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.dateNais') as dateNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.villeNais') as villeNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.depNais') as depNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.paysNais') as paysNais,
json_extract_string(json, '$.acteur.etatCivil.dateDeces') as dateDeces,
json_extract_string(json, '$.acteur.profession.libelleCourant') as libelleCourant,
json_extract_string(json, '$.acteur.profession.socProcINSEE.catSocPro') as catSocPro,
json_extract_string(json, '$.acteur.profession.socProcINSEE.famSocPro') as famSocPro,
json_extract_string(json, '$.acteur.uri_hatvp') as uri_hatvp
FROM "database"."main"."stg_acteurs"
    );
  
  
  
[0m22:44:22.408780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:22.536948 [debug] [Thread-1 (]: SQL status: OK in 0.128 seconds
[0m22:44:22.541103 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m22:44:22.541307 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m22:44:22.541600 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.541747 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m22:44:22.541896 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs__dbt_tmp20251201224422401492'
      
      
      order by ordinal_position

  
[0m22:44:22.545759 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:44:22.548468 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m22:44:22.548653 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:44:22.549849 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:22.553157 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m22:44:22.553338 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:44:22.554468 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:22.555211 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m22:44:22.555364 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_acteurs"} */
SELECT version()
[0m22:44:22.555596 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.562080 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_acteurs"
[0m22:44:22.562501 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m22:44:22.562669 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_acteurs"} */

        
            delete from "database"."main"."int_acteurs"
            where (
                uid) in (
                select (uid)
                from "int_acteurs__dbt_tmp20251201224422401492"
            );

        
    

    insert into "database"."main"."int_acteurs" ("uid", "civ", "prenom", "nom", "trigramme", "dateNais", "villeNais", "depNais", "paysNais", "dateDeces", "libelleCourant", "catSocPro", "famSocPro", "uri_hatvp")
    (
        select "uid", "civ", "prenom", "nom", "trigramme", "dateNais", "villeNais", "depNais", "paysNais", "dateDeces", "libelleCourant", "catSocPro", "famSocPro", "uri_hatvp"
        from "int_acteurs__dbt_tmp20251201224422401492"
    )
  
[0m22:44:22.567434 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:44:22.568051 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m22:44:22.568207 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m22:44:22.568353 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m22:44:22.569841 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:22.570199 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: Close
[0m22:44:22.570673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d470c21-9b26-4f20-9473-c6173cb24845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a030b00>]}
[0m22:44:22.570962 [info ] [Thread-1 (]: 8 of 17 OK created sql incremental model main.int_acteurs ...................... [[32mOK[0m in 0.18s]
[0m22:44:22.571184 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_acteurs
[0m22:44:22.571343 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_mandats
[0m22:44:22.571554 [info ] [Thread-1 (]: 9 of 17 START sql incremental model main.int_mandats ........................... [RUN]
[0m22:44:22.571730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_acteurs, now model.dbt_an_data.int_mandats)
[0m22:44:22.571872 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_mandats
[0m22:44:22.573277 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_mandats"
[0m22:44:22.573577 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_mandats
[0m22:44:22.575046 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m22:44:22.575223 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_mandats"} */

    
  
    
    

    create temporary table
      "int_mandats__dbt_tmp20251201224422574550"
  
    as (
      

SELECT 
json_extract_string(mandat.value, '$.uid') as uid,
json_extract_string(mandat.value, '$.acteurRef') as acteurRef,
json_extract_string(mandat.value, '$.legislature') as legislature,
json_extract_string(mandat.value, '$.typeOrgane') as typeOrgane,
json_extract_string(mandat.value, '$.dateDebut') as dateDebut,
json_extract_string(mandat.value, '$.dateFin') as dateFin,
json_extract_string(mandat.value, '$.preseance') as preseance,
json_extract_string(mandat.value, '$.nominPrincipale') as nominPrincipale,
json_extract_string(mandat.value, '$.infosQualite.codeQualite') as codeQualite,
json_extract_string(mandat.value, '$.organes.organeRef') as organeRef,
FROM "database"."main"."stg_acteurs" act, json_each(json->'acteur'->'mandats'->'mandat') mandat
    );
  
  
  
[0m22:44:22.575384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:22.860840 [debug] [Thread-1 (]: SQL status: OK in 0.285 seconds
[0m22:44:22.863060 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m22:44:22.863308 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m22:44:22.863653 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.863800 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m22:44:22.863948 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats__dbt_tmp20251201224422574550'
      
      
      order by ordinal_position

  
[0m22:44:22.865306 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:22.866753 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m22:44:22.866934 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:44:22.868078 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:22.869503 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m22:44:22.869673 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:44:22.870788 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:22.871808 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_mandats"
[0m22:44:22.872296 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m22:44:22.872463 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_mandats"} */

        
            delete from "database"."main"."int_mandats"
            where (
                uid) in (
                select (uid)
                from "int_mandats__dbt_tmp20251201224422574550"
            );

        
    

    insert into "database"."main"."int_mandats" ("uid", "acteurRef", "legislature", "typeOrgane", "dateDebut", "dateFin", "preseance", "nominPrincipale", "codeQualite", "organeRef")
    (
        select "uid", "acteurRef", "legislature", "typeOrgane", "dateDebut", "dateFin", "preseance", "nominPrincipale", "codeQualite", "organeRef"
        from "int_mandats__dbt_tmp20251201224422574550"
    )
  
[0m22:44:22.888899 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m22:44:22.889670 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m22:44:22.889858 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m22:44:22.890007 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m22:44:22.901491 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m22:44:22.901985 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: Close
[0m22:44:22.905530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d470c21-9b26-4f20-9473-c6173cb24845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fca330>]}
[0m22:44:22.905895 [info ] [Thread-1 (]: 9 of 17 OK created sql incremental model main.int_mandats ...................... [[32mOK[0m in 0.33s]
[0m22:44:22.906152 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_mandats
[0m22:44:22.906329 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_agenda
[0m22:44:22.906572 [info ] [Thread-1 (]: 10 of 17 START sql incremental model main.int_agenda ........................... [RUN]
[0m22:44:22.906788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_mandats, now model.dbt_an_data.int_agenda)
[0m22:44:22.906938 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_agenda
[0m22:44:22.908510 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_agenda"
[0m22:44:22.909081 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_agenda
[0m22:44:22.911562 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m22:44:22.911738 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */

    
  
    
    

    create temporary table
      "int_agenda__dbt_tmp20251201224422911003"
  
    as (
      

SELECT * 
FROM "database"."main"."stg_agenda"
    );
  
  
  
[0m22:44:22.911884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:22.913227 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:22.914560 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m22:44:22.914729 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m22:44:22.914953 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.915094 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m22:44:22.915240 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda__dbt_tmp20251201224422911003'
      
      
      order by ordinal_position

  
[0m22:44:22.916410 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:22.917708 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m22:44:22.917866 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:44:22.918965 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:22.920261 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m22:44:22.920419 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:44:22.921548 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:22.922435 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_agenda"
[0m22:44:22.922799 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m22:44:22.922965 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */

        
            delete from "database"."main"."int_agenda" as DBT_INCREMENTAL_TARGET
            using "int_agenda__dbt_tmp20251201224422911003"
            where (
                
                    "int_agenda__dbt_tmp20251201224422911003".Date = DBT_INCREMENTAL_TARGET.Date
                    and 
                
                    "int_agenda__dbt_tmp20251201224422911003".Heure = DBT_INCREMENTAL_TARGET.Heure
                    
                
                
            );
        
    

    insert into "database"."main"."int_agenda" ("Date", "Heure", "Ordre(s) du jour", "filename", "date_T_insert")
    (
        select "Date", "Heure", "Ordre(s) du jour", "filename", "date_T_insert"
        from "int_agenda__dbt_tmp20251201224422911003"
    )
  
[0m22:44:22.926012 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:44:22.926600 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m22:44:22.926750 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m22:44:22.926885 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m22:44:22.927339 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.927670 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: Close
[0m22:44:22.927920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d470c21-9b26-4f20-9473-c6173cb24845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109941970>]}
[0m22:44:22.928193 [info ] [Thread-1 (]: 10 of 17 OK created sql incremental model main.int_agenda ...................... [[32mOK[0m in 0.02s]
[0m22:44:22.928431 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_agenda
[0m22:44:22.928595 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements
[0m22:44:22.928799 [info ] [Thread-1 (]: 11 of 17 START sql incremental model main.int_amendements ...................... [RUN]
[0m22:44:22.928975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_agenda, now model.dbt_an_data.int_amendements)
[0m22:44:22.929120 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements
[0m22:44:22.930736 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements"
[0m22:44:22.931267 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements
[0m22:44:22.932911 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m22:44:22.933171 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements"} */

    
  
    
    

    create temporary table
      "int_amendements__dbt_tmp20251201224422932281"
  
    as (
      

SELECT
json_extract_string(json, '$.amendement.uid') AS uid,
json_extract_string(json, '$.amendement.chronotag') AS chronotag,
json_extract_string(json, '$.amendement.examenRef') AS examenRef,
json_extract_string(json, '$.amendement.amendementParentRef') AS amendementParentRef,
json_extract_string(json, '$.amendement.signataires.auteur.typeAuteur') AS typeAuteur,
json_extract_string(json, '$.amendement.signataires.auteur.acteurRef') AS refAuteur,
json_extract_string(json, '$.amendement.signataires.auteur.groupePolitique') AS groupePolitiqueAuteur,
json_extract_string(json, '$.amendement.cycleDeVie.dateDepot') AS dateDepot,
json_extract_string(json, '$.amendement.cycleDeVie.datePublication') AS datePublication,
json_extract_string(json, '$.amendement.cycleDeVie.soumisArticle40') AS soumisArticle40,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.code') AS codeEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.libelle') AS libelleEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.code') AS codeSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.dateSort') AS dateSort,
json_extract_string(json, '$.amendement.cycleDeVie.sort') AS sort,
split_part(replace(filename, '.json', ''), '/', -1) AS id_amendement,
split_part(replace(filename, '.json', ''), '/', -2) AS id_texte,
split_part(replace(filename, '.json', ''), '/', -3) AS id_dossier_legislatif,
id_texte[:4] AS nature_texte,
id_texte[5:6] AS source_texte,
regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 1) AS prefix_bibard,
regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 2) AS numero_bibard,
regexp_extract(id_amendement, '(SEA|PO\d*)', 1) AS code_organe,
regexp_extract(id_amendement, '(P)(\d*)(D)', 2) AS numero_partie,
regexp_extract(id_amendement, '(D)(\d*)(N)', 2) AS numero_deliberation,
regexp_extract(id_amendement, '(D)(\d*)(N)(\d*)', 4) AS numero_court
from "database"."main"."stg_amendements"
    );
  
  
  
[0m22:44:22.933386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:22.936878 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:44:22.938429 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m22:44:22.938606 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m22:44:22.938859 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.939006 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m22:44:22.939155 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements__dbt_tmp20251201224422932281'
      
      
      order by ordinal_position

  
[0m22:44:22.940332 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:22.941932 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m22:44:22.942103 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:44:22.943226 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:22.944759 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m22:44:22.944937 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:44:22.946062 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:22.947235 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements"
[0m22:44:22.947632 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m22:44:22.947826 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements"} */

        
            delete from "database"."main"."int_amendements"
            where (
                uid) in (
                select (uid)
                from "int_amendements__dbt_tmp20251201224422932281"
            );

        
    

    insert into "database"."main"."int_amendements" ("uid", "chronotag", "examenRef", "amendementParentRef", "typeAuteur", "refAuteur", "groupePolitiqueAuteur", "dateDepot", "datePublication", "soumisArticle40", "codeEtat", "libelleEtat", "codeSousEtat", "libelleSousEtat", "libelleSousEtat_1", "dateSort", "sort", "id_amendement", "id_texte", "id_dossier_legislatif", "nature_texte", "source_texte", "prefix_bibard", "numero_bibard", "code_organe", "numero_partie", "numero_deliberation", "numero_court")
    (
        select "uid", "chronotag", "examenRef", "amendementParentRef", "typeAuteur", "refAuteur", "groupePolitiqueAuteur", "dateDepot", "datePublication", "soumisArticle40", "codeEtat", "libelleEtat", "codeSousEtat", "libelleSousEtat", "libelleSousEtat_1", "dateSort", "sort", "id_amendement", "id_texte", "id_dossier_legislatif", "nature_texte", "source_texte", "prefix_bibard", "numero_bibard", "code_organe", "numero_partie", "numero_deliberation", "numero_court"
        from "int_amendements__dbt_tmp20251201224422932281"
    )
  
[0m22:44:22.948800 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:22.949459 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m22:44:22.949618 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m22:44:22.949753 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m22:44:22.949981 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.950300 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: Close
[0m22:44:22.950544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d470c21-9b26-4f20-9473-c6173cb24845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ff61e0>]}
[0m22:44:22.950817 [info ] [Thread-1 (]: 11 of 17 OK created sql incremental model main.int_amendements ................. [[32mOK[0m in 0.02s]
[0m22:44:22.951057 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements
[0m22:44:22.951223 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements_cosignataires
[0m22:44:22.951433 [info ] [Thread-1 (]: 12 of 17 START sql incremental model main.int_amendements_cosignataires ........ [RUN]
[0m22:44:22.951609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements, now model.dbt_an_data.int_amendements_cosignataires)
[0m22:44:22.951771 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements_cosignataires
[0m22:44:22.953395 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements_cosignataires"
[0m22:44:22.953758 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements_cosignataires
[0m22:44:22.956398 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m22:44:22.956607 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
  
    
    

    create temporary table
      "int_amendements_cosignataires__dbt_tmp20251201224422955781"
  
    as (
      

WITH cosignataires_arr AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef[*]') AS acteurRef
  FROM "database"."main"."stg_amendements"
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') == 'ARRAY' AND acteurRef IS NOT NULL
), cosignataires_str AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef') AS acteurRef
  FROM "database"."main"."stg_amendements"
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') <> 'ARRAY' AND acteurRef IS NOT NULL
)
SELECT 
  uid, 
  unnest(acteurRef) as acteurRef
FROM cosignataires_arr
UNION ALL
SELECT 
  uid, 
  acteurRef
FROM cosignataires_str
    );
  
  
  
[0m22:44:22.956792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:22.957807 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:22.959941 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m22:44:22.960142 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m22:44:22.960409 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.960561 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m22:44:22.960717 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires__dbt_tmp20251201224422955781'
      
      
      order by ordinal_position

  
[0m22:44:22.961949 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:22.963869 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m22:44:22.964064 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:44:22.965285 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:22.966757 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m22:44:22.966935 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:44:22.968162 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:22.969393 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements_cosignataires"
[0m22:44:22.969806 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m22:44:22.969983 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

        
            delete from "database"."main"."int_amendements_cosignataires" as DBT_INCREMENTAL_TARGET
            using "int_amendements_cosignataires__dbt_tmp20251201224422955781"
            where (
                
                    "int_amendements_cosignataires__dbt_tmp20251201224422955781".uid = DBT_INCREMENTAL_TARGET.uid
                    and 
                
                    "int_amendements_cosignataires__dbt_tmp20251201224422955781".acteurRef = DBT_INCREMENTAL_TARGET.acteurRef
                    
                
                
            );
        
    

    insert into "database"."main"."int_amendements_cosignataires" ("uid", "acteurRef")
    (
        select "uid", "acteurRef"
        from "int_amendements_cosignataires__dbt_tmp20251201224422955781"
    )
  
[0m22:44:22.970643 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.971266 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m22:44:22.971441 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m22:44:22.971581 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m22:44:22.971800 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:22.972102 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: Close
[0m22:44:22.972338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d470c21-9b26-4f20-9473-c6173cb24845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fed8b0>]}
[0m22:44:22.972617 [info ] [Thread-1 (]: 12 of 17 OK created sql incremental model main.int_amendements_cosignataires ... [[32mOK[0m in 0.02s]
[0m22:44:22.972862 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements_cosignataires
[0m22:44:22.973086 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_organes
[0m22:44:22.973334 [info ] [Thread-1 (]: 13 of 17 START sql incremental model main.int_organes .......................... [RUN]
[0m22:44:22.973585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements_cosignataires, now model.dbt_an_data.int_organes)
[0m22:44:22.973759 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_organes
[0m22:44:22.975867 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_organes"
[0m22:44:22.976351 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_organes
[0m22:44:22.977913 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m22:44:22.978107 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_organes"} */

    
  
    
    

    create temporary table
      "int_organes__dbt_tmp20251201224422977337"
  
    as (
      

SELECT 
json_extract_string(json, '$.organe.uid') as uid,
json_extract_string(json, '$.organe.codeType') as codeType,
json_extract_string(json, '$.organe.libelle') as libelle,
json_extract_string(json, '$.organe.libelleEdition') as libelleEdition,
json_extract_string(json, '$.organe.libelleAbrege') as libelleAbrege,
json_extract_string(json, '$.organe.libelleAbrev') as libelleAbrev,
json_extract_string(json, '$.organe.viMoDe.dateDebut') as dateDebut,
json_extract_string(json, '$.organe.viMoDe.dateAgrement') as dateAgrement,
json_extract_string(json, '$.organe.viMoDe.dateFin') as dateFin,
json_extract_string(json, '$.organe.organeParent') as organeParent,
json_extract_string(json, '$.organe.chambre') as chambre,
json_extract_string(json, '$.organe.regime') as regime,
json_extract_string(json, '$.organe.legislature') as legislature
FROM "database"."main"."stg_organes"
    );
  
  
  
[0m22:44:22.978282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:23.044398 [debug] [Thread-1 (]: SQL status: OK in 0.066 seconds
[0m22:44:23.046044 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m22:44:23.046221 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m22:44:23.046488 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:23.046627 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m22:44:23.046767 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes__dbt_tmp20251201224422977337'
      
      
      order by ordinal_position

  
[0m22:44:23.047947 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:23.049314 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m22:44:23.049472 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:44:23.050602 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:23.052017 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m22:44:23.052190 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:44:23.053281 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:23.054201 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_organes"
[0m22:44:23.054631 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m22:44:23.054795 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_organes"} */

        
            delete from "database"."main"."int_organes"
            where (
                uid) in (
                select (uid)
                from "int_organes__dbt_tmp20251201224422977337"
            );

        
    

    insert into "database"."main"."int_organes" ("uid", "codeType", "libelle", "libelleEdition", "libelleAbrege", "libelleAbrev", "dateDebut", "dateAgrement", "dateFin", "organeParent", "chambre", "regime", "legislature")
    (
        select "uid", "codeType", "libelle", "libelleEdition", "libelleAbrege", "libelleAbrev", "dateDebut", "dateAgrement", "dateFin", "organeParent", "chambre", "regime", "legislature"
        from "int_organes__dbt_tmp20251201224422977337"
    )
  
[0m22:44:23.061856 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m22:44:23.062522 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m22:44:23.062685 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m22:44:23.062836 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m22:44:23.069081 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m22:44:23.069464 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: Close
[0m22:44:23.069737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d470c21-9b26-4f20-9473-c6173cb24845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0affb0>]}
[0m22:44:23.070008 [info ] [Thread-1 (]: 13 of 17 OK created sql incremental model main.int_organes ..................... [[32mOK[0m in 0.10s]
[0m22:44:23.070239 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_organes
[0m22:44:23.070408 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_pays
[0m22:44:23.070581 [info ] [Thread-1 (]: 14 of 17 START sql incremental model main.int_pays ............................. [RUN]
[0m22:44:23.070814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_organes, now model.dbt_an_data.int_pays)
[0m22:44:23.070985 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_pays
[0m22:44:23.072472 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_pays"
[0m22:44:23.072807 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_pays
[0m22:44:23.075214 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m22:44:23.075391 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_pays"} */

    
  
    
    

    create temporary table
      "int_pays__dbt_tmp20251201224423074659"
  
    as (
      

SELECT
json_extract_string(json, '$.pays.uid') as uid,
json_extract_string(json, '$.pays.code_insee') as code_insee,
json_extract_string(json, '$.pays.libelleInsee') as libelleInsee,
json_extract_string(json, '$.pays.nomCourant') as nomCourant,
json_extract_string(json, '$.pays.code_iso2A') as code_iso2A,
json_extract_string(json, '$.pays.code_iso3A') as code_iso3A,
json_extract_string(json, '$.pays.code_iso3N') as code_iso3N,
json_extract_string(json, '$.pays.libelleIso') as libelleIso,
json_extract_string(json, '$.pays.libelleANCourt') as libelleANCourt,
json_extract_string(json, '$.pays.libelleANLong') as libelleANLong,
json_extract_string(json, '$.pays.sourceJuridique') as sourceJuridique,
json_extract_string(json, '$.pays.activ') as activ
FROM "database"."main"."stg_pays"
    );
  
  
  
[0m22:44:23.075551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:23.077099 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:44:23.078407 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m22:44:23.078565 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m22:44:23.078778 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:23.078921 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m22:44:23.079068 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays__dbt_tmp20251201224423074659'
      
      
      order by ordinal_position

  
[0m22:44:23.080185 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:23.081583 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m22:44:23.081746 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:44:23.082873 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:23.084268 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m22:44:23.084438 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:44:23.085565 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:23.086543 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_pays"
[0m22:44:23.086913 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m22:44:23.087078 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_pays"} */

        
            delete from "database"."main"."int_pays"
            where (
                uid) in (
                select (uid)
                from "int_pays__dbt_tmp20251201224423074659"
            );

        
    

    insert into "database"."main"."int_pays" ("uid", "code_insee", "libelleInsee", "nomCourant", "code_iso2A", "code_iso3A", "code_iso3N", "libelleIso", "libelleANCourt", "libelleANLong", "sourceJuridique", "activ")
    (
        select "uid", "code_insee", "libelleInsee", "nomCourant", "code_iso2A", "code_iso3A", "code_iso3N", "libelleIso", "libelleANCourt", "libelleANLong", "sourceJuridique", "activ"
        from "int_pays__dbt_tmp20251201224423074659"
    )
  
[0m22:44:23.089180 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:44:23.089759 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m22:44:23.089917 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m22:44:23.090051 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m22:44:23.090754 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:23.091108 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: Close
[0m22:44:23.091366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d470c21-9b26-4f20-9473-c6173cb24845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0b7170>]}
[0m22:44:23.091648 [info ] [Thread-1 (]: 14 of 17 OK created sql incremental model main.int_pays ........................ [[32mOK[0m in 0.02s]
[0m22:44:23.091887 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_pays
[0m22:44:23.092079 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_reunions
[0m22:44:23.092290 [info ] [Thread-1 (]: 15 of 17 START sql incremental model main.int_reunions ......................... [RUN]
[0m22:44:23.092469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_pays, now model.dbt_an_data.int_reunions)
[0m22:44:23.092617 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_reunions
[0m22:44:23.094167 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_reunions"
[0m22:44:23.094503 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_reunions
[0m22:44:23.096075 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m22:44:23.096280 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_reunions"} */

    
  
    
    

    create temporary table
      "int_reunions__dbt_tmp20251201224423095506"
  
    as (
      

SELECT
json_extract_string(json, '$.reunion.uid') AS uid,
json_extract_string(json, '$.reunion.timeStampDebut') AS timeStampDebut,
json_extract_string(json, '$.reunion.lieu.lieuRef') AS lieuRef,
json_extract_string(json, '$.reunion.lieu.libelleLong') AS lieuLibelle,
json_extract_string(json, '$.reunion.cycleDeVie.etat') AS cycleDeVieEtat,
json_extract_string(json, '$.reunion.demandeur') AS demandeur,
json_extract_string(json, '$.reunion.organeReuniRef') AS organeReuniRef,
json_extract_string(json, '$.reunion.visioConference') AS visioConference,
json_extract_string(json, '$.reunion.sessionRef') AS sessionRef,
json_extract_string(json, '$.reunion.ouverturePresse') AS ouverturePresse,
json_extract_string(json, '$.reunion.captationVideo') AS captationVideo,
json_extract_string(json, '$.reunion.ODJ.convocationODJ.item') AS convocationODJ,
json_extract_string(json, '$.reunion.ODJ.resumeODJ.item') AS resumeODJ,
json_extract_string(json, '$.reunion.compteRenduRef') AS compteRenduRef,
json_extract_string(json, '$.reunion.identifiants.numSeanceJO') AS numSeanceJO,
json_extract_string(json, '$.reunion.identifiants.idJO') AS idJO,
json_extract_string(json, '$.reunion.identifiants.quantieme') AS quantieme,
json_extract_string(json, '$.reunion.identifiants.DataSeance') AS DataSeance
FROM "database"."main"."stg_reunions"
    );
  
  
  
[0m22:44:23.096466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:23.403337 [debug] [Thread-1 (]: SQL status: OK in 0.307 seconds
[0m22:44:23.406898 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m22:44:23.407098 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m22:44:23.407415 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:23.407564 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m22:44:23.407703 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions__dbt_tmp20251201224423095506'
      
      
      order by ordinal_position

  
[0m22:44:23.409228 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:23.410731 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m22:44:23.410903 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:44:23.412051 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:23.413498 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m22:44:23.413659 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:44:23.414777 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:23.416039 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_reunions"
[0m22:44:23.416514 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m22:44:23.416683 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_reunions"} */

        
            delete from "database"."main"."int_reunions"
            where (
                uid) in (
                select (uid)
                from "int_reunions__dbt_tmp20251201224423095506"
            );

        
    

    insert into "database"."main"."int_reunions" ("uid", "timeStampDebut", "lieuRef", "lieuLibelle", "cycleDeVieEtat", "demandeur", "organeReuniRef", "visioConference", "sessionRef", "ouverturePresse", "captationVideo", "convocationODJ", "resumeODJ", "compteRenduRef", "numSeanceJO", "idJO", "quantieme", "DataSeance")
    (
        select "uid", "timeStampDebut", "lieuRef", "lieuLibelle", "cycleDeVieEtat", "demandeur", "organeReuniRef", "visioConference", "sessionRef", "ouverturePresse", "captationVideo", "convocationODJ", "resumeODJ", "compteRenduRef", "numSeanceJO", "idJO", "quantieme", "DataSeance"
        from "int_reunions__dbt_tmp20251201224423095506"
    )
  
[0m22:44:23.422659 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m22:44:23.423481 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m22:44:23.423663 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m22:44:23.423803 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m22:44:23.431083 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m22:44:23.431784 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: Close
[0m22:44:23.432375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d470c21-9b26-4f20-9473-c6173cb24845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fa5dc0>]}
[0m22:44:23.432773 [info ] [Thread-1 (]: 15 of 17 OK created sql incremental model main.int_reunions .................... [[32mOK[0m in 0.34s]
[0m22:44:23.433068 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_reunions
[0m22:44:23.433302 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins
[0m22:44:23.433650 [info ] [Thread-1 (]: 16 of 17 START sql incremental model main.int_scrutins ......................... [RUN]
[0m22:44:23.433841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_reunions, now model.dbt_an_data.int_scrutins)
[0m22:44:23.434001 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins
[0m22:44:23.435825 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins"
[0m22:44:23.436381 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins
[0m22:44:23.439224 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m22:44:23.439408 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

    
  
    
    

    create temporary table
      "int_scrutins__dbt_tmp20251201224423438649"
  
    as (
      

SELECT
filename,
json_extract_string(json, '$.scrutin.uid') AS uid,
json_extract_string(json, '$.scrutin.numero') AS numero,
json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
json_extract_string(json, '$.scrutin.legislature') AS legislature,
json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
json_extract_string(json, '$.scrutin.titre') AS titre,
json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote
FROM "database"."main"."stg_scrutins"
    );
  
  
  
[0m22:44:23.439575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:24.510250 [debug] [Thread-1 (]: SQL status: OK in 1.071 seconds
[0m22:44:24.512543 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m22:44:24.512730 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m22:44:24.513016 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:24.513163 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m22:44:24.513310 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins__dbt_tmp20251201224423438649'
      
      
      order by ordinal_position

  
[0m22:44:24.514529 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:24.515919 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m22:44:24.516082 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:44:24.517214 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:24.518656 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m22:44:24.518831 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:44:24.520013 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:24.521012 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins"
[0m22:44:24.521405 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m22:44:24.521574 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

        
            delete from "database"."main"."int_scrutins"
            where (
                uid) in (
                select (uid)
                from "int_scrutins__dbt_tmp20251201224423438649"
            );

        
    

    insert into "database"."main"."int_scrutins" ("filename", "uid", "numero", "organeRef", "legislature", "date_scrutin", "titre", "resultat_code", "resultat_libelle", "nb_votants", "suffrages_exprimes", "seuil", "lieu_vote")
    (
        select "filename", "uid", "numero", "organeRef", "legislature", "date_scrutin", "titre", "resultat_code", "resultat_libelle", "nb_votants", "suffrages_exprimes", "seuil", "lieu_vote"
        from "int_scrutins__dbt_tmp20251201224423438649"
    )
  
[0m22:44:24.526284 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:44:24.526934 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m22:44:24.527097 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m22:44:24.527230 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m22:44:24.531054 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:44:24.531455 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: Close
[0m22:44:24.531785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d470c21-9b26-4f20-9473-c6173cb24845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f708c0>]}
[0m22:44:24.532084 [info ] [Thread-1 (]: 16 of 17 OK created sql incremental model main.int_scrutins .................... [[32mOK[0m in 1.10s]
[0m22:44:24.532321 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins
[0m22:44:24.532505 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins_votes
[0m22:44:24.532684 [info ] [Thread-1 (]: 17 of 17 START sql incremental model main.int_scrutins_votes ................... [RUN]
[0m22:44:24.532862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_scrutins, now model.dbt_an_data.int_scrutins_votes)
[0m22:44:24.533010 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins_votes
[0m22:44:24.534985 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins_votes"
[0m22:44:24.535647 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins_votes
[0m22:44:24.537228 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m22:44:24.537528 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
  
    
    

    create temporary table
      "int_scrutins_votes__dbt_tmp20251201224424536660"
  
    as (
      

WITH grp AS (
      -- explode les groupes (1 par groupe)
      SELECT
          json_extract_string(j.json, '$.scrutin.uid') AS uid,
          json_extract_string(g.value, '$.organeRef') AS groupe_organe,
          g.value AS groupe_json
      FROM "database"."main"."stg_scrutins" j,
           json_each(json->'scrutin'->'ventilationVotes'->'organe'->'groupes'->'groupe') g
  ),

  positions_array AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          p.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'pours'->'votant') p
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          c.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'contres'->'votant') c
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          a.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'abstentions'->'votant') a
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          n.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'nonVotants'->'votant') n
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[ARRAY]'
  ),
  positions_object AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[OBJECT]'
  ),

  clean AS (
      -- sécurise les champs (souvent string ou null)
      SELECT
          uid,
          groupe_organe,
          type_vote,
          json_extract_string(vote_json, '$.acteurRef') AS acteurRef,
          json_extract_string(vote_json, '$.mandatRef') AS mandatRef,
          json_extract_string(vote_json, '$.parDelegation') AS parDelegation,
          json_extract_string(vote_json, '$.numPlace') AS numPlace,
          json_extract_string(vote_json, '$.causePositionVote') AS cause
      FROM positions_array
      UNION ALL
      SELECT * 
      FROM positions_object
  )

  SELECT * FROM clean
    );
  
  
  
[0m22:44:24.537818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:33.794452 [debug] [Thread-1 (]: SQL status: OK in 9.256 seconds
[0m22:44:33.799695 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m22:44:33.799894 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m22:44:33.800281 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:44:33.800444 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m22:44:33.800601 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins_votes__dbt_tmp20251201224424536660'
      
      
      order by ordinal_position

  
[0m22:44:33.802028 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:33.803493 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m22:44:33.803657 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins_votes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:44:33.804756 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:33.806128 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m22:44:33.806291 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins_votes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:44:33.807404 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:44:33.808645 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins_votes"
[0m22:44:33.809377 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m22:44:33.809555 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

        
            delete from "database"."main"."int_scrutins_votes" as DBT_INCREMENTAL_TARGET
            using "int_scrutins_votes__dbt_tmp20251201224424536660"
            where (
                
                    "int_scrutins_votes__dbt_tmp20251201224424536660".uid = DBT_INCREMENTAL_TARGET.uid
                    and 
                
                    "int_scrutins_votes__dbt_tmp20251201224424536660".acteurRef = DBT_INCREMENTAL_TARGET.acteurRef
                    
                
                
            );
        
    

    insert into "database"."main"."int_scrutins_votes" ("uid", "groupe_organe", "type_vote", "acteurRef", "mandatRef", "parDelegation", "numPlace", "cause")
    (
        select "uid", "groupe_organe", "type_vote", "acteurRef", "mandatRef", "parDelegation", "numPlace", "cause"
        from "int_scrutins_votes__dbt_tmp20251201224424536660"
    )
  
[0m22:44:33.977324 [debug] [Thread-1 (]: SQL status: OK in 0.168 seconds
[0m22:44:33.978210 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m22:44:33.978400 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m22:44:33.978644 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m22:44:34.084992 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m22:44:34.085831 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: Close
[0m22:44:34.095977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d470c21-9b26-4f20-9473-c6173cb24845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ec1a30>]}
[0m22:44:34.096537 [info ] [Thread-1 (]: 17 of 17 OK created sql incremental model main.int_scrutins_votes .............. [[32mOK[0m in 9.56s]
[0m22:44:34.096853 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins_votes
[0m22:44:34.100155 [debug] [MainThread]: Using duckdb connection "master"
[0m22:44:34.100340 [debug] [MainThread]: On master: BEGIN
[0m22:44:34.100485 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:44:34.100818 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:44:34.100950 [debug] [MainThread]: On master: COMMIT
[0m22:44:34.101070 [debug] [MainThread]: Using duckdb connection "master"
[0m22:44:34.101186 [debug] [MainThread]: On master: COMMIT
[0m22:44:34.101352 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:44:34.101473 [debug] [MainThread]: On master: Close
[0m22:44:34.101631 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:44:34.101743 [debug] [MainThread]: Connection 'model.dbt_an_data.int_scrutins_votes' was properly closed.
[0m22:44:34.102227 [info ] [MainThread]: 
[0m22:44:34.102382 [info ] [MainThread]: Finished running 10 incremental models, 7 view models in 0 hours 0 minutes and 11.97 seconds (11.97s).
[0m22:44:34.103446 [debug] [MainThread]: Command end result
[0m22:44:34.116447 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m22:44:34.118520 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m22:44:34.122793 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m22:44:34.122988 [info ] [MainThread]: 
[0m22:44:34.123175 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:44:34.123320 [info ] [MainThread]: 
[0m22:44:34.125642 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=17
[0m22:44:34.126659 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 12.935228, "process_in_blocks": "0", "process_kernel_time": 5.923421, "process_mem_max_rss": "2895757312", "process_out_blocks": "0", "process_user_time": 13.807784}
[0m22:44:34.126986 [debug] [MainThread]: Command `dbt build` succeeded at 22:44:34.126937 after 12.94 seconds
[0m22:44:34.127250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092a7230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092a73e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092a75f0>]}
[0m22:44:34.127426 [debug] [MainThread]: Flushing usage events
[0m22:44:34.772578 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:48:14.669317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b93f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d67650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d67320>]}


============================== 22:48:14.672658 | c5014f7f-760c-4afc-a93e-5e115ab189a8 ==============================
[0m22:48:14.672658 [info ] [MainThread]: Running with dbt=1.10.15
[0m22:48:14.672955 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'warn_error': 'None', 'log_format': 'default', 'log_cache_events': 'False', 'no_print': 'None', 'quiet': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'invocation_command': 'dbt build', 'write_json': 'True', 'introspect': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'printer_width': '80', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'target_path': 'None', 'debug': 'False', 'send_anonymous_usage_stats': 'True'}
[0m22:48:14.851670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5014f7f-760c-4afc-a93e-5e115ab189a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ddef30>]}
[0m22:48:14.878657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5014f7f-760c-4afc-a93e-5e115ab189a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040e88f0>]}
[0m22:48:14.880014 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:48:14.936505 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m22:48:14.999810 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:48:15.000140 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_scrutins.sql
[0m22:48:15.111143 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_an_data.mart
[0m22:48:15.117211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5014f7f-760c-4afc-a93e-5e115ab189a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054e0cb0>]}
[0m22:48:15.149839 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m22:48:15.151468 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m22:48:15.172149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5014f7f-760c-4afc-a93e-5e115ab189a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055d7620>]}
[0m22:48:15.172430 [info ] [MainThread]: Found 17 models, 9 sources, 469 macros
[0m22:48:15.173757 [info ] [MainThread]: 
[0m22:48:15.173943 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:48:15.174073 [info ] [MainThread]: 
[0m22:48:15.174305 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:48:15.176706 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m22:48:15.259912 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m22:48:15.260145 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m22:48:15.260280 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:48:15.277411 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m22:48:15.278143 [debug] [ThreadPool]: On list_database: Close
[0m22:48:15.278476 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m22:48:15.278705 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m22:48:15.281753 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:48:15.281921 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m22:48:15.282053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:48:15.282689 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:48:15.283251 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:48:15.283378 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m22:48:15.283571 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:48:15.283689 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:48:15.283804 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m22:48:15.284365 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:48:15.284716 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m22:48:15.284840 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:48:15.284947 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m22:48:15.285108 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:48:15.285227 [debug] [ThreadPool]: On create_database_main: Close
[0m22:48:15.286051 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_main, now list_database_main)
[0m22:48:15.288457 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:48:15.288603 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m22:48:15.288720 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:48:15.288933 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:48:15.289056 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:48:15.289182 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m22:48:15.296885 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m22:48:15.297666 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m22:48:15.298512 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m22:48:15.298652 [debug] [ThreadPool]: On list_database_main: Close
[0m22:48:15.299689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5014f7f-760c-4afc-a93e-5e115ab189a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053621b0>]}
[0m22:48:15.299927 [debug] [MainThread]: Using duckdb connection "master"
[0m22:48:15.300061 [debug] [MainThread]: On master: BEGIN
[0m22:48:15.300173 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:48:15.300391 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:48:15.300516 [debug] [MainThread]: On master: COMMIT
[0m22:48:15.300633 [debug] [MainThread]: Using duckdb connection "master"
[0m22:48:15.300745 [debug] [MainThread]: On master: COMMIT
[0m22:48:15.300916 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:48:15.301032 [debug] [MainThread]: On master: Close
[0m22:48:15.302368 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_acteurs
[0m22:48:15.302595 [info ] [Thread-1 (]: 1 of 17 START sql view model main.stg_acteurs .................................. [RUN]
[0m22:48:15.302781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_database_main, now model.dbt_an_data.stg_acteurs)
[0m22:48:15.302921 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_acteurs
[0m22:48:15.306142 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_acteurs"
[0m22:48:15.306720 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_acteurs
[0m22:48:15.353388 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_acteurs"
[0m22:48:15.353911 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m22:48:15.354076 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: BEGIN
[0m22:48:15.354218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:15.354559 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.354697 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m22:48:15.354833 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_acteurs"} */

  
  create view "database"."main"."stg_acteurs__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_acteurs"
  );

[0m22:48:15.355131 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.357956 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m22:48:15.358127 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_acteurs"} */
alter view "database"."main"."stg_acteurs" rename to "stg_acteurs__dbt_backup"
[0m22:48:15.359044 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:15.360344 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m22:48:15.360495 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_acteurs"} */
alter view "database"."main"."stg_acteurs__dbt_tmp" rename to "stg_acteurs"
[0m22:48:15.360728 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.365961 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: COMMIT
[0m22:48:15.366146 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m22:48:15.366295 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: COMMIT
[0m22:48:15.367276 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:15.369801 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m22:48:15.369979 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_acteurs"} */

      drop view if exists "database"."main"."stg_acteurs__dbt_backup" cascade
    
[0m22:48:15.370488 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.371584 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: Close
[0m22:48:15.372556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5014f7f-760c-4afc-a93e-5e115ab189a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10402ce30>]}
[0m22:48:15.372862 [info ] [Thread-1 (]: 1 of 17 OK created sql view model main.stg_acteurs ............................. [[32mOK[0m in 0.07s]
[0m22:48:15.373119 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_acteurs
[0m22:48:15.373302 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_agenda
[0m22:48:15.373548 [info ] [Thread-1 (]: 2 of 17 START sql view model main.stg_agenda ................................... [RUN]
[0m22:48:15.373789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_acteurs, now model.dbt_an_data.stg_agenda)
[0m22:48:15.373971 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_agenda
[0m22:48:15.375198 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_agenda"
[0m22:48:15.375497 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_agenda
[0m22:48:15.376867 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_agenda"
[0m22:48:15.377139 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m22:48:15.377283 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: BEGIN
[0m22:48:15.377415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:15.377669 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.377808 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m22:48:15.377945 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_agenda"} */

  
  create view "database"."main"."stg_agenda__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_agenda"
  );

[0m22:48:15.378227 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.379499 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m22:48:15.379648 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_agenda"} */
alter view "database"."main"."stg_agenda" rename to "stg_agenda__dbt_backup"
[0m22:48:15.379882 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.381099 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m22:48:15.381251 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_agenda"} */
alter view "database"."main"."stg_agenda__dbt_tmp" rename to "stg_agenda"
[0m22:48:15.381487 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.382031 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: COMMIT
[0m22:48:15.382177 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m22:48:15.382306 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: COMMIT
[0m22:48:15.382657 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.383731 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m22:48:15.383895 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_agenda"} */

      drop view if exists "database"."main"."stg_agenda__dbt_backup" cascade
    
[0m22:48:15.384209 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.384800 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: Close
[0m22:48:15.385034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5014f7f-760c-4afc-a93e-5e115ab189a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105927140>]}
[0m22:48:15.385316 [info ] [Thread-1 (]: 2 of 17 OK created sql view model main.stg_agenda .............................. [[32mOK[0m in 0.01s]
[0m22:48:15.385554 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_agenda
[0m22:48:15.385727 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_amendements
[0m22:48:15.385951 [info ] [Thread-1 (]: 3 of 17 START sql view model main.stg_amendements .............................. [RUN]
[0m22:48:15.386224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_agenda, now model.dbt_an_data.stg_amendements)
[0m22:48:15.386422 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_amendements
[0m22:48:15.387710 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_amendements"
[0m22:48:15.388051 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_amendements
[0m22:48:15.390375 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_amendements"
[0m22:48:15.390690 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m22:48:15.390847 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: BEGIN
[0m22:48:15.390989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:15.391276 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.391420 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m22:48:15.391564 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_amendements"} */

  
  create view "database"."main"."stg_amendements__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_amendements"
  );

[0m22:48:15.391850 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.393274 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m22:48:15.393436 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_amendements"} */
alter view "database"."main"."stg_amendements" rename to "stg_amendements__dbt_backup"
[0m22:48:15.393701 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.395010 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m22:48:15.395198 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_amendements"} */
alter view "database"."main"."stg_amendements__dbt_tmp" rename to "stg_amendements"
[0m22:48:15.395658 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.396411 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: COMMIT
[0m22:48:15.396569 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m22:48:15.396699 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: COMMIT
[0m22:48:15.397061 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.398113 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m22:48:15.398268 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_amendements"} */

      drop view if exists "database"."main"."stg_amendements__dbt_backup" cascade
    
[0m22:48:15.398573 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.399163 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: Close
[0m22:48:15.399398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5014f7f-760c-4afc-a93e-5e115ab189a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10531cd40>]}
[0m22:48:15.399664 [info ] [Thread-1 (]: 3 of 17 OK created sql view model main.stg_amendements ......................... [[32mOK[0m in 0.01s]
[0m22:48:15.399887 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_amendements
[0m22:48:15.400058 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_organes
[0m22:48:15.400271 [info ] [Thread-1 (]: 4 of 17 START sql view model main.stg_organes .................................. [RUN]
[0m22:48:15.400483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_amendements, now model.dbt_an_data.stg_organes)
[0m22:48:15.400627 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_organes
[0m22:48:15.401885 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_organes"
[0m22:48:15.402212 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_organes
[0m22:48:15.403522 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_organes"
[0m22:48:15.403801 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m22:48:15.403949 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: BEGIN
[0m22:48:15.404080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:15.404332 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.404469 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m22:48:15.404608 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_organes"} */

  
  create view "database"."main"."stg_organes__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_organes"
  );

[0m22:48:15.404889 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.406164 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m22:48:15.406306 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_organes"} */
alter view "database"."main"."stg_organes" rename to "stg_organes__dbt_backup"
[0m22:48:15.406538 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.407735 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m22:48:15.407881 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_organes"} */
alter view "database"."main"."stg_organes__dbt_tmp" rename to "stg_organes"
[0m22:48:15.408105 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.408625 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: COMMIT
[0m22:48:15.408762 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m22:48:15.408884 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: COMMIT
[0m22:48:15.409137 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.410115 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m22:48:15.410264 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_organes"} */

      drop view if exists "database"."main"."stg_organes__dbt_backup" cascade
    
[0m22:48:15.410526 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.411054 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: Close
[0m22:48:15.411246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5014f7f-760c-4afc-a93e-5e115ab189a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f0abd0>]}
[0m22:48:15.411494 [info ] [Thread-1 (]: 4 of 17 OK created sql view model main.stg_organes ............................. [[32mOK[0m in 0.01s]
[0m22:48:15.411721 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_organes
[0m22:48:15.411881 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_pays
[0m22:48:15.412088 [info ] [Thread-1 (]: 5 of 17 START sql view model main.stg_pays ..................................... [RUN]
[0m22:48:15.412287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_organes, now model.dbt_an_data.stg_pays)
[0m22:48:15.412435 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_pays
[0m22:48:15.413678 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_pays"
[0m22:48:15.414004 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_pays
[0m22:48:15.416486 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_pays"
[0m22:48:15.416805 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m22:48:15.416957 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: BEGIN
[0m22:48:15.417094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:15.417386 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.417523 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m22:48:15.417665 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_pays"} */

  
  create view "database"."main"."stg_pays__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_pays"
  );

[0m22:48:15.417979 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.419340 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m22:48:15.419500 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_pays"} */
alter view "database"."main"."stg_pays" rename to "stg_pays__dbt_backup"
[0m22:48:15.419777 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.421012 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m22:48:15.421164 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_pays"} */
alter view "database"."main"."stg_pays__dbt_tmp" rename to "stg_pays"
[0m22:48:15.421402 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.421925 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: COMMIT
[0m22:48:15.422068 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m22:48:15.422199 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: COMMIT
[0m22:48:15.422484 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.423457 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m22:48:15.423608 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_pays"} */

      drop view if exists "database"."main"."stg_pays__dbt_backup" cascade
    
[0m22:48:15.423888 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.424452 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: Close
[0m22:48:15.424676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5014f7f-760c-4afc-a93e-5e115ab189a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a33890>]}
[0m22:48:15.424946 [info ] [Thread-1 (]: 5 of 17 OK created sql view model main.stg_pays ................................ [[32mOK[0m in 0.01s]
[0m22:48:15.425174 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_pays
[0m22:48:15.425343 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_reunions
[0m22:48:15.425558 [info ] [Thread-1 (]: 6 of 17 START sql view model main.stg_reunions ................................. [RUN]
[0m22:48:15.425795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_pays, now model.dbt_an_data.stg_reunions)
[0m22:48:15.425948 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_reunions
[0m22:48:15.427676 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_reunions"
[0m22:48:15.428313 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_reunions
[0m22:48:15.429912 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_reunions"
[0m22:48:15.430248 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m22:48:15.430400 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: BEGIN
[0m22:48:15.430539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:15.430857 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.430997 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m22:48:15.431139 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_reunions"} */

  
  create view "database"."main"."stg_reunions__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_reunions"
  );

[0m22:48:15.431436 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.432790 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m22:48:15.432939 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_reunions"} */
alter view "database"."main"."stg_reunions" rename to "stg_reunions__dbt_backup"
[0m22:48:15.433189 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.434408 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m22:48:15.434552 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_reunions"} */
alter view "database"."main"."stg_reunions__dbt_tmp" rename to "stg_reunions"
[0m22:48:15.434779 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.435314 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: COMMIT
[0m22:48:15.435455 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m22:48:15.435582 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: COMMIT
[0m22:48:15.435889 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.436918 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m22:48:15.437072 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_reunions"} */

      drop view if exists "database"."main"."stg_reunions__dbt_backup" cascade
    
[0m22:48:15.437413 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.437984 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: Close
[0m22:48:15.438209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5014f7f-760c-4afc-a93e-5e115ab189a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105927680>]}
[0m22:48:15.438476 [info ] [Thread-1 (]: 6 of 17 OK created sql view model main.stg_reunions ............................ [[32mOK[0m in 0.01s]
[0m22:48:15.438712 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_reunions
[0m22:48:15.438880 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_scrutins
[0m22:48:15.439098 [info ] [Thread-1 (]: 7 of 17 START sql view model main.stg_scrutins ................................. [RUN]
[0m22:48:15.439310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_reunions, now model.dbt_an_data.stg_scrutins)
[0m22:48:15.439458 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_scrutins
[0m22:48:15.440726 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_scrutins"
[0m22:48:15.441049 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_scrutins
[0m22:48:15.442608 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_scrutins"
[0m22:48:15.443236 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m22:48:15.443393 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: BEGIN
[0m22:48:15.443535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:15.443870 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.444012 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m22:48:15.444158 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins"} */

  
  create view "database"."main"."stg_scrutins__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_scrutins"
  );

[0m22:48:15.444530 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.448101 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m22:48:15.448286 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins"} */
alter view "database"."main"."stg_scrutins" rename to "stg_scrutins__dbt_backup"
[0m22:48:15.448606 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.449843 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m22:48:15.449995 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins"} */
alter view "database"."main"."stg_scrutins__dbt_tmp" rename to "stg_scrutins"
[0m22:48:15.450230 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.450779 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: COMMIT
[0m22:48:15.450923 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m22:48:15.451051 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: COMMIT
[0m22:48:15.451381 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.452390 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m22:48:15.452536 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins"} */

      drop view if exists "database"."main"."stg_scrutins__dbt_backup" cascade
    
[0m22:48:15.452842 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.453409 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: Close
[0m22:48:15.453645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5014f7f-760c-4afc-a93e-5e115ab189a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a423c0>]}
[0m22:48:15.453916 [info ] [Thread-1 (]: 7 of 17 OK created sql view model main.stg_scrutins ............................ [[32mOK[0m in 0.01s]
[0m22:48:15.454149 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_scrutins
[0m22:48:15.454315 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_acteurs
[0m22:48:15.454532 [info ] [Thread-1 (]: 8 of 17 START sql incremental model main.int_acteurs ........................... [RUN]
[0m22:48:15.454744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_scrutins, now model.dbt_an_data.int_acteurs)
[0m22:48:15.454891 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_acteurs
[0m22:48:15.456312 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_acteurs"
[0m22:48:15.456618 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_acteurs
[0m22:48:15.475755 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m22:48:15.476037 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_acteurs"} */

    
  
    
    

    create temporary table
      "int_acteurs__dbt_tmp20251201224815470046"
  
    as (
      

SELECT 
json_extract_string(json, '$.acteur.uid.#text') as uid,
json_extract_string(json, '$.acteur.etatCivil.ident.civ') as civ,
json_extract_string(json, '$.acteur.etatCivil.ident.prenom') as prenom,
json_extract_string(json, '$.acteur.etatCivil.ident.nom') as nom,
json_extract_string(json, '$.acteur.etatCivil.ident.trigramme') as trigramme,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.dateNais') as dateNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.villeNais') as villeNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.depNais') as depNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.paysNais') as paysNais,
json_extract_string(json, '$.acteur.etatCivil.dateDeces') as dateDeces,
json_extract_string(json, '$.acteur.profession.libelleCourant') as libelleCourant,
json_extract_string(json, '$.acteur.profession.socProcINSEE.catSocPro') as catSocPro,
json_extract_string(json, '$.acteur.profession.socProcINSEE.famSocPro') as famSocPro,
json_extract_string(json, '$.acteur.uri_hatvp') as uri_hatvp
FROM "database"."main"."stg_acteurs"
    );
  
  
  
[0m22:48:15.476241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:15.603279 [debug] [Thread-1 (]: SQL status: OK in 0.127 seconds
[0m22:48:15.606902 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m22:48:15.607081 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m22:48:15.607358 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.607498 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m22:48:15.607636 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs__dbt_tmp20251201224815470046'
      
      
      order by ordinal_position

  
[0m22:48:15.611276 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:48:15.615438 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m22:48:15.615648 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:48:15.616991 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:15.621061 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m22:48:15.621276 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:48:15.622526 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:15.623300 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m22:48:15.623460 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_acteurs"} */
SELECT version()
[0m22:48:15.623709 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.631020 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_acteurs"
[0m22:48:15.631590 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m22:48:15.631788 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_acteurs"} */

        
            delete from "database"."main"."int_acteurs"
            where (
                uid) in (
                select (uid)
                from "int_acteurs__dbt_tmp20251201224815470046"
            );

        
    

    insert into "database"."main"."int_acteurs" ("uid", "civ", "prenom", "nom", "trigramme", "dateNais", "villeNais", "depNais", "paysNais", "dateDeces", "libelleCourant", "catSocPro", "famSocPro", "uri_hatvp")
    (
        select "uid", "civ", "prenom", "nom", "trigramme", "dateNais", "villeNais", "depNais", "paysNais", "dateDeces", "libelleCourant", "catSocPro", "famSocPro", "uri_hatvp"
        from "int_acteurs__dbt_tmp20251201224815470046"
    )
  
[0m22:48:15.636339 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:48:15.637158 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m22:48:15.637359 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m22:48:15.637514 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m22:48:15.638987 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:15.639394 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: Close
[0m22:48:15.639700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5014f7f-760c-4afc-a93e-5e115ab189a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105924740>]}
[0m22:48:15.640005 [info ] [Thread-1 (]: 8 of 17 OK created sql incremental model main.int_acteurs ...................... [[32mOK[0m in 0.18s]
[0m22:48:15.640250 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_acteurs
[0m22:48:15.640424 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_mandats
[0m22:48:15.640644 [info ] [Thread-1 (]: 9 of 17 START sql incremental model main.int_mandats ........................... [RUN]
[0m22:48:15.640831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_acteurs, now model.dbt_an_data.int_mandats)
[0m22:48:15.640980 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_mandats
[0m22:48:15.643561 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_mandats"
[0m22:48:15.644044 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_mandats
[0m22:48:15.645907 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m22:48:15.646133 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_mandats"} */

    
  
    
    

    create temporary table
      "int_mandats__dbt_tmp20251201224815645344"
  
    as (
      

SELECT 
json_extract_string(mandat.value, '$.uid') as uid,
json_extract_string(mandat.value, '$.acteurRef') as acteurRef,
json_extract_string(mandat.value, '$.legislature') as legislature,
json_extract_string(mandat.value, '$.typeOrgane') as typeOrgane,
json_extract_string(mandat.value, '$.dateDebut') as dateDebut,
json_extract_string(mandat.value, '$.dateFin') as dateFin,
json_extract_string(mandat.value, '$.preseance') as preseance,
json_extract_string(mandat.value, '$.nominPrincipale') as nominPrincipale,
json_extract_string(mandat.value, '$.infosQualite.codeQualite') as codeQualite,
json_extract_string(mandat.value, '$.organes.organeRef') as organeRef,
FROM "database"."main"."stg_acteurs" act, json_each(json->'acteur'->'mandats'->'mandat') mandat
    );
  
  
  
[0m22:48:15.646320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:15.875305 [debug] [Thread-1 (]: SQL status: OK in 0.229 seconds
[0m22:48:15.876947 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m22:48:15.877184 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m22:48:15.877460 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.877607 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m22:48:15.877754 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats__dbt_tmp20251201224815645344'
      
      
      order by ordinal_position

  
[0m22:48:15.878960 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:15.880374 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m22:48:15.880561 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:48:15.881674 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:15.883070 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m22:48:15.883234 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:48:15.884303 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:15.885203 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_mandats"
[0m22:48:15.885652 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m22:48:15.885823 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_mandats"} */

        
            delete from "database"."main"."int_mandats"
            where (
                uid) in (
                select (uid)
                from "int_mandats__dbt_tmp20251201224815645344"
            );

        
    

    insert into "database"."main"."int_mandats" ("uid", "acteurRef", "legislature", "typeOrgane", "dateDebut", "dateFin", "preseance", "nominPrincipale", "codeQualite", "organeRef")
    (
        select "uid", "acteurRef", "legislature", "typeOrgane", "dateDebut", "dateFin", "preseance", "nominPrincipale", "codeQualite", "organeRef"
        from "int_mandats__dbt_tmp20251201224815645344"
    )
  
[0m22:48:15.899256 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m22:48:15.899929 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m22:48:15.900094 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m22:48:15.900228 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m22:48:15.910707 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m22:48:15.911084 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: Close
[0m22:48:15.914657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5014f7f-760c-4afc-a93e-5e115ab189a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105043d70>]}
[0m22:48:15.914948 [info ] [Thread-1 (]: 9 of 17 OK created sql incremental model main.int_mandats ...................... [[32mOK[0m in 0.27s]
[0m22:48:15.915181 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_mandats
[0m22:48:15.915343 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_agenda
[0m22:48:15.915520 [info ] [Thread-1 (]: 10 of 17 START sql incremental model main.int_agenda ........................... [RUN]
[0m22:48:15.915697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_mandats, now model.dbt_an_data.int_agenda)
[0m22:48:15.915839 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_agenda
[0m22:48:15.917295 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_agenda"
[0m22:48:15.917973 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_agenda
[0m22:48:15.919535 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m22:48:15.919714 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */

    
  
    
    

    create temporary table
      "int_agenda__dbt_tmp20251201224815918980"
  
    as (
      

SELECT * 
FROM "database"."main"."stg_agenda"
    );
  
  
  
[0m22:48:15.919862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:15.921257 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:15.922544 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m22:48:15.922698 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m22:48:15.922916 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.923065 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m22:48:15.923213 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda__dbt_tmp20251201224815918980'
      
      
      order by ordinal_position

  
[0m22:48:15.924309 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:15.925788 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m22:48:15.925945 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:48:15.927046 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:15.928382 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m22:48:15.928545 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:48:15.929624 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:15.930483 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_agenda"
[0m22:48:15.930810 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m22:48:15.930968 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */

        
            delete from "database"."main"."int_agenda" as DBT_INCREMENTAL_TARGET
            using "int_agenda__dbt_tmp20251201224815918980"
            where (
                
                    "int_agenda__dbt_tmp20251201224815918980".Date = DBT_INCREMENTAL_TARGET.Date
                    and 
                
                    "int_agenda__dbt_tmp20251201224815918980".Heure = DBT_INCREMENTAL_TARGET.Heure
                    
                
                
            );
        
    

    insert into "database"."main"."int_agenda" ("Date", "Heure", "Ordre(s) du jour", "filename", "date_T_insert")
    (
        select "Date", "Heure", "Ordre(s) du jour", "filename", "date_T_insert"
        from "int_agenda__dbt_tmp20251201224815918980"
    )
  
[0m22:48:15.932444 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:15.933033 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m22:48:15.933200 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m22:48:15.933340 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m22:48:15.934096 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:15.934421 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: Close
[0m22:48:15.934660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5014f7f-760c-4afc-a93e-5e115ab189a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053351c0>]}
[0m22:48:15.934930 [info ] [Thread-1 (]: 10 of 17 OK created sql incremental model main.int_agenda ...................... [[32mOK[0m in 0.02s]
[0m22:48:15.935169 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_agenda
[0m22:48:15.935370 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements
[0m22:48:15.935660 [info ] [Thread-1 (]: 11 of 17 START sql incremental model main.int_amendements ...................... [RUN]
[0m22:48:15.935871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_agenda, now model.dbt_an_data.int_amendements)
[0m22:48:15.936032 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements
[0m22:48:15.938621 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements"
[0m22:48:15.938954 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements
[0m22:48:15.940522 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m22:48:15.940745 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements"} */

    
  
    
    

    create temporary table
      "int_amendements__dbt_tmp20251201224815939950"
  
    as (
      

SELECT
json_extract_string(json, '$.amendement.uid') AS uid,
json_extract_string(json, '$.amendement.chronotag') AS chronotag,
json_extract_string(json, '$.amendement.examenRef') AS examenRef,
json_extract_string(json, '$.amendement.amendementParentRef') AS amendementParentRef,
json_extract_string(json, '$.amendement.signataires.auteur.typeAuteur') AS typeAuteur,
json_extract_string(json, '$.amendement.signataires.auteur.acteurRef') AS refAuteur,
json_extract_string(json, '$.amendement.signataires.auteur.groupePolitique') AS groupePolitiqueAuteur,
json_extract_string(json, '$.amendement.cycleDeVie.dateDepot') AS dateDepot,
json_extract_string(json, '$.amendement.cycleDeVie.datePublication') AS datePublication,
json_extract_string(json, '$.amendement.cycleDeVie.soumisArticle40') AS soumisArticle40,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.code') AS codeEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.libelle') AS libelleEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.code') AS codeSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.dateSort') AS dateSort,
json_extract_string(json, '$.amendement.cycleDeVie.sort') AS sort,
split_part(replace(filename, '.json', ''), '/', -1) AS id_amendement,
split_part(replace(filename, '.json', ''), '/', -2) AS id_texte,
split_part(replace(filename, '.json', ''), '/', -3) AS id_dossier_legislatif,
id_texte[:4] AS nature_texte,
id_texte[5:6] AS source_texte,
regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 1) AS prefix_bibard,
regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 2) AS numero_bibard,
regexp_extract(id_amendement, '(SEA|PO\d*)', 1) AS code_organe,
regexp_extract(id_amendement, '(P)(\d*)(D)', 2) AS numero_partie,
regexp_extract(id_amendement, '(D)(\d*)(N)', 2) AS numero_deliberation,
regexp_extract(id_amendement, '(D)(\d*)(N)(\d*)', 4) AS numero_court
from "database"."main"."stg_amendements"
    );
  
  
  
[0m22:48:15.940945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:15.944718 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:48:15.946829 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m22:48:15.947021 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m22:48:15.947297 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.947443 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m22:48:15.947589 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements__dbt_tmp20251201224815939950'
      
      
      order by ordinal_position

  
[0m22:48:15.948848 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:15.950484 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m22:48:15.950654 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:48:15.951862 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:15.953543 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m22:48:15.953742 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:48:15.954979 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:15.956187 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements"
[0m22:48:15.956569 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m22:48:15.956754 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements"} */

        
            delete from "database"."main"."int_amendements"
            where (
                uid) in (
                select (uid)
                from "int_amendements__dbt_tmp20251201224815939950"
            );

        
    

    insert into "database"."main"."int_amendements" ("uid", "chronotag", "examenRef", "amendementParentRef", "typeAuteur", "refAuteur", "groupePolitiqueAuteur", "dateDepot", "datePublication", "soumisArticle40", "codeEtat", "libelleEtat", "codeSousEtat", "libelleSousEtat", "libelleSousEtat_1", "dateSort", "sort", "id_amendement", "id_texte", "id_dossier_legislatif", "nature_texte", "source_texte", "prefix_bibard", "numero_bibard", "code_organe", "numero_partie", "numero_deliberation", "numero_court")
    (
        select "uid", "chronotag", "examenRef", "amendementParentRef", "typeAuteur", "refAuteur", "groupePolitiqueAuteur", "dateDepot", "datePublication", "soumisArticle40", "codeEtat", "libelleEtat", "codeSousEtat", "libelleSousEtat", "libelleSousEtat_1", "dateSort", "sort", "id_amendement", "id_texte", "id_dossier_legislatif", "nature_texte", "source_texte", "prefix_bibard", "numero_bibard", "code_organe", "numero_partie", "numero_deliberation", "numero_court"
        from "int_amendements__dbt_tmp20251201224815939950"
    )
  
[0m22:48:15.957575 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:15.958283 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m22:48:15.958474 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m22:48:15.958628 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m22:48:15.958924 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.959388 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: Close
[0m22:48:15.959743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5014f7f-760c-4afc-a93e-5e115ab189a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105338c50>]}
[0m22:48:15.960122 [info ] [Thread-1 (]: 11 of 17 OK created sql incremental model main.int_amendements ................. [[32mOK[0m in 0.02s]
[0m22:48:15.960386 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements
[0m22:48:15.960577 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements_cosignataires
[0m22:48:15.960826 [info ] [Thread-1 (]: 12 of 17 START sql incremental model main.int_amendements_cosignataires ........ [RUN]
[0m22:48:15.961017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements, now model.dbt_an_data.int_amendements_cosignataires)
[0m22:48:15.961170 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements_cosignataires
[0m22:48:15.962811 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements_cosignataires"
[0m22:48:15.963290 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements_cosignataires
[0m22:48:15.964855 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m22:48:15.965046 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
  
    
    

    create temporary table
      "int_amendements_cosignataires__dbt_tmp20251201224815964333"
  
    as (
      

WITH cosignataires_arr AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef[*]') AS acteurRef
  FROM "database"."main"."stg_amendements"
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') == 'ARRAY' AND acteurRef IS NOT NULL
), cosignataires_str AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef') AS acteurRef
  FROM "database"."main"."stg_amendements"
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') <> 'ARRAY' AND acteurRef IS NOT NULL
)
SELECT 
  uid, 
  unnest(acteurRef) as acteurRef
FROM cosignataires_arr
UNION ALL
SELECT 
  uid, 
  acteurRef
FROM cosignataires_str
    );
  
  
  
[0m22:48:15.965213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:15.966045 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:15.967328 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m22:48:15.967487 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m22:48:15.967703 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.967849 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m22:48:15.968003 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires__dbt_tmp20251201224815964333'
      
      
      order by ordinal_position

  
[0m22:48:15.969092 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:15.970455 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m22:48:15.970650 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:48:15.971823 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:15.973129 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m22:48:15.973301 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:48:15.974409 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:15.976264 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements_cosignataires"
[0m22:48:15.976643 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m22:48:15.976821 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

        
            delete from "database"."main"."int_amendements_cosignataires" as DBT_INCREMENTAL_TARGET
            using "int_amendements_cosignataires__dbt_tmp20251201224815964333"
            where (
                
                    "int_amendements_cosignataires__dbt_tmp20251201224815964333".uid = DBT_INCREMENTAL_TARGET.uid
                    and 
                
                    "int_amendements_cosignataires__dbt_tmp20251201224815964333".acteurRef = DBT_INCREMENTAL_TARGET.acteurRef
                    
                
                
            );
        
    

    insert into "database"."main"."int_amendements_cosignataires" ("uid", "acteurRef")
    (
        select "uid", "acteurRef"
        from "int_amendements_cosignataires__dbt_tmp20251201224815964333"
    )
  
[0m22:48:15.977496 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.978070 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m22:48:15.978230 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m22:48:15.978367 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m22:48:15.978587 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:15.978909 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: Close
[0m22:48:15.979149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5014f7f-760c-4afc-a93e-5e115ab189a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a770e0>]}
[0m22:48:15.979423 [info ] [Thread-1 (]: 12 of 17 OK created sql incremental model main.int_amendements_cosignataires ... [[32mOK[0m in 0.02s]
[0m22:48:15.979668 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements_cosignataires
[0m22:48:15.979837 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_organes
[0m22:48:15.980067 [info ] [Thread-1 (]: 13 of 17 START sql incremental model main.int_organes .......................... [RUN]
[0m22:48:15.980291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements_cosignataires, now model.dbt_an_data.int_organes)
[0m22:48:15.980450 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_organes
[0m22:48:15.981890 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_organes"
[0m22:48:15.982378 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_organes
[0m22:48:15.983873 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m22:48:15.984061 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_organes"} */

    
  
    
    

    create temporary table
      "int_organes__dbt_tmp20251201224815983364"
  
    as (
      

SELECT 
json_extract_string(json, '$.organe.uid') as uid,
json_extract_string(json, '$.organe.codeType') as codeType,
json_extract_string(json, '$.organe.libelle') as libelle,
json_extract_string(json, '$.organe.libelleEdition') as libelleEdition,
json_extract_string(json, '$.organe.libelleAbrege') as libelleAbrege,
json_extract_string(json, '$.organe.libelleAbrev') as libelleAbrev,
json_extract_string(json, '$.organe.viMoDe.dateDebut') as dateDebut,
json_extract_string(json, '$.organe.viMoDe.dateAgrement') as dateAgrement,
json_extract_string(json, '$.organe.viMoDe.dateFin') as dateFin,
json_extract_string(json, '$.organe.organeParent') as organeParent,
json_extract_string(json, '$.organe.chambre') as chambre,
json_extract_string(json, '$.organe.regime') as regime,
json_extract_string(json, '$.organe.legislature') as legislature
FROM "database"."main"."stg_organes"
    );
  
  
  
[0m22:48:15.984234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:16.054381 [debug] [Thread-1 (]: SQL status: OK in 0.070 seconds
[0m22:48:16.055923 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m22:48:16.056095 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m22:48:16.056357 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:16.056495 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m22:48:16.056638 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes__dbt_tmp20251201224815983364'
      
      
      order by ordinal_position

  
[0m22:48:16.057904 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:16.059446 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m22:48:16.059629 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:48:16.060819 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:16.062325 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m22:48:16.062500 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:48:16.063671 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:16.064743 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_organes"
[0m22:48:16.065501 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m22:48:16.065690 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_organes"} */

        
            delete from "database"."main"."int_organes"
            where (
                uid) in (
                select (uid)
                from "int_organes__dbt_tmp20251201224815983364"
            );

        
    

    insert into "database"."main"."int_organes" ("uid", "codeType", "libelle", "libelleEdition", "libelleAbrege", "libelleAbrev", "dateDebut", "dateAgrement", "dateFin", "organeParent", "chambre", "regime", "legislature")
    (
        select "uid", "codeType", "libelle", "libelleEdition", "libelleAbrege", "libelleAbrev", "dateDebut", "dateAgrement", "dateFin", "organeParent", "chambre", "regime", "legislature"
        from "int_organes__dbt_tmp20251201224815983364"
    )
  
[0m22:48:16.073757 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m22:48:16.074535 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m22:48:16.074702 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m22:48:16.074837 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m22:48:16.081029 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m22:48:16.081419 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: Close
[0m22:48:16.081720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5014f7f-760c-4afc-a93e-5e115ab189a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a77e00>]}
[0m22:48:16.081996 [info ] [Thread-1 (]: 13 of 17 OK created sql incremental model main.int_organes ..................... [[32mOK[0m in 0.10s]
[0m22:48:16.082237 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_organes
[0m22:48:16.082407 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_pays
[0m22:48:16.082625 [info ] [Thread-1 (]: 14 of 17 START sql incremental model main.int_pays ............................. [RUN]
[0m22:48:16.082809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_organes, now model.dbt_an_data.int_pays)
[0m22:48:16.082957 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_pays
[0m22:48:16.084405 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_pays"
[0m22:48:16.084704 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_pays
[0m22:48:16.086172 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m22:48:16.086348 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_pays"} */

    
  
    
    

    create temporary table
      "int_pays__dbt_tmp20251201224816085676"
  
    as (
      

SELECT
json_extract_string(json, '$.pays.uid') as uid,
json_extract_string(json, '$.pays.code_insee') as code_insee,
json_extract_string(json, '$.pays.libelleInsee') as libelleInsee,
json_extract_string(json, '$.pays.nomCourant') as nomCourant,
json_extract_string(json, '$.pays.code_iso2A') as code_iso2A,
json_extract_string(json, '$.pays.code_iso3A') as code_iso3A,
json_extract_string(json, '$.pays.code_iso3N') as code_iso3N,
json_extract_string(json, '$.pays.libelleIso') as libelleIso,
json_extract_string(json, '$.pays.libelleANCourt') as libelleANCourt,
json_extract_string(json, '$.pays.libelleANLong') as libelleANLong,
json_extract_string(json, '$.pays.sourceJuridique') as sourceJuridique,
json_extract_string(json, '$.pays.activ') as activ
FROM "database"."main"."stg_pays"
    );
  
  
  
[0m22:48:16.086503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:16.088478 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:48:16.089829 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m22:48:16.089992 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m22:48:16.090224 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:16.090367 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m22:48:16.090521 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays__dbt_tmp20251201224816085676'
      
      
      order by ordinal_position

  
[0m22:48:16.091673 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:16.093245 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m22:48:16.093401 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:48:16.094504 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:16.095860 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m22:48:16.096014 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:48:16.097115 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:16.099002 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_pays"
[0m22:48:16.099344 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m22:48:16.099513 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_pays"} */

        
            delete from "database"."main"."int_pays"
            where (
                uid) in (
                select (uid)
                from "int_pays__dbt_tmp20251201224816085676"
            );

        
    

    insert into "database"."main"."int_pays" ("uid", "code_insee", "libelleInsee", "nomCourant", "code_iso2A", "code_iso3A", "code_iso3N", "libelleIso", "libelleANCourt", "libelleANLong", "sourceJuridique", "activ")
    (
        select "uid", "code_insee", "libelleInsee", "nomCourant", "code_iso2A", "code_iso3A", "code_iso3N", "libelleIso", "libelleANCourt", "libelleANLong", "sourceJuridique", "activ"
        from "int_pays__dbt_tmp20251201224816085676"
    )
  
[0m22:48:16.101280 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:48:16.101919 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m22:48:16.102133 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m22:48:16.102311 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m22:48:16.103103 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:16.103450 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: Close
[0m22:48:16.103718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5014f7f-760c-4afc-a93e-5e115ab189a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a84980>]}
[0m22:48:16.103999 [info ] [Thread-1 (]: 14 of 17 OK created sql incremental model main.int_pays ........................ [[32mOK[0m in 0.02s]
[0m22:48:16.104242 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_pays
[0m22:48:16.104410 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_reunions
[0m22:48:16.104622 [info ] [Thread-1 (]: 15 of 17 START sql incremental model main.int_reunions ......................... [RUN]
[0m22:48:16.104798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_pays, now model.dbt_an_data.int_reunions)
[0m22:48:16.104943 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_reunions
[0m22:48:16.106469 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_reunions"
[0m22:48:16.106786 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_reunions
[0m22:48:16.108296 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m22:48:16.108497 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_reunions"} */

    
  
    
    

    create temporary table
      "int_reunions__dbt_tmp20251201224816107770"
  
    as (
      

SELECT
json_extract_string(json, '$.reunion.uid') AS uid,
json_extract_string(json, '$.reunion.timeStampDebut') AS timeStampDebut,
json_extract_string(json, '$.reunion.lieu.lieuRef') AS lieuRef,
json_extract_string(json, '$.reunion.lieu.libelleLong') AS lieuLibelle,
json_extract_string(json, '$.reunion.cycleDeVie.etat') AS cycleDeVieEtat,
json_extract_string(json, '$.reunion.demandeur') AS demandeur,
json_extract_string(json, '$.reunion.organeReuniRef') AS organeReuniRef,
json_extract_string(json, '$.reunion.visioConference') AS visioConference,
json_extract_string(json, '$.reunion.sessionRef') AS sessionRef,
json_extract_string(json, '$.reunion.ouverturePresse') AS ouverturePresse,
json_extract_string(json, '$.reunion.captationVideo') AS captationVideo,
json_extract_string(json, '$.reunion.ODJ.convocationODJ.item') AS convocationODJ,
json_extract_string(json, '$.reunion.ODJ.resumeODJ.item') AS resumeODJ,
json_extract_string(json, '$.reunion.compteRenduRef') AS compteRenduRef,
json_extract_string(json, '$.reunion.identifiants.numSeanceJO') AS numSeanceJO,
json_extract_string(json, '$.reunion.identifiants.idJO') AS idJO,
json_extract_string(json, '$.reunion.identifiants.quantieme') AS quantieme,
json_extract_string(json, '$.reunion.identifiants.DataSeance') AS DataSeance
FROM "database"."main"."stg_reunions"
    );
  
  
  
[0m22:48:16.108677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:16.365097 [debug] [Thread-1 (]: SQL status: OK in 0.256 seconds
[0m22:48:16.366641 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m22:48:16.366808 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m22:48:16.367066 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:16.367206 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m22:48:16.367344 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions__dbt_tmp20251201224816107770'
      
      
      order by ordinal_position

  
[0m22:48:16.368497 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:16.369947 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m22:48:16.370111 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:48:16.371187 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:16.372578 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m22:48:16.372736 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:48:16.373798 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:16.374779 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_reunions"
[0m22:48:16.375172 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m22:48:16.375333 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_reunions"} */

        
            delete from "database"."main"."int_reunions"
            where (
                uid) in (
                select (uid)
                from "int_reunions__dbt_tmp20251201224816107770"
            );

        
    

    insert into "database"."main"."int_reunions" ("uid", "timeStampDebut", "lieuRef", "lieuLibelle", "cycleDeVieEtat", "demandeur", "organeReuniRef", "visioConference", "sessionRef", "ouverturePresse", "captationVideo", "convocationODJ", "resumeODJ", "compteRenduRef", "numSeanceJO", "idJO", "quantieme", "DataSeance")
    (
        select "uid", "timeStampDebut", "lieuRef", "lieuLibelle", "cycleDeVieEtat", "demandeur", "organeReuniRef", "visioConference", "sessionRef", "ouverturePresse", "captationVideo", "convocationODJ", "resumeODJ", "compteRenduRef", "numSeanceJO", "idJO", "quantieme", "DataSeance"
        from "int_reunions__dbt_tmp20251201224816107770"
    )
  
[0m22:48:16.380917 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:48:16.381611 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m22:48:16.381777 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m22:48:16.381914 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m22:48:16.387518 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:48:16.387933 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: Close
[0m22:48:16.388371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5014f7f-760c-4afc-a93e-5e115ab189a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e6a6c0>]}
[0m22:48:16.388645 [info ] [Thread-1 (]: 15 of 17 OK created sql incremental model main.int_reunions .................... [[32mOK[0m in 0.28s]
[0m22:48:16.388876 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_reunions
[0m22:48:16.389039 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins
[0m22:48:16.389246 [info ] [Thread-1 (]: 16 of 17 START sql incremental model main.int_scrutins ......................... [RUN]
[0m22:48:16.389421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_reunions, now model.dbt_an_data.int_scrutins)
[0m22:48:16.389559 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins
[0m22:48:16.391005 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins"
[0m22:48:16.391314 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins
[0m22:48:16.392813 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m22:48:16.392985 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

    
  
    
    

    create temporary table
      "int_scrutins__dbt_tmp20251201224816392267"
  
    as (
      

SELECT
date_T_insert,
json_extract_string(json, '$.scrutin.uid') AS uid,
json_extract_string(json, '$.scrutin.numero') AS numero,
json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
json_extract_string(json, '$.scrutin.legislature') AS legislature,
json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
json_extract_string(json, '$.scrutin.titre') AS titre,
json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote
FROM "database"."main"."stg_scrutins"
    );
  
  
  
[0m22:48:16.393144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:17.504119 [debug] [Thread-1 (]: SQL status: OK in 1.105 seconds
[0m22:48:17.514669 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m22:48:17.514877 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m22:48:17.515291 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:17.515441 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m22:48:17.515592 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins__dbt_tmp20251201224816392267'
      
      
      order by ordinal_position

  
[0m22:48:17.517208 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:17.518705 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m22:48:17.518874 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:48:17.520151 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:17.523018 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m22:48:17.523191 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:48:17.524351 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:17.525653 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins"
[0m22:48:17.526232 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m22:48:17.526405 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

        
            delete from "database"."main"."int_scrutins"
            where (
                uid) in (
                select (uid)
                from "int_scrutins__dbt_tmp20251201224816392267"
            );

        
    

    insert into "database"."main"."int_scrutins" ("filename", "uid", "numero", "organeRef", "legislature", "date_scrutin", "titre", "resultat_code", "resultat_libelle", "nb_votants", "suffrages_exprimes", "seuil", "lieu_vote")
    (
        select "filename", "uid", "numero", "organeRef", "legislature", "date_scrutin", "titre", "resultat_code", "resultat_libelle", "nb_votants", "suffrages_exprimes", "seuil", "lieu_vote"
        from "int_scrutins__dbt_tmp20251201224816392267"
    )
  
[0m22:48:17.529706 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

        
            delete from "database"."main"."int_scrutins"
            where (
                uid) in (
                select (uid)
                from "int_scrutins__dbt_tmp20251201224816392267"
            );

        
    

    insert into "database"."main"."int_scrutins" ("filename", "uid", "numero", "organeRef", "legislature", "date_scrutin", "titre", "resultat_code", "resultat_libelle", "nb_votants", "suffrages_exprimes", "seuil", "lieu_vote")
    (
        select "filename", "uid", "numero", "organeRef", "legislature", "date_scrutin", "titre", "resultat_code", "resultat_libelle", "nb_votants", "suffrages_exprimes", "seuil", "lieu_vote"
        from "int_scrutins__dbt_tmp20251201224816392267"
    )
  
[0m22:48:17.529935 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:48:17.530289 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: ROLLBACK
[0m22:48:17.538451 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_an_data.int_scrutins'
[0m22:48:17.538643 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: Close
[0m22:48:17.540393 [debug] [Thread-1 (]: Runtime Error in model int_scrutins (models/int/int_scrutins.sql)
  Binder Error: Referenced column "filename" not found in FROM clause!
  Candidate bindings: "legislature", "organeRef", "lieu_vote", "titre", "seuil"
[0m22:48:17.542178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5014f7f-760c-4afc-a93e-5e115ab189a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a9e540>]}
[0m22:48:17.542720 [error] [Thread-1 (]: 16 of 17 ERROR creating sql incremental model main.int_scrutins ................ [[31mERROR[0m in 1.15s]
[0m22:48:17.543026 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins
[0m22:48:17.543444 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins_votes
[0m22:48:17.543705 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.int_scrutins' to be skipped because of status 'error'.  Reason: Runtime Error in model int_scrutins (models/int/int_scrutins.sql)
  Binder Error: Referenced column "filename" not found in FROM clause!
  Candidate bindings: "legislature", "organeRef", "lieu_vote", "titre", "seuil".
[0m22:48:17.543921 [info ] [Thread-1 (]: 17 of 17 START sql incremental model main.int_scrutins_votes ................... [RUN]
[0m22:48:17.544689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_scrutins, now model.dbt_an_data.int_scrutins_votes)
[0m22:48:17.544871 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins_votes
[0m22:48:17.547405 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins_votes"
[0m22:48:17.547931 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins_votes
[0m22:48:17.549991 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m22:48:17.550313 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
  
    
    

    create temporary table
      "int_scrutins_votes__dbt_tmp20251201224817549352"
  
    as (
      

WITH grp AS (
      -- explode les groupes (1 par groupe)
      SELECT
          json_extract_string(j.json, '$.scrutin.uid') AS uid,
          json_extract_string(g.value, '$.organeRef') AS groupe_organe,
          g.value AS groupe_json
      FROM "database"."main"."stg_scrutins" j,
           json_each(json->'scrutin'->'ventilationVotes'->'organe'->'groupes'->'groupe') g
  ),

  positions_array AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          p.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'pours'->'votant') p
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          c.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'contres'->'votant') c
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          a.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'abstentions'->'votant') a
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          n.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'nonVotants'->'votant') n
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[ARRAY]'
  ),
  positions_object AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[OBJECT]'
  ),

  clean AS (
      -- sécurise les champs (souvent string ou null)
      SELECT
          uid,
          groupe_organe,
          type_vote,
          json_extract_string(vote_json, '$.acteurRef') AS acteurRef,
          json_extract_string(vote_json, '$.mandatRef') AS mandatRef,
          json_extract_string(vote_json, '$.parDelegation') AS parDelegation,
          json_extract_string(vote_json, '$.numPlace') AS numPlace,
          json_extract_string(vote_json, '$.causePositionVote') AS cause
      FROM positions_array
      UNION ALL
      SELECT * 
      FROM positions_object
  )

  SELECT * FROM clean
    );
  
  
  
[0m22:48:17.550630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:26.393538 [debug] [Thread-1 (]: SQL status: OK in 8.843 seconds
[0m22:48:26.400793 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m22:48:26.401004 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m22:48:26.401353 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:48:26.401506 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m22:48:26.401659 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins_votes__dbt_tmp20251201224817549352'
      
      
      order by ordinal_position

  
[0m22:48:26.402974 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:26.404421 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m22:48:26.404587 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins_votes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:48:26.405686 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:26.407086 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m22:48:26.407248 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins_votes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'database'
      
      order by ordinal_position

  
[0m22:48:26.408334 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:48:26.409528 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins_votes"
[0m22:48:26.410060 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m22:48:26.410227 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

        
            delete from "database"."main"."int_scrutins_votes" as DBT_INCREMENTAL_TARGET
            using "int_scrutins_votes__dbt_tmp20251201224817549352"
            where (
                
                    "int_scrutins_votes__dbt_tmp20251201224817549352".uid = DBT_INCREMENTAL_TARGET.uid
                    and 
                
                    "int_scrutins_votes__dbt_tmp20251201224817549352".acteurRef = DBT_INCREMENTAL_TARGET.acteurRef
                    
                
                
            );
        
    

    insert into "database"."main"."int_scrutins_votes" ("uid", "groupe_organe", "type_vote", "acteurRef", "mandatRef", "parDelegation", "numPlace", "cause")
    (
        select "uid", "groupe_organe", "type_vote", "acteurRef", "mandatRef", "parDelegation", "numPlace", "cause"
        from "int_scrutins_votes__dbt_tmp20251201224817549352"
    )
  
[0m22:48:26.587864 [debug] [Thread-1 (]: SQL status: OK in 0.177 seconds
[0m22:48:26.588762 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m22:48:26.588955 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m22:48:26.589098 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m22:48:26.682856 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m22:48:26.683677 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: Close
[0m22:48:26.698405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5014f7f-760c-4afc-a93e-5e115ab189a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a08560>]}
[0m22:48:26.699001 [info ] [Thread-1 (]: 17 of 17 OK created sql incremental model main.int_scrutins_votes .............. [[32mOK[0m in 9.15s]
[0m22:48:26.699330 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins_votes
[0m22:48:26.700709 [debug] [MainThread]: Using duckdb connection "master"
[0m22:48:26.700847 [debug] [MainThread]: On master: BEGIN
[0m22:48:26.700967 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:48:26.701286 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:48:26.701406 [debug] [MainThread]: On master: COMMIT
[0m22:48:26.701517 [debug] [MainThread]: Using duckdb connection "master"
[0m22:48:26.701623 [debug] [MainThread]: On master: COMMIT
[0m22:48:26.701787 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:48:26.701900 [debug] [MainThread]: On master: Close
[0m22:48:26.702050 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:48:26.702156 [debug] [MainThread]: Connection 'model.dbt_an_data.int_scrutins_votes' was properly closed.
[0m22:48:26.702377 [info ] [MainThread]: 
[0m22:48:26.702793 [info ] [MainThread]: Finished running 10 incremental models, 7 view models in 0 hours 0 minutes and 11.53 seconds (11.53s).
[0m22:48:26.703954 [debug] [MainThread]: Command end result
[0m22:48:26.716251 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m22:48:26.718225 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m22:48:26.722361 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m22:48:26.722537 [info ] [MainThread]: 
[0m22:48:26.722733 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:48:26.722880 [info ] [MainThread]: 
[0m22:48:26.723062 [error] [MainThread]: [31mFailure in model int_scrutins (models/int/int_scrutins.sql)[0m
[0m22:48:26.723222 [error] [MainThread]:   Runtime Error in model int_scrutins (models/int/int_scrutins.sql)
  Binder Error: Referenced column "filename" not found in FROM clause!
  Candidate bindings: "legislature", "organeRef", "lieu_vote", "titre", "seuil"
[0m22:48:26.723342 [info ] [MainThread]: 
[0m22:48:26.723481 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/int/int_scrutins.sql
[0m22:48:26.723604 [info ] [MainThread]: 
[0m22:48:26.723751 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=17
[0m22:48:26.724236 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 12.096145, "process_in_blocks": "0", "process_kernel_time": 5.267687, "process_mem_max_rss": "2832220160", "process_out_blocks": "0", "process_user_time": 15.191434}
[0m22:48:26.724488 [debug] [MainThread]: Command `dbt build` failed at 22:48:26.724452 after 12.10 seconds
[0m22:48:26.724742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d67320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a0ae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042ce0c0>]}
[0m22:48:26.724897 [debug] [MainThread]: Flushing usage events
[0m22:48:27.327306 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:49:40.519040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b78c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a47f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070cb5c0>]}


============================== 22:49:40.521826 | c7788aac-d8b3-44d0-980c-7c9510ed9535 ==============================
[0m22:49:40.521826 [info ] [MainThread]: Running with dbt=1.10.15
[0m22:49:40.522130 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'write_json': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'introspect': 'True', 'quiet': 'False', 'target_path': 'None', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt build --full-refresh', 'empty': 'False', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'debug': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'static_parser': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'printer_width': '80'}
[0m22:49:40.620634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7788aac-d8b3-44d0-980c-7c9510ed9535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10726e630>]}
[0m22:49:40.647589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7788aac-d8b3-44d0-980c-7c9510ed9535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b6e3f0>]}
[0m22:49:40.649137 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:49:40.705275 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m22:49:40.763991 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:49:40.764215 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:49:40.767261 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_an_data.mart
[0m22:49:40.779950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7788aac-d8b3-44d0-980c-7c9510ed9535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107141790>]}
[0m22:49:40.812980 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m22:49:40.814139 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m22:49:40.834297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7788aac-d8b3-44d0-980c-7c9510ed9535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a7ad0>]}
[0m22:49:40.834575 [info ] [MainThread]: Found 17 models, 9 sources, 469 macros
[0m22:49:40.835941 [info ] [MainThread]: 
[0m22:49:40.836114 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:49:40.836238 [info ] [MainThread]: 
[0m22:49:40.836471 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:49:40.838914 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database'
[0m22:49:40.870474 [debug] [ThreadPool]: Using duckdb connection "list_database"
[0m22:49:40.870734 [debug] [ThreadPool]: On list_database: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database"'
    
  
  
[0m22:49:40.870877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:40.879473 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m22:49:40.880320 [debug] [ThreadPool]: On list_database: Close
[0m22:49:40.880668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database, now create_database_main)
[0m22:49:40.880907 [debug] [ThreadPool]: Creating schema "database: "database"
schema: "main"
"
[0m22:49:40.884025 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:49:40.884190 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "create_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database'
        and type='sqlite'
    
  
[0m22:49:40.884318 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:49:40.884672 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:49:40.885266 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:49:40.885389 [debug] [ThreadPool]: On create_database_main: BEGIN
[0m22:49:40.885568 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:49:40.885683 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:49:40.885797 [debug] [ThreadPool]: On create_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "create_database_main"} */

    
    
        create schema if not exists "database"."main"
    
[0m22:49:40.886001 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:49:40.886365 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m22:49:40.886488 [debug] [ThreadPool]: Using duckdb connection "create_database_main"
[0m22:49:40.886596 [debug] [ThreadPool]: On create_database_main: COMMIT
[0m22:49:40.886762 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:49:40.886882 [debug] [ThreadPool]: On create_database_main: Close
[0m22:49:40.887745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_main, now list_database_main)
[0m22:49:40.890250 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:49:40.890419 [debug] [ThreadPool]: On list_database_main: BEGIN
[0m22:49:40.890543 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:49:40.890788 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:49:40.890904 [debug] [ThreadPool]: Using duckdb connection "list_database_main"
[0m22:49:40.891020 [debug] [ThreadPool]: On list_database_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "connection_name": "list_database_main"} */
select
      'database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database'
  
[0m22:49:40.895833 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m22:49:40.896590 [debug] [ThreadPool]: On list_database_main: ROLLBACK
[0m22:49:40.897624 [debug] [ThreadPool]: Failed to rollback 'list_database_main'
[0m22:49:40.897763 [debug] [ThreadPool]: On list_database_main: Close
[0m22:49:40.898807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7788aac-d8b3-44d0-980c-7c9510ed9535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a7bc0>]}
[0m22:49:40.899042 [debug] [MainThread]: Using duckdb connection "master"
[0m22:49:40.899175 [debug] [MainThread]: On master: BEGIN
[0m22:49:40.899286 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:49:40.899508 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:49:40.899634 [debug] [MainThread]: On master: COMMIT
[0m22:49:40.899753 [debug] [MainThread]: Using duckdb connection "master"
[0m22:49:40.899867 [debug] [MainThread]: On master: COMMIT
[0m22:49:40.900039 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:49:40.900163 [debug] [MainThread]: On master: Close
[0m22:49:40.901398 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_acteurs
[0m22:49:40.901623 [info ] [Thread-1 (]: 1 of 17 START sql view model main.stg_acteurs .................................. [RUN]
[0m22:49:40.901806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_database_main, now model.dbt_an_data.stg_acteurs)
[0m22:49:40.901951 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_acteurs
[0m22:49:40.905960 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_acteurs"
[0m22:49:40.906329 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_acteurs
[0m22:49:40.919592 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_acteurs"
[0m22:49:40.919977 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m22:49:40.920137 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: BEGIN
[0m22:49:40.920274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:40.920576 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:40.920713 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m22:49:40.920850 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_acteurs"} */

  
  create view "database"."main"."stg_acteurs__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_acteurs"
  );

[0m22:49:40.921149 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:40.924195 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m22:49:40.924484 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_acteurs"} */
alter view "database"."main"."stg_acteurs" rename to "stg_acteurs__dbt_backup"
[0m22:49:40.924970 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:40.926363 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m22:49:40.926515 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_acteurs"} */
alter view "database"."main"."stg_acteurs__dbt_tmp" rename to "stg_acteurs"
[0m22:49:40.926747 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:40.931860 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: COMMIT
[0m22:49:40.932049 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m22:49:40.932190 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: COMMIT
[0m22:49:40.932643 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:40.935102 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m22:49:40.935279 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_acteurs"} */

      drop view if exists "database"."main"."stg_acteurs__dbt_backup" cascade
    
[0m22:49:40.935622 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:40.936688 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: Close
[0m22:49:40.937617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7788aac-d8b3-44d0-980c-7c9510ed9535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b97830>]}
[0m22:49:40.937914 [info ] [Thread-1 (]: 1 of 17 OK created sql view model main.stg_acteurs ............................. [[32mOK[0m in 0.04s]
[0m22:49:40.938162 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_acteurs
[0m22:49:40.938344 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_agenda
[0m22:49:40.938578 [info ] [Thread-1 (]: 2 of 17 START sql view model main.stg_agenda ................................... [RUN]
[0m22:49:40.938828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_acteurs, now model.dbt_an_data.stg_agenda)
[0m22:49:40.939002 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_agenda
[0m22:49:40.940307 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_agenda"
[0m22:49:40.940645 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_agenda
[0m22:49:40.942108 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_agenda"
[0m22:49:40.942425 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m22:49:40.942590 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: BEGIN
[0m22:49:40.942728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:40.943029 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:40.943174 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m22:49:40.943316 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_agenda"} */

  
  create view "database"."main"."stg_agenda__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_agenda"
  );

[0m22:49:40.943622 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:40.944960 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m22:49:40.945119 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_agenda"} */
alter view "database"."main"."stg_agenda" rename to "stg_agenda__dbt_backup"
[0m22:49:40.945394 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:40.947460 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m22:49:40.947635 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_agenda"} */
alter view "database"."main"."stg_agenda__dbt_tmp" rename to "stg_agenda"
[0m22:49:40.947900 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:40.948451 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: COMMIT
[0m22:49:40.948603 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m22:49:40.948743 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: COMMIT
[0m22:49:40.949031 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:40.950031 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m22:49:40.950198 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_agenda"} */

      drop view if exists "database"."main"."stg_agenda__dbt_backup" cascade
    
[0m22:49:40.950544 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:40.951278 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: Close
[0m22:49:40.951614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7788aac-d8b3-44d0-980c-7c9510ed9535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c24260>]}
[0m22:49:40.951961 [info ] [Thread-1 (]: 2 of 17 OK created sql view model main.stg_agenda .............................. [[32mOK[0m in 0.01s]
[0m22:49:40.952215 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_agenda
[0m22:49:40.952384 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_amendements
[0m22:49:40.952600 [info ] [Thread-1 (]: 3 of 17 START sql view model main.stg_amendements .............................. [RUN]
[0m22:49:40.952815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_agenda, now model.dbt_an_data.stg_amendements)
[0m22:49:40.952963 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_amendements
[0m22:49:40.954228 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_amendements"
[0m22:49:40.954559 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_amendements
[0m22:49:40.955935 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_amendements"
[0m22:49:40.956233 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m22:49:40.956377 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: BEGIN
[0m22:49:40.956509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:40.956774 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:40.956914 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m22:49:40.957056 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_amendements"} */

  
  create view "database"."main"."stg_amendements__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_amendements"
  );

[0m22:49:40.957341 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:40.958663 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m22:49:40.958819 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_amendements"} */
alter view "database"."main"."stg_amendements" rename to "stg_amendements__dbt_backup"
[0m22:49:40.959060 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:40.960248 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m22:49:40.960400 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_amendements"} */
alter view "database"."main"."stg_amendements__dbt_tmp" rename to "stg_amendements"
[0m22:49:40.960635 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:40.961168 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: COMMIT
[0m22:49:40.961311 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m22:49:40.961442 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: COMMIT
[0m22:49:40.961768 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:40.962810 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m22:49:40.963017 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_amendements"} */

      drop view if exists "database"."main"."stg_amendements__dbt_backup" cascade
    
[0m22:49:40.963334 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:40.963911 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: Close
[0m22:49:40.964152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7788aac-d8b3-44d0-980c-7c9510ed9535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b951c0>]}
[0m22:49:40.964429 [info ] [Thread-1 (]: 3 of 17 OK created sql view model main.stg_amendements ......................... [[32mOK[0m in 0.01s]
[0m22:49:40.964668 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_amendements
[0m22:49:40.964837 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_organes
[0m22:49:40.965058 [info ] [Thread-1 (]: 4 of 17 START sql view model main.stg_organes .................................. [RUN]
[0m22:49:40.965278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_amendements, now model.dbt_an_data.stg_organes)
[0m22:49:40.965438 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_organes
[0m22:49:40.966711 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_organes"
[0m22:49:40.967028 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_organes
[0m22:49:40.968364 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_organes"
[0m22:49:40.968655 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m22:49:40.968806 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: BEGIN
[0m22:49:40.968940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:40.969207 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:40.969345 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m22:49:40.969485 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_organes"} */

  
  create view "database"."main"."stg_organes__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_organes"
  );

[0m22:49:40.969763 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:40.971432 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m22:49:40.971647 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_organes"} */
alter view "database"."main"."stg_organes" rename to "stg_organes__dbt_backup"
[0m22:49:40.972063 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:40.973339 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m22:49:40.973489 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_organes"} */
alter view "database"."main"."stg_organes__dbt_tmp" rename to "stg_organes"
[0m22:49:40.973718 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:40.974248 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: COMMIT
[0m22:49:40.974389 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m22:49:40.974517 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: COMMIT
[0m22:49:40.974820 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:40.976721 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m22:49:40.976872 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_organes"} */

      drop view if exists "database"."main"."stg_organes__dbt_backup" cascade
    
[0m22:49:40.977169 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:40.977718 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: Close
[0m22:49:40.977954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7788aac-d8b3-44d0-980c-7c9510ed9535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c4c800>]}
[0m22:49:40.978240 [info ] [Thread-1 (]: 4 of 17 OK created sql view model main.stg_organes ............................. [[32mOK[0m in 0.01s]
[0m22:49:40.978479 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_organes
[0m22:49:40.978656 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_pays
[0m22:49:40.978877 [info ] [Thread-1 (]: 5 of 17 START sql view model main.stg_pays ..................................... [RUN]
[0m22:49:40.979109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_organes, now model.dbt_an_data.stg_pays)
[0m22:49:40.979256 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_pays
[0m22:49:41.013310 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_pays"
[0m22:49:41.013788 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_pays
[0m22:49:41.015093 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_pays"
[0m22:49:41.015386 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m22:49:41.015535 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: BEGIN
[0m22:49:41.015668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:41.015973 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.016108 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m22:49:41.016241 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_pays"} */

  
  create view "database"."main"."stg_pays__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_pays"
  );

[0m22:49:41.016524 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.017829 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m22:49:41.017975 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_pays"} */
alter view "database"."main"."stg_pays" rename to "stg_pays__dbt_backup"
[0m22:49:41.018210 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.019412 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m22:49:41.019552 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_pays"} */
alter view "database"."main"."stg_pays__dbt_tmp" rename to "stg_pays"
[0m22:49:41.019771 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.020348 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: COMMIT
[0m22:49:41.020490 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m22:49:41.020618 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: COMMIT
[0m22:49:41.020905 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.021897 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m22:49:41.022041 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_pays"} */

      drop view if exists "database"."main"."stg_pays__dbt_backup" cascade
    
[0m22:49:41.022339 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.022984 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: Close
[0m22:49:41.023246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7788aac-d8b3-44d0-980c-7c9510ed9535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c4fce0>]}
[0m22:49:41.023527 [info ] [Thread-1 (]: 5 of 17 OK created sql view model main.stg_pays ................................ [[32mOK[0m in 0.04s]
[0m22:49:41.023775 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_pays
[0m22:49:41.023956 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_reunions
[0m22:49:41.024182 [info ] [Thread-1 (]: 6 of 17 START sql view model main.stg_reunions ................................. [RUN]
[0m22:49:41.024408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_pays, now model.dbt_an_data.stg_reunions)
[0m22:49:41.024567 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_reunions
[0m22:49:41.025803 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_reunions"
[0m22:49:41.026093 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_reunions
[0m22:49:41.027415 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_reunions"
[0m22:49:41.027733 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m22:49:41.027883 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: BEGIN
[0m22:49:41.028017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:41.028296 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.028436 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m22:49:41.028578 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_reunions"} */

  
  create view "database"."main"."stg_reunions__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_reunions"
  );

[0m22:49:41.028857 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.030194 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m22:49:41.030346 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_reunions"} */
alter view "database"."main"."stg_reunions" rename to "stg_reunions__dbt_backup"
[0m22:49:41.030601 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.031820 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m22:49:41.031970 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_reunions"} */
alter view "database"."main"."stg_reunions__dbt_tmp" rename to "stg_reunions"
[0m22:49:41.032199 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.032730 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: COMMIT
[0m22:49:41.032873 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m22:49:41.033057 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: COMMIT
[0m22:49:41.033415 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.035229 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m22:49:41.035388 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_reunions"} */

      drop view if exists "database"."main"."stg_reunions__dbt_backup" cascade
    
[0m22:49:41.035679 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.036244 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: Close
[0m22:49:41.036464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7788aac-d8b3-44d0-980c-7c9510ed9535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c26bd0>]}
[0m22:49:41.036727 [info ] [Thread-1 (]: 6 of 17 OK created sql view model main.stg_reunions ............................ [[32mOK[0m in 0.01s]
[0m22:49:41.036962 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_reunions
[0m22:49:41.037133 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_scrutins
[0m22:49:41.037367 [info ] [Thread-1 (]: 7 of 17 START sql view model main.stg_scrutins ................................. [RUN]
[0m22:49:41.037674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_reunions, now model.dbt_an_data.stg_scrutins)
[0m22:49:41.037889 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_scrutins
[0m22:49:41.039632 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_scrutins"
[0m22:49:41.040000 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_scrutins
[0m22:49:41.041532 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_scrutins"
[0m22:49:41.041848 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m22:49:41.042003 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: BEGIN
[0m22:49:41.042141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:41.042472 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.042615 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m22:49:41.042761 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins"} */

  
  create view "database"."main"."stg_scrutins__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_scrutins"
  );

[0m22:49:41.043057 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.044476 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m22:49:41.044648 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins"} */
alter view "database"."main"."stg_scrutins" rename to "stg_scrutins__dbt_backup"
[0m22:49:41.044943 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.046230 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m22:49:41.046391 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins"} */
alter view "database"."main"."stg_scrutins__dbt_tmp" rename to "stg_scrutins"
[0m22:49:41.046649 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.047199 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: COMMIT
[0m22:49:41.047352 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m22:49:41.047488 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: COMMIT
[0m22:49:41.047802 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.048806 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m22:49:41.048957 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.stg_scrutins"} */

      drop view if exists "database"."main"."stg_scrutins__dbt_backup" cascade
    
[0m22:49:41.049266 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.049830 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: Close
[0m22:49:41.050058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7788aac-d8b3-44d0-980c-7c9510ed9535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c25010>]}
[0m22:49:41.050330 [info ] [Thread-1 (]: 7 of 17 OK created sql view model main.stg_scrutins ............................ [[32mOK[0m in 0.01s]
[0m22:49:41.050563 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_scrutins
[0m22:49:41.050732 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_acteurs
[0m22:49:41.050948 [info ] [Thread-1 (]: 8 of 17 START sql incremental model main.int_acteurs ........................... [RUN]
[0m22:49:41.051168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_scrutins, now model.dbt_an_data.int_acteurs)
[0m22:49:41.051318 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_acteurs
[0m22:49:41.052799 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_acteurs"
[0m22:49:41.053152 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_acteurs
[0m22:49:41.073027 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_acteurs"
[0m22:49:41.073735 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m22:49:41.073899 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m22:49:41.074032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:41.074355 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.074490 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m22:49:41.074650 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_acteurs"} */

  
    
    

    create  table
      "database"."main"."int_acteurs__dbt_tmp"
  
    as (
      

SELECT 
json_extract_string(json, '$.acteur.uid.#text') as uid,
json_extract_string(json, '$.acteur.etatCivil.ident.civ') as civ,
json_extract_string(json, '$.acteur.etatCivil.ident.prenom') as prenom,
json_extract_string(json, '$.acteur.etatCivil.ident.nom') as nom,
json_extract_string(json, '$.acteur.etatCivil.ident.trigramme') as trigramme,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.dateNais') as dateNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.villeNais') as villeNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.depNais') as depNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.paysNais') as paysNais,
json_extract_string(json, '$.acteur.etatCivil.dateDeces') as dateDeces,
json_extract_string(json, '$.acteur.profession.libelleCourant') as libelleCourant,
json_extract_string(json, '$.acteur.profession.socProcINSEE.catSocPro') as catSocPro,
json_extract_string(json, '$.acteur.profession.socProcINSEE.famSocPro') as famSocPro,
json_extract_string(json, '$.acteur.uri_hatvp') as uri_hatvp
FROM "database"."main"."stg_acteurs"
    );
  
  
  
[0m22:49:41.194535 [debug] [Thread-1 (]: SQL status: OK in 0.120 seconds
[0m22:49:41.197515 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m22:49:41.197703 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_acteurs"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_acteurs'
  
[0m22:49:41.198150 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.198729 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m22:49:41.198885 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_acteurs"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_acteurs'
  
[0m22:49:41.199556 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:49:41.201101 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m22:49:41.201262 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_acteurs"} */
alter table "database"."main"."int_acteurs" rename to "int_acteurs__dbt_backup"
[0m22:49:41.201526 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.202707 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m22:49:41.202855 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_acteurs"} */
alter table "database"."main"."int_acteurs__dbt_tmp" rename to "int_acteurs"
[0m22:49:41.203086 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.205204 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m22:49:41.205371 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m22:49:41.205511 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m22:49:41.206440 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:49:41.206710 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m22:49:41.206863 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m22:49:41.207069 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.207210 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m22:49:41.207352 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_acteurs"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_acteurs__dbt_backup'
  
[0m22:49:41.207688 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.208281 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m22:49:41.208424 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_acteurs"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_acteurs__dbt_backup'
  
[0m22:49:41.208733 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.210970 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m22:49:41.211127 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "database"."main"."int_acteurs__dbt_backup" cascade
    
[0m22:49:41.211432 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.212019 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: ROLLBACK
[0m22:49:41.212498 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_an_data.int_acteurs'
[0m22:49:41.212642 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: Close
[0m22:49:41.212915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7788aac-d8b3-44d0-980c-7c9510ed9535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6eb70>]}
[0m22:49:41.213205 [info ] [Thread-1 (]: 8 of 17 OK created sql incremental model main.int_acteurs ...................... [[32mOK[0m in 0.16s]
[0m22:49:41.213433 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_acteurs
[0m22:49:41.213595 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_mandats
[0m22:49:41.213807 [info ] [Thread-1 (]: 9 of 17 START sql incremental model main.int_mandats ........................... [RUN]
[0m22:49:41.213980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_acteurs, now model.dbt_an_data.int_mandats)
[0m22:49:41.214125 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_mandats
[0m22:49:41.215489 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_mandats"
[0m22:49:41.215825 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_mandats
[0m22:49:41.217265 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_mandats"
[0m22:49:41.217541 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m22:49:41.217687 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m22:49:41.217817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:41.218061 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.218200 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m22:49:41.218359 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_mandats"} */

  
    
    

    create  table
      "database"."main"."int_mandats__dbt_tmp"
  
    as (
      

SELECT 
json_extract_string(mandat.value, '$.uid') as uid,
json_extract_string(mandat.value, '$.acteurRef') as acteurRef,
json_extract_string(mandat.value, '$.legislature') as legislature,
json_extract_string(mandat.value, '$.typeOrgane') as typeOrgane,
json_extract_string(mandat.value, '$.dateDebut') as dateDebut,
json_extract_string(mandat.value, '$.dateFin') as dateFin,
json_extract_string(mandat.value, '$.preseance') as preseance,
json_extract_string(mandat.value, '$.nominPrincipale') as nominPrincipale,
json_extract_string(mandat.value, '$.infosQualite.codeQualite') as codeQualite,
json_extract_string(mandat.value, '$.organes.organeRef') as organeRef,
FROM "database"."main"."stg_acteurs" act, json_each(json->'acteur'->'mandats'->'mandat') mandat
    );
  
  
  
[0m22:49:41.402205 [debug] [Thread-1 (]: SQL status: OK in 0.184 seconds
[0m22:49:41.402895 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m22:49:41.403062 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_mandats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_mandats'
  
[0m22:49:41.403500 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.404048 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m22:49:41.404198 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_mandats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_mandats'
  
[0m22:49:41.404528 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.405945 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m22:49:41.406096 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_mandats"} */
alter table "database"."main"."int_mandats" rename to "int_mandats__dbt_backup"
[0m22:49:41.406346 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.407517 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m22:49:41.407658 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_mandats"} */
alter table "database"."main"."int_mandats__dbt_tmp" rename to "int_mandats"
[0m22:49:41.407884 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.408510 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m22:49:41.408652 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m22:49:41.408798 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m22:49:41.414247 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:49:41.414527 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m22:49:41.414678 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m22:49:41.414906 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.415041 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m22:49:41.415175 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_mandats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_mandats__dbt_backup'
  
[0m22:49:41.415499 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.416071 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m22:49:41.416217 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_mandats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_mandats__dbt_backup'
  
[0m22:49:41.416528 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.417888 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m22:49:41.418041 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "database"."main"."int_mandats__dbt_backup" cascade
    
[0m22:49:41.418279 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.418813 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: ROLLBACK
[0m22:49:41.419263 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_an_data.int_mandats'
[0m22:49:41.419401 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: Close
[0m22:49:41.419637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7788aac-d8b3-44d0-980c-7c9510ed9535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae9790>]}
[0m22:49:41.419905 [info ] [Thread-1 (]: 9 of 17 OK created sql incremental model main.int_mandats ...................... [[32mOK[0m in 0.21s]
[0m22:49:41.420127 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_mandats
[0m22:49:41.420284 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_agenda
[0m22:49:41.420456 [info ] [Thread-1 (]: 10 of 17 START sql incremental model main.int_agenda ........................... [RUN]
[0m22:49:41.420627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_mandats, now model.dbt_an_data.int_agenda)
[0m22:49:41.420770 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_agenda
[0m22:49:41.422109 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_agenda"
[0m22:49:41.422488 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_agenda
[0m22:49:41.423966 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_agenda"
[0m22:49:41.424268 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m22:49:41.424423 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m22:49:41.424563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:41.424806 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.424952 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m22:49:41.425095 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */

  
    
    

    create  table
      "database"."main"."int_agenda__dbt_tmp"
  
    as (
      

SELECT * 
FROM "database"."main"."stg_agenda"
    );
  
  
  
[0m22:49:41.426064 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:49:41.426601 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m22:49:41.426773 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_agenda'
  
[0m22:49:41.427109 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.427676 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m22:49:41.427829 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_agenda'
  
[0m22:49:41.428167 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.429582 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m22:49:41.429735 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */
alter table "database"."main"."int_agenda" rename to "int_agenda__dbt_backup"
[0m22:49:41.429989 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.431181 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m22:49:41.431325 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */
alter table "database"."main"."int_agenda__dbt_tmp" rename to "int_agenda"
[0m22:49:41.431553 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.433132 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m22:49:41.433283 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m22:49:41.433417 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m22:49:41.433802 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.434029 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m22:49:41.434164 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m22:49:41.434355 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.434488 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m22:49:41.434627 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_agenda__dbt_backup'
  
[0m22:49:41.434932 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.435511 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m22:49:41.435658 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_agenda__dbt_backup'
  
[0m22:49:41.435985 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.437648 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m22:49:41.437851 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "database"."main"."int_agenda__dbt_backup" cascade
    
[0m22:49:41.438186 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.438873 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: ROLLBACK
[0m22:49:41.439418 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_an_data.int_agenda'
[0m22:49:41.439578 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: Close
[0m22:49:41.439856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7788aac-d8b3-44d0-980c-7c9510ed9535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c219a0>]}
[0m22:49:41.440162 [info ] [Thread-1 (]: 10 of 17 OK created sql incremental model main.int_agenda ...................... [[32mOK[0m in 0.02s]
[0m22:49:41.440409 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_agenda
[0m22:49:41.440581 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements
[0m22:49:41.440797 [info ] [Thread-1 (]: 11 of 17 START sql incremental model main.int_amendements ...................... [RUN]
[0m22:49:41.440982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_agenda, now model.dbt_an_data.int_amendements)
[0m22:49:41.441132 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements
[0m22:49:41.442821 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements"
[0m22:49:41.443206 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements
[0m22:49:41.444740 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements"
[0m22:49:41.445047 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m22:49:41.445198 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m22:49:41.445334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:41.445655 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.445801 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m22:49:41.446000 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements"} */

  
    
    

    create  table
      "database"."main"."int_amendements__dbt_tmp"
  
    as (
      

SELECT
json_extract_string(json, '$.amendement.uid') AS uid,
json_extract_string(json, '$.amendement.chronotag') AS chronotag,
json_extract_string(json, '$.amendement.examenRef') AS examenRef,
json_extract_string(json, '$.amendement.amendementParentRef') AS amendementParentRef,
json_extract_string(json, '$.amendement.signataires.auteur.typeAuteur') AS typeAuteur,
json_extract_string(json, '$.amendement.signataires.auteur.acteurRef') AS refAuteur,
json_extract_string(json, '$.amendement.signataires.auteur.groupePolitique') AS groupePolitiqueAuteur,
json_extract_string(json, '$.amendement.cycleDeVie.dateDepot') AS dateDepot,
json_extract_string(json, '$.amendement.cycleDeVie.datePublication') AS datePublication,
json_extract_string(json, '$.amendement.cycleDeVie.soumisArticle40') AS soumisArticle40,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.code') AS codeEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.libelle') AS libelleEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.code') AS codeSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.dateSort') AS dateSort,
json_extract_string(json, '$.amendement.cycleDeVie.sort') AS sort,
split_part(replace(filename, '.json', ''), '/', -1) AS id_amendement,
split_part(replace(filename, '.json', ''), '/', -2) AS id_texte,
split_part(replace(filename, '.json', ''), '/', -3) AS id_dossier_legislatif,
id_texte[:4] AS nature_texte,
id_texte[5:6] AS source_texte,
regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 1) AS prefix_bibard,
regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 2) AS numero_bibard,
regexp_extract(id_amendement, '(SEA|PO\d*)', 1) AS code_organe,
regexp_extract(id_amendement, '(P)(\d*)(D)', 2) AS numero_partie,
regexp_extract(id_amendement, '(D)(\d*)(N)', 2) AS numero_deliberation,
regexp_extract(id_amendement, '(D)(\d*)(N)(\d*)', 4) AS numero_court
from "database"."main"."stg_amendements"
    );
  
  
  
[0m22:49:41.448204 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:49:41.448737 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m22:49:41.448894 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_amendements'
  
[0m22:49:41.449211 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.449776 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m22:49:41.449937 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_amendements'
  
[0m22:49:41.450307 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.451856 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m22:49:41.452046 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements"} */
alter table "database"."main"."int_amendements" rename to "int_amendements__dbt_backup"
[0m22:49:41.452347 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.453820 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m22:49:41.454141 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements"} */
alter table "database"."main"."int_amendements__dbt_tmp" rename to "int_amendements"
[0m22:49:41.454658 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.455659 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m22:49:41.455841 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m22:49:41.455982 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m22:49:41.456445 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.456727 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m22:49:41.456892 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m22:49:41.457124 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.457272 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m22:49:41.457421 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_amendements__dbt_backup'
  
[0m22:49:41.457797 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.458449 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m22:49:41.458610 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_amendements__dbt_backup'
  
[0m22:49:41.458967 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.460846 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m22:49:41.461079 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "database"."main"."int_amendements__dbt_backup" cascade
    
[0m22:49:41.461445 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.462260 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: ROLLBACK
[0m22:49:41.462856 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_an_data.int_amendements'
[0m22:49:41.463032 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: Close
[0m22:49:41.463412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7788aac-d8b3-44d0-980c-7c9510ed9535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107821cd0>]}
[0m22:49:41.463782 [info ] [Thread-1 (]: 11 of 17 OK created sql incremental model main.int_amendements ................. [[32mOK[0m in 0.02s]
[0m22:49:41.464045 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements
[0m22:49:41.464245 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements_cosignataires
[0m22:49:41.464481 [info ] [Thread-1 (]: 12 of 17 START sql incremental model main.int_amendements_cosignataires ........ [RUN]
[0m22:49:41.464690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements, now model.dbt_an_data.int_amendements_cosignataires)
[0m22:49:41.464855 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements_cosignataires
[0m22:49:41.466748 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements_cosignataires"
[0m22:49:41.467147 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements_cosignataires
[0m22:49:41.468722 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements_cosignataires"
[0m22:49:41.469026 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m22:49:41.469183 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m22:49:41.469325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:41.469650 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.469794 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m22:49:41.469961 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

  
    
    

    create  table
      "database"."main"."int_amendements_cosignataires__dbt_tmp"
  
    as (
      

WITH cosignataires_arr AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef[*]') AS acteurRef
  FROM "database"."main"."stg_amendements"
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') == 'ARRAY' AND acteurRef IS NOT NULL
), cosignataires_str AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef') AS acteurRef
  FROM "database"."main"."stg_amendements"
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') <> 'ARRAY' AND acteurRef IS NOT NULL
)
SELECT 
  uid, 
  unnest(acteurRef) as acteurRef
FROM cosignataires_arr
UNION ALL
SELECT 
  uid, 
  acteurRef
FROM cosignataires_str
    );
  
  
  
[0m22:49:41.470824 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:49:41.471464 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m22:49:41.471672 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_amendements_cosignataires'
  
[0m22:49:41.472258 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.472925 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m22:49:41.473089 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_amendements_cosignataires'
  
[0m22:49:41.473487 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.474993 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m22:49:41.475161 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */
alter table "database"."main"."int_amendements_cosignataires" rename to "int_amendements_cosignataires__dbt_backup"
[0m22:49:41.475476 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.476797 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m22:49:41.476971 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */
alter table "database"."main"."int_amendements_cosignataires__dbt_tmp" rename to "int_amendements_cosignataires"
[0m22:49:41.477251 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.478935 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m22:49:41.479111 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m22:49:41.479261 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m22:49:41.479628 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.479856 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m22:49:41.480009 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m22:49:41.480214 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.480355 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m22:49:41.480502 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_amendements_cosignataires__dbt_backup'
  
[0m22:49:41.480837 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.481423 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m22:49:41.481577 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_amendements_cosignataires__dbt_backup'
  
[0m22:49:41.481914 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.483390 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m22:49:41.483565 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "database"."main"."int_amendements_cosignataires__dbt_backup" cascade
    
[0m22:49:41.483853 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.484479 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: ROLLBACK
[0m22:49:41.485022 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_an_data.int_amendements_cosignataires'
[0m22:49:41.485180 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: Close
[0m22:49:41.485447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7788aac-d8b3-44d0-980c-7c9510ed9535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c47830>]}
[0m22:49:41.485752 [info ] [Thread-1 (]: 12 of 17 OK created sql incremental model main.int_amendements_cosignataires ... [[32mOK[0m in 0.02s]
[0m22:49:41.485997 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements_cosignataires
[0m22:49:41.486291 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_organes
[0m22:49:41.486599 [info ] [Thread-1 (]: 13 of 17 START sql incremental model main.int_organes .......................... [RUN]
[0m22:49:41.486839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements_cosignataires, now model.dbt_an_data.int_organes)
[0m22:49:41.487021 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_organes
[0m22:49:41.489059 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_organes"
[0m22:49:41.489658 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_organes
[0m22:49:41.491246 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_organes"
[0m22:49:41.491542 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m22:49:41.491695 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m22:49:41.491834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:41.492152 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.492295 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m22:49:41.492458 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_organes"} */

  
    
    

    create  table
      "database"."main"."int_organes__dbt_tmp"
  
    as (
      

SELECT 
json_extract_string(json, '$.organe.uid') as uid,
json_extract_string(json, '$.organe.codeType') as codeType,
json_extract_string(json, '$.organe.libelle') as libelle,
json_extract_string(json, '$.organe.libelleEdition') as libelleEdition,
json_extract_string(json, '$.organe.libelleAbrege') as libelleAbrege,
json_extract_string(json, '$.organe.libelleAbrev') as libelleAbrev,
json_extract_string(json, '$.organe.viMoDe.dateDebut') as dateDebut,
json_extract_string(json, '$.organe.viMoDe.dateAgrement') as dateAgrement,
json_extract_string(json, '$.organe.viMoDe.dateFin') as dateFin,
json_extract_string(json, '$.organe.organeParent') as organeParent,
json_extract_string(json, '$.organe.chambre') as chambre,
json_extract_string(json, '$.organe.regime') as regime,
json_extract_string(json, '$.organe.legislature') as legislature
FROM "database"."main"."stg_organes"
    );
  
  
  
[0m22:49:41.564380 [debug] [Thread-1 (]: SQL status: OK in 0.072 seconds
[0m22:49:41.565068 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m22:49:41.565239 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_organes"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_organes'
  
[0m22:49:41.565673 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.566261 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m22:49:41.566417 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_organes"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_organes'
  
[0m22:49:41.566773 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.568206 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m22:49:41.568369 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_organes"} */
alter table "database"."main"."int_organes" rename to "int_organes__dbt_backup"
[0m22:49:41.568632 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.569811 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m22:49:41.569961 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_organes"} */
alter table "database"."main"."int_organes__dbt_tmp" rename to "int_organes"
[0m22:49:41.570200 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.570817 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m22:49:41.570972 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m22:49:41.571109 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m22:49:41.574718 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:49:41.574980 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m22:49:41.575120 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m22:49:41.575329 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.575453 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m22:49:41.575583 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_organes"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_organes__dbt_backup'
  
[0m22:49:41.575896 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.576482 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m22:49:41.576634 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_organes"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_organes__dbt_backup'
  
[0m22:49:41.577053 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.578512 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m22:49:41.578680 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "database"."main"."int_organes__dbt_backup" cascade
    
[0m22:49:41.578934 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.579527 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: ROLLBACK
[0m22:49:41.579970 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_an_data.int_organes'
[0m22:49:41.580109 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: Close
[0m22:49:41.580346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7788aac-d8b3-44d0-980c-7c9510ed9535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c47f20>]}
[0m22:49:41.580613 [info ] [Thread-1 (]: 13 of 17 OK created sql incremental model main.int_organes ..................... [[32mOK[0m in 0.09s]
[0m22:49:41.580835 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_organes
[0m22:49:41.580997 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_pays
[0m22:49:41.581203 [info ] [Thread-1 (]: 14 of 17 START sql incremental model main.int_pays ............................. [RUN]
[0m22:49:41.581378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_organes, now model.dbt_an_data.int_pays)
[0m22:49:41.581524 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_pays
[0m22:49:41.582872 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_pays"
[0m22:49:41.583185 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_pays
[0m22:49:41.584597 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_pays"
[0m22:49:41.584862 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m22:49:41.585002 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m22:49:41.585129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:41.585360 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.585489 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m22:49:41.585635 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_pays"} */

  
    
    

    create  table
      "database"."main"."int_pays__dbt_tmp"
  
    as (
      

SELECT
json_extract_string(json, '$.pays.uid') as uid,
json_extract_string(json, '$.pays.code_insee') as code_insee,
json_extract_string(json, '$.pays.libelleInsee') as libelleInsee,
json_extract_string(json, '$.pays.nomCourant') as nomCourant,
json_extract_string(json, '$.pays.code_iso2A') as code_iso2A,
json_extract_string(json, '$.pays.code_iso3A') as code_iso3A,
json_extract_string(json, '$.pays.code_iso3N') as code_iso3N,
json_extract_string(json, '$.pays.libelleIso') as libelleIso,
json_extract_string(json, '$.pays.libelleANCourt') as libelleANCourt,
json_extract_string(json, '$.pays.libelleANLong') as libelleANLong,
json_extract_string(json, '$.pays.sourceJuridique') as sourceJuridique,
json_extract_string(json, '$.pays.activ') as activ
FROM "database"."main"."stg_pays"
    );
  
  
  
[0m22:49:41.587138 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:49:41.587639 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m22:49:41.587787 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_pays"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_pays'
  
[0m22:49:41.588093 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.588629 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m22:49:41.588772 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_pays"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_pays'
  
[0m22:49:41.589098 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.590447 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m22:49:41.590598 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_pays"} */
alter table "database"."main"."int_pays" rename to "int_pays__dbt_backup"
[0m22:49:41.590840 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.592039 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m22:49:41.592180 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_pays"} */
alter table "database"."main"."int_pays__dbt_tmp" rename to "int_pays"
[0m22:49:41.592404 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.593961 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m22:49:41.594122 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m22:49:41.594256 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m22:49:41.594723 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.594935 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m22:49:41.595070 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m22:49:41.595263 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.595388 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m22:49:41.595522 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_pays"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_pays__dbt_backup'
  
[0m22:49:41.595821 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.596360 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m22:49:41.596503 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_pays"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_pays__dbt_backup'
  
[0m22:49:41.596848 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.598276 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m22:49:41.598441 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "database"."main"."int_pays__dbt_backup" cascade
    
[0m22:49:41.598683 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.599250 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: ROLLBACK
[0m22:49:41.599686 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_an_data.int_pays'
[0m22:49:41.599827 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: Close
[0m22:49:41.600064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7788aac-d8b3-44d0-980c-7c9510ed9535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c5cd40>]}
[0m22:49:41.600328 [info ] [Thread-1 (]: 14 of 17 OK created sql incremental model main.int_pays ........................ [[32mOK[0m in 0.02s]
[0m22:49:41.600551 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_pays
[0m22:49:41.600710 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_reunions
[0m22:49:41.600930 [info ] [Thread-1 (]: 15 of 17 START sql incremental model main.int_reunions ......................... [RUN]
[0m22:49:41.601121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_pays, now model.dbt_an_data.int_reunions)
[0m22:49:41.601265 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_reunions
[0m22:49:41.602666 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_reunions"
[0m22:49:41.602993 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_reunions
[0m22:49:41.604446 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_reunions"
[0m22:49:41.604738 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m22:49:41.604894 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m22:49:41.605030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:41.605303 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.605448 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m22:49:41.605621 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_reunions"} */

  
    
    

    create  table
      "database"."main"."int_reunions__dbt_tmp"
  
    as (
      

SELECT
json_extract_string(json, '$.reunion.uid') AS uid,
json_extract_string(json, '$.reunion.timeStampDebut') AS timeStampDebut,
json_extract_string(json, '$.reunion.lieu.lieuRef') AS lieuRef,
json_extract_string(json, '$.reunion.lieu.libelleLong') AS lieuLibelle,
json_extract_string(json, '$.reunion.cycleDeVie.etat') AS cycleDeVieEtat,
json_extract_string(json, '$.reunion.demandeur') AS demandeur,
json_extract_string(json, '$.reunion.organeReuniRef') AS organeReuniRef,
json_extract_string(json, '$.reunion.visioConference') AS visioConference,
json_extract_string(json, '$.reunion.sessionRef') AS sessionRef,
json_extract_string(json, '$.reunion.ouverturePresse') AS ouverturePresse,
json_extract_string(json, '$.reunion.captationVideo') AS captationVideo,
json_extract_string(json, '$.reunion.ODJ.convocationODJ.item') AS convocationODJ,
json_extract_string(json, '$.reunion.ODJ.resumeODJ.item') AS resumeODJ,
json_extract_string(json, '$.reunion.compteRenduRef') AS compteRenduRef,
json_extract_string(json, '$.reunion.identifiants.numSeanceJO') AS numSeanceJO,
json_extract_string(json, '$.reunion.identifiants.idJO') AS idJO,
json_extract_string(json, '$.reunion.identifiants.quantieme') AS quantieme,
json_extract_string(json, '$.reunion.identifiants.DataSeance') AS DataSeance
FROM "database"."main"."stg_reunions"
    );
  
  
  
[0m22:49:41.860395 [debug] [Thread-1 (]: SQL status: OK in 0.255 seconds
[0m22:49:41.861078 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m22:49:41.861255 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_reunions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_reunions'
  
[0m22:49:41.861680 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.862254 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m22:49:41.862413 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_reunions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_reunions'
  
[0m22:49:41.862767 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.864233 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m22:49:41.864395 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_reunions"} */
alter table "database"."main"."int_reunions" rename to "int_reunions__dbt_backup"
[0m22:49:41.864671 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.865914 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m22:49:41.866068 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_reunions"} */
alter table "database"."main"."int_reunions__dbt_tmp" rename to "int_reunions"
[0m22:49:41.866313 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.866951 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m22:49:41.867094 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m22:49:41.867221 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m22:49:41.870820 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:49:41.871164 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m22:49:41.871321 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m22:49:41.871571 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.871715 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m22:49:41.871860 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_reunions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_reunions__dbt_backup'
  
[0m22:49:41.872226 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.872855 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m22:49:41.873005 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_reunions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_reunions__dbt_backup'
  
[0m22:49:41.873330 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.874784 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m22:49:41.874940 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "database"."main"."int_reunions__dbt_backup" cascade
    
[0m22:49:41.875182 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.875763 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: ROLLBACK
[0m22:49:41.876221 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_an_data.int_reunions'
[0m22:49:41.876366 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: Close
[0m22:49:41.876596 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7788aac-d8b3-44d0-980c-7c9510ed9535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b94ad0>]}
[0m22:49:41.876865 [info ] [Thread-1 (]: 15 of 17 OK created sql incremental model main.int_reunions .................... [[32mOK[0m in 0.28s]
[0m22:49:41.877088 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_reunions
[0m22:49:41.877250 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins
[0m22:49:41.877453 [info ] [Thread-1 (]: 16 of 17 START sql incremental model main.int_scrutins ......................... [RUN]
[0m22:49:41.877622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_reunions, now model.dbt_an_data.int_scrutins)
[0m22:49:41.877767 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins
[0m22:49:41.879126 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins"
[0m22:49:41.879482 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins
[0m22:49:41.880929 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins"
[0m22:49:41.881214 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m22:49:41.881357 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m22:49:41.881487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:41.881726 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:41.881856 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m22:49:41.882008 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

  
    
    

    create  table
      "database"."main"."int_scrutins__dbt_tmp"
  
    as (
      

SELECT
date_T_insert,
json_extract_string(json, '$.scrutin.uid') AS uid,
json_extract_string(json, '$.scrutin.numero') AS numero,
json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
json_extract_string(json, '$.scrutin.legislature') AS legislature,
json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
json_extract_string(json, '$.scrutin.titre') AS titre,
json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote
FROM "database"."main"."stg_scrutins"
    );
  
  
  
[0m22:49:42.946827 [debug] [Thread-1 (]: SQL status: OK in 1.065 seconds
[0m22:49:42.947531 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m22:49:42.947707 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_scrutins'
  
[0m22:49:42.948137 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:42.948677 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m22:49:42.948831 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_scrutins'
  
[0m22:49:42.949159 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:42.950604 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m22:49:42.950759 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */
alter table "database"."main"."int_scrutins" rename to "int_scrutins__dbt_backup"
[0m22:49:42.951022 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:42.952193 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m22:49:42.952337 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */
alter table "database"."main"."int_scrutins__dbt_tmp" rename to "int_scrutins"
[0m22:49:42.952564 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:42.954128 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m22:49:42.954283 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m22:49:42.954415 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m22:49:42.957071 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:49:42.957367 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m22:49:42.957526 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m22:49:42.957746 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:42.957887 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m22:49:42.958022 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_scrutins__dbt_backup'
  
[0m22:49:42.958352 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:42.958941 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m22:49:42.959094 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_scrutins__dbt_backup'
  
[0m22:49:42.959480 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:42.960972 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m22:49:42.961143 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "database"."main"."int_scrutins__dbt_backup" cascade
    
[0m22:49:42.961401 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:42.961963 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: ROLLBACK
[0m22:49:42.962408 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_an_data.int_scrutins'
[0m22:49:42.962552 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: Close
[0m22:49:42.962786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7788aac-d8b3-44d0-980c-7c9510ed9535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c8e570>]}
[0m22:49:42.963055 [info ] [Thread-1 (]: 16 of 17 OK created sql incremental model main.int_scrutins .................... [[32mOK[0m in 1.09s]
[0m22:49:42.963287 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins
[0m22:49:42.963445 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins_votes
[0m22:49:42.963616 [info ] [Thread-1 (]: 17 of 17 START sql incremental model main.int_scrutins_votes ................... [RUN]
[0m22:49:42.963785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_scrutins, now model.dbt_an_data.int_scrutins_votes)
[0m22:49:42.963929 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins_votes
[0m22:49:42.965646 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins_votes"
[0m22:49:42.966040 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins_votes
[0m22:49:42.967506 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins_votes"
[0m22:49:42.967803 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m22:49:42.967952 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m22:49:42.968088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:42.968344 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:42.968487 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m22:49:42.968771 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

  
    
    

    create  table
      "database"."main"."int_scrutins_votes__dbt_tmp"
  
    as (
      

WITH grp AS (
      -- explode les groupes (1 par groupe)
      SELECT
          json_extract_string(j.json, '$.scrutin.uid') AS uid,
          json_extract_string(g.value, '$.organeRef') AS groupe_organe,
          g.value AS groupe_json
      FROM "database"."main"."stg_scrutins" j,
           json_each(json->'scrutin'->'ventilationVotes'->'organe'->'groupes'->'groupe') g
  ),

  positions_array AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          p.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'pours'->'votant') p
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          c.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'contres'->'votant') c
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          a.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'abstentions'->'votant') a
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          n.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'nonVotants'->'votant') n
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[ARRAY]'
  ),
  positions_object AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[OBJECT]'
  ),

  clean AS (
      -- sécurise les champs (souvent string ou null)
      SELECT
          uid,
          groupe_organe,
          type_vote,
          json_extract_string(vote_json, '$.acteurRef') AS acteurRef,
          json_extract_string(vote_json, '$.mandatRef') AS mandatRef,
          json_extract_string(vote_json, '$.parDelegation') AS parDelegation,
          json_extract_string(vote_json, '$.numPlace') AS numPlace,
          json_extract_string(vote_json, '$.causePositionVote') AS cause
      FROM positions_array
      UNION ALL
      SELECT * 
      FROM positions_object
  )

  SELECT * FROM clean
    );
  
  
  
[0m22:49:51.790735 [debug] [Thread-1 (]: SQL status: OK in 8.816 seconds
[0m22:49:51.798110 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m22:49:51.798352 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_scrutins_votes'
  
[0m22:49:51.809081 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m22:49:51.810627 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m22:49:51.810795 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_scrutins_votes'
  
[0m22:49:51.811670 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:49:51.815523 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m22:49:51.815712 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins_votes"} */
alter table "database"."main"."int_scrutins_votes" rename to "int_scrutins_votes__dbt_backup"
[0m22:49:51.817222 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:49:51.818552 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m22:49:51.818719 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins_votes"} */
alter table "database"."main"."int_scrutins_votes__dbt_tmp" rename to "int_scrutins_votes"
[0m22:49:51.818989 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:51.819820 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m22:49:51.819976 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m22:49:51.820111 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m22:49:51.973874 [debug] [Thread-1 (]: SQL status: OK in 0.154 seconds
[0m22:49:51.974333 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m22:49:51.974506 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m22:49:51.974773 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:51.974921 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m22:49:51.975070 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_scrutins_votes__dbt_backup'
  
[0m22:49:51.975456 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:51.976100 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m22:49:51.976264 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_scrutins_votes__dbt_backup'
  
[0m22:49:51.976591 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:51.978115 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m22:49:51.978282 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "dev", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "database"."main"."int_scrutins_votes__dbt_backup" cascade
    
[0m22:49:51.978596 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:51.979322 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: ROLLBACK
[0m22:49:51.980347 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_an_data.int_scrutins_votes'
[0m22:49:51.980512 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: Close
[0m22:49:51.982685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7788aac-d8b3-44d0-980c-7c9510ed9535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b94dd0>]}
[0m22:49:51.983257 [info ] [Thread-1 (]: 17 of 17 OK created sql incremental model main.int_scrutins_votes .............. [[32mOK[0m in 9.02s]
[0m22:49:51.983576 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins_votes
[0m22:49:51.988559 [debug] [MainThread]: Using duckdb connection "master"
[0m22:49:51.988751 [debug] [MainThread]: On master: BEGIN
[0m22:49:51.988895 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:49:51.989376 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:49:51.989521 [debug] [MainThread]: On master: COMMIT
[0m22:49:51.989650 [debug] [MainThread]: Using duckdb connection "master"
[0m22:49:51.989761 [debug] [MainThread]: On master: COMMIT
[0m22:49:51.989947 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:49:51.990063 [debug] [MainThread]: On master: Close
[0m22:49:51.990222 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:49:51.990333 [debug] [MainThread]: Connection 'model.dbt_an_data.int_scrutins_votes' was properly closed.
[0m22:49:51.990734 [info ] [MainThread]: 
[0m22:49:51.990891 [info ] [MainThread]: Finished running 10 incremental models, 7 view models in 0 hours 0 minutes and 11.15 seconds (11.15s).
[0m22:49:51.992298 [debug] [MainThread]: Command end result
[0m22:49:52.009161 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m22:49:52.016750 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m22:49:52.023415 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m22:49:52.023608 [info ] [MainThread]: 
[0m22:49:52.023801 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:49:52.023947 [info ] [MainThread]: 
[0m22:49:52.024312 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=17
[0m22:49:52.025663 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 11.542553, "process_in_blocks": "0", "process_kernel_time": 4.933241, "process_mem_max_rss": "2962472960", "process_out_blocks": "0", "process_user_time": 15.353032}
[0m22:49:52.026166 [debug] [MainThread]: Command `dbt build` succeeded at 22:49:52.026111 after 11.54 seconds
[0m22:49:52.026616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c35490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10767a6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106392e40>]}
[0m22:49:52.026811 [debug] [MainThread]: Flushing usage events
[0m22:49:52.728500 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:10:49.973658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fdf8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c35a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf31d0>]}


============================== 23:10:49.976903 | dbe13065-713e-4055-bac2-e033790454fc ==============================
[0m23:10:49.976903 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:10:49.977225 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'log_cache_events': 'False', 'warn_error': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'printer_width': '80', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'fail_fast': 'False', 'target_path': 'None', 'empty': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'partial_parse': 'True', 'no_print': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'debug': 'False', 'introspect': 'True'}
[0m23:10:49.981150 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'MOTHERDUCK_TOKEN'
[0m23:10:49.981499 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.047872625, "process_in_blocks": "0", "process_kernel_time": 0.119316, "process_mem_max_rss": "103137280", "process_out_blocks": "0", "process_user_time": 0.622903}
[0m23:10:49.981759 [debug] [MainThread]: Command `dbt run` failed at 23:10:49.981710 after 0.05 seconds
[0m23:10:49.981929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f3afc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb00e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032f11f0>]}
[0m23:10:49.982100 [debug] [MainThread]: Flushing usage events
[0m23:10:50.508251 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:13:50.339247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10665a060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105536e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105533b0>]}


============================== 23:13:50.342454 | c100cec7-cf41-4cc6-bf3a-e24484be4018 ==============================
[0m23:13:50.342454 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:13:50.342780 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'no_print': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'target_path': 'None', 'write_json': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'log_format': 'default', 'empty': 'False', 'partial_parse': 'True', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'printer_width': '80', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m23:13:50.524158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c100cec7-cf41-4cc6-bf3a-e24484be4018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11058ba70>]}
[0m23:13:50.550815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c100cec7-cf41-4cc6-bf3a-e24484be4018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f37b30>]}
[0m23:13:50.552222 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m23:13:50.610482 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m23:13:50.648471 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m23:13:50.648751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c100cec7-cf41-4cc6-bf3a-e24484be4018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11165dac0>]}
[0m23:13:51.160745 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_an_data.mart
[0m23:13:51.165184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c100cec7-cf41-4cc6-bf3a-e24484be4018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110f6a20>]}
[0m23:13:51.195395 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m23:13:51.196799 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m23:13:51.210716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c100cec7-cf41-4cc6-bf3a-e24484be4018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129dbf80>]}
[0m23:13:51.210980 [info ] [MainThread]: Found 17 models, 9 sources, 469 macros
[0m23:13:51.211136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c100cec7-cf41-4cc6-bf3a-e24484be4018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117d5fa0>]}
[0m23:13:51.212145 [info ] [MainThread]: 
[0m23:13:51.212307 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m23:13:51.212433 [info ] [MainThread]: 
[0m23:13:51.212655 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:13:51.215059 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_an_data_pipeline'
[0m23:13:51.299655 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline"
[0m23:13:51.299885 [debug] [ThreadPool]: On list_an_data_pipeline: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"an_data_pipeline"'
    
  
  
[0m23:13:51.300029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:13:55.970841 [debug] [ThreadPool]: SQL status: OK in 4.671 seconds
[0m23:13:55.972015 [debug] [ThreadPool]: On list_an_data_pipeline: Close
[0m23:13:55.972403 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_an_data_pipeline, now create_an_data_pipeline_main)
[0m23:13:55.972662 [debug] [ThreadPool]: Creating schema "database: "an_data_pipeline"
schema: "main"
"
[0m23:13:55.978920 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m23:13:55.979292 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:13:55.979442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:13:55.980711 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:13:55.981610 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m23:13:55.981785 [debug] [ThreadPool]: On create_an_data_pipeline_main: BEGIN
[0m23:13:55.982326 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:13:55.982473 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m23:13:55.982998 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
    
        create schema if not exists "an_data_pipeline"."main"
    
[0m23:13:56.088997 [debug] [ThreadPool]: SQL status: OK in 0.106 seconds
[0m23:13:56.089548 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m23:13:56.089699 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m23:13:56.089821 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m23:13:56.191856 [debug] [ThreadPool]: SQL status: OK in 0.102 seconds
[0m23:13:56.192956 [debug] [ThreadPool]: On create_an_data_pipeline_main: Close
[0m23:13:56.198011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_an_data_pipeline_main, now list_an_data_pipeline_main)
[0m23:13:56.209339 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m23:13:56.209900 [debug] [ThreadPool]: On list_an_data_pipeline_main: BEGIN
[0m23:13:56.210253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:13:56.213090 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m23:13:56.213858 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m23:13:56.214246 [debug] [ThreadPool]: On list_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline_main"} */
select
      'an_data_pipeline' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'an_data_pipeline'
  
[0m23:13:56.227277 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m23:13:56.228310 [debug] [ThreadPool]: On list_an_data_pipeline_main: ROLLBACK
[0m23:13:56.229265 [debug] [ThreadPool]: Failed to rollback 'list_an_data_pipeline_main'
[0m23:13:56.229414 [debug] [ThreadPool]: On list_an_data_pipeline_main: Close
[0m23:13:56.229773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c100cec7-cf41-4cc6-bf3a-e24484be4018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110f7fe0>]}
[0m23:13:56.230068 [debug] [MainThread]: Using duckdb connection "master"
[0m23:13:56.230217 [debug] [MainThread]: On master: BEGIN
[0m23:13:56.230346 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:13:56.230922 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:13:56.231061 [debug] [MainThread]: On master: COMMIT
[0m23:13:56.231186 [debug] [MainThread]: Using duckdb connection "master"
[0m23:13:56.231302 [debug] [MainThread]: On master: COMMIT
[0m23:13:56.231519 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:13:56.231645 [debug] [MainThread]: On master: Close
[0m23:13:56.233159 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_acteurs
[0m23:13:56.233429 [info ] [Thread-1 (]: 1 of 17 START sql view model main.stg_acteurs .................................. [RUN]
[0m23:13:56.233642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_an_data_pipeline_main, now model.dbt_an_data.stg_acteurs)
[0m23:13:56.233797 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_acteurs
[0m23:13:56.237340 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_acteurs"
[0m23:13:56.238250 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_acteurs
[0m23:13:56.253581 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_acteurs"
[0m23:13:56.254108 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m23:13:56.254276 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: BEGIN
[0m23:13:56.254419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:56.255061 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:13:56.255249 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m23:13:56.255411 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_acteurs"} */

  
  create view "an_data_pipeline"."main"."stg_acteurs__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_acteurs"
  );

[0m23:13:56.364446 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_acteurs"} */

  
  create view "an_data_pipeline"."main"."stg_acteurs__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_acteurs"
  );

[0m23:13:56.365167 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:13:56.365782 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: ROLLBACK
[0m23:13:56.374842 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_an_data.stg_acteurs'
[0m23:13:56.375085 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: Close
[0m23:13:56.376626 [debug] [Thread-1 (]: Runtime Error in model stg_acteurs (models/stg/stg_acteurs.sql)
  Binder Error: Catalog "database" does not exist!
[0m23:13:56.377779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c100cec7-cf41-4cc6-bf3a-e24484be4018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c18ec0>]}
[0m23:13:56.378121 [error] [Thread-1 (]: 1 of 17 ERROR creating sql view model main.stg_acteurs ......................... [[31mERROR[0m in 0.14s]
[0m23:13:56.378382 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_acteurs
[0m23:13:56.378563 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_agenda
[0m23:13:56.378799 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.stg_acteurs' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_acteurs (models/stg/stg_acteurs.sql)
  Binder Error: Catalog "database" does not exist!.
[0m23:13:56.379046 [info ] [Thread-1 (]: 2 of 17 START sql view model main.stg_agenda ................................... [RUN]
[0m23:13:56.379660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_acteurs, now model.dbt_an_data.stg_agenda)
[0m23:13:56.379836 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_agenda
[0m23:13:56.381279 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_agenda"
[0m23:13:56.381918 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_agenda
[0m23:13:56.383263 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_agenda"
[0m23:13:56.383725 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m23:13:56.383885 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: BEGIN
[0m23:13:56.384021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:56.384630 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:13:56.384781 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m23:13:56.384925 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_agenda"} */

  
  create view "an_data_pipeline"."main"."stg_agenda__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_agenda"
  );

[0m23:13:56.489334 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_agenda"} */

  
  create view "an_data_pipeline"."main"."stg_agenda__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_agenda"
  );

[0m23:13:56.490487 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:13:56.491159 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: ROLLBACK
[0m23:13:56.495680 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_an_data.stg_agenda'
[0m23:13:56.496211 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: Close
[0m23:13:56.500057 [debug] [Thread-1 (]: Runtime Error in model stg_agenda (models/stg/stg_agenda.sql)
  Binder Error: Catalog "database" does not exist!
[0m23:13:56.500925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c100cec7-cf41-4cc6-bf3a-e24484be4018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ec7c80>]}
[0m23:13:56.502018 [error] [Thread-1 (]: 2 of 17 ERROR creating sql view model main.stg_agenda .......................... [[31mERROR[0m in 0.12s]
[0m23:13:56.503051 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_agenda
[0m23:13:56.503569 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_amendements
[0m23:13:56.504132 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.stg_agenda' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_agenda (models/stg/stg_agenda.sql)
  Binder Error: Catalog "database" does not exist!.
[0m23:13:56.504676 [info ] [Thread-1 (]: 3 of 17 START sql view model main.stg_amendements .............................. [RUN]
[0m23:13:56.505472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_agenda, now model.dbt_an_data.stg_amendements)
[0m23:13:56.505917 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_amendements
[0m23:13:56.509338 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_amendements"
[0m23:13:56.510290 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_amendements
[0m23:13:56.512411 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_amendements"
[0m23:13:56.512936 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m23:13:56.513144 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: BEGIN
[0m23:13:56.513314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:56.514033 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:13:56.514203 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m23:13:56.514359 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_amendements"} */

  
  create view "an_data_pipeline"."main"."stg_amendements__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_amendements"
  );

[0m23:13:56.623527 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_amendements"} */

  
  create view "an_data_pipeline"."main"."stg_amendements__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_amendements"
  );

[0m23:13:56.624775 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:13:56.625762 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: ROLLBACK
[0m23:13:56.632027 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_an_data.stg_amendements'
[0m23:13:56.632643 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: Close
[0m23:13:56.636834 [debug] [Thread-1 (]: Runtime Error in model stg_amendements (models/stg/stg_amendements.sql)
  Binder Error: Catalog "database" does not exist!
[0m23:13:56.637544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c100cec7-cf41-4cc6-bf3a-e24484be4018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112edd220>]}
[0m23:13:56.638397 [error] [Thread-1 (]: 3 of 17 ERROR creating sql view model main.stg_amendements ..................... [[31mERROR[0m in 0.13s]
[0m23:13:56.639108 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_amendements
[0m23:13:56.639606 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_organes
[0m23:13:56.640442 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.stg_amendements' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_amendements (models/stg/stg_amendements.sql)
  Binder Error: Catalog "database" does not exist!.
[0m23:13:56.641509 [info ] [Thread-1 (]: 4 of 17 START sql view model main.stg_organes .................................. [RUN]
[0m23:13:56.642746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_amendements, now model.dbt_an_data.stg_organes)
[0m23:13:56.643485 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_organes
[0m23:13:56.647420 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_organes"
[0m23:13:56.648516 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_organes
[0m23:13:56.652187 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_organes"
[0m23:13:56.652873 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m23:13:56.653240 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: BEGIN
[0m23:13:56.653570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:56.654770 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:13:56.655113 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m23:13:56.655449 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_organes"} */

  
  create view "an_data_pipeline"."main"."stg_organes__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_organes"
  );

[0m23:13:56.761573 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_organes"} */

  
  create view "an_data_pipeline"."main"."stg_organes__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_organes"
  );

[0m23:13:56.762912 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:13:56.763852 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: ROLLBACK
[0m23:13:56.770643 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_an_data.stg_organes'
[0m23:13:56.771510 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: Close
[0m23:13:56.777604 [debug] [Thread-1 (]: Runtime Error in model stg_organes (models/stg/stg_organes.sql)
  Binder Error: Catalog "database" does not exist!
[0m23:13:56.778616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c100cec7-cf41-4cc6-bf3a-e24484be4018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112eff8f0>]}
[0m23:13:56.779779 [error] [Thread-1 (]: 4 of 17 ERROR creating sql view model main.stg_organes ......................... [[31mERROR[0m in 0.14s]
[0m23:13:56.780693 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_organes
[0m23:13:56.781403 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_pays
[0m23:13:56.782076 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.stg_organes' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_organes (models/stg/stg_organes.sql)
  Binder Error: Catalog "database" does not exist!.
[0m23:13:56.782740 [info ] [Thread-1 (]: 5 of 17 START sql view model main.stg_pays ..................................... [RUN]
[0m23:13:56.783733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_organes, now model.dbt_an_data.stg_pays)
[0m23:13:56.784278 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_pays
[0m23:13:56.789638 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_pays"
[0m23:13:56.790707 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_pays
[0m23:13:56.794310 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_pays"
[0m23:13:56.795175 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m23:13:56.795622 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: BEGIN
[0m23:13:56.796030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:56.797564 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:13:56.797902 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m23:13:56.798236 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_pays"} */

  
  create view "an_data_pipeline"."main"."stg_pays__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_pays"
  );

[0m23:13:56.908574 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_pays"} */

  
  create view "an_data_pipeline"."main"."stg_pays__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_pays"
  );

[0m23:13:56.909947 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:13:56.911262 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: ROLLBACK
[0m23:13:56.919527 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_an_data.stg_pays'
[0m23:13:56.920332 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: Close
[0m23:13:56.925783 [debug] [Thread-1 (]: Runtime Error in model stg_pays (models/stg/stg_pays.sql)
  Binder Error: Catalog "database" does not exist!
[0m23:13:56.926764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c100cec7-cf41-4cc6-bf3a-e24484be4018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a2a360>]}
[0m23:13:56.928099 [error] [Thread-1 (]: 5 of 17 ERROR creating sql view model main.stg_pays ............................ [[31mERROR[0m in 0.14s]
[0m23:13:56.928887 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_pays
[0m23:13:56.929469 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_reunions
[0m23:13:56.930112 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.stg_pays' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_pays (models/stg/stg_pays.sql)
  Binder Error: Catalog "database" does not exist!.
[0m23:13:56.930784 [info ] [Thread-1 (]: 6 of 17 START sql view model main.stg_reunions ................................. [RUN]
[0m23:13:56.931787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_pays, now model.dbt_an_data.stg_reunions)
[0m23:13:56.932354 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_reunions
[0m23:13:56.939587 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_reunions"
[0m23:13:56.940556 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_reunions
[0m23:13:56.944347 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_reunions"
[0m23:13:56.945151 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m23:13:56.945506 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: BEGIN
[0m23:13:56.945836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:56.947146 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:13:56.947578 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m23:13:56.947959 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_reunions"} */

  
  create view "an_data_pipeline"."main"."stg_reunions__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_reunions"
  );

[0m23:13:57.057547 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_reunions"} */

  
  create view "an_data_pipeline"."main"."stg_reunions__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_reunions"
  );

[0m23:13:57.059221 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:13:57.060675 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: ROLLBACK
[0m23:13:57.067971 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_an_data.stg_reunions'
[0m23:13:57.068718 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: Close
[0m23:13:57.073762 [debug] [Thread-1 (]: Runtime Error in model stg_reunions (models/stg/stg_reunions.sql)
  Binder Error: Catalog "database" does not exist!
[0m23:13:57.074767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c100cec7-cf41-4cc6-bf3a-e24484be4018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112efcd10>]}
[0m23:13:57.076045 [error] [Thread-1 (]: 6 of 17 ERROR creating sql view model main.stg_reunions ........................ [[31mERROR[0m in 0.14s]
[0m23:13:57.076940 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_reunions
[0m23:13:57.077592 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_scrutins
[0m23:13:57.078334 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.stg_reunions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_reunions (models/stg/stg_reunions.sql)
  Binder Error: Catalog "database" does not exist!.
[0m23:13:57.079427 [info ] [Thread-1 (]: 7 of 17 START sql view model main.stg_scrutins ................................. [RUN]
[0m23:13:57.080705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_reunions, now model.dbt_an_data.stg_scrutins)
[0m23:13:57.081463 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_scrutins
[0m23:13:57.085683 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_scrutins"
[0m23:13:57.087367 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_scrutins
[0m23:13:57.091007 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_scrutins"
[0m23:13:57.091717 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m23:13:57.092086 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: BEGIN
[0m23:13:57.092428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:57.093698 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:13:57.094031 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m23:13:57.094372 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_scrutins"} */

  
  create view "an_data_pipeline"."main"."stg_scrutins__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_scrutins"
  );

[0m23:13:57.201563 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_scrutins"} */

  
  create view "an_data_pipeline"."main"."stg_scrutins__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_scrutins"
  );

[0m23:13:57.203092 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:13:57.204375 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: ROLLBACK
[0m23:13:57.210433 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_an_data.stg_scrutins'
[0m23:13:57.211013 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: Close
[0m23:13:57.215727 [debug] [Thread-1 (]: Runtime Error in model stg_scrutins (models/stg/stg_scrutins.sql)
  Binder Error: Catalog "database" does not exist!
[0m23:13:57.216774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c100cec7-cf41-4cc6-bf3a-e24484be4018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d303b0>]}
[0m23:13:57.218144 [error] [Thread-1 (]: 7 of 17 ERROR creating sql view model main.stg_scrutins ........................ [[31mERROR[0m in 0.14s]
[0m23:13:57.219026 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_scrutins
[0m23:13:57.219676 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_acteurs
[0m23:13:57.220446 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.stg_scrutins' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_scrutins (models/stg/stg_scrutins.sql)
  Binder Error: Catalog "database" does not exist!.
[0m23:13:57.221113 [info ] [Thread-1 (]: 8 of 17 SKIP relation main.int_acteurs ......................................... [[33mSKIP[0m]
[0m23:13:57.221938 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_acteurs
[0m23:13:57.222438 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_mandats
[0m23:13:57.222954 [info ] [Thread-1 (]: 9 of 17 SKIP relation main.int_mandats ......................................... [[33mSKIP[0m]
[0m23:13:57.223477 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_mandats
[0m23:13:57.223921 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_agenda
[0m23:13:57.224399 [info ] [Thread-1 (]: 10 of 17 SKIP relation main.int_agenda ......................................... [[33mSKIP[0m]
[0m23:13:57.224900 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_agenda
[0m23:13:57.225359 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements
[0m23:13:57.225819 [info ] [Thread-1 (]: 11 of 17 SKIP relation main.int_amendements .................................... [[33mSKIP[0m]
[0m23:13:57.226309 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements
[0m23:13:57.226752 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements_cosignataires
[0m23:13:57.227240 [info ] [Thread-1 (]: 12 of 17 SKIP relation main.int_amendements_cosignataires ...................... [[33mSKIP[0m]
[0m23:13:57.227754 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements_cosignataires
[0m23:13:57.228214 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_organes
[0m23:13:57.228682 [info ] [Thread-1 (]: 13 of 17 SKIP relation main.int_organes ........................................ [[33mSKIP[0m]
[0m23:13:57.229087 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_organes
[0m23:13:57.229433 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_pays
[0m23:13:57.229804 [info ] [Thread-1 (]: 14 of 17 SKIP relation main.int_pays ........................................... [[33mSKIP[0m]
[0m23:13:57.230199 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_pays
[0m23:13:57.230605 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_reunions
[0m23:13:57.231014 [info ] [Thread-1 (]: 15 of 17 SKIP relation main.int_reunions ....................................... [[33mSKIP[0m]
[0m23:13:57.231415 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_reunions
[0m23:13:57.231807 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins
[0m23:13:57.232171 [info ] [Thread-1 (]: 16 of 17 SKIP relation main.int_scrutins ....................................... [[33mSKIP[0m]
[0m23:13:57.232575 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins
[0m23:13:57.232938 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins_votes
[0m23:13:57.233313 [info ] [Thread-1 (]: 17 of 17 SKIP relation main.int_scrutins_votes ................................. [[33mSKIP[0m]
[0m23:13:57.233697 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins_votes
[0m23:13:57.234907 [debug] [MainThread]: Using duckdb connection "master"
[0m23:13:57.235227 [debug] [MainThread]: On master: BEGIN
[0m23:13:57.235497 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:13:57.236636 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:13:57.236931 [debug] [MainThread]: On master: COMMIT
[0m23:13:57.237206 [debug] [MainThread]: Using duckdb connection "master"
[0m23:13:57.237467 [debug] [MainThread]: On master: COMMIT
[0m23:13:57.237943 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:13:57.238221 [debug] [MainThread]: On master: Close
[0m23:13:57.238582 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:13:57.238846 [debug] [MainThread]: Connection 'model.dbt_an_data.stg_scrutins' was properly closed.
[0m23:13:57.239228 [info ] [MainThread]: 
[0m23:13:57.239539 [info ] [MainThread]: Finished running 10 incremental models, 7 view models in 0 hours 0 minutes and 6.03 seconds (6.03s).
[0m23:13:57.241091 [debug] [MainThread]: Command end result
[0m23:13:57.262054 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m23:13:57.263455 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m23:13:57.267891 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m23:13:57.268127 [info ] [MainThread]: 
[0m23:13:57.268336 [info ] [MainThread]: [31mCompleted with 7 errors, 0 partial successes, and 0 warnings:[0m
[0m23:13:57.268508 [info ] [MainThread]: 
[0m23:13:57.268724 [error] [MainThread]: [31mFailure in model stg_acteurs (models/stg/stg_acteurs.sql)[0m
[0m23:13:57.268918 [error] [MainThread]:   Runtime Error in model stg_acteurs (models/stg/stg_acteurs.sql)
  Binder Error: Catalog "database" does not exist!
[0m23:13:57.269061 [info ] [MainThread]: 
[0m23:13:57.269237 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/stg/stg_acteurs.sql
[0m23:13:57.269385 [info ] [MainThread]: 
[0m23:13:57.269563 [error] [MainThread]: [31mFailure in model stg_agenda (models/stg/stg_agenda.sql)[0m
[0m23:13:57.269738 [error] [MainThread]:   Runtime Error in model stg_agenda (models/stg/stg_agenda.sql)
  Binder Error: Catalog "database" does not exist!
[0m23:13:57.269876 [info ] [MainThread]: 
[0m23:13:57.270045 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/stg/stg_agenda.sql
[0m23:13:57.270186 [info ] [MainThread]: 
[0m23:13:57.270359 [error] [MainThread]: [31mFailure in model stg_amendements (models/stg/stg_amendements.sql)[0m
[0m23:13:57.270538 [error] [MainThread]:   Runtime Error in model stg_amendements (models/stg/stg_amendements.sql)
  Binder Error: Catalog "database" does not exist!
[0m23:13:57.270675 [info ] [MainThread]: 
[0m23:13:57.270846 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/stg/stg_amendements.sql
[0m23:13:57.270982 [info ] [MainThread]: 
[0m23:13:57.271152 [error] [MainThread]: [31mFailure in model stg_organes (models/stg/stg_organes.sql)[0m
[0m23:13:57.271328 [error] [MainThread]:   Runtime Error in model stg_organes (models/stg/stg_organes.sql)
  Binder Error: Catalog "database" does not exist!
[0m23:13:57.271463 [info ] [MainThread]: 
[0m23:13:57.271626 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/stg/stg_organes.sql
[0m23:13:57.271759 [info ] [MainThread]: 
[0m23:13:57.271929 [error] [MainThread]: [31mFailure in model stg_pays (models/stg/stg_pays.sql)[0m
[0m23:13:57.272099 [error] [MainThread]:   Runtime Error in model stg_pays (models/stg/stg_pays.sql)
  Binder Error: Catalog "database" does not exist!
[0m23:13:57.272236 [info ] [MainThread]: 
[0m23:13:57.272397 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/stg/stg_pays.sql
[0m23:13:57.272534 [info ] [MainThread]: 
[0m23:13:57.272702 [error] [MainThread]: [31mFailure in model stg_reunions (models/stg/stg_reunions.sql)[0m
[0m23:13:57.272872 [error] [MainThread]:   Runtime Error in model stg_reunions (models/stg/stg_reunions.sql)
  Binder Error: Catalog "database" does not exist!
[0m23:13:57.273022 [info ] [MainThread]: 
[0m23:13:57.273183 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/stg/stg_reunions.sql
[0m23:13:57.273318 [info ] [MainThread]: 
[0m23:13:57.273485 [error] [MainThread]: [31mFailure in model stg_scrutins (models/stg/stg_scrutins.sql)[0m
[0m23:13:57.273656 [error] [MainThread]:   Runtime Error in model stg_scrutins (models/stg/stg_scrutins.sql)
  Binder Error: Catalog "database" does not exist!
[0m23:13:57.273789 [info ] [MainThread]: 
[0m23:13:57.273948 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/stg/stg_scrutins.sql
[0m23:13:57.274087 [info ] [MainThread]: 
[0m23:13:57.274255 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=7 SKIP=10 NO-OP=0 TOTAL=17
[0m23:13:57.274768 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.972408, "process_in_blocks": "0", "process_kernel_time": 0.45623, "process_mem_max_rss": "289177600", "process_out_blocks": "0", "process_user_time": 2.355217}
[0m23:13:57.275063 [debug] [MainThread]: Command `dbt run` failed at 23:13:57.275010 after 6.97 seconds
[0m23:13:57.275337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111673ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d7efc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d7ebd0>]}
[0m23:13:57.275574 [debug] [MainThread]: Flushing usage events
[0m23:13:57.899470 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:18:49.241411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095f96d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a7b470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a7b140>]}


============================== 23:18:49.244583 | 59895efa-b80b-4fcd-83b7-e354c894d635 ==============================
[0m23:18:49.244583 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:18:49.244899 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'empty': 'False', 'debug': 'False', 'no_print': 'None', 'static_parser': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'warn_error': 'None', 'quiet': 'False', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'cache_selected_only': 'False', 'log_format': 'default', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'use_colors': 'True', 'target_path': 'None', 'write_json': 'True', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs'}
[0m23:18:49.421496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59895efa-b80b-4fcd-83b7-e354c894d635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093428d0>]}
[0m23:18:49.448646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59895efa-b80b-4fcd-83b7-e354c894d635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d24fe0>]}
[0m23:18:49.449935 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m23:18:49.507930 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m23:18:49.572828 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:18:49.573540 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/sources.yml
[0m23:18:49.743718 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_an_data.mart
[0m23:18:49.748134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59895efa-b80b-4fcd-83b7-e354c894d635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2178c0>]}
[0m23:18:49.778511 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m23:18:49.780224 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m23:18:49.793844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59895efa-b80b-4fcd-83b7-e354c894d635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1cf8f0>]}
[0m23:18:49.794100 [info ] [MainThread]: Found 17 models, 9 sources, 469 macros
[0m23:18:49.794257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59895efa-b80b-4fcd-83b7-e354c894d635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a193650>]}
[0m23:18:49.795310 [info ] [MainThread]: 
[0m23:18:49.795474 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m23:18:49.795601 [info ] [MainThread]: 
[0m23:18:49.795829 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:18:49.798231 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_an_data_pipeline'
[0m23:18:49.929334 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline"
[0m23:18:49.929564 [debug] [ThreadPool]: On list_an_data_pipeline: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"an_data_pipeline"'
    
  
  
[0m23:18:49.929701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:51.845143 [debug] [ThreadPool]: SQL status: OK in 1.915 seconds
[0m23:18:51.847990 [debug] [ThreadPool]: On list_an_data_pipeline: Close
[0m23:18:51.849231 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_an_data_pipeline, now create_an_data_pipeline_main)
[0m23:18:51.850087 [debug] [ThreadPool]: Creating schema "database: "an_data_pipeline"
schema: "main"
"
[0m23:18:51.860623 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m23:18:51.861275 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:18:51.861687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:18:51.864071 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:18:51.865840 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m23:18:51.866174 [debug] [ThreadPool]: On create_an_data_pipeline_main: BEGIN
[0m23:18:51.867053 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:18:51.867349 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m23:18:51.867633 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
    
        create schema if not exists "an_data_pipeline"."main"
    
[0m23:18:51.978675 [debug] [ThreadPool]: SQL status: OK in 0.110 seconds
[0m23:18:51.982080 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m23:18:51.982934 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m23:18:51.983657 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m23:18:52.089092 [debug] [ThreadPool]: SQL status: OK in 0.105 seconds
[0m23:18:52.089404 [debug] [ThreadPool]: On create_an_data_pipeline_main: Close
[0m23:18:52.090426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_an_data_pipeline_main, now list_an_data_pipeline_main)
[0m23:18:52.093248 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m23:18:52.093417 [debug] [ThreadPool]: On list_an_data_pipeline_main: BEGIN
[0m23:18:52.093543 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:18:52.094112 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:18:52.094235 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m23:18:52.094364 [debug] [ThreadPool]: On list_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline_main"} */
select
      'an_data_pipeline' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'an_data_pipeline'
  
[0m23:18:52.104174 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m23:18:52.105050 [debug] [ThreadPool]: On list_an_data_pipeline_main: ROLLBACK
[0m23:18:52.105930 [debug] [ThreadPool]: Failed to rollback 'list_an_data_pipeline_main'
[0m23:18:52.106084 [debug] [ThreadPool]: On list_an_data_pipeline_main: Close
[0m23:18:52.106379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59895efa-b80b-4fcd-83b7-e354c894d635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a217bc0>]}
[0m23:18:52.106611 [debug] [MainThread]: Using duckdb connection "master"
[0m23:18:52.106739 [debug] [MainThread]: On master: BEGIN
[0m23:18:52.106851 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:18:52.107259 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:18:52.107392 [debug] [MainThread]: On master: COMMIT
[0m23:18:52.107515 [debug] [MainThread]: Using duckdb connection "master"
[0m23:18:52.107628 [debug] [MainThread]: On master: COMMIT
[0m23:18:52.107830 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:18:52.107955 [debug] [MainThread]: On master: Close
[0m23:18:52.109317 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_acteurs
[0m23:18:52.109561 [info ] [Thread-1 (]: 1 of 17 START sql view model main.stg_acteurs .................................. [RUN]
[0m23:18:52.109759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_an_data_pipeline_main, now model.dbt_an_data.stg_acteurs)
[0m23:18:52.109910 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_acteurs
[0m23:18:52.113281 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_acteurs"
[0m23:18:52.113858 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_acteurs
[0m23:18:52.128748 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_acteurs"
[0m23:18:52.129601 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m23:18:52.129779 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: BEGIN
[0m23:18:52.129926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:52.130545 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:18:52.130702 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m23:18:52.130848 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_acteurs"} */

  
  create view "an_data_pipeline"."main"."stg_acteurs__dbt_tmp" as (
    SELECT * 
FROM "an_data_pipeline"."stg"."raw_acteurs"
  );

[0m23:18:52.238555 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_acteurs"} */

  
  create view "an_data_pipeline"."main"."stg_acteurs__dbt_tmp" as (
    SELECT * 
FROM "an_data_pipeline"."stg"."raw_acteurs"
  );

[0m23:18:52.238965 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:18:52.239368 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: ROLLBACK
[0m23:18:52.247905 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_an_data.stg_acteurs'
[0m23:18:52.248189 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: Close
[0m23:18:52.250273 [debug] [Thread-1 (]: Runtime Error in model stg_acteurs (models/stg/stg_acteurs.sql)
  Catalog Error: Table with name raw_acteurs does not exist!
  Did you mean "information_schema.character_sets"?
  
  LINE 6: FROM "an_data_pipeline"."stg"."raw_acteurs"
               ^
[0m23:18:52.251687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59895efa-b80b-4fcd-83b7-e354c894d635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cd06e0>]}
[0m23:18:52.252198 [error] [Thread-1 (]: 1 of 17 ERROR creating sql view model main.stg_acteurs ......................... [[31mERROR[0m in 0.14s]
[0m23:18:52.252635 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_acteurs
[0m23:18:52.252886 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_agenda
[0m23:18:52.253189 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.stg_acteurs' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_acteurs (models/stg/stg_acteurs.sql)
  Catalog Error: Table with name raw_acteurs does not exist!
  Did you mean "information_schema.character_sets"?
  
  LINE 6: FROM "an_data_pipeline"."stg"."raw_acteurs"
               ^.
[0m23:18:52.253479 [info ] [Thread-1 (]: 2 of 17 START sql view model main.stg_agenda ................................... [RUN]
[0m23:18:52.254200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_acteurs, now model.dbt_an_data.stg_agenda)
[0m23:18:52.254420 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_agenda
[0m23:18:52.256328 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_agenda"
[0m23:18:52.256917 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_agenda
[0m23:18:52.258759 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_agenda"
[0m23:18:52.259400 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m23:18:52.259630 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: BEGIN
[0m23:18:52.259829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:52.260531 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:18:52.260721 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m23:18:52.260904 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_agenda"} */

  
  create view "an_data_pipeline"."main"."stg_agenda__dbt_tmp" as (
    SELECT * 
FROM "an_data_pipeline"."stg"."raw_agenda"
  );

[0m23:18:52.364933 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_agenda"} */

  
  create view "an_data_pipeline"."main"."stg_agenda__dbt_tmp" as (
    SELECT * 
FROM "an_data_pipeline"."stg"."raw_agenda"
  );

[0m23:18:52.365485 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:18:52.366062 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: ROLLBACK
[0m23:18:52.370139 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_an_data.stg_agenda'
[0m23:18:52.370558 [debug] [Thread-1 (]: On model.dbt_an_data.stg_agenda: Close
[0m23:18:52.373618 [debug] [Thread-1 (]: Runtime Error in model stg_agenda (models/stg/stg_agenda.sql)
  Catalog Error: Table with name raw_agenda does not exist!
  Did you mean "main.pragma_database_list"?
  
  LINE 6: FROM "an_data_pipeline"."stg"."raw_agenda"
               ^
[0m23:18:52.374110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59895efa-b80b-4fcd-83b7-e354c894d635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a602c60>]}
[0m23:18:52.374775 [error] [Thread-1 (]: 2 of 17 ERROR creating sql view model main.stg_agenda .......................... [[31mERROR[0m in 0.12s]
[0m23:18:52.375337 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_agenda
[0m23:18:52.375739 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_amendements
[0m23:18:52.376241 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.stg_agenda' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_agenda (models/stg/stg_agenda.sql)
  Catalog Error: Table with name raw_agenda does not exist!
  Did you mean "main.pragma_database_list"?
  
  LINE 6: FROM "an_data_pipeline"."stg"."raw_agenda"
               ^.
[0m23:18:52.376782 [info ] [Thread-1 (]: 3 of 17 START sql view model main.stg_amendements .............................. [RUN]
[0m23:18:52.377457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_agenda, now model.dbt_an_data.stg_amendements)
[0m23:18:52.377859 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_amendements
[0m23:18:52.380649 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_amendements"
[0m23:18:52.382532 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_amendements
[0m23:18:52.385101 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_amendements"
[0m23:18:52.385709 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m23:18:52.386020 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: BEGIN
[0m23:18:52.386296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:52.387273 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:18:52.387535 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m23:18:52.387794 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_amendements"} */

  
  create view "an_data_pipeline"."main"."stg_amendements__dbt_tmp" as (
    SELECT * 
FROM "an_data_pipeline"."stg"."raw_amendements"
  );

[0m23:18:52.503569 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_amendements"} */

  
  create view "an_data_pipeline"."main"."stg_amendements__dbt_tmp" as (
    SELECT * 
FROM "an_data_pipeline"."stg"."raw_amendements"
  );

[0m23:18:52.505072 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:18:52.506172 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: ROLLBACK
[0m23:18:52.512197 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_an_data.stg_amendements'
[0m23:18:52.512689 [debug] [Thread-1 (]: On model.dbt_an_data.stg_amendements: Close
[0m23:18:52.517692 [debug] [Thread-1 (]: Runtime Error in model stg_amendements (models/stg/stg_amendements.sql)
  Catalog Error: Table with name raw_amendements does not exist!
  Did you mean "pg_catalog.pg_prepared_statements"?
  
  LINE 6: FROM "an_data_pipeline"."stg"."raw_amendements"
               ^
[0m23:18:52.518705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59895efa-b80b-4fcd-83b7-e354c894d635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8376e0>]}
[0m23:18:52.519821 [error] [Thread-1 (]: 3 of 17 ERROR creating sql view model main.stg_amendements ..................... [[31mERROR[0m in 0.14s]
[0m23:18:52.520549 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_amendements
[0m23:18:52.521034 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_organes
[0m23:18:52.521604 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.stg_amendements' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_amendements (models/stg/stg_amendements.sql)
  Catalog Error: Table with name raw_amendements does not exist!
  Did you mean "pg_catalog.pg_prepared_statements"?
  
  LINE 6: FROM "an_data_pipeline"."stg"."raw_amendements"
               ^.
[0m23:18:52.522208 [info ] [Thread-1 (]: 4 of 17 START sql view model main.stg_organes .................................. [RUN]
[0m23:18:52.523035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_amendements, now model.dbt_an_data.stg_organes)
[0m23:18:52.523489 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_organes
[0m23:18:52.527428 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_organes"
[0m23:18:52.528345 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_organes
[0m23:18:52.531401 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_organes"
[0m23:18:52.532073 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m23:18:52.532423 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: BEGIN
[0m23:18:52.532737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:52.533961 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:18:52.534294 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m23:18:52.534627 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_organes"} */

  
  create view "an_data_pipeline"."main"."stg_organes__dbt_tmp" as (
    SELECT * 
FROM "an_data_pipeline"."stg"."raw_organes"
  );

[0m23:18:52.646591 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_organes"} */

  
  create view "an_data_pipeline"."main"."stg_organes__dbt_tmp" as (
    SELECT * 
FROM "an_data_pipeline"."stg"."raw_organes"
  );

[0m23:18:52.647858 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:18:52.648752 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: ROLLBACK
[0m23:18:52.656042 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_an_data.stg_organes'
[0m23:18:52.656798 [debug] [Thread-1 (]: On model.dbt_an_data.stg_organes: Close
[0m23:18:52.662148 [debug] [Thread-1 (]: Runtime Error in model stg_organes (models/stg/stg_organes.sql)
  Catalog Error: Table with name raw_organes does not exist!
  Did you mean "pg_catalog.pg_namespace"?
  
  LINE 6: FROM "an_data_pipeline"."stg"."raw_organes"
               ^
[0m23:18:52.663159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59895efa-b80b-4fcd-83b7-e354c894d635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a85ab10>]}
[0m23:18:52.664227 [error] [Thread-1 (]: 4 of 17 ERROR creating sql view model main.stg_organes ......................... [[31mERROR[0m in 0.14s]
[0m23:18:52.664987 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_organes
[0m23:18:52.665527 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_pays
[0m23:18:52.666140 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.stg_organes' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_organes (models/stg/stg_organes.sql)
  Catalog Error: Table with name raw_organes does not exist!
  Did you mean "pg_catalog.pg_namespace"?
  
  LINE 6: FROM "an_data_pipeline"."stg"."raw_organes"
               ^.
[0m23:18:52.666747 [info ] [Thread-1 (]: 5 of 17 START sql view model main.stg_pays ..................................... [RUN]
[0m23:18:52.668121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_organes, now model.dbt_an_data.stg_pays)
[0m23:18:52.668878 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_pays
[0m23:18:52.673305 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_pays"
[0m23:18:52.674284 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_pays
[0m23:18:52.677977 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_pays"
[0m23:18:52.678778 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m23:18:52.679137 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: BEGIN
[0m23:18:52.679463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:52.680917 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:18:52.681332 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m23:18:52.681710 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_pays"} */

  
  create view "an_data_pipeline"."main"."stg_pays__dbt_tmp" as (
    SELECT * 
FROM "an_data_pipeline"."stg"."raw_pays"
  );

[0m23:18:52.790373 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_pays"} */

  
  create view "an_data_pipeline"."main"."stg_pays__dbt_tmp" as (
    SELECT * 
FROM "an_data_pipeline"."stg"."raw_pays"
  );

[0m23:18:52.791542 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:18:52.792443 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: ROLLBACK
[0m23:18:52.799016 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_an_data.stg_pays'
[0m23:18:52.799737 [debug] [Thread-1 (]: On model.dbt_an_data.stg_pays: Close
[0m23:18:52.804809 [debug] [Thread-1 (]: Runtime Error in model stg_pays (models/stg/stg_pays.sql)
  Catalog Error: Table with name raw_pays does not exist!
  Did you mean "pg_catalog.pg_database"?
  
  LINE 6: FROM "an_data_pipeline"."stg"."raw_pays"
               ^
[0m23:18:52.805803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59895efa-b80b-4fcd-83b7-e354c894d635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a867140>]}
[0m23:18:52.807012 [error] [Thread-1 (]: 5 of 17 ERROR creating sql view model main.stg_pays ............................ [[31mERROR[0m in 0.14s]
[0m23:18:52.807897 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_pays
[0m23:18:52.808530 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_reunions
[0m23:18:52.809622 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.stg_pays' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_pays (models/stg/stg_pays.sql)
  Catalog Error: Table with name raw_pays does not exist!
  Did you mean "pg_catalog.pg_database"?
  
  LINE 6: FROM "an_data_pipeline"."stg"."raw_pays"
               ^.
[0m23:18:52.810584 [info ] [Thread-1 (]: 6 of 17 START sql view model main.stg_reunions ................................. [RUN]
[0m23:18:52.811736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_pays, now model.dbt_an_data.stg_reunions)
[0m23:18:52.812374 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_reunions
[0m23:18:52.818880 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_reunions"
[0m23:18:52.819811 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_reunions
[0m23:18:52.822899 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_reunions"
[0m23:18:52.823657 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m23:18:52.824021 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: BEGIN
[0m23:18:52.824360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:52.825786 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:18:52.826257 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m23:18:52.826649 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_reunions"} */

  
  create view "an_data_pipeline"."main"."stg_reunions__dbt_tmp" as (
    SELECT * 
FROM "an_data_pipeline"."stg"."raw_reunions"
  );

[0m23:18:52.939133 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_reunions"} */

  
  create view "an_data_pipeline"."main"."stg_reunions__dbt_tmp" as (
    SELECT * 
FROM "an_data_pipeline"."stg"."raw_reunions"
  );

[0m23:18:52.940850 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:18:52.942255 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: ROLLBACK
[0m23:18:52.950184 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_an_data.stg_reunions'
[0m23:18:52.950967 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: Close
[0m23:18:52.956085 [debug] [Thread-1 (]: Runtime Error in model stg_reunions (models/stg/stg_reunions.sql)
  Catalog Error: Table with name raw_reunions does not exist!
  Did you mean "information_schema.referential_constraints"?
  
  LINE 6: FROM "an_data_pipeline"."stg"."raw_reunions"
               ^
[0m23:18:52.957011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59895efa-b80b-4fcd-83b7-e354c894d635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a855190>]}
[0m23:18:52.958140 [error] [Thread-1 (]: 6 of 17 ERROR creating sql view model main.stg_reunions ........................ [[31mERROR[0m in 0.15s]
[0m23:18:52.959017 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_reunions
[0m23:18:52.959671 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_scrutins
[0m23:18:52.960437 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.stg_reunions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_reunions (models/stg/stg_reunions.sql)
  Catalog Error: Table with name raw_reunions does not exist!
  Did you mean "information_schema.referential_constraints"?
  
  LINE 6: FROM "an_data_pipeline"."stg"."raw_reunions"
               ^.
[0m23:18:52.961438 [info ] [Thread-1 (]: 7 of 17 START sql view model main.stg_scrutins ................................. [RUN]
[0m23:18:52.962582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_reunions, now model.dbt_an_data.stg_scrutins)
[0m23:18:52.963258 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_scrutins
[0m23:18:52.967502 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_scrutins"
[0m23:18:52.968532 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_scrutins
[0m23:18:52.972261 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_scrutins"
[0m23:18:52.972931 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m23:18:52.973290 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: BEGIN
[0m23:18:52.973610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:52.974789 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:18:52.975120 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m23:18:52.975455 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_scrutins"} */

  
  create view "an_data_pipeline"."main"."stg_scrutins__dbt_tmp" as (
    SELECT * 
FROM "an_data_pipeline"."stg"."raw_scrutins"
  );

[0m23:18:53.087154 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_scrutins"} */

  
  create view "an_data_pipeline"."main"."stg_scrutins__dbt_tmp" as (
    SELECT * 
FROM "an_data_pipeline"."stg"."raw_scrutins"
  );

[0m23:18:53.088999 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:18:53.090400 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: ROLLBACK
[0m23:18:53.097634 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_an_data.stg_scrutins'
[0m23:18:53.098282 [debug] [Thread-1 (]: On model.dbt_an_data.stg_scrutins: Close
[0m23:18:53.103250 [debug] [Thread-1 (]: Runtime Error in model stg_scrutins (models/stg/stg_scrutins.sql)
  Catalog Error: Table with name raw_scrutins does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 6: FROM "an_data_pipeline"."stg"."raw_scrutins"
               ^
[0m23:18:53.104178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59895efa-b80b-4fcd-83b7-e354c894d635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a61d970>]}
[0m23:18:53.105798 [error] [Thread-1 (]: 7 of 17 ERROR creating sql view model main.stg_scrutins ........................ [[31mERROR[0m in 0.14s]
[0m23:18:53.106973 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_scrutins
[0m23:18:53.107655 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_acteurs
[0m23:18:53.108392 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.stg_scrutins' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_scrutins (models/stg/stg_scrutins.sql)
  Catalog Error: Table with name raw_scrutins does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 6: FROM "an_data_pipeline"."stg"."raw_scrutins"
               ^.
[0m23:18:53.109080 [info ] [Thread-1 (]: 8 of 17 SKIP relation main.int_acteurs ......................................... [[33mSKIP[0m]
[0m23:18:53.109877 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_acteurs
[0m23:18:53.110355 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_mandats
[0m23:18:53.110874 [info ] [Thread-1 (]: 9 of 17 SKIP relation main.int_mandats ......................................... [[33mSKIP[0m]
[0m23:18:53.111371 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_mandats
[0m23:18:53.111810 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_agenda
[0m23:18:53.112272 [info ] [Thread-1 (]: 10 of 17 SKIP relation main.int_agenda ......................................... [[33mSKIP[0m]
[0m23:18:53.112764 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_agenda
[0m23:18:53.113196 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements
[0m23:18:53.113668 [info ] [Thread-1 (]: 11 of 17 SKIP relation main.int_amendements .................................... [[33mSKIP[0m]
[0m23:18:53.114165 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements
[0m23:18:53.114616 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements_cosignataires
[0m23:18:53.115085 [info ] [Thread-1 (]: 12 of 17 SKIP relation main.int_amendements_cosignataires ...................... [[33mSKIP[0m]
[0m23:18:53.115570 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements_cosignataires
[0m23:18:53.116006 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_organes
[0m23:18:53.116467 [info ] [Thread-1 (]: 13 of 17 SKIP relation main.int_organes ........................................ [[33mSKIP[0m]
[0m23:18:53.116925 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_organes
[0m23:18:53.117306 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_pays
[0m23:18:53.117736 [info ] [Thread-1 (]: 14 of 17 SKIP relation main.int_pays ........................................... [[33mSKIP[0m]
[0m23:18:53.118188 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_pays
[0m23:18:53.118575 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_reunions
[0m23:18:53.118970 [info ] [Thread-1 (]: 15 of 17 SKIP relation main.int_reunions ....................................... [[33mSKIP[0m]
[0m23:18:53.119378 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_reunions
[0m23:18:53.119736 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins
[0m23:18:53.120180 [info ] [Thread-1 (]: 16 of 17 SKIP relation main.int_scrutins ....................................... [[33mSKIP[0m]
[0m23:18:53.120666 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins
[0m23:18:53.121067 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins_votes
[0m23:18:53.121458 [info ] [Thread-1 (]: 17 of 17 SKIP relation main.int_scrutins_votes ................................. [[33mSKIP[0m]
[0m23:18:53.121849 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins_votes
[0m23:18:53.123012 [debug] [MainThread]: Using duckdb connection "master"
[0m23:18:53.123343 [debug] [MainThread]: On master: BEGIN
[0m23:18:53.123619 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:18:53.124786 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:18:53.125085 [debug] [MainThread]: On master: COMMIT
[0m23:18:53.125365 [debug] [MainThread]: Using duckdb connection "master"
[0m23:18:53.125631 [debug] [MainThread]: On master: COMMIT
[0m23:18:53.126111 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:18:53.126402 [debug] [MainThread]: On master: Close
[0m23:18:53.126772 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:18:53.127034 [debug] [MainThread]: Connection 'model.dbt_an_data.stg_scrutins' was properly closed.
[0m23:18:53.127424 [info ] [MainThread]: 
[0m23:18:53.127733 [info ] [MainThread]: Finished running 10 incremental models, 7 view models in 0 hours 0 minutes and 3.33 seconds (3.33s).
[0m23:18:53.129236 [debug] [MainThread]: Command end result
[0m23:18:53.151338 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m23:18:53.152762 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m23:18:53.157219 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m23:18:53.157429 [info ] [MainThread]: 
[0m23:18:53.157645 [info ] [MainThread]: [31mCompleted with 7 errors, 0 partial successes, and 0 warnings:[0m
[0m23:18:53.157827 [info ] [MainThread]: 
[0m23:18:53.158044 [error] [MainThread]: [31mFailure in model stg_acteurs (models/stg/stg_acteurs.sql)[0m
[0m23:18:53.158251 [error] [MainThread]:   Runtime Error in model stg_acteurs (models/stg/stg_acteurs.sql)
  Catalog Error: Table with name raw_acteurs does not exist!
  Did you mean "information_schema.character_sets"?
  
  LINE 6: FROM "an_data_pipeline"."stg"."raw_acteurs"
               ^
[0m23:18:53.158407 [info ] [MainThread]: 
[0m23:18:53.158588 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/stg/stg_acteurs.sql
[0m23:18:53.158739 [info ] [MainThread]: 
[0m23:18:53.158925 [error] [MainThread]: [31mFailure in model stg_agenda (models/stg/stg_agenda.sql)[0m
[0m23:18:53.159111 [error] [MainThread]:   Runtime Error in model stg_agenda (models/stg/stg_agenda.sql)
  Catalog Error: Table with name raw_agenda does not exist!
  Did you mean "main.pragma_database_list"?
  
  LINE 6: FROM "an_data_pipeline"."stg"."raw_agenda"
               ^
[0m23:18:53.159256 [info ] [MainThread]: 
[0m23:18:53.159425 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/stg/stg_agenda.sql
[0m23:18:53.159575 [info ] [MainThread]: 
[0m23:18:53.159755 [error] [MainThread]: [31mFailure in model stg_amendements (models/stg/stg_amendements.sql)[0m
[0m23:18:53.159935 [error] [MainThread]:   Runtime Error in model stg_amendements (models/stg/stg_amendements.sql)
  Catalog Error: Table with name raw_amendements does not exist!
  Did you mean "pg_catalog.pg_prepared_statements"?
  
  LINE 6: FROM "an_data_pipeline"."stg"."raw_amendements"
               ^
[0m23:18:53.160078 [info ] [MainThread]: 
[0m23:18:53.160244 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/stg/stg_amendements.sql
[0m23:18:53.160390 [info ] [MainThread]: 
[0m23:18:53.160564 [error] [MainThread]: [31mFailure in model stg_organes (models/stg/stg_organes.sql)[0m
[0m23:18:53.160743 [error] [MainThread]:   Runtime Error in model stg_organes (models/stg/stg_organes.sql)
  Catalog Error: Table with name raw_organes does not exist!
  Did you mean "pg_catalog.pg_namespace"?
  
  LINE 6: FROM "an_data_pipeline"."stg"."raw_organes"
               ^
[0m23:18:53.160887 [info ] [MainThread]: 
[0m23:18:53.161050 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/stg/stg_organes.sql
[0m23:18:53.161190 [info ] [MainThread]: 
[0m23:18:53.161361 [error] [MainThread]: [31mFailure in model stg_pays (models/stg/stg_pays.sql)[0m
[0m23:18:53.161536 [error] [MainThread]:   Runtime Error in model stg_pays (models/stg/stg_pays.sql)
  Catalog Error: Table with name raw_pays does not exist!
  Did you mean "pg_catalog.pg_database"?
  
  LINE 6: FROM "an_data_pipeline"."stg"."raw_pays"
               ^
[0m23:18:53.161672 [info ] [MainThread]: 
[0m23:18:53.161837 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/stg/stg_pays.sql
[0m23:18:53.161981 [info ] [MainThread]: 
[0m23:18:53.162155 [error] [MainThread]: [31mFailure in model stg_reunions (models/stg/stg_reunions.sql)[0m
[0m23:18:53.162334 [error] [MainThread]:   Runtime Error in model stg_reunions (models/stg/stg_reunions.sql)
  Catalog Error: Table with name raw_reunions does not exist!
  Did you mean "information_schema.referential_constraints"?
  
  LINE 6: FROM "an_data_pipeline"."stg"."raw_reunions"
               ^
[0m23:18:53.162477 [info ] [MainThread]: 
[0m23:18:53.162643 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/stg/stg_reunions.sql
[0m23:18:53.162781 [info ] [MainThread]: 
[0m23:18:53.162953 [error] [MainThread]: [31mFailure in model stg_scrutins (models/stg/stg_scrutins.sql)[0m
[0m23:18:53.163132 [error] [MainThread]:   Runtime Error in model stg_scrutins (models/stg/stg_scrutins.sql)
  Catalog Error: Table with name raw_scrutins does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 6: FROM "an_data_pipeline"."stg"."raw_scrutins"
               ^
[0m23:18:53.163271 [info ] [MainThread]: 
[0m23:18:53.163434 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/stg/stg_scrutins.sql
[0m23:18:53.163578 [info ] [MainThread]: 
[0m23:18:53.163751 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=7 SKIP=10 NO-OP=0 TOTAL=17
[0m23:18:53.164124 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.960008, "process_in_blocks": "0", "process_kernel_time": 0.418569, "process_mem_max_rss": "167739392", "process_out_blocks": "0", "process_user_time": 1.976768}
[0m23:18:53.164355 [debug] [MainThread]: Command `dbt run` failed at 23:18:53.164312 after 3.96 seconds
[0m23:18:53.164553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d69a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a7b5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a7b2f0>]}
[0m23:18:53.164741 [debug] [MainThread]: Flushing usage events
[0m23:18:53.845453 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:22:35.159218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c4c3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f475c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c24a40>]}


============================== 23:22:35.162411 | ebd77f3b-d3a6-4b33-a472-b5bcc04dc8f0 ==============================
[0m23:22:35.162411 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:22:35.162723 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'empty': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_format': 'default', 'no_print': 'None', 'write_json': 'True', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'use_experimental_parser': 'False', 'target_path': 'None', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'version_check': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'debug': 'False', 'quiet': 'False'}
[0m23:22:35.338990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebd77f3b-d3a6-4b33-a472-b5bcc04dc8f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10512f740>]}
[0m23:22:35.365874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebd77f3b-d3a6-4b33-a472-b5bcc04dc8f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042caba0>]}
[0m23:22:35.367305 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m23:22:35.423968 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m23:22:35.460774 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m23:22:35.461036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ebd77f3b-d3a6-4b33-a472-b5bcc04dc8f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048b6420>]}
[0m23:22:35.982418 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_an_data.mart
[0m23:22:35.986812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebd77f3b-d3a6-4b33-a472-b5bcc04dc8f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10503dbe0>]}
[0m23:22:36.017132 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m23:22:36.018496 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m23:22:36.031610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebd77f3b-d3a6-4b33-a472-b5bcc04dc8f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c8530>]}
[0m23:22:36.031863 [info ] [MainThread]: Found 17 models, 9 sources, 469 macros
[0m23:22:36.032019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebd77f3b-d3a6-4b33-a472-b5bcc04dc8f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056fdc10>]}
[0m23:22:36.033035 [info ] [MainThread]: 
[0m23:22:36.033208 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m23:22:36.033331 [info ] [MainThread]: 
[0m23:22:36.033558 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:22:36.035906 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_an_data_pipeline'
[0m23:22:36.120430 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline"
[0m23:22:36.120659 [debug] [ThreadPool]: On list_an_data_pipeline: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"an_data_pipeline"'
    
  
  
[0m23:22:36.120796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:22:37.925545 [debug] [ThreadPool]: SQL status: OK in 1.805 seconds
[0m23:22:37.928511 [debug] [ThreadPool]: On list_an_data_pipeline: Close
[0m23:22:37.929583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_an_data_pipeline, now create_an_data_pipeline_main)
[0m23:22:37.930306 [debug] [ThreadPool]: Creating schema "database: "an_data_pipeline"
schema: "main"
"
[0m23:22:37.942158 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m23:22:37.942785 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:22:37.943189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:22:37.945175 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:22:37.946381 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m23:22:37.946629 [debug] [ThreadPool]: On create_an_data_pipeline_main: BEGIN
[0m23:22:37.947232 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:22:37.947449 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m23:22:37.947691 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
    
        create schema if not exists "an_data_pipeline"."main"
    
[0m23:22:38.052861 [debug] [ThreadPool]: SQL status: OK in 0.105 seconds
[0m23:22:38.055168 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m23:22:38.055806 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m23:22:38.056297 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m23:22:38.160171 [debug] [ThreadPool]: SQL status: OK in 0.103 seconds
[0m23:22:38.161842 [debug] [ThreadPool]: On create_an_data_pipeline_main: Close
[0m23:22:38.168035 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_an_data_pipeline_main, now list_an_data_pipeline_main)
[0m23:22:38.179717 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m23:22:38.180415 [debug] [ThreadPool]: On list_an_data_pipeline_main: BEGIN
[0m23:22:38.180869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:22:38.182471 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:22:38.183184 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m23:22:38.183662 [debug] [ThreadPool]: On list_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline_main"} */
select
      'an_data_pipeline' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'an_data_pipeline'
  
[0m23:22:38.204684 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m23:22:38.206209 [debug] [ThreadPool]: On list_an_data_pipeline_main: ROLLBACK
[0m23:22:38.207946 [debug] [ThreadPool]: Failed to rollback 'list_an_data_pipeline_main'
[0m23:22:38.208312 [debug] [ThreadPool]: On list_an_data_pipeline_main: Close
[0m23:22:38.208971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebd77f3b-d3a6-4b33-a472-b5bcc04dc8f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c9dc0>]}
[0m23:22:38.209469 [debug] [MainThread]: Using duckdb connection "master"
[0m23:22:38.209761 [debug] [MainThread]: On master: BEGIN
[0m23:22:38.210026 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:22:38.210877 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:22:38.211143 [debug] [MainThread]: On master: COMMIT
[0m23:22:38.211392 [debug] [MainThread]: Using duckdb connection "master"
[0m23:22:38.211627 [debug] [MainThread]: On master: COMMIT
[0m23:22:38.211994 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:22:38.212216 [debug] [MainThread]: On master: Close
[0m23:22:38.214660 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_acteurs
[0m23:22:38.214991 [debug] [Thread-2 (]: Began running node model.dbt_an_data.stg_agenda
[0m23:22:38.215673 [debug] [Thread-3 (]: Began running node model.dbt_an_data.stg_amendements
[0m23:22:38.215928 [debug] [Thread-4 (]: Began running node model.dbt_an_data.stg_organes
[0m23:22:38.215427 [info ] [Thread-1 (]: 1 of 17 START sql view model main.stg_acteurs .................................. [RUN]
[0m23:22:38.216325 [info ] [Thread-2 (]: 2 of 17 START sql view model main.stg_agenda ................................... [RUN]
[0m23:22:38.216688 [info ] [Thread-3 (]: 3 of 17 START sql view model main.stg_amendements .............................. [RUN]
[0m23:22:38.217055 [info ] [Thread-4 (]: 4 of 17 START sql view model main.stg_organes .................................. [RUN]
[0m23:22:38.217397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_an_data_pipeline_main, now model.dbt_an_data.stg_acteurs)
[0m23:22:38.217761 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.dbt_an_data.stg_agenda'
[0m23:22:38.218097 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.dbt_an_data.stg_amendements'
[0m23:22:38.218414 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.dbt_an_data.stg_organes'
[0m23:22:38.218675 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_acteurs
[0m23:22:38.218923 [debug] [Thread-2 (]: Began compiling node model.dbt_an_data.stg_agenda
[0m23:22:38.219160 [debug] [Thread-3 (]: Began compiling node model.dbt_an_data.stg_amendements
[0m23:22:38.219396 [debug] [Thread-4 (]: Began compiling node model.dbt_an_data.stg_organes
[0m23:22:38.225100 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_acteurs"
[0m23:22:38.228303 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_an_data.stg_agenda"
[0m23:22:38.230034 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_an_data.stg_amendements"
[0m23:22:38.231638 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_an_data.stg_organes"
[0m23:22:38.232550 [debug] [Thread-3 (]: Began executing node model.dbt_an_data.stg_amendements
[0m23:22:38.239219 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_acteurs
[0m23:22:38.245927 [debug] [Thread-4 (]: Began executing node model.dbt_an_data.stg_organes
[0m23:22:38.246127 [debug] [Thread-2 (]: Began executing node model.dbt_an_data.stg_agenda
[0m23:22:38.253977 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_an_data.stg_amendements"
[0m23:22:38.254582 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_acteurs"
[0m23:22:38.255889 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_an_data.stg_organes"
[0m23:22:38.257092 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_an_data.stg_agenda"
[0m23:22:38.257602 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m23:22:38.257773 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: BEGIN
[0m23:22:38.257922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:38.258104 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m23:22:38.258284 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m23:22:38.258435 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m23:22:38.258717 [debug] [Thread-3 (]: On model.dbt_an_data.stg_amendements: BEGIN
[0m23:22:38.258903 [debug] [Thread-2 (]: On model.dbt_an_data.stg_agenda: BEGIN
[0m23:22:38.259072 [debug] [Thread-4 (]: On model.dbt_an_data.stg_organes: BEGIN
[0m23:22:38.259264 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:22:38.259432 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:22:38.259574 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:22:38.259742 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:22:38.259994 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m23:22:38.260288 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m23:22:38.260465 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_acteurs"} */

  
  create view "an_data_pipeline"."main"."stg_acteurs__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_acteurs"
  );

[0m23:22:38.260637 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m23:22:38.260810 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m23:22:38.260976 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m23:22:38.261185 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m23:22:38.261348 [debug] [Thread-3 (]: On model.dbt_an_data.stg_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_amendements"} */

  
  create view "an_data_pipeline"."main"."stg_amendements__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_amendements"
  );

[0m23:22:38.261513 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m23:22:38.261678 [debug] [Thread-2 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_agenda"} */

  
  create view "an_data_pipeline"."main"."stg_agenda__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_agenda"
  );

[0m23:22:38.261879 [debug] [Thread-4 (]: On model.dbt_an_data.stg_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_organes"} */

  
  create view "an_data_pipeline"."main"."stg_organes__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_organes"
  );

[0m23:22:38.371420 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_acteurs"} */

  
  create view "an_data_pipeline"."main"."stg_acteurs__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_acteurs"
  );

[0m23:22:38.371951 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_amendements"} */

  
  create view "an_data_pipeline"."main"."stg_amendements__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_amendements"
  );

[0m23:22:38.372345 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_agenda"} */

  
  create view "an_data_pipeline"."main"."stg_agenda__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_agenda"
  );

[0m23:22:38.372708 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_organes"} */

  
  create view "an_data_pipeline"."main"."stg_organes__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_organes"
  );

[0m23:22:38.372963 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:22:38.373232 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m23:22:38.373486 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m23:22:38.373729 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m23:22:38.374100 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: ROLLBACK
[0m23:22:38.374447 [debug] [Thread-3 (]: On model.dbt_an_data.stg_amendements: ROLLBACK
[0m23:22:38.374773 [debug] [Thread-2 (]: On model.dbt_an_data.stg_agenda: ROLLBACK
[0m23:22:38.375084 [debug] [Thread-4 (]: On model.dbt_an_data.stg_organes: ROLLBACK
[0m23:22:38.388929 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_an_data.stg_acteurs'
[0m23:22:38.389915 [debug] [Thread-4 (]: Failed to rollback 'model.dbt_an_data.stg_organes'
[0m23:22:38.390855 [debug] [Thread-2 (]: Failed to rollback 'model.dbt_an_data.stg_agenda'
[0m23:22:38.391079 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: Close
[0m23:22:38.391989 [debug] [Thread-3 (]: Failed to rollback 'model.dbt_an_data.stg_amendements'
[0m23:22:38.392196 [debug] [Thread-4 (]: On model.dbt_an_data.stg_organes: Close
[0m23:22:38.392399 [debug] [Thread-2 (]: On model.dbt_an_data.stg_agenda: Close
[0m23:22:38.392615 [debug] [Thread-3 (]: On model.dbt_an_data.stg_amendements: Close
[0m23:22:38.396095 [debug] [Thread-4 (]: Runtime Error in model stg_organes (models/stg/stg_organes.sql)
  Binder Error: Catalog "database" does not exist!
[0m23:22:38.396920 [debug] [Thread-1 (]: Runtime Error in model stg_acteurs (models/stg/stg_acteurs.sql)
  Binder Error: Catalog "database" does not exist!
[0m23:22:38.398770 [debug] [Thread-3 (]: Runtime Error in model stg_amendements (models/stg/stg_amendements.sql)
  Binder Error: Catalog "database" does not exist!
[0m23:22:38.399567 [debug] [Thread-2 (]: Runtime Error in model stg_agenda (models/stg/stg_agenda.sql)
  Binder Error: Catalog "database" does not exist!
[0m23:22:38.400015 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebd77f3b-d3a6-4b33-a472-b5bcc04dc8f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10420cd70>]}
[0m23:22:38.400191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebd77f3b-d3a6-4b33-a472-b5bcc04dc8f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb44a0>]}
[0m23:22:38.400522 [error] [Thread-4 (]: 4 of 17 ERROR creating sql view model main.stg_organes ......................... [[31mERROR[0m in 0.18s]
[0m23:22:38.400711 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebd77f3b-d3a6-4b33-a472-b5bcc04dc8f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051a8ce0>]}
[0m23:22:38.400880 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebd77f3b-d3a6-4b33-a472-b5bcc04dc8f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b5ed80>]}
[0m23:22:38.401175 [error] [Thread-1 (]: 1 of 17 ERROR creating sql view model main.stg_acteurs ......................... [[31mERROR[0m in 0.18s]
[0m23:22:38.401464 [debug] [Thread-4 (]: Finished running node model.dbt_an_data.stg_organes
[0m23:22:38.401784 [error] [Thread-3 (]: 3 of 17 ERROR creating sql view model main.stg_amendements ..................... [[31mERROR[0m in 0.18s]
[0m23:22:38.402110 [error] [Thread-2 (]: 2 of 17 ERROR creating sql view model main.stg_agenda .......................... [[31mERROR[0m in 0.18s]
[0m23:22:38.402417 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_acteurs
[0m23:22:38.402623 [debug] [Thread-4 (]: Began running node model.dbt_an_data.stg_pays
[0m23:22:38.402863 [debug] [Thread-7 (]: Marking all children of 'model.dbt_an_data.stg_organes' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_organes (models/stg/stg_organes.sql)
  Binder Error: Catalog "database" does not exist!.
[0m23:22:38.403102 [debug] [Thread-3 (]: Finished running node model.dbt_an_data.stg_amendements
[0m23:22:38.403336 [debug] [Thread-2 (]: Finished running node model.dbt_an_data.stg_agenda
[0m23:22:38.403520 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_reunions
[0m23:22:38.403740 [info ] [Thread-4 (]: 5 of 17 START sql view model main.stg_pays ..................................... [RUN]
[0m23:22:38.404318 [debug] [Thread-7 (]: Marking all children of 'model.dbt_an_data.stg_acteurs' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_acteurs (models/stg/stg_acteurs.sql)
  Binder Error: Catalog "database" does not exist!.
[0m23:22:38.404536 [debug] [Thread-3 (]: Began running node model.dbt_an_data.stg_scrutins
[0m23:22:38.404707 [debug] [Thread-2 (]: Began running node model.dbt_an_data.int_organes
[0m23:22:38.404919 [info ] [Thread-1 (]: 6 of 17 START sql view model main.stg_reunions ................................. [RUN]
[0m23:22:38.405131 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_organes, now model.dbt_an_data.stg_pays)
[0m23:22:38.405367 [debug] [Thread-7 (]: Marking all children of 'model.dbt_an_data.stg_amendements' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_amendements (models/stg/stg_amendements.sql)
  Binder Error: Catalog "database" does not exist!.
[0m23:22:38.405602 [info ] [Thread-3 (]: 7 of 17 START sql view model main.stg_scrutins ................................. [RUN]
[0m23:22:38.405817 [info ] [Thread-2 (]: 8 of 17 SKIP relation main.int_organes ......................................... [[33mSKIP[0m]
[0m23:22:38.406015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_acteurs, now model.dbt_an_data.stg_reunions)
[0m23:22:38.406188 [debug] [Thread-4 (]: Began compiling node model.dbt_an_data.stg_pays
[0m23:22:38.406414 [debug] [Thread-7 (]: Marking all children of 'model.dbt_an_data.stg_agenda' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_agenda (models/stg/stg_agenda.sql)
  Binder Error: Catalog "database" does not exist!.
[0m23:22:38.406620 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_amendements, now model.dbt_an_data.stg_scrutins)
[0m23:22:38.406803 [debug] [Thread-2 (]: Finished running node model.dbt_an_data.int_organes
[0m23:22:38.406958 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_reunions
[0m23:22:38.408494 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_an_data.stg_pays"
[0m23:22:38.408745 [debug] [Thread-3 (]: Began compiling node model.dbt_an_data.stg_scrutins
[0m23:22:38.408927 [debug] [Thread-2 (]: Began running node model.dbt_an_data.int_acteurs
[0m23:22:38.410189 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_reunions"
[0m23:22:38.412417 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_an_data.stg_scrutins"
[0m23:22:38.412620 [info ] [Thread-2 (]: 9 of 17 SKIP relation main.int_acteurs ......................................... [[33mSKIP[0m]
[0m23:22:38.412894 [debug] [Thread-4 (]: Began executing node model.dbt_an_data.stg_pays
[0m23:22:38.413107 [debug] [Thread-2 (]: Finished running node model.dbt_an_data.int_acteurs
[0m23:22:38.413266 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_reunions
[0m23:22:38.414560 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_an_data.stg_pays"
[0m23:22:38.414775 [debug] [Thread-2 (]: Began running node model.dbt_an_data.int_mandats
[0m23:22:38.414922 [debug] [Thread-3 (]: Began executing node model.dbt_an_data.stg_scrutins
[0m23:22:38.416170 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_reunions"
[0m23:22:38.417505 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_an_data.stg_scrutins"
[0m23:22:38.416386 [info ] [Thread-2 (]: 10 of 17 SKIP relation main.int_mandats ........................................ [[33mSKIP[0m]
[0m23:22:38.417785 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m23:22:38.417988 [debug] [Thread-2 (]: Finished running node model.dbt_an_data.int_mandats
[0m23:22:38.418167 [debug] [Thread-4 (]: On model.dbt_an_data.stg_pays: BEGIN
[0m23:22:38.418351 [debug] [Thread-2 (]: Began running node model.dbt_an_data.int_amendements
[0m23:22:38.418531 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:22:38.418704 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m23:22:38.419011 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m23:22:38.418867 [info ] [Thread-2 (]: 11 of 17 SKIP relation main.int_amendements .................................... [[33mSKIP[0m]
[0m23:22:38.419315 [debug] [Thread-3 (]: On model.dbt_an_data.stg_scrutins: BEGIN
[0m23:22:38.419469 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: BEGIN
[0m23:22:38.419640 [debug] [Thread-2 (]: Finished running node model.dbt_an_data.int_amendements
[0m23:22:38.419799 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:22:38.419948 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m23:22:38.420082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:38.420248 [debug] [Thread-2 (]: Began running node model.dbt_an_data.int_amendements_cosignataires
[0m23:22:38.420450 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m23:22:38.420674 [info ] [Thread-2 (]: 12 of 17 SKIP relation main.int_amendements_cosignataires ...................... [[33mSKIP[0m]
[0m23:22:38.420869 [debug] [Thread-4 (]: On model.dbt_an_data.stg_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_pays"} */

  
  create view "an_data_pipeline"."main"."stg_pays__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_pays"
  );

[0m23:22:38.421018 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m23:22:38.421163 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:22:38.421308 [debug] [Thread-2 (]: Finished running node model.dbt_an_data.int_amendements_cosignataires
[0m23:22:38.421502 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m23:22:38.421654 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m23:22:38.421828 [debug] [Thread-2 (]: Began running node model.dbt_an_data.int_agenda
[0m23:22:38.422002 [debug] [Thread-3 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_scrutins"} */

  
  create view "an_data_pipeline"."main"."stg_scrutins__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_scrutins"
  );

[0m23:22:38.422166 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_reunions"} */

  
  create view "an_data_pipeline"."main"."stg_reunions__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_reunions"
  );

[0m23:22:38.422329 [info ] [Thread-2 (]: 13 of 17 SKIP relation main.int_agenda ......................................... [[33mSKIP[0m]
[0m23:22:38.422602 [debug] [Thread-2 (]: Finished running node model.dbt_an_data.int_agenda
[0m23:22:38.525409 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_reunions"} */

  
  create view "an_data_pipeline"."main"."stg_reunions__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_reunions"
  );

[0m23:22:38.525946 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_scrutins"} */

  
  create view "an_data_pipeline"."main"."stg_scrutins__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_scrutins"
  );

[0m23:22:38.526349 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_pays"} */

  
  create view "an_data_pipeline"."main"."stg_pays__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_pays"
  );

[0m23:22:38.526620 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:22:38.526896 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m23:22:38.527146 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m23:22:38.527505 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: ROLLBACK
[0m23:22:38.527833 [debug] [Thread-3 (]: On model.dbt_an_data.stg_scrutins: ROLLBACK
[0m23:22:38.528155 [debug] [Thread-4 (]: On model.dbt_an_data.stg_pays: ROLLBACK
[0m23:22:38.533150 [debug] [Thread-3 (]: Failed to rollback 'model.dbt_an_data.stg_scrutins'
[0m23:22:38.533556 [debug] [Thread-3 (]: On model.dbt_an_data.stg_scrutins: Close
[0m23:22:38.534711 [debug] [Thread-4 (]: Failed to rollback 'model.dbt_an_data.stg_pays'
[0m23:22:38.535902 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_an_data.stg_reunions'
[0m23:22:38.536163 [debug] [Thread-4 (]: On model.dbt_an_data.stg_pays: Close
[0m23:22:38.537239 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: Close
[0m23:22:38.540187 [debug] [Thread-3 (]: Runtime Error in model stg_scrutins (models/stg/stg_scrutins.sql)
  Binder Error: Catalog "database" does not exist!
[0m23:22:38.540514 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebd77f3b-d3a6-4b33-a472-b5bcc04dc8f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb6450>]}
[0m23:22:38.540998 [error] [Thread-3 (]: 7 of 17 ERROR creating sql view model main.stg_scrutins ........................ [[31mERROR[0m in 0.13s]
[0m23:22:38.541420 [debug] [Thread-3 (]: Finished running node model.dbt_an_data.stg_scrutins
[0m23:22:38.541774 [debug] [Thread-7 (]: Marking all children of 'model.dbt_an_data.stg_scrutins' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_scrutins (models/stg/stg_scrutins.sql)
  Binder Error: Catalog "database" does not exist!.
[0m23:22:38.542286 [debug] [Thread-2 (]: Began running node model.dbt_an_data.int_scrutins
[0m23:22:38.543292 [debug] [Thread-4 (]: Runtime Error in model stg_pays (models/stg/stg_pays.sql)
  Binder Error: Catalog "database" does not exist!
[0m23:22:38.543547 [info ] [Thread-2 (]: 14 of 17 SKIP relation main.int_scrutins ....................................... [[33mSKIP[0m]
[0m23:22:38.543787 [debug] [Thread-3 (]: Began running node model.dbt_an_data.int_scrutins_votes
[0m23:22:38.544116 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebd77f3b-d3a6-4b33-a472-b5bcc04dc8f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b61d60>]}
[0m23:22:38.544965 [debug] [Thread-1 (]: Runtime Error in model stg_reunions (models/stg/stg_reunions.sql)
  Binder Error: Catalog "database" does not exist!
[0m23:22:38.545204 [debug] [Thread-2 (]: Finished running node model.dbt_an_data.int_scrutins
[0m23:22:38.545425 [info ] [Thread-3 (]: 15 of 17 SKIP relation main.int_scrutins_votes ................................. [[33mSKIP[0m]
[0m23:22:38.546020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebd77f3b-d3a6-4b33-a472-b5bcc04dc8f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b80b00>]}
[0m23:22:38.545757 [error] [Thread-4 (]: 5 of 17 ERROR creating sql view model main.stg_pays ............................ [[31mERROR[0m in 0.14s]
[0m23:22:38.546355 [debug] [Thread-3 (]: Finished running node model.dbt_an_data.int_scrutins_votes
[0m23:22:38.546685 [error] [Thread-1 (]: 6 of 17 ERROR creating sql view model main.stg_reunions ........................ [[31mERROR[0m in 0.14s]
[0m23:22:38.547005 [debug] [Thread-4 (]: Finished running node model.dbt_an_data.stg_pays
[0m23:22:38.547346 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_reunions
[0m23:22:38.547614 [debug] [Thread-7 (]: Marking all children of 'model.dbt_an_data.stg_pays' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_pays (models/stg/stg_pays.sql)
  Binder Error: Catalog "database" does not exist!.
[0m23:22:38.547916 [debug] [Thread-7 (]: Marking all children of 'model.dbt_an_data.stg_reunions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_reunions (models/stg/stg_reunions.sql)
  Binder Error: Catalog "database" does not exist!.
[0m23:22:38.548165 [debug] [Thread-2 (]: Began running node model.dbt_an_data.int_pays
[0m23:22:38.548438 [info ] [Thread-2 (]: 16 of 17 SKIP relation main.int_pays ........................................... [[33mSKIP[0m]
[0m23:22:38.548669 [debug] [Thread-3 (]: Began running node model.dbt_an_data.int_reunions
[0m23:22:38.548871 [debug] [Thread-2 (]: Finished running node model.dbt_an_data.int_pays
[0m23:22:38.549083 [info ] [Thread-3 (]: 17 of 17 SKIP relation main.int_reunions ....................................... [[33mSKIP[0m]
[0m23:22:38.549359 [debug] [Thread-3 (]: Finished running node model.dbt_an_data.int_reunions
[0m23:22:38.550110 [debug] [MainThread]: Using duckdb connection "master"
[0m23:22:38.550289 [debug] [MainThread]: On master: BEGIN
[0m23:22:38.550444 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:22:38.551068 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:22:38.551223 [debug] [MainThread]: On master: COMMIT
[0m23:22:38.551369 [debug] [MainThread]: Using duckdb connection "master"
[0m23:22:38.551510 [debug] [MainThread]: On master: COMMIT
[0m23:22:38.551765 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:22:38.551911 [debug] [MainThread]: On master: Close
[0m23:22:38.552100 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:22:38.552235 [debug] [MainThread]: Connection 'model.dbt_an_data.stg_reunions' was properly closed.
[0m23:22:38.552374 [debug] [MainThread]: Connection 'model.dbt_an_data.stg_agenda' was properly closed.
[0m23:22:38.552495 [debug] [MainThread]: Connection 'model.dbt_an_data.stg_scrutins' was properly closed.
[0m23:22:38.552617 [debug] [MainThread]: Connection 'model.dbt_an_data.stg_pays' was properly closed.
[0m23:22:38.552813 [info ] [MainThread]: 
[0m23:22:38.552982 [info ] [MainThread]: Finished running 10 incremental models, 7 view models in 0 hours 0 minutes and 2.52 seconds (2.52s).
[0m23:22:38.553833 [debug] [MainThread]: Command end result
[0m23:22:38.567235 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m23:22:38.568127 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m23:22:38.571243 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m23:22:38.571384 [info ] [MainThread]: 
[0m23:22:38.571542 [info ] [MainThread]: [31mCompleted with 7 errors, 0 partial successes, and 0 warnings:[0m
[0m23:22:38.571677 [info ] [MainThread]: 
[0m23:22:38.571844 [error] [MainThread]: [31mFailure in model stg_organes (models/stg/stg_organes.sql)[0m
[0m23:22:38.571998 [error] [MainThread]:   Runtime Error in model stg_organes (models/stg/stg_organes.sql)
  Binder Error: Catalog "database" does not exist!
[0m23:22:38.572117 [info ] [MainThread]: 
[0m23:22:38.572261 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/stg/stg_organes.sql
[0m23:22:38.572379 [info ] [MainThread]: 
[0m23:22:38.572522 [error] [MainThread]: [31mFailure in model stg_acteurs (models/stg/stg_acteurs.sql)[0m
[0m23:22:38.572665 [error] [MainThread]:   Runtime Error in model stg_acteurs (models/stg/stg_acteurs.sql)
  Binder Error: Catalog "database" does not exist!
[0m23:22:38.572779 [info ] [MainThread]: 
[0m23:22:38.572914 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/stg/stg_acteurs.sql
[0m23:22:38.573030 [info ] [MainThread]: 
[0m23:22:38.573171 [error] [MainThread]: [31mFailure in model stg_amendements (models/stg/stg_amendements.sql)[0m
[0m23:22:38.573311 [error] [MainThread]:   Runtime Error in model stg_amendements (models/stg/stg_amendements.sql)
  Binder Error: Catalog "database" does not exist!
[0m23:22:38.573422 [info ] [MainThread]: 
[0m23:22:38.573558 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/stg/stg_amendements.sql
[0m23:22:38.573672 [info ] [MainThread]: 
[0m23:22:38.573814 [error] [MainThread]: [31mFailure in model stg_agenda (models/stg/stg_agenda.sql)[0m
[0m23:22:38.573958 [error] [MainThread]:   Runtime Error in model stg_agenda (models/stg/stg_agenda.sql)
  Binder Error: Catalog "database" does not exist!
[0m23:22:38.574070 [info ] [MainThread]: 
[0m23:22:38.574207 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/stg/stg_agenda.sql
[0m23:22:38.574319 [info ] [MainThread]: 
[0m23:22:38.574459 [error] [MainThread]: [31mFailure in model stg_scrutins (models/stg/stg_scrutins.sql)[0m
[0m23:22:38.574598 [error] [MainThread]:   Runtime Error in model stg_scrutins (models/stg/stg_scrutins.sql)
  Binder Error: Catalog "database" does not exist!
[0m23:22:38.574709 [info ] [MainThread]: 
[0m23:22:38.574842 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/stg/stg_scrutins.sql
[0m23:22:38.574959 [info ] [MainThread]: 
[0m23:22:38.575102 [error] [MainThread]: [31mFailure in model stg_pays (models/stg/stg_pays.sql)[0m
[0m23:22:38.575242 [error] [MainThread]:   Runtime Error in model stg_pays (models/stg/stg_pays.sql)
  Binder Error: Catalog "database" does not exist!
[0m23:22:38.575350 [info ] [MainThread]: 
[0m23:22:38.575483 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/stg/stg_pays.sql
[0m23:22:38.575597 [info ] [MainThread]: 
[0m23:22:38.575732 [error] [MainThread]: [31mFailure in model stg_reunions (models/stg/stg_reunions.sql)[0m
[0m23:22:38.575867 [error] [MainThread]:   Runtime Error in model stg_reunions (models/stg/stg_reunions.sql)
  Binder Error: Catalog "database" does not exist!
[0m23:22:38.575973 [info ] [MainThread]: 
[0m23:22:38.576108 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/stg/stg_reunions.sql
[0m23:22:38.576226 [info ] [MainThread]: 
[0m23:22:38.576371 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=7 SKIP=10 NO-OP=0 TOTAL=17
[0m23:22:38.576711 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.4545462, "process_in_blocks": "0", "process_kernel_time": 0.406727, "process_mem_max_rss": "168722432", "process_out_blocks": "0", "process_user_time": 2.022422}
[0m23:22:38.576915 [debug] [MainThread]: Command `dbt run` failed at 23:22:38.576877 after 3.45 seconds
[0m23:22:38.577087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c24a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f1e780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f47500>]}
[0m23:22:38.577249 [debug] [MainThread]: Flushing usage events
[0m23:22:39.194787 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:28:32.519670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e21b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c37a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c3440>]}


============================== 23:28:32.522872 | ef35c809-8938-447b-8eca-897bca279c5e ==============================
[0m23:28:32.522872 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:28:32.523183 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'write_json': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'quiet': 'False', 'partial_parse': 'True', 'target_path': 'None', 'debug': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error': 'None', 'no_print': 'None', 'use_colors': 'True'}
[0m23:28:32.714151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef35c809-8938-447b-8eca-897bca279c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10712fd40>]}
[0m23:28:32.741500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef35c809-8938-447b-8eca-897bca279c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a6ba0>]}
[0m23:28:32.742879 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m23:28:32.799685 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m23:28:32.837453 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:28:32.837728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ef35c809-8938-447b-8eca-897bca279c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10725bad0>]}
[0m23:28:33.412282 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_an_data.mart
[0m23:28:33.416745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef35c809-8938-447b-8eca-897bca279c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108174680>]}
[0m23:28:33.452510 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m23:28:33.453790 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m23:28:33.467258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef35c809-8938-447b-8eca-897bca279c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108316d50>]}
[0m23:28:33.467519 [info ] [MainThread]: Found 17 models, 1 operation, 9 sources, 469 macros
[0m23:28:33.467687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef35c809-8938-447b-8eca-897bca279c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10812a750>]}
[0m23:28:33.468694 [info ] [MainThread]: 
[0m23:28:33.468859 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m23:28:33.468982 [info ] [MainThread]: 
[0m23:28:33.469214 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:28:33.471638 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_an_data_pipeline'
[0m23:28:33.556383 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline"
[0m23:28:33.556617 [debug] [ThreadPool]: On list_an_data_pipeline: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"an_data_pipeline"'
    
  
  
[0m23:28:33.556757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:28:35.589252 [debug] [ThreadPool]: SQL status: OK in 2.032 seconds
[0m23:28:35.592940 [debug] [ThreadPool]: On list_an_data_pipeline: Close
[0m23:28:35.594154 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_an_data_pipeline, now create_an_data_pipeline_main)
[0m23:28:35.594874 [debug] [ThreadPool]: Creating schema "database: "an_data_pipeline"
schema: "main"
"
[0m23:28:35.606079 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m23:28:35.606721 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:28:35.607142 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:28:35.609496 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:28:35.611148 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m23:28:35.611489 [debug] [ThreadPool]: On create_an_data_pipeline_main: BEGIN
[0m23:28:35.612304 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:28:35.612593 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m23:28:35.612878 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
    
        create schema if not exists "an_data_pipeline"."main"
    
[0m23:28:35.720685 [debug] [ThreadPool]: SQL status: OK in 0.107 seconds
[0m23:28:35.723782 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m23:28:35.724844 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m23:28:35.725786 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m23:28:35.829614 [debug] [ThreadPool]: SQL status: OK in 0.103 seconds
[0m23:28:35.829875 [debug] [ThreadPool]: On create_an_data_pipeline_main: Close
[0m23:28:35.830900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_an_data_pipeline_main, now list_an_data_pipeline_main)
[0m23:28:35.833565 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m23:28:35.833732 [debug] [ThreadPool]: On list_an_data_pipeline_main: BEGIN
[0m23:28:35.833909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:28:35.834320 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:28:35.834447 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m23:28:35.834569 [debug] [ThreadPool]: On list_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline_main"} */
select
      'an_data_pipeline' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'an_data_pipeline'
  
[0m23:28:35.843842 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m23:28:35.844524 [debug] [ThreadPool]: On list_an_data_pipeline_main: ROLLBACK
[0m23:28:35.845416 [debug] [ThreadPool]: Failed to rollback 'list_an_data_pipeline_main'
[0m23:28:35.845569 [debug] [ThreadPool]: On list_an_data_pipeline_main: Close
[0m23:28:35.845868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef35c809-8938-447b-8eca-897bca279c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083337a0>]}
[0m23:28:35.846121 [debug] [MainThread]: Using duckdb connection "master"
[0m23:28:35.846260 [debug] [MainThread]: On master: BEGIN
[0m23:28:35.846381 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:28:35.846777 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:28:35.846911 [debug] [MainThread]: On master: COMMIT
[0m23:28:35.847035 [debug] [MainThread]: Using duckdb connection "master"
[0m23:28:35.847151 [debug] [MainThread]: On master: COMMIT
[0m23:28:35.847348 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:28:35.850630 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_an_data.dbt_an_data-on-run-start-0"
[0m23:28:35.852820 [info ] [MainThread]: 1 of 1 START hook: dbt_an_data.on-run-start.0 .................................. [RUN]
[0m23:28:35.853040 [debug] [MainThread]: Using duckdb connection "master"
[0m23:28:35.853195 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "master"} */
ATTACH '../data/database/database.duckdb' AS database (READ_ONLY)
[0m23:28:35.859604 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m23:28:35.860120 [info ] [MainThread]: 1 of 1 OK hook: dbt_an_data.on-run-start.0 ..................................... [[32mOK[0m in 0.01s]
[0m23:28:35.860266 [info ] [MainThread]: 
[0m23:28:35.860405 [debug] [MainThread]: On master: Close
[0m23:28:35.861946 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_acteurs
[0m23:28:35.862131 [debug] [Thread-2 (]: Began running node model.dbt_an_data.stg_agenda
[0m23:28:35.862502 [debug] [Thread-3 (]: Began running node model.dbt_an_data.stg_amendements
[0m23:28:35.862371 [info ] [Thread-1 (]: 1 of 17 START sql view model main.stg_acteurs .................................. [RUN]
[0m23:28:35.862697 [debug] [Thread-4 (]: Began running node model.dbt_an_data.stg_organes
[0m23:28:35.862888 [info ] [Thread-2 (]: 2 of 17 START sql view model main.stg_agenda ................................... [RUN]
[0m23:28:35.863089 [info ] [Thread-3 (]: 3 of 17 START sql view model main.stg_amendements .............................. [RUN]
[0m23:28:35.863282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_an_data_pipeline_main, now model.dbt_an_data.stg_acteurs)
[0m23:28:35.863460 [info ] [Thread-4 (]: 4 of 17 START sql view model main.stg_organes .................................. [RUN]
[0m23:28:35.863658 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.dbt_an_data.stg_agenda'
[0m23:28:35.863864 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.dbt_an_data.stg_amendements'
[0m23:28:35.864022 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_acteurs
[0m23:28:35.864206 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.dbt_an_data.stg_organes'
[0m23:28:35.864349 [debug] [Thread-2 (]: Began compiling node model.dbt_an_data.stg_agenda
[0m23:28:35.864491 [debug] [Thread-3 (]: Began compiling node model.dbt_an_data.stg_amendements
[0m23:28:35.865937 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_acteurs"
[0m23:28:35.866122 [debug] [Thread-4 (]: Began compiling node model.dbt_an_data.stg_organes
[0m23:28:35.867314 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_an_data.stg_agenda"
[0m23:28:35.869253 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_an_data.stg_amendements"
[0m23:28:35.870519 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_an_data.stg_organes"
[0m23:28:35.870978 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_acteurs
[0m23:28:35.883868 [debug] [Thread-3 (]: Began executing node model.dbt_an_data.stg_amendements
[0m23:28:35.885765 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_acteurs"
[0m23:28:35.885948 [debug] [Thread-2 (]: Began executing node model.dbt_an_data.stg_agenda
[0m23:28:35.887345 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_an_data.stg_amendements"
[0m23:28:35.887586 [debug] [Thread-4 (]: Began executing node model.dbt_an_data.stg_organes
[0m23:28:35.888835 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_an_data.stg_agenda"
[0m23:28:35.890136 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_an_data.stg_organes"
[0m23:28:35.890422 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m23:28:35.890588 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: BEGIN
[0m23:28:35.890736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:35.890906 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m23:28:35.891237 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m23:28:35.891391 [debug] [Thread-3 (]: On model.dbt_an_data.stg_amendements: BEGIN
[0m23:28:35.891558 [debug] [Thread-2 (]: On model.dbt_an_data.stg_agenda: BEGIN
[0m23:28:35.891725 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m23:28:35.891861 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:28:35.892007 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:28:35.892143 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:28:35.892291 [debug] [Thread-4 (]: On model.dbt_an_data.stg_organes: BEGIN
[0m23:28:35.892482 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m23:28:35.892688 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:28:35.892842 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m23:28:35.892987 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_acteurs"} */

  
  create view "an_data_pipeline"."main"."stg_acteurs__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_acteurs"
  );

[0m23:28:35.893189 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m23:28:35.893337 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m23:28:35.893551 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m23:28:35.893702 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m23:28:35.893862 [debug] [Thread-3 (]: On model.dbt_an_data.stg_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_amendements"} */

  
  create view "an_data_pipeline"."main"."stg_amendements__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_amendements"
  );

[0m23:28:35.894024 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m23:28:35.894177 [debug] [Thread-2 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_agenda"} */

  
  create view "an_data_pipeline"."main"."stg_agenda__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_agenda"
  );

[0m23:28:35.894378 [debug] [Thread-4 (]: On model.dbt_an_data.stg_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_organes"} */

  
  create view "an_data_pipeline"."main"."stg_organes__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_organes"
  );

[0m23:28:35.997220 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m23:28:36.002615 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m23:28:36.002964 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_acteurs"} */
alter view "an_data_pipeline"."main"."stg_acteurs__dbt_tmp" rename to "stg_acteurs"
[0m23:28:36.005735 [debug] [Thread-4 (]: SQL status: OK in 0.111 seconds
[0m23:28:36.006028 [debug] [Thread-2 (]: SQL status: OK in 0.111 seconds
[0m23:28:36.006288 [debug] [Thread-3 (]: SQL status: OK in 0.112 seconds
[0m23:28:36.008561 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m23:28:36.010722 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m23:28:36.013430 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m23:28:36.013699 [debug] [Thread-4 (]: On model.dbt_an_data.stg_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_organes"} */
alter view "an_data_pipeline"."main"."stg_organes__dbt_tmp" rename to "stg_organes"
[0m23:28:36.013943 [debug] [Thread-2 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_agenda"} */
alter view "an_data_pipeline"."main"."stg_agenda__dbt_tmp" rename to "stg_agenda"
[0m23:28:36.014178 [debug] [Thread-3 (]: On model.dbt_an_data.stg_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_amendements"} */
alter view "an_data_pipeline"."main"."stg_amendements__dbt_tmp" rename to "stg_amendements"
[0m23:28:36.107929 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m23:28:36.121819 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: COMMIT
[0m23:28:36.122314 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m23:28:36.122682 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: COMMIT
[0m23:28:36.123327 [debug] [Thread-2 (]: SQL status: OK in 0.109 seconds
[0m23:28:36.124703 [debug] [Thread-2 (]: On model.dbt_an_data.stg_agenda: COMMIT
[0m23:28:36.125104 [debug] [Thread-4 (]: SQL status: OK in 0.111 seconds
[0m23:28:36.125441 [debug] [Thread-3 (]: SQL status: OK in 0.111 seconds
[0m23:28:36.125759 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m23:28:36.126839 [debug] [Thread-4 (]: On model.dbt_an_data.stg_organes: COMMIT
[0m23:28:36.127859 [debug] [Thread-3 (]: On model.dbt_an_data.stg_amendements: COMMIT
[0m23:28:36.128163 [debug] [Thread-2 (]: On model.dbt_an_data.stg_agenda: COMMIT
[0m23:28:36.128456 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m23:28:36.128735 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m23:28:36.129110 [debug] [Thread-4 (]: On model.dbt_an_data.stg_organes: COMMIT
[0m23:28:36.129420 [debug] [Thread-3 (]: On model.dbt_an_data.stg_amendements: COMMIT
[0m23:28:36.342073 [debug] [Thread-3 (]: SQL status: OK in 0.212 seconds
[0m23:28:36.344883 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.stg_amendements"
[0m23:28:36.345084 [debug] [Thread-3 (]: On model.dbt_an_data.stg_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_amendements"} */

      drop view if exists "an_data_pipeline"."main"."stg_amendements__dbt_backup" cascade
    
[0m23:28:36.345361 [debug] [Thread-1 (]: SQL status: OK in 0.222 seconds
[0m23:28:36.346416 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_acteurs"
[0m23:28:36.346583 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_acteurs"} */

      drop view if exists "an_data_pipeline"."main"."stg_acteurs__dbt_backup" cascade
    
[0m23:28:36.346813 [debug] [Thread-2 (]: SQL status: OK in 0.218 seconds
[0m23:28:36.347814 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.stg_agenda"
[0m23:28:36.347979 [debug] [Thread-2 (]: On model.dbt_an_data.stg_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_agenda"} */

      drop view if exists "an_data_pipeline"."main"."stg_agenda__dbt_backup" cascade
    
[0m23:28:36.348192 [debug] [Thread-4 (]: SQL status: OK in 0.219 seconds
[0m23:28:36.349134 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.stg_organes"
[0m23:28:36.349279 [debug] [Thread-4 (]: On model.dbt_an_data.stg_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_organes"} */

      drop view if exists "an_data_pipeline"."main"."stg_organes__dbt_backup" cascade
    
[0m23:28:36.555869 [debug] [Thread-1 (]: SQL status: OK in 0.209 seconds
[0m23:28:36.556852 [debug] [Thread-4 (]: SQL status: OK in 0.207 seconds
[0m23:28:36.557594 [debug] [Thread-3 (]: SQL status: OK in 0.212 seconds
[0m23:28:36.558308 [debug] [Thread-2 (]: SQL status: OK in 0.210 seconds
[0m23:28:36.564563 [debug] [Thread-1 (]: On model.dbt_an_data.stg_acteurs: Close
[0m23:28:36.566561 [debug] [Thread-4 (]: On model.dbt_an_data.stg_organes: Close
[0m23:28:36.568407 [debug] [Thread-3 (]: On model.dbt_an_data.stg_amendements: Close
[0m23:28:36.569962 [debug] [Thread-2 (]: On model.dbt_an_data.stg_agenda: Close
[0m23:28:36.576003 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef35c809-8938-447b-8eca-897bca279c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073449b0>]}
[0m23:28:36.576538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef35c809-8938-447b-8eca-897bca279c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086ec980>]}
[0m23:28:36.577445 [info ] [Thread-4 (]: 4 of 17 OK created sql view model main.stg_organes ............................. [[32mOK[0m in 0.71s]
[0m23:28:36.577940 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef35c809-8938-447b-8eca-897bca279c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10879c0b0>]}
[0m23:28:36.578598 [info ] [Thread-1 (]: 1 of 17 OK created sql view model main.stg_acteurs ............................. [[32mOK[0m in 0.71s]
[0m23:28:36.579030 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef35c809-8938-447b-8eca-897bca279c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087b5730>]}
[0m23:28:36.579700 [debug] [Thread-4 (]: Finished running node model.dbt_an_data.stg_organes
[0m23:28:36.580393 [info ] [Thread-3 (]: 3 of 17 OK created sql view model main.stg_amendements ......................... [[32mOK[0m in 0.71s]
[0m23:28:36.581080 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_acteurs
[0m23:28:36.581735 [info ] [Thread-2 (]: 2 of 17 OK created sql view model main.stg_agenda .............................. [[32mOK[0m in 0.71s]
[0m23:28:36.582303 [debug] [Thread-4 (]: Began running node model.dbt_an_data.stg_pays
[0m23:28:36.583056 [debug] [Thread-3 (]: Finished running node model.dbt_an_data.stg_amendements
[0m23:28:36.583664 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_reunions
[0m23:28:36.584339 [debug] [Thread-2 (]: Finished running node model.dbt_an_data.stg_agenda
[0m23:28:36.584946 [info ] [Thread-4 (]: 5 of 17 START sql view model main.stg_pays ..................................... [RUN]
[0m23:28:36.585375 [debug] [Thread-3 (]: Began running node model.dbt_an_data.stg_scrutins
[0m23:28:36.585884 [info ] [Thread-1 (]: 6 of 17 START sql view model main.stg_reunions ................................. [RUN]
[0m23:28:36.586315 [debug] [Thread-2 (]: Began running node model.dbt_an_data.int_organes
[0m23:28:36.586785 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_organes, now model.dbt_an_data.stg_pays)
[0m23:28:36.587329 [info ] [Thread-3 (]: 7 of 17 START sql view model main.stg_scrutins ................................. [RUN]
[0m23:28:36.587767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_acteurs, now model.dbt_an_data.stg_reunions)
[0m23:28:36.588555 [debug] [Thread-4 (]: Began compiling node model.dbt_an_data.stg_pays
[0m23:28:36.588234 [info ] [Thread-2 (]: 8 of 17 START sql incremental model main.int_organes ........................... [RUN]
[0m23:28:36.589043 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_amendements, now model.dbt_an_data.stg_scrutins)
[0m23:28:36.589398 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_reunions
[0m23:28:36.592602 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_an_data.stg_pays"
[0m23:28:36.592996 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_agenda, now model.dbt_an_data.int_organes)
[0m23:28:36.593295 [debug] [Thread-3 (]: Began compiling node model.dbt_an_data.stg_scrutins
[0m23:28:36.595682 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_reunions"
[0m23:28:36.596113 [debug] [Thread-2 (]: Began compiling node model.dbt_an_data.int_organes
[0m23:28:36.598572 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_an_data.stg_scrutins"
[0m23:28:36.601348 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_an_data.int_organes"
[0m23:28:36.601658 [debug] [Thread-4 (]: Began executing node model.dbt_an_data.stg_pays
[0m23:28:36.602055 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.stg_reunions
[0m23:28:36.604430 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_an_data.stg_pays"
[0m23:28:36.648566 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.stg_reunions"
[0m23:28:36.648878 [debug] [Thread-2 (]: Began executing node model.dbt_an_data.int_organes
[0m23:28:36.649101 [debug] [Thread-3 (]: Began executing node model.dbt_an_data.stg_scrutins
[0m23:28:36.650826 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:28:36.652000 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_an_data.stg_scrutins"
[0m23:28:36.652232 [debug] [Thread-2 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__c6b3d4044518" cascade
    
[0m23:28:36.652430 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m23:28:36.652640 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m23:28:36.652834 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:28:36.653034 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: BEGIN
[0m23:28:36.653213 [debug] [Thread-4 (]: On model.dbt_an_data.stg_pays: BEGIN
[0m23:28:36.653502 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m23:28:36.653683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:36.653874 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:28:36.654033 [debug] [Thread-3 (]: On model.dbt_an_data.stg_scrutins: BEGIN
[0m23:28:36.654330 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:28:36.654570 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m23:28:36.654721 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m23:28:36.654864 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:28:36.655015 [debug] [Thread-4 (]: On model.dbt_an_data.stg_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_pays"} */

  
  create view "an_data_pipeline"."main"."stg_pays__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_pays"
  );

[0m23:28:36.655162 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m23:28:36.655297 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m23:28:36.655492 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m23:28:36.655640 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_reunions"} */

  
  create view "an_data_pipeline"."main"."stg_reunions__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_reunions"
  );

[0m23:28:36.655800 [debug] [Thread-3 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_scrutins"} */

  
  create view "an_data_pipeline"."main"."stg_scrutins__dbt_tmp" as (
    SELECT * 
FROM "database"."stg"."raw_scrutins"
  );

[0m23:28:36.757890 [debug] [Thread-2 (]: SQL status: OK in 0.105 seconds
[0m23:28:36.764403 [debug] [Thread-4 (]: SQL status: OK in 0.109 seconds
[0m23:28:36.772817 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m23:28:36.779634 [debug] [Thread-1 (]: SQL status: OK in 0.124 seconds
[0m23:28:36.779912 [debug] [Thread-4 (]: On model.dbt_an_data.stg_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_pays"} */
alter view "an_data_pipeline"."main"."stg_pays__dbt_tmp" rename to "stg_pays"
[0m23:28:36.785510 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:28:36.785772 [debug] [Thread-3 (]: SQL status: OK in 0.130 seconds
[0m23:28:36.787515 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m23:28:36.787795 [debug] [Thread-2 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:28:36.789542 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m23:28:36.789768 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_reunions"} */
alter view "an_data_pipeline"."main"."stg_reunions__dbt_tmp" rename to "stg_reunions"
[0m23:28:36.790069 [debug] [Thread-3 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_scrutins"} */
alter view "an_data_pipeline"."main"."stg_scrutins__dbt_tmp" rename to "stg_scrutins"
[0m23:28:36.790554 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m23:28:36.791324 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:28:36.791520 [debug] [Thread-2 (]: On model.dbt_an_data.int_organes: BEGIN
[0m23:28:36.791977 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m23:28:36.792149 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:28:36.792322 [debug] [Thread-2 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m23:28:36.897326 [debug] [Thread-2 (]: SQL status: OK in 0.105 seconds
[0m23:28:36.897822 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m23:28:36.898208 [debug] [Thread-3 (]: SQL status: OK in 0.108 seconds
[0m23:28:36.898535 [debug] [Thread-4 (]: SQL status: OK in 0.111 seconds
[0m23:28:36.899737 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:28:36.901047 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: COMMIT
[0m23:28:36.902263 [debug] [Thread-3 (]: On model.dbt_an_data.stg_scrutins: COMMIT
[0m23:28:36.903520 [debug] [Thread-4 (]: On model.dbt_an_data.stg_pays: COMMIT
[0m23:28:36.903920 [debug] [Thread-2 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    

  
[0m23:28:36.904283 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m23:28:36.904626 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m23:28:36.904971 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m23:28:36.905382 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: COMMIT
[0m23:28:36.905809 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m23:28:36.906174 [debug] [Thread-3 (]: On model.dbt_an_data.stg_scrutins: COMMIT
[0m23:28:36.906520 [debug] [Thread-4 (]: On model.dbt_an_data.stg_pays: COMMIT
[0m23:28:36.907742 [debug] [Thread-2 (]: On model.dbt_an_data.int_organes: COMMIT
[0m23:28:36.908692 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:28:36.909060 [debug] [Thread-2 (]: On model.dbt_an_data.int_organes: COMMIT
[0m23:28:37.103368 [debug] [Thread-2 (]: SQL status: OK in 0.194 seconds
[0m23:28:37.107151 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_an_data.int_organes"
[0m23:28:37.107713 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:28:37.107896 [debug] [Thread-2 (]: On model.dbt_an_data.int_organes: BEGIN
[0m23:28:37.108381 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m23:28:37.108634 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:28:37.108846 [debug] [Thread-2 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

  
    
    

    create  table
      "an_data_pipeline"."main"."int_organes"
  
    as (
      

SELECT 
json_extract_string(json, '$.organe.uid') as uid,
json_extract_string(json, '$.organe.codeType') as codeType,
json_extract_string(json, '$.organe.libelle') as libelle,
json_extract_string(json, '$.organe.libelleEdition') as libelleEdition,
json_extract_string(json, '$.organe.libelleAbrege') as libelleAbrege,
json_extract_string(json, '$.organe.libelleAbrev') as libelleAbrev,
json_extract_string(json, '$.organe.viMoDe.dateDebut') as dateDebut,
json_extract_string(json, '$.organe.viMoDe.dateAgrement') as dateAgrement,
json_extract_string(json, '$.organe.viMoDe.dateFin') as dateFin,
json_extract_string(json, '$.organe.organeParent') as organeParent,
json_extract_string(json, '$.organe.chambre') as chambre,
json_extract_string(json, '$.organe.regime') as regime,
json_extract_string(json, '$.organe.legislature') as legislature
FROM "an_data_pipeline"."main"."stg_organes"
    );
  
  
  
[0m23:28:37.211588 [debug] [Thread-3 (]: SQL status: OK in 0.303 seconds
[0m23:28:37.212866 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.stg_scrutins"
[0m23:28:37.213046 [debug] [Thread-3 (]: On model.dbt_an_data.stg_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_scrutins"} */

      drop view if exists "an_data_pipeline"."main"."stg_scrutins__dbt_backup" cascade
    
[0m23:28:37.213297 [debug] [Thread-4 (]: SQL status: OK in 0.305 seconds
[0m23:28:37.215046 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.stg_pays"
[0m23:28:37.215232 [debug] [Thread-1 (]: SQL status: OK in 0.308 seconds
[0m23:28:37.215383 [debug] [Thread-4 (]: On model.dbt_an_data.stg_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_pays"} */

      drop view if exists "an_data_pipeline"."main"."stg_pays__dbt_backup" cascade
    
[0m23:28:37.216317 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.stg_reunions"
[0m23:28:37.216584 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.stg_reunions"} */

      drop view if exists "an_data_pipeline"."main"."stg_reunions__dbt_backup" cascade
    
[0m23:28:37.318626 [debug] [Thread-4 (]: SQL status: OK in 0.102 seconds
[0m23:28:37.318957 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m23:28:37.319262 [debug] [Thread-3 (]: SQL status: OK in 0.106 seconds
[0m23:28:37.320494 [debug] [Thread-4 (]: On model.dbt_an_data.stg_pays: Close
[0m23:28:37.321622 [debug] [Thread-1 (]: On model.dbt_an_data.stg_reunions: Close
[0m23:28:37.322674 [debug] [Thread-3 (]: On model.dbt_an_data.stg_scrutins: Close
[0m23:28:37.323211 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef35c809-8938-447b-8eca-897bca279c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108da26c0>]}
[0m23:28:37.323659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef35c809-8938-447b-8eca-897bca279c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108190620>]}
[0m23:28:37.324220 [info ] [Thread-4 (]: 5 of 17 OK created sql view model main.stg_pays ................................ [[32mOK[0m in 0.74s]
[0m23:28:37.324616 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef35c809-8938-447b-8eca-897bca279c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108191220>]}
[0m23:28:37.325045 [info ] [Thread-1 (]: 6 of 17 OK created sql view model main.stg_reunions ............................ [[32mOK[0m in 0.74s]
[0m23:28:37.325491 [debug] [Thread-4 (]: Finished running node model.dbt_an_data.stg_pays
[0m23:28:37.325957 [info ] [Thread-3 (]: 7 of 17 OK created sql view model main.stg_scrutins ............................ [[32mOK[0m in 0.74s]
[0m23:28:37.326406 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_reunions
[0m23:28:37.326735 [debug] [Thread-4 (]: Began running node model.dbt_an_data.int_acteurs
[0m23:28:37.327162 [debug] [Thread-3 (]: Finished running node model.dbt_an_data.stg_scrutins
[0m23:28:37.327503 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_mandats
[0m23:28:37.327917 [info ] [Thread-4 (]: 9 of 17 START sql incremental model main.int_acteurs ........................... [RUN]
[0m23:28:37.328252 [debug] [Thread-3 (]: Began running node model.dbt_an_data.int_amendements
[0m23:28:37.328623 [info ] [Thread-1 (]: 10 of 17 START sql incremental model main.int_mandats .......................... [RUN]
[0m23:28:37.328986 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_pays, now model.dbt_an_data.int_acteurs)
[0m23:28:37.329293 [info ] [Thread-3 (]: 11 of 17 START sql incremental model main.int_amendements ...................... [RUN]
[0m23:28:37.329609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_reunions, now model.dbt_an_data.int_mandats)
[0m23:28:37.329872 [debug] [Thread-4 (]: Began compiling node model.dbt_an_data.int_acteurs
[0m23:28:37.330142 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_scrutins, now model.dbt_an_data.int_amendements)
[0m23:28:37.330397 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_mandats
[0m23:28:37.332834 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_an_data.int_acteurs"
[0m23:28:37.333169 [debug] [Thread-3 (]: Began compiling node model.dbt_an_data.int_amendements
[0m23:28:37.335265 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_mandats"
[0m23:28:37.337404 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements"
[0m23:28:37.338219 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_mandats
[0m23:28:37.340820 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:28:37.341181 [debug] [Thread-4 (]: Began executing node model.dbt_an_data.int_acteurs
[0m23:28:37.341427 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__f5aed1e15ef0" cascade
    
[0m23:28:37.341642 [debug] [Thread-3 (]: Began executing node model.dbt_an_data.int_amendements
[0m23:28:37.343808 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:28:37.344037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:37.346127 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:28:37.346380 [debug] [Thread-4 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__95f27231ff94" cascade
    
[0m23:28:37.346803 [debug] [Thread-3 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__66afafc4fddb" cascade
    
[0m23:28:37.347010 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:28:37.347209 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:28:37.450949 [debug] [Thread-4 (]: SQL status: OK in 0.104 seconds
[0m23:28:37.451254 [debug] [Thread-3 (]: SQL status: OK in 0.104 seconds
[0m23:28:37.451460 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m23:28:37.452929 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:28:37.454089 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:28:37.456465 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:28:37.456673 [debug] [Thread-4 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:28:37.456863 [debug] [Thread-3 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:28:37.457042 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:28:37.457695 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m23:28:37.457924 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:28:37.458123 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m23:28:37.458779 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:28:37.459456 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:28:37.460048 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:28:37.460209 [debug] [Thread-3 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m23:28:37.460365 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m23:28:37.460513 [debug] [Thread-4 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m23:28:37.460872 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:28:37.461032 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:28:37.461192 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m23:28:37.461404 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m23:28:37.461578 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m23:28:37.461722 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:28:37.461868 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:28:37.462020 [debug] [Thread-4 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m23:28:37.462173 [debug] [Thread-3 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m23:28:37.643173 [debug] [Thread-4 (]: SQL status: OK in 0.180 seconds
[0m23:28:37.644217 [debug] [Thread-1 (]: SQL status: OK in 0.183 seconds
[0m23:28:37.644975 [debug] [Thread-3 (]: SQL status: OK in 0.182 seconds
[0m23:28:37.647453 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:28:37.649591 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:28:37.651229 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:28:37.651888 [debug] [Thread-4 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    

  
[0m23:28:37.652549 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    

  
[0m23:28:37.653179 [debug] [Thread-3 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    

  
[0m23:28:37.653974 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:28:37.654448 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m23:28:37.654954 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m23:28:37.656616 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m23:28:37.658443 [debug] [Thread-4 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m23:28:37.660404 [debug] [Thread-3 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m23:28:37.660995 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:28:37.661540 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:28:37.662020 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:28:37.662425 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m23:28:37.662836 [debug] [Thread-4 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m23:28:37.663252 [debug] [Thread-3 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m23:28:37.739478 [debug] [Thread-2 (]: SQL status: OK in 0.630 seconds
[0m23:28:37.741961 [debug] [Thread-2 (]: On model.dbt_an_data.int_organes: COMMIT
[0m23:28:37.742146 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:28:37.742294 [debug] [Thread-2 (]: On model.dbt_an_data.int_organes: COMMIT
[0m23:28:37.764766 [debug] [Thread-3 (]: SQL status: OK in 0.101 seconds
[0m23:28:37.765111 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements"
[0m23:28:37.765313 [debug] [Thread-4 (]: SQL status: OK in 0.102 seconds
[0m23:28:37.765777 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_an_data.int_acteurs"
[0m23:28:37.765967 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m23:28:37.766245 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_mandats"
[0m23:28:37.766560 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:28:37.766732 [debug] [Thread-3 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m23:28:37.766970 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:28:37.767126 [debug] [Thread-4 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m23:28:37.767357 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m23:28:37.767513 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:28:37.767712 [debug] [Thread-3 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

  
    
    

    create  table
      "an_data_pipeline"."main"."int_amendements"
  
    as (
      

SELECT
json_extract_string(json, '$.amendement.uid') AS uid,
json_extract_string(json, '$.amendement.chronotag') AS chronotag,
json_extract_string(json, '$.amendement.examenRef') AS examenRef,
json_extract_string(json, '$.amendement.amendementParentRef') AS amendementParentRef,
json_extract_string(json, '$.amendement.signataires.auteur.typeAuteur') AS typeAuteur,
json_extract_string(json, '$.amendement.signataires.auteur.acteurRef') AS refAuteur,
json_extract_string(json, '$.amendement.signataires.auteur.groupePolitique') AS groupePolitiqueAuteur,
json_extract_string(json, '$.amendement.cycleDeVie.dateDepot') AS dateDepot,
json_extract_string(json, '$.amendement.cycleDeVie.datePublication') AS datePublication,
json_extract_string(json, '$.amendement.cycleDeVie.soumisArticle40') AS soumisArticle40,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.code') AS codeEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.libelle') AS libelleEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.code') AS codeSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.dateSort') AS dateSort,
json_extract_string(json, '$.amendement.cycleDeVie.sort') AS sort,
split_part(replace(filename, '.json', ''), '/', -1) AS id_amendement,
split_part(replace(filename, '.json', ''), '/', -2) AS id_texte,
split_part(replace(filename, '.json', ''), '/', -3) AS id_dossier_legislatif,
id_texte[:4] AS nature_texte,
id_texte[5:6] AS source_texte,
regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 1) AS prefix_bibard,
regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 2) AS numero_bibard,
regexp_extract(id_amendement, '(SEA|PO\d*)', 1) AS code_organe,
regexp_extract(id_amendement, '(P)(\d*)(D)', 2) AS numero_partie,
regexp_extract(id_amendement, '(D)(\d*)(N)', 2) AS numero_deliberation,
regexp_extract(id_amendement, '(D)(\d*)(N)(\d*)', 4) AS numero_court
from "an_data_pipeline"."main"."stg_amendements"
    );
  
  
  
[0m23:28:37.768072 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:28:37.768228 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m23:28:37.768465 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m23:28:37.768610 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:28:37.768795 [debug] [Thread-4 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

  
    
    

    create  table
      "an_data_pipeline"."main"."int_acteurs"
  
    as (
      

SELECT 
json_extract_string(json, '$.acteur.uid.#text') as uid,
json_extract_string(json, '$.acteur.etatCivil.ident.civ') as civ,
json_extract_string(json, '$.acteur.etatCivil.ident.prenom') as prenom,
json_extract_string(json, '$.acteur.etatCivil.ident.nom') as nom,
json_extract_string(json, '$.acteur.etatCivil.ident.trigramme') as trigramme,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.dateNais') as dateNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.villeNais') as villeNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.depNais') as depNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.paysNais') as paysNais,
json_extract_string(json, '$.acteur.etatCivil.dateDeces') as dateDeces,
json_extract_string(json, '$.acteur.profession.libelleCourant') as libelleCourant,
json_extract_string(json, '$.acteur.profession.socProcINSEE.catSocPro') as catSocPro,
json_extract_string(json, '$.acteur.profession.socProcINSEE.famSocPro') as famSocPro,
json_extract_string(json, '$.acteur.uri_hatvp') as uri_hatvp
FROM "an_data_pipeline"."main"."stg_acteurs"
    );
  
  
  
[0m23:28:37.769064 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:28:37.769207 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:28:37.769373 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

  
    
    

    create  table
      "an_data_pipeline"."main"."int_mandats"
  
    as (
      

SELECT 
json_extract_string(mandat.value, '$.uid') as uid,
json_extract_string(mandat.value, '$.acteurRef') as acteurRef,
json_extract_string(mandat.value, '$.legislature') as legislature,
json_extract_string(mandat.value, '$.typeOrgane') as typeOrgane,
json_extract_string(mandat.value, '$.dateDebut') as dateDebut,
json_extract_string(mandat.value, '$.dateFin') as dateFin,
json_extract_string(mandat.value, '$.preseance') as preseance,
json_extract_string(mandat.value, '$.nominPrincipale') as nominPrincipale,
json_extract_string(mandat.value, '$.infosQualite.codeQualite') as codeQualite,
json_extract_string(mandat.value, '$.organes.organeRef') as organeRef,
FROM "an_data_pipeline"."main"."stg_acteurs" act, json_each(json->'acteur'->'mandats'->'mandat') mandat
    );
  
  
  
[0m23:28:38.019080 [debug] [Thread-2 (]: SQL status: OK in 0.277 seconds
[0m23:28:38.020431 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:28:38.020641 [debug] [Thread-2 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__c6b3d4044518" cascade
    
[0m23:28:38.126752 [debug] [Thread-2 (]: SQL status: OK in 0.105 seconds
[0m23:28:38.132861 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:28:38.133811 [debug] [Thread-2 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__c6b3d4044518" cascade
    
[0m23:28:38.239855 [debug] [Thread-3 (]: SQL status: OK in 0.472 seconds
[0m23:28:38.242667 [debug] [Thread-3 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m23:28:38.243701 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:28:38.244128 [debug] [Thread-3 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m23:28:38.250162 [debug] [Thread-2 (]: SQL status: OK in 0.116 seconds
[0m23:28:38.251521 [debug] [Thread-2 (]: On model.dbt_an_data.int_organes: Close
[0m23:28:38.252552 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef35c809-8938-447b-8eca-897bca279c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee7c80>]}
[0m23:28:38.253633 [info ] [Thread-2 (]: 8 of 17 OK created sql incremental model main.int_organes ...................... [[32mOK[0m in 1.66s]
[0m23:28:38.254381 [debug] [Thread-2 (]: Finished running node model.dbt_an_data.int_organes
[0m23:28:38.254695 [debug] [Thread-2 (]: Began running node model.dbt_an_data.int_amendements_cosignataires
[0m23:28:38.255041 [info ] [Thread-2 (]: 12 of 17 START sql incremental model main.int_amendements_cosignataires ........ [RUN]
[0m23:28:38.255397 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_organes, now model.dbt_an_data.int_amendements_cosignataires)
[0m23:28:38.255656 [debug] [Thread-2 (]: Began compiling node model.dbt_an_data.int_amendements_cosignataires
[0m23:28:38.263306 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements_cosignataires"
[0m23:28:38.265818 [debug] [Thread-2 (]: Began executing node model.dbt_an_data.int_amendements_cosignataires
[0m23:28:38.269893 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:28:38.270224 [debug] [Thread-2 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__6d713cc2f0bf" cascade
    
[0m23:28:38.270415 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:28:38.472132 [debug] [Thread-3 (]: SQL status: OK in 0.228 seconds
[0m23:28:38.473562 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:28:38.473742 [debug] [Thread-3 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__66afafc4fddb" cascade
    
[0m23:28:38.485664 [debug] [Thread-2 (]: SQL status: OK in 0.215 seconds
[0m23:28:38.487099 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:28:38.487293 [debug] [Thread-2 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:28:38.487994 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m23:28:38.488682 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:28:38.488844 [debug] [Thread-2 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m23:28:38.489204 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m23:28:38.489359 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:28:38.489508 [debug] [Thread-2 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m23:28:38.503468 [debug] [Thread-4 (]: SQL status: OK in 0.734 seconds
[0m23:28:38.504138 [debug] [Thread-4 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m23:28:38.504317 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:28:38.504467 [debug] [Thread-4 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m23:28:38.590483 [debug] [Thread-3 (]: SQL status: OK in 0.117 seconds
[0m23:28:38.593015 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:28:38.593329 [debug] [Thread-3 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__66afafc4fddb" cascade
    
[0m23:28:38.594575 [debug] [Thread-2 (]: SQL status: OK in 0.105 seconds
[0m23:28:38.595432 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:28:38.595724 [debug] [Thread-2 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    

  
[0m23:28:38.596059 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m23:28:38.596952 [debug] [Thread-2 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m23:28:38.597199 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:28:38.597451 [debug] [Thread-2 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m23:28:38.705074 [debug] [Thread-1 (]: SQL status: OK in 0.935 seconds
[0m23:28:38.706571 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m23:28:38.706972 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:28:38.707306 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m23:28:38.721883 [debug] [Thread-2 (]: SQL status: OK in 0.124 seconds
[0m23:28:38.722342 [debug] [Thread-4 (]: SQL status: OK in 0.218 seconds
[0m23:28:38.723291 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements_cosignataires"
[0m23:28:38.725926 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:28:38.726462 [debug] [Thread-4 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__95f27231ff94" cascade
    
[0m23:28:38.727318 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:28:38.727705 [debug] [Thread-2 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m23:28:38.728620 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m23:28:38.728982 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:28:38.729407 [debug] [Thread-2 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

  
    
    

    create  table
      "an_data_pipeline"."main"."int_amendements_cosignataires"
  
    as (
      

WITH cosignataires_arr AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef[*]') AS acteurRef
  FROM "an_data_pipeline"."main"."stg_amendements"
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') == 'ARRAY' AND acteurRef IS NOT NULL
), cosignataires_str AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef') AS acteurRef
  FROM "an_data_pipeline"."main"."stg_amendements"
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') <> 'ARRAY' AND acteurRef IS NOT NULL
)
SELECT 
  uid, 
  unnest(acteurRef) as acteurRef
FROM cosignataires_arr
UNION ALL
SELECT 
  uid, 
  acteurRef
FROM cosignataires_str
    );
  
  
  
[0m23:28:38.802681 [debug] [Thread-3 (]: SQL status: OK in 0.209 seconds
[0m23:28:38.804717 [debug] [Thread-3 (]: On model.dbt_an_data.int_amendements: Close
[0m23:28:38.805611 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef35c809-8938-447b-8eca-897bca279c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108368650>]}
[0m23:28:38.806477 [info ] [Thread-3 (]: 11 of 17 OK created sql incremental model main.int_amendements ................. [[32mOK[0m in 1.48s]
[0m23:28:38.807220 [debug] [Thread-3 (]: Finished running node model.dbt_an_data.int_amendements
[0m23:28:38.807770 [debug] [Thread-3 (]: Began running node model.dbt_an_data.int_agenda
[0m23:28:38.809890 [info ] [Thread-3 (]: 13 of 17 START sql incremental model main.int_agenda ........................... [RUN]
[0m23:28:38.810616 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements, now model.dbt_an_data.int_agenda)
[0m23:28:38.811092 [debug] [Thread-3 (]: Began compiling node model.dbt_an_data.int_agenda
[0m23:28:38.816062 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_an_data.int_agenda"
[0m23:28:38.817560 [debug] [Thread-3 (]: Began executing node model.dbt_an_data.int_agenda
[0m23:28:38.821962 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:28:38.822258 [debug] [Thread-3 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__f1c2e5d02353" cascade
    
[0m23:28:38.822478 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:28:38.979575 [debug] [Thread-1 (]: SQL status: OK in 0.271 seconds
[0m23:28:38.988321 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:28:38.989237 [debug] [Thread-4 (]: SQL status: OK in 0.262 seconds
[0m23:28:38.990101 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__f5aed1e15ef0" cascade
    
[0m23:28:38.995849 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:28:38.996845 [debug] [Thread-4 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__95f27231ff94" cascade
    
[0m23:28:39.041805 [debug] [Thread-3 (]: SQL status: OK in 0.219 seconds
[0m23:28:39.051640 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:28:39.052575 [debug] [Thread-3 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:28:39.055739 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m23:28:39.058152 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:28:39.058867 [debug] [Thread-3 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m23:28:39.060599 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m23:28:39.061242 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:28:39.061816 [debug] [Thread-3 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m23:28:39.104704 [debug] [Thread-4 (]: SQL status: OK in 0.107 seconds
[0m23:28:39.107361 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m23:28:39.110221 [debug] [Thread-4 (]: On model.dbt_an_data.int_acteurs: Close
[0m23:28:39.115615 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:28:39.116498 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__f5aed1e15ef0" cascade
    
[0m23:28:39.117755 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef35c809-8938-447b-8eca-897bca279c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108752b70>]}
[0m23:28:39.119389 [info ] [Thread-4 (]: 9 of 17 OK created sql incremental model main.int_acteurs ...................... [[32mOK[0m in 1.79s]
[0m23:28:39.120531 [debug] [Thread-4 (]: Finished running node model.dbt_an_data.int_acteurs
[0m23:28:39.121213 [debug] [Thread-4 (]: Began running node model.dbt_an_data.int_pays
[0m23:28:39.122169 [info ] [Thread-4 (]: 14 of 17 START sql incremental model main.int_pays ............................. [RUN]
[0m23:28:39.123007 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_acteurs, now model.dbt_an_data.int_pays)
[0m23:28:39.123523 [debug] [Thread-4 (]: Began compiling node model.dbt_an_data.int_pays
[0m23:28:39.127718 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_an_data.int_pays"
[0m23:28:39.128729 [debug] [Thread-4 (]: Began executing node model.dbt_an_data.int_pays
[0m23:28:39.133682 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:28:39.134175 [debug] [Thread-4 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__efe1a0e33abf" cascade
    
[0m23:28:39.134602 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:28:39.165856 [debug] [Thread-3 (]: SQL status: OK in 0.103 seconds
[0m23:28:39.167301 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:28:39.167666 [debug] [Thread-3 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    

  
[0m23:28:39.168056 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m23:28:39.169119 [debug] [Thread-3 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m23:28:39.169434 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:28:39.169714 [debug] [Thread-3 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m23:28:39.206019 [debug] [Thread-2 (]: SQL status: OK in 0.476 seconds
[0m23:28:39.206825 [debug] [Thread-2 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m23:28:39.207014 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:28:39.207166 [debug] [Thread-2 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m23:28:39.222886 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m23:28:39.224194 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: Close
[0m23:28:39.224723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef35c809-8938-447b-8eca-897bca279c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d85850>]}
[0m23:28:39.225293 [info ] [Thread-1 (]: 10 of 17 OK created sql incremental model main.int_mandats ..................... [[32mOK[0m in 1.90s]
[0m23:28:39.225949 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_mandats
[0m23:28:39.226359 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_reunions
[0m23:28:39.226909 [info ] [Thread-1 (]: 15 of 17 START sql incremental model main.int_reunions ......................... [RUN]
[0m23:28:39.227409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_mandats, now model.dbt_an_data.int_reunions)
[0m23:28:39.227801 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_reunions
[0m23:28:39.231253 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_reunions"
[0m23:28:39.231992 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_reunions
[0m23:28:39.235953 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:28:39.236364 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__3ef9d757a17d" cascade
    
[0m23:28:39.236719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:39.239674 [debug] [Thread-4 (]: SQL status: OK in 0.105 seconds
[0m23:28:39.244456 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:28:39.244829 [debug] [Thread-4 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:28:39.246120 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m23:28:39.247422 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:28:39.247749 [debug] [Thread-4 (]: On model.dbt_an_data.int_pays: BEGIN
[0m23:28:39.248489 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m23:28:39.248794 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:28:39.249088 [debug] [Thread-4 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m23:28:39.276497 [debug] [Thread-3 (]: SQL status: OK in 0.106 seconds
[0m23:28:39.277535 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_an_data.int_agenda"
[0m23:28:39.278360 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:28:39.278703 [debug] [Thread-3 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m23:28:39.279644 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m23:28:39.279972 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:28:39.280287 [debug] [Thread-3 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

  
    
    

    create  table
      "an_data_pipeline"."main"."int_agenda"
  
    as (
      

SELECT * 
FROM "an_data_pipeline"."main"."stg_agenda"
    );
  
  
  
[0m23:28:39.429410 [debug] [Thread-2 (]: SQL status: OK in 0.222 seconds
[0m23:28:39.436747 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:28:39.437803 [debug] [Thread-2 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__6d713cc2f0bf" cascade
    
[0m23:28:39.449721 [debug] [Thread-1 (]: SQL status: OK in 0.213 seconds
[0m23:28:39.455974 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:28:39.456830 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:28:39.458781 [debug] [Thread-4 (]: SQL status: OK in 0.209 seconds
[0m23:28:39.460444 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:28:39.460989 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:28:39.461558 [debug] [Thread-4 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    

  
[0m23:28:39.462431 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m23:28:39.464235 [debug] [Thread-4 (]: On model.dbt_an_data.int_pays: COMMIT
[0m23:28:39.466277 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:28:39.466741 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:28:39.467194 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m23:28:39.467628 [debug] [Thread-4 (]: On model.dbt_an_data.int_pays: COMMIT
[0m23:28:39.468962 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:28:39.469445 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:28:39.469925 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m23:28:39.554854 [debug] [Thread-2 (]: SQL status: OK in 0.116 seconds
[0m23:28:39.562415 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:28:39.563188 [debug] [Thread-2 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__6d713cc2f0bf" cascade
    
[0m23:28:39.567104 [debug] [Thread-4 (]: SQL status: OK in 0.099 seconds
[0m23:28:39.568464 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_an_data.int_pays"
[0m23:28:39.569928 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:28:39.570902 [debug] [Thread-4 (]: On model.dbt_an_data.int_pays: BEGIN
[0m23:28:39.572873 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m23:28:39.573645 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:28:39.574218 [debug] [Thread-4 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

  
    
    

    create  table
      "an_data_pipeline"."main"."int_pays"
  
    as (
      

SELECT
json_extract_string(json, '$.pays.uid') as uid,
json_extract_string(json, '$.pays.code_insee') as code_insee,
json_extract_string(json, '$.pays.libelleInsee') as libelleInsee,
json_extract_string(json, '$.pays.nomCourant') as nomCourant,
json_extract_string(json, '$.pays.code_iso2A') as code_iso2A,
json_extract_string(json, '$.pays.code_iso3A') as code_iso3A,
json_extract_string(json, '$.pays.code_iso3N') as code_iso3N,
json_extract_string(json, '$.pays.libelleIso') as libelleIso,
json_extract_string(json, '$.pays.libelleANCourt') as libelleANCourt,
json_extract_string(json, '$.pays.libelleANLong') as libelleANLong,
json_extract_string(json, '$.pays.sourceJuridique') as sourceJuridique,
json_extract_string(json, '$.pays.activ') as activ
FROM "an_data_pipeline"."main"."stg_pays"
    );
  
  
  
[0m23:28:39.575723 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m23:28:39.577290 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:28:39.577753 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    

  
[0m23:28:39.578254 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:28:39.579698 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m23:28:39.580156 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:28:39.580590 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m23:28:39.674076 [debug] [Thread-2 (]: SQL status: OK in 0.110 seconds
[0m23:28:39.678485 [debug] [Thread-2 (]: On model.dbt_an_data.int_amendements_cosignataires: Close
[0m23:28:39.680531 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef35c809-8938-447b-8eca-897bca279c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d3db20>]}
[0m23:28:39.681885 [info ] [Thread-2 (]: 12 of 17 OK created sql incremental model main.int_amendements_cosignataires ... [[32mOK[0m in 1.42s]
[0m23:28:39.682970 [debug] [Thread-2 (]: Finished running node model.dbt_an_data.int_amendements_cosignataires
[0m23:28:39.683697 [debug] [Thread-2 (]: Began running node model.dbt_an_data.int_scrutins
[0m23:28:39.684516 [info ] [Thread-2 (]: 16 of 17 START sql incremental model main.int_scrutins ......................... [RUN]
[0m23:28:39.685410 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements_cosignataires, now model.dbt_an_data.int_scrutins)
[0m23:28:39.686035 [debug] [Thread-2 (]: Began compiling node model.dbt_an_data.int_scrutins
[0m23:28:39.692888 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins"
[0m23:28:39.693780 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m23:28:39.695120 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_reunions"
[0m23:28:39.696292 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:28:39.697231 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m23:28:39.696789 [debug] [Thread-2 (]: Began executing node model.dbt_an_data.int_scrutins
[0m23:28:39.702883 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:28:39.703383 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m23:28:39.703817 [debug] [Thread-3 (]: SQL status: OK in 0.423 seconds
[0m23:28:39.704245 [debug] [Thread-2 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__c8be131bb748" cascade
    
[0m23:28:39.704686 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:28:39.706264 [debug] [Thread-3 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m23:28:39.706637 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:28:39.707076 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

  
    
    

    create  table
      "an_data_pipeline"."main"."int_reunions"
  
    as (
      

SELECT
json_extract_string(json, '$.reunion.uid') AS uid,
json_extract_string(json, '$.reunion.timeStampDebut') AS timeStampDebut,
json_extract_string(json, '$.reunion.lieu.lieuRef') AS lieuRef,
json_extract_string(json, '$.reunion.lieu.libelleLong') AS lieuLibelle,
json_extract_string(json, '$.reunion.cycleDeVie.etat') AS cycleDeVieEtat,
json_extract_string(json, '$.reunion.demandeur') AS demandeur,
json_extract_string(json, '$.reunion.organeReuniRef') AS organeReuniRef,
json_extract_string(json, '$.reunion.visioConference') AS visioConference,
json_extract_string(json, '$.reunion.sessionRef') AS sessionRef,
json_extract_string(json, '$.reunion.ouverturePresse') AS ouverturePresse,
json_extract_string(json, '$.reunion.captationVideo') AS captationVideo,
json_extract_string(json, '$.reunion.ODJ.convocationODJ.item') AS convocationODJ,
json_extract_string(json, '$.reunion.ODJ.resumeODJ.item') AS resumeODJ,
json_extract_string(json, '$.reunion.compteRenduRef') AS compteRenduRef,
json_extract_string(json, '$.reunion.identifiants.numSeanceJO') AS numSeanceJO,
json_extract_string(json, '$.reunion.identifiants.idJO') AS idJO,
json_extract_string(json, '$.reunion.identifiants.quantieme') AS quantieme,
json_extract_string(json, '$.reunion.identifiants.DataSeance') AS DataSeance
FROM "an_data_pipeline"."main"."stg_reunions"
    );
  
  
  
[0m23:28:39.707519 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:28:39.708367 [debug] [Thread-3 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m23:28:39.809922 [debug] [Thread-2 (]: SQL status: OK in 0.103 seconds
[0m23:28:39.811489 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:28:39.811679 [debug] [Thread-2 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:28:39.812529 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m23:28:39.813215 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:28:39.813390 [debug] [Thread-2 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m23:28:39.813798 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m23:28:39.813954 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:28:39.814102 [debug] [Thread-2 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m23:28:39.883066 [debug] [Thread-4 (]: SQL status: OK in 0.308 seconds
[0m23:28:39.883690 [debug] [Thread-4 (]: On model.dbt_an_data.int_pays: COMMIT
[0m23:28:39.883856 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:28:39.884005 [debug] [Thread-4 (]: On model.dbt_an_data.int_pays: COMMIT
[0m23:28:39.922185 [debug] [Thread-3 (]: SQL status: OK in 0.213 seconds
[0m23:28:39.923376 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:28:39.923554 [debug] [Thread-3 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__f1c2e5d02353" cascade
    
[0m23:28:40.017759 [debug] [Thread-2 (]: SQL status: OK in 0.203 seconds
[0m23:28:40.018496 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:28:40.018679 [debug] [Thread-2 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    

  
[0m23:28:40.018907 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m23:28:40.019442 [debug] [Thread-2 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m23:28:40.019613 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:28:40.019779 [debug] [Thread-2 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m23:28:40.103460 [debug] [Thread-4 (]: SQL status: OK in 0.219 seconds
[0m23:28:40.105054 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:28:40.105345 [debug] [Thread-4 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__efe1a0e33abf" cascade
    
[0m23:28:40.121831 [debug] [Thread-2 (]: SQL status: OK in 0.102 seconds
[0m23:28:40.122326 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins"
[0m23:28:40.123232 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:28:40.123401 [debug] [Thread-2 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m23:28:40.123919 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m23:28:40.124091 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:28:40.124281 [debug] [Thread-2 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

  
    
    

    create  table
      "an_data_pipeline"."main"."int_scrutins"
  
    as (
      

SELECT
date_T_insert,
json_extract_string(json, '$.scrutin.uid') AS uid,
json_extract_string(json, '$.scrutin.numero') AS numero,
json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
json_extract_string(json, '$.scrutin.legislature') AS legislature,
json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
json_extract_string(json, '$.scrutin.titre') AS titre,
json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote
FROM "an_data_pipeline"."main"."stg_scrutins"
    );
  
  
  
[0m23:28:40.139876 [debug] [Thread-3 (]: SQL status: OK in 0.216 seconds
[0m23:28:40.141732 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:28:40.141940 [debug] [Thread-3 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__f1c2e5d02353" cascade
    
[0m23:28:40.225506 [debug] [Thread-4 (]: SQL status: OK in 0.120 seconds
[0m23:28:40.227396 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:28:40.227598 [debug] [Thread-4 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__efe1a0e33abf" cascade
    
[0m23:28:40.248928 [debug] [Thread-3 (]: SQL status: OK in 0.107 seconds
[0m23:28:40.249748 [debug] [Thread-3 (]: On model.dbt_an_data.int_agenda: Close
[0m23:28:40.250072 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef35c809-8938-447b-8eca-897bca279c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10771f0e0>]}
[0m23:28:40.250396 [info ] [Thread-3 (]: 13 of 17 OK created sql incremental model main.int_agenda ...................... [[32mOK[0m in 1.44s]
[0m23:28:40.250657 [debug] [Thread-3 (]: Finished running node model.dbt_an_data.int_agenda
[0m23:28:40.250843 [debug] [Thread-3 (]: Began running node model.dbt_an_data.int_scrutins_votes
[0m23:28:40.251041 [info ] [Thread-3 (]: 17 of 17 START sql incremental model main.int_scrutins_votes ................... [RUN]
[0m23:28:40.251253 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_agenda, now model.dbt_an_data.int_scrutins_votes)
[0m23:28:40.251456 [debug] [Thread-3 (]: Began compiling node model.dbt_an_data.int_scrutins_votes
[0m23:28:40.254870 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins_votes"
[0m23:28:40.255941 [debug] [Thread-3 (]: Began executing node model.dbt_an_data.int_scrutins_votes
[0m23:28:40.257876 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:28:40.258080 [debug] [Thread-3 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__c11acad3a6ba" cascade
    
[0m23:28:40.258238 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:28:40.424442 [debug] [Thread-4 (]: SQL status: OK in 0.196 seconds
[0m23:28:40.424970 [debug] [Thread-3 (]: SQL status: OK in 0.167 seconds
[0m23:28:40.426076 [debug] [Thread-4 (]: On model.dbt_an_data.int_pays: Close
[0m23:28:40.427816 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:28:40.428695 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef35c809-8938-447b-8eca-897bca279c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087f7950>]}
[0m23:28:40.429037 [debug] [Thread-3 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:28:40.429890 [info ] [Thread-4 (]: 14 of 17 OK created sql incremental model main.int_pays ........................ [[32mOK[0m in 1.31s]
[0m23:28:40.431085 [debug] [Thread-4 (]: Finished running node model.dbt_an_data.int_pays
[0m23:28:40.431910 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m23:28:40.432765 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:28:40.432979 [debug] [Thread-3 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m23:28:40.433590 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m23:28:40.433759 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:28:40.433923 [debug] [Thread-3 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m23:28:40.537928 [debug] [Thread-3 (]: SQL status: OK in 0.104 seconds
[0m23:28:40.538936 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:28:40.539151 [debug] [Thread-3 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    

  
[0m23:28:40.539444 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m23:28:40.540130 [debug] [Thread-3 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m23:28:40.540326 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:28:40.540492 [debug] [Thread-3 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m23:28:40.639080 [debug] [Thread-1 (]: SQL status: OK in 0.931 seconds
[0m23:28:40.640610 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m23:28:40.640871 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:28:40.641129 [debug] [Thread-3 (]: SQL status: OK in 0.100 seconds
[0m23:28:40.641296 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m23:28:40.641763 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins_votes"
[0m23:28:40.643588 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:28:40.643777 [debug] [Thread-3 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m23:28:40.644276 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m23:28:40.644431 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:28:40.644736 [debug] [Thread-3 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

  
    
    

    create  table
      "an_data_pipeline"."main"."int_scrutins_votes"
  
    as (
      

WITH grp AS (
      -- explode les groupes (1 par groupe)
      SELECT
          json_extract_string(j.json, '$.scrutin.uid') AS uid,
          json_extract_string(g.value, '$.organeRef') AS groupe_organe,
          g.value AS groupe_json
      FROM "an_data_pipeline"."main"."stg_scrutins" j,
           json_each(json->'scrutin'->'ventilationVotes'->'organe'->'groupes'->'groupe') g
  ),

  positions_array AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          p.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'pours'->'votant') p
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          c.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'contres'->'votant') c
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          a.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'abstentions'->'votant') a
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          n.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'nonVotants'->'votant') n
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[ARRAY]'
  ),
  positions_object AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[OBJECT]'
  ),

  clean AS (
      -- sécurise les champs (souvent string ou null)
      SELECT
          uid,
          groupe_organe,
          type_vote,
          json_extract_string(vote_json, '$.acteurRef') AS acteurRef,
          json_extract_string(vote_json, '$.mandatRef') AS mandatRef,
          json_extract_string(vote_json, '$.parDelegation') AS parDelegation,
          json_extract_string(vote_json, '$.numPlace') AS numPlace,
          json_extract_string(vote_json, '$.causePositionVote') AS cause
      FROM positions_array
      UNION ALL
      SELECT * 
      FROM positions_object
  )

  SELECT * FROM clean
    );
  
  
  
[0m23:28:40.947957 [debug] [Thread-1 (]: SQL status: OK in 0.306 seconds
[0m23:28:40.951854 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:28:40.952147 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__3ef9d757a17d" cascade
    
[0m23:28:41.054821 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m23:28:41.057237 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:28:41.057464 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__3ef9d757a17d" cascade
    
[0m23:28:41.166270 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m23:28:41.171233 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: Close
[0m23:28:41.175811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef35c809-8938-447b-8eca-897bca279c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107746150>]}
[0m23:28:41.181541 [info ] [Thread-1 (]: 15 of 17 OK created sql incremental model main.int_reunions .................... [[32mOK[0m in 1.94s]
[0m23:28:41.184185 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_reunions
[0m23:28:42.506676 [debug] [Thread-2 (]: SQL status: OK in 2.381 seconds
[0m23:28:42.511766 [debug] [Thread-2 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m23:28:42.512182 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:28:42.512366 [debug] [Thread-2 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m23:28:42.767593 [debug] [Thread-2 (]: SQL status: OK in 0.255 seconds
[0m23:28:42.771448 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:28:42.771766 [debug] [Thread-2 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__c8be131bb748" cascade
    
[0m23:28:42.881578 [debug] [Thread-2 (]: SQL status: OK in 0.110 seconds
[0m23:28:42.883527 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:28:42.883761 [debug] [Thread-2 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__c8be131bb748" cascade
    
[0m23:28:43.028835 [debug] [Thread-2 (]: SQL status: OK in 0.145 seconds
[0m23:28:43.031381 [debug] [Thread-2 (]: On model.dbt_an_data.int_scrutins: Close
[0m23:28:43.032480 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef35c809-8938-447b-8eca-897bca279c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10750a240>]}
[0m23:28:43.033427 [info ] [Thread-2 (]: 16 of 17 OK created sql incremental model main.int_scrutins .................... [[32mOK[0m in 3.35s]
[0m23:28:43.033867 [debug] [Thread-2 (]: Finished running node model.dbt_an_data.int_scrutins
[0m23:28:53.198874 [debug] [Thread-3 (]: SQL status: OK in 12.554 seconds
[0m23:28:53.202843 [debug] [Thread-3 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m23:28:53.203106 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:28:53.203264 [debug] [Thread-3 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m23:28:53.811660 [debug] [Thread-3 (]: SQL status: OK in 0.608 seconds
[0m23:28:53.819352 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:28:53.820061 [debug] [Thread-3 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__c11acad3a6ba" cascade
    
[0m23:28:53.930530 [debug] [Thread-3 (]: SQL status: OK in 0.110 seconds
[0m23:28:53.935529 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:28:53.936138 [debug] [Thread-3 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__c11acad3a6ba" cascade
    
[0m23:28:54.048741 [debug] [Thread-3 (]: SQL status: OK in 0.112 seconds
[0m23:28:54.052900 [debug] [Thread-3 (]: On model.dbt_an_data.int_scrutins_votes: Close
[0m23:28:54.055347 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef35c809-8938-447b-8eca-897bca279c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087c0920>]}
[0m23:28:54.057405 [info ] [Thread-3 (]: 17 of 17 OK created sql incremental model main.int_scrutins_votes .............. [[32mOK[0m in 13.80s]
[0m23:28:54.058610 [debug] [Thread-3 (]: Finished running node model.dbt_an_data.int_scrutins_votes
[0m23:28:54.065273 [debug] [MainThread]: Using duckdb connection "master"
[0m23:28:54.066039 [debug] [MainThread]: On master: BEGIN
[0m23:28:54.066712 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:28:54.068484 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:28:54.069039 [debug] [MainThread]: On master: COMMIT
[0m23:28:54.069542 [debug] [MainThread]: Using duckdb connection "master"
[0m23:28:54.069959 [debug] [MainThread]: On master: COMMIT
[0m23:28:54.070592 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:28:54.070976 [debug] [MainThread]: On master: Close
[0m23:28:54.071551 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:28:54.071906 [debug] [MainThread]: Connection 'model.dbt_an_data.int_reunions' was properly closed.
[0m23:28:54.072226 [debug] [MainThread]: Connection 'model.dbt_an_data.int_scrutins' was properly closed.
[0m23:28:54.072515 [debug] [MainThread]: Connection 'model.dbt_an_data.int_scrutins_votes' was properly closed.
[0m23:28:54.072793 [debug] [MainThread]: Connection 'model.dbt_an_data.int_pays' was properly closed.
[0m23:28:54.073830 [info ] [MainThread]: 
[0m23:28:54.074863 [info ] [MainThread]: Finished running 10 incremental models, 1 project hook, 7 view models in 0 hours 0 minutes and 20.60 seconds (20.60s).
[0m23:28:54.078519 [debug] [MainThread]: Command end result
[0m23:28:54.109141 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m23:28:54.115428 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m23:28:54.121167 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m23:28:54.121383 [info ] [MainThread]: 
[0m23:28:54.121805 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:28:54.121979 [info ] [MainThread]: 
[0m23:28:54.122507 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=18
[0m23:28:54.123298 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 21.64156, "process_in_blocks": "0", "process_kernel_time": 8.115388, "process_mem_max_rss": "3365584896", "process_out_blocks": "0", "process_user_time": 18.337593}
[0m23:28:54.123725 [debug] [MainThread]: Command `dbt run` succeeded at 23:28:54.123643 after 21.64 seconds
[0m23:28:54.124072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c3650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c3680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c37a0>]}
[0m23:28:54.124311 [debug] [MainThread]: Flushing usage events
[0m23:28:54.785367 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:32:40.149209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104410cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10514b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10514b200>]}


============================== 23:32:40.152385 | b064e5f6-c86b-474e-a699-91eca678d0f0 ==============================
[0m23:32:40.152385 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:32:40.152700 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'quiet': 'False', 'no_print': 'None', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'debug': 'False', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'target_path': 'None', 'partial_parse': 'True', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs'}
[0m23:32:40.333705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b064e5f6-c86b-474e-a699-91eca678d0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101929d00>]}
[0m23:32:40.360460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b064e5f6-c86b-474e-a699-91eca678d0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105182570>]}
[0m23:32:40.361879 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m23:32:40.420966 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m23:32:40.464881 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:32:40.465143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b064e5f6-c86b-474e-a699-91eca678d0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105655f40>]}
[0m23:32:41.026340 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_an_data.mart
[0m23:32:41.030920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b064e5f6-c86b-474e-a699-91eca678d0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053a0440>]}
[0m23:32:41.066410 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m23:32:41.067732 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m23:32:41.080786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b064e5f6-c86b-474e-a699-91eca678d0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105828fb0>]}
[0m23:32:41.081049 [info ] [MainThread]: Found 17 models, 1 operation, 9 sources, 469 macros
[0m23:32:41.081207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b064e5f6-c86b-474e-a699-91eca678d0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058d0e60>]}
[0m23:32:41.082247 [info ] [MainThread]: 
[0m23:32:41.082418 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m23:32:41.082550 [info ] [MainThread]: 
[0m23:32:41.082774 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:32:41.085046 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_an_data_pipeline'
[0m23:32:41.169446 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline"
[0m23:32:41.169712 [debug] [ThreadPool]: On list_an_data_pipeline: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"an_data_pipeline"'
    
  
  
[0m23:32:41.169863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:43.085896 [debug] [ThreadPool]: SQL status: OK in 1.916 seconds
[0m23:32:43.089581 [debug] [ThreadPool]: On list_an_data_pipeline: Close
[0m23:32:43.090902 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_an_data_pipeline, now create_an_data_pipeline_main)
[0m23:32:43.091607 [debug] [ThreadPool]: Creating schema "database: "an_data_pipeline"
schema: "main"
"
[0m23:32:43.103588 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m23:32:43.104265 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:32:43.104697 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:43.107127 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:32:43.108955 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m23:32:43.109327 [debug] [ThreadPool]: On create_an_data_pipeline_main: BEGIN
[0m23:32:43.110233 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:32:43.110554 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m23:32:43.110879 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
    
        create schema if not exists "an_data_pipeline"."main"
    
[0m23:32:43.223007 [debug] [ThreadPool]: SQL status: OK in 0.112 seconds
[0m23:32:43.224722 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m23:32:43.225129 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m23:32:43.225493 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m23:32:43.329940 [debug] [ThreadPool]: SQL status: OK in 0.104 seconds
[0m23:32:43.331252 [debug] [ThreadPool]: On create_an_data_pipeline_main: Close
[0m23:32:43.335799 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_an_data_pipeline_main, now list_an_data_pipeline_main)
[0m23:32:43.347148 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m23:32:43.347881 [debug] [ThreadPool]: On list_an_data_pipeline_main: BEGIN
[0m23:32:43.348304 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:43.349752 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:32:43.350122 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m23:32:43.350490 [debug] [ThreadPool]: On list_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline_main"} */
select
      'an_data_pipeline' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'an_data_pipeline'
  
[0m23:32:43.374415 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m23:32:43.376311 [debug] [ThreadPool]: On list_an_data_pipeline_main: ROLLBACK
[0m23:32:43.377855 [debug] [ThreadPool]: Failed to rollback 'list_an_data_pipeline_main'
[0m23:32:43.378158 [debug] [ThreadPool]: On list_an_data_pipeline_main: Close
[0m23:32:43.380585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b064e5f6-c86b-474e-a699-91eca678d0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058133b0>]}
[0m23:32:43.380995 [debug] [MainThread]: Using duckdb connection "master"
[0m23:32:43.381219 [debug] [MainThread]: On master: BEGIN
[0m23:32:43.381426 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:32:43.382315 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:32:43.382539 [debug] [MainThread]: On master: COMMIT
[0m23:32:43.382748 [debug] [MainThread]: Using duckdb connection "master"
[0m23:32:43.382946 [debug] [MainThread]: On master: COMMIT
[0m23:32:43.383308 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:32:43.389352 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_an_data.dbt_an_data-on-run-start-0"
[0m23:32:43.393014 [info ] [MainThread]: 1 of 1 START hook: dbt_an_data.on-run-start.0 .................................. [RUN]
[0m23:32:43.393362 [debug] [MainThread]: Using duckdb connection "master"
[0m23:32:43.393607 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "master"} */
ATTACH '../data/database/database.duckdb' AS database (READ_ONLY)
[0m23:32:43.401855 [debug] [MainThread]: SQL status: OK in 0.008 seconds
[0m23:32:43.402562 [info ] [MainThread]: 1 of 1 OK hook: dbt_an_data.on-run-start.0 ..................................... [[32mOK[0m in 0.02s]
[0m23:32:43.402767 [info ] [MainThread]: 
[0m23:32:43.402968 [debug] [MainThread]: On master: Close
[0m23:32:43.404784 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_acteurs
[0m23:32:43.405047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_an_data_pipeline_main, now model.dbt_an_data.stg_acteurs)
[0m23:32:43.405249 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_acteurs
[0m23:32:43.406990 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_acteurs"
[0m23:32:43.407757 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_acteurs
[0m23:32:43.407977 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_agenda
[0m23:32:43.408221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_acteurs, now model.dbt_an_data.stg_agenda)
[0m23:32:43.408436 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_agenda
[0m23:32:43.409965 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_agenda"
[0m23:32:43.410412 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_agenda
[0m23:32:43.410612 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_amendements
[0m23:32:43.410821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_agenda, now model.dbt_an_data.stg_amendements)
[0m23:32:43.411013 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_amendements
[0m23:32:43.412390 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_amendements"
[0m23:32:43.412764 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_amendements
[0m23:32:43.412937 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_organes
[0m23:32:43.413120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_amendements, now model.dbt_an_data.stg_organes)
[0m23:32:43.413298 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_organes
[0m23:32:43.415449 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_organes"
[0m23:32:43.415841 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_organes
[0m23:32:43.416010 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_pays
[0m23:32:43.416193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_organes, now model.dbt_an_data.stg_pays)
[0m23:32:43.416363 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_pays
[0m23:32:43.417612 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_pays"
[0m23:32:43.417964 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_pays
[0m23:32:43.418129 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_reunions
[0m23:32:43.418300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_pays, now model.dbt_an_data.stg_reunions)
[0m23:32:43.418464 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_reunions
[0m23:32:43.419648 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_reunions"
[0m23:32:43.419980 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_reunions
[0m23:32:43.420132 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_scrutins
[0m23:32:43.420286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_reunions, now model.dbt_an_data.stg_scrutins)
[0m23:32:43.420437 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_scrutins
[0m23:32:43.421579 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_scrutins"
[0m23:32:43.421934 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_scrutins
[0m23:32:43.422091 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_acteurs
[0m23:32:43.422304 [info ] [Thread-1 (]: 1 of 10 START sql incremental model main.int_acteurs ........................... [RUN]
[0m23:32:43.422568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_scrutins, now model.dbt_an_data.int_acteurs)
[0m23:32:43.422768 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_acteurs
[0m23:32:43.427200 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_acteurs"
[0m23:32:43.427611 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_acteurs
[0m23:32:43.432118 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:32:43.432325 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__78e76b269358" cascade
    
[0m23:32:43.432483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:43.536482 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m23:32:43.567321 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:32:43.567598 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:32:43.568461 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:43.569224 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:32:43.569414 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m23:32:43.569844 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:32:43.570014 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:32:43.570178 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m23:32:43.674201 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m23:32:43.675754 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:32:43.676263 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    

  
[0m23:32:43.676765 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:32:43.677939 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m23:32:43.678307 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:32:43.678640 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m23:32:43.788689 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m23:32:43.815839 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_acteurs"
[0m23:32:43.818149 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:32:43.818614 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m23:32:43.819742 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:43.820155 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:32:43.820650 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

  
    
    

    create  table
      "an_data_pipeline"."main"."int_acteurs__dbt_tmp"
  
    as (
      

with __dbt__cte__stg_acteurs as (
SELECT * 
FROM "database"."stg"."raw_acteurs"
) SELECT 
json_extract_string(json, '$.acteur.uid.#text') as uid,
json_extract_string(json, '$.acteur.etatCivil.ident.civ') as civ,
json_extract_string(json, '$.acteur.etatCivil.ident.prenom') as prenom,
json_extract_string(json, '$.acteur.etatCivil.ident.nom') as nom,
json_extract_string(json, '$.acteur.etatCivil.ident.trigramme') as trigramme,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.dateNais') as dateNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.villeNais') as villeNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.depNais') as depNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.paysNais') as paysNais,
json_extract_string(json, '$.acteur.etatCivil.dateDeces') as dateDeces,
json_extract_string(json, '$.acteur.profession.libelleCourant') as libelleCourant,
json_extract_string(json, '$.acteur.profession.socProcINSEE.catSocPro') as catSocPro,
json_extract_string(json, '$.acteur.profession.socProcINSEE.famSocPro') as famSocPro,
json_extract_string(json, '$.acteur.uri_hatvp') as uri_hatvp
FROM __dbt__cte__stg_acteurs
    );
  
  
  
[0m23:32:44.409345 [debug] [Thread-1 (]: SQL status: OK in 0.588 seconds
[0m23:32:44.419371 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:32:44.420054 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_acteurs'
  
[0m23:32:44.421830 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:44.423596 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:32:44.424002 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_acteurs'
  
[0m23:32:44.425668 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:44.432736 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:32:44.433112 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */
alter table "an_data_pipeline"."main"."int_acteurs" rename to "int_acteurs__dbt_backup"
[0m23:32:44.549226 [debug] [Thread-1 (]: SQL status: OK in 0.115 seconds
[0m23:32:44.559216 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:32:44.559924 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */
alter table "an_data_pipeline"."main"."int_acteurs__dbt_tmp" rename to "int_acteurs"
[0m23:32:44.673047 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m23:32:44.698469 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m23:32:44.699055 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:32:44.699488 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m23:32:45.736259 [debug] [Thread-1 (]: SQL status: OK in 1.036 seconds
[0m23:32:45.743620 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:32:45.744701 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__78e76b269358" cascade
    
[0m23:32:45.854295 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m23:32:45.863976 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:32:45.864816 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."main"."int_acteurs__dbt_backup" cascade
    
[0m23:32:46.195161 [debug] [Thread-1 (]: SQL status: OK in 0.329 seconds
[0m23:32:46.201476 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:32:46.202259 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__78e76b269358" cascade
    
[0m23:32:46.319347 [debug] [Thread-1 (]: SQL status: OK in 0.116 seconds
[0m23:32:46.323690 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: Close
[0m23:32:46.327727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b064e5f6-c86b-474e-a699-91eca678d0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101928e00>]}
[0m23:32:46.329098 [info ] [Thread-1 (]: 1 of 10 OK created sql incremental model main.int_acteurs ...................... [[32mOK[0m in 2.90s]
[0m23:32:46.330143 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_acteurs
[0m23:32:46.330870 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_mandats
[0m23:32:46.331703 [info ] [Thread-1 (]: 2 of 10 START sql incremental model main.int_mandats ........................... [RUN]
[0m23:32:46.332615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_acteurs, now model.dbt_an_data.int_mandats)
[0m23:32:46.333238 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_mandats
[0m23:32:46.346720 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_mandats"
[0m23:32:46.347978 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_mandats
[0m23:32:46.352562 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:32:46.352976 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__3086b0833805" cascade
    
[0m23:32:46.353339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:46.462237 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m23:32:46.466992 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:32:46.467830 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:32:46.471175 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:32:46.473651 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:32:46.474250 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m23:32:46.475596 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:46.476158 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:32:46.476670 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m23:32:46.584358 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m23:32:46.587817 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:32:46.590407 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    

  
[0m23:32:46.591468 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:32:46.597940 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m23:32:46.599085 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:32:46.602434 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m23:32:46.704385 [debug] [Thread-1 (]: SQL status: OK in 0.101 seconds
[0m23:32:46.704898 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_mandats"
[0m23:32:46.705599 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:32:46.705810 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m23:32:46.706375 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:32:46.706578 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:32:46.706769 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

  
    
    

    create  table
      "an_data_pipeline"."main"."int_mandats__dbt_tmp"
  
    as (
      

with __dbt__cte__stg_acteurs as (
SELECT * 
FROM "database"."stg"."raw_acteurs"
) SELECT 
json_extract_string(mandat.value, '$.uid') as uid,
json_extract_string(mandat.value, '$.acteurRef') as acteurRef,
json_extract_string(mandat.value, '$.legislature') as legislature,
json_extract_string(mandat.value, '$.typeOrgane') as typeOrgane,
json_extract_string(mandat.value, '$.dateDebut') as dateDebut,
json_extract_string(mandat.value, '$.dateFin') as dateFin,
json_extract_string(mandat.value, '$.preseance') as preseance,
json_extract_string(mandat.value, '$.nominPrincipale') as nominPrincipale,
json_extract_string(mandat.value, '$.infosQualite.codeQualite') as codeQualite,
json_extract_string(mandat.value, '$.organes.organeRef') as organeRef,
FROM __dbt__cte__stg_acteurs act, json_each(json->'acteur'->'mandats'->'mandat') mandat
    );
  
  
  
[0m23:32:47.902498 [debug] [Thread-1 (]: SQL status: OK in 1.190 seconds
[0m23:32:47.910241 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:32:47.910648 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_mandats'
  
[0m23:32:47.912407 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:47.913635 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:32:47.913933 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_mandats'
  
[0m23:32:47.914659 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:32:47.918653 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:32:47.918967 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */
alter table "an_data_pipeline"."main"."int_mandats" rename to "int_mandats__dbt_backup"
[0m23:32:48.031390 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m23:32:48.037855 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:32:48.038642 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */
alter table "an_data_pipeline"."main"."int_mandats__dbt_tmp" rename to "int_mandats"
[0m23:32:48.154210 [debug] [Thread-1 (]: SQL status: OK in 0.115 seconds
[0m23:32:48.159060 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m23:32:48.159964 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:32:48.160656 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m23:32:48.434138 [debug] [Thread-1 (]: SQL status: OK in 0.273 seconds
[0m23:32:48.439793 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:32:48.440542 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__3086b0833805" cascade
    
[0m23:32:48.549482 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m23:32:48.566128 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:32:48.567115 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."main"."int_mandats__dbt_backup" cascade
    
[0m23:32:48.785998 [debug] [Thread-1 (]: SQL status: OK in 0.218 seconds
[0m23:32:48.788583 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:32:48.788761 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__3086b0833805" cascade
    
[0m23:32:48.892099 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m23:32:48.894376 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: Close
[0m23:32:48.899703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b064e5f6-c86b-474e-a699-91eca678d0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10600aa80>]}
[0m23:32:48.900768 [info ] [Thread-1 (]: 2 of 10 OK created sql incremental model main.int_mandats ...................... [[32mOK[0m in 2.56s]
[0m23:32:48.901292 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_mandats
[0m23:32:48.901702 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_agenda
[0m23:32:48.902084 [info ] [Thread-1 (]: 3 of 10 START sql incremental model main.int_agenda ............................ [RUN]
[0m23:32:48.904773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_mandats, now model.dbt_an_data.int_agenda)
[0m23:32:48.905321 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_agenda
[0m23:32:48.910520 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_agenda"
[0m23:32:48.911610 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_agenda
[0m23:32:48.914364 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:32:48.914616 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__418bb45b833a" cascade
    
[0m23:32:48.914832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:49.017876 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m23:32:49.021799 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:32:49.022356 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:32:49.024222 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:49.026042 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:32:49.026505 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m23:32:49.027251 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:32:49.027470 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:32:49.027695 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m23:32:49.132918 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m23:32:49.134755 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:32:49.135433 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    

  
[0m23:32:49.136141 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:32:49.137921 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m23:32:49.138587 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:32:49.139098 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m23:32:49.242288 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m23:32:49.244311 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_agenda"
[0m23:32:49.245958 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:32:49.246734 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m23:32:49.248859 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:49.249669 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:32:49.250359 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

  
    
    

    create  table
      "an_data_pipeline"."main"."int_agenda__dbt_tmp"
  
    as (
      

with __dbt__cte__stg_agenda as (
SELECT * 
FROM "database"."stg"."raw_agenda"
) SELECT * 
FROM __dbt__cte__stg_agenda
    );
  
  
  
[0m23:32:49.573951 [debug] [Thread-1 (]: SQL status: OK in 0.323 seconds
[0m23:32:49.577860 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:32:49.578477 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_agenda'
  
[0m23:32:49.580100 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:49.581992 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:32:49.582526 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_agenda'
  
[0m23:32:49.583747 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:49.589227 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:32:49.590177 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */
alter table "an_data_pipeline"."main"."int_agenda" rename to "int_agenda__dbt_backup"
[0m23:32:49.706173 [debug] [Thread-1 (]: SQL status: OK in 0.114 seconds
[0m23:32:49.714892 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:32:49.715906 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */
alter table "an_data_pipeline"."main"."int_agenda__dbt_tmp" rename to "int_agenda"
[0m23:32:49.830808 [debug] [Thread-1 (]: SQL status: OK in 0.114 seconds
[0m23:32:49.833384 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m23:32:49.834008 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:32:49.834439 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m23:32:50.056085 [debug] [Thread-1 (]: SQL status: OK in 0.221 seconds
[0m23:32:50.063498 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:32:50.064537 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__418bb45b833a" cascade
    
[0m23:32:50.172048 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m23:32:50.180728 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:32:50.181741 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."main"."int_agenda__dbt_backup" cascade
    
[0m23:32:50.405650 [debug] [Thread-1 (]: SQL status: OK in 0.223 seconds
[0m23:32:50.410634 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:32:50.411321 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__418bb45b833a" cascade
    
[0m23:32:50.516879 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m23:32:50.518753 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: Close
[0m23:32:50.519670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b064e5f6-c86b-474e-a699-91eca678d0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d20e30>]}
[0m23:32:50.520590 [info ] [Thread-1 (]: 3 of 10 OK created sql incremental model main.int_agenda ....................... [[32mOK[0m in 1.61s]
[0m23:32:50.521460 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_agenda
[0m23:32:50.522466 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements
[0m23:32:50.523431 [info ] [Thread-1 (]: 4 of 10 START sql incremental model main.int_amendements ....................... [RUN]
[0m23:32:50.525586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_agenda, now model.dbt_an_data.int_amendements)
[0m23:32:50.526456 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements
[0m23:32:50.612232 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements"
[0m23:32:50.612825 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements
[0m23:32:50.614923 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:32:50.615170 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__642eeccf73b2" cascade
    
[0m23:32:50.615340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:50.719333 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m23:32:50.721934 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:32:50.722177 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:32:50.723106 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:50.723968 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:32:50.724175 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m23:32:50.724648 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:32:50.724832 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:32:50.725015 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m23:32:50.828830 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m23:32:50.831638 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:32:50.832277 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    

  
[0m23:32:50.832849 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:32:50.834357 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m23:32:50.834985 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:32:50.835485 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m23:32:50.937105 [debug] [Thread-1 (]: SQL status: OK in 0.101 seconds
[0m23:32:50.937659 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements"
[0m23:32:50.938095 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:32:50.938263 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m23:32:50.938824 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:32:50.939020 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:32:50.939237 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

  
    
    

    create  table
      "an_data_pipeline"."main"."int_amendements__dbt_tmp"
  
    as (
      

with __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
) SELECT
json_extract_string(json, '$.amendement.uid') AS uid,
json_extract_string(json, '$.amendement.chronotag') AS chronotag,
json_extract_string(json, '$.amendement.examenRef') AS examenRef,
json_extract_string(json, '$.amendement.amendementParentRef') AS amendementParentRef,
json_extract_string(json, '$.amendement.signataires.auteur.typeAuteur') AS typeAuteur,
json_extract_string(json, '$.amendement.signataires.auteur.acteurRef') AS refAuteur,
json_extract_string(json, '$.amendement.signataires.auteur.groupePolitique') AS groupePolitiqueAuteur,
json_extract_string(json, '$.amendement.cycleDeVie.dateDepot') AS dateDepot,
json_extract_string(json, '$.amendement.cycleDeVie.datePublication') AS datePublication,
json_extract_string(json, '$.amendement.cycleDeVie.soumisArticle40') AS soumisArticle40,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.code') AS codeEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.libelle') AS libelleEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.code') AS codeSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.dateSort') AS dateSort,
json_extract_string(json, '$.amendement.cycleDeVie.sort') AS sort,
split_part(replace(filename, '.json', ''), '/', -1) AS id_amendement,
split_part(replace(filename, '.json', ''), '/', -2) AS id_texte,
split_part(replace(filename, '.json', ''), '/', -3) AS id_dossier_legislatif,
id_texte[:4] AS nature_texte,
id_texte[5:6] AS source_texte,
regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 1) AS prefix_bibard,
regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 2) AS numero_bibard,
regexp_extract(id_amendement, '(SEA|PO\d*)', 1) AS code_organe,
regexp_extract(id_amendement, '(P)(\d*)(D)', 2) AS numero_partie,
regexp_extract(id_amendement, '(D)(\d*)(N)', 2) AS numero_deliberation,
regexp_extract(id_amendement, '(D)(\d*)(N)(\d*)', 4) AS numero_court
from __dbt__cte__stg_amendements
    );
  
  
  
[0m23:32:51.284067 [debug] [Thread-1 (]: SQL status: OK in 0.344 seconds
[0m23:32:51.285007 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:32:51.285239 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_amendements'
  
[0m23:32:51.286071 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:51.286832 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:32:51.287031 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_amendements'
  
[0m23:32:51.287576 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:32:51.289822 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:32:51.290064 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */
alter table "an_data_pipeline"."main"."int_amendements" rename to "int_amendements__dbt_backup"
[0m23:32:51.452297 [debug] [Thread-1 (]: SQL status: OK in 0.162 seconds
[0m23:32:51.457527 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:32:51.458199 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */
alter table "an_data_pipeline"."main"."int_amendements__dbt_tmp" rename to "int_amendements"
[0m23:32:51.576672 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m23:32:51.579794 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m23:32:51.580635 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:32:51.581349 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m23:32:51.801893 [debug] [Thread-1 (]: SQL status: OK in 0.220 seconds
[0m23:32:51.806137 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:32:51.806807 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__642eeccf73b2" cascade
    
[0m23:32:51.914011 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m23:32:51.918773 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:32:51.919343 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."main"."int_amendements__dbt_backup" cascade
    
[0m23:32:52.140196 [debug] [Thread-1 (]: SQL status: OK in 0.220 seconds
[0m23:32:52.141888 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:32:52.142082 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__642eeccf73b2" cascade
    
[0m23:32:52.245073 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m23:32:52.246258 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: Close
[0m23:32:52.246710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b064e5f6-c86b-474e-a699-91eca678d0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055afd40>]}
[0m23:32:52.247153 [info ] [Thread-1 (]: 4 of 10 OK created sql incremental model main.int_amendements .................. [[32mOK[0m in 1.72s]
[0m23:32:52.247499 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements
[0m23:32:52.247732 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements_cosignataires
[0m23:32:52.248047 [info ] [Thread-1 (]: 5 of 10 START sql incremental model main.int_amendements_cosignataires ......... [RUN]
[0m23:32:52.248362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements, now model.dbt_an_data.int_amendements_cosignataires)
[0m23:32:52.248607 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements_cosignataires
[0m23:32:52.254225 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements_cosignataires"
[0m23:32:52.254791 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements_cosignataires
[0m23:32:52.259220 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:32:52.259467 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__d1029d64296e" cascade
    
[0m23:32:52.259651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:52.364955 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m23:32:52.368795 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:32:52.369482 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:32:52.371437 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:52.372871 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:32:52.373162 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m23:32:52.373842 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:32:52.374072 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:32:52.374270 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m23:32:52.478401 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m23:32:52.480828 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:32:52.481535 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    

  
[0m23:32:52.482187 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:32:52.484134 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m23:32:52.484658 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:32:52.485110 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m23:32:52.589383 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m23:32:52.591248 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements_cosignataires"
[0m23:32:52.592758 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:32:52.593259 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m23:32:52.594735 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:52.595228 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:32:52.595712 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

  
    
    

    create  table
      "an_data_pipeline"."main"."int_amendements_cosignataires__dbt_tmp"
  
    as (
      

WITH  __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
), cosignataires_arr AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef[*]') AS acteurRef
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') == 'ARRAY' AND acteurRef IS NOT NULL
), cosignataires_str AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef') AS acteurRef
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') <> 'ARRAY' AND acteurRef IS NOT NULL
)
SELECT 
  uid, 
  unnest(acteurRef) as acteurRef
FROM cosignataires_arr
UNION ALL
SELECT 
  uid, 
  acteurRef
FROM cosignataires_str
    );
  
  
  
[0m23:32:52.925015 [debug] [Thread-1 (]: SQL status: OK in 0.328 seconds
[0m23:32:52.927960 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:32:52.928483 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_amendements_cosignataires'
  
[0m23:32:52.931282 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:32:52.934556 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:32:52.935507 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_amendements_cosignataires'
  
[0m23:32:52.937339 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:52.941841 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:32:52.942360 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */
alter table "an_data_pipeline"."main"."int_amendements_cosignataires" rename to "int_amendements_cosignataires__dbt_backup"
[0m23:32:53.052711 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m23:32:53.057940 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:32:53.058635 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */
alter table "an_data_pipeline"."main"."int_amendements_cosignataires__dbt_tmp" rename to "int_amendements_cosignataires"
[0m23:32:53.175171 [debug] [Thread-1 (]: SQL status: OK in 0.116 seconds
[0m23:32:53.179589 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m23:32:53.180469 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:32:53.181097 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m23:32:53.403655 [debug] [Thread-1 (]: SQL status: OK in 0.222 seconds
[0m23:32:53.408719 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:32:53.409503 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__d1029d64296e" cascade
    
[0m23:32:53.519344 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m23:32:53.526016 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:32:53.526573 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."main"."int_amendements_cosignataires__dbt_backup" cascade
    
[0m23:32:53.751540 [debug] [Thread-1 (]: SQL status: OK in 0.225 seconds
[0m23:32:53.753223 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:32:53.753406 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__d1029d64296e" cascade
    
[0m23:32:53.858408 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m23:32:53.859438 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: Close
[0m23:32:53.859934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b064e5f6-c86b-474e-a699-91eca678d0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d4860>]}
[0m23:32:53.860369 [info ] [Thread-1 (]: 5 of 10 OK created sql incremental model main.int_amendements_cosignataires .... [[32mOK[0m in 1.61s]
[0m23:32:53.860701 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements_cosignataires
[0m23:32:53.860930 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_organes
[0m23:32:53.861300 [info ] [Thread-1 (]: 6 of 10 START sql incremental model main.int_organes ........................... [RUN]
[0m23:32:53.861640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements_cosignataires, now model.dbt_an_data.int_organes)
[0m23:32:53.861869 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_organes
[0m23:32:53.867837 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_organes"
[0m23:32:53.870825 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_organes
[0m23:32:53.873690 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:32:53.873946 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__14501409dfbe" cascade
    
[0m23:32:53.874182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:53.989466 [debug] [Thread-1 (]: SQL status: OK in 0.115 seconds
[0m23:32:53.992850 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:32:53.993194 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:32:53.996285 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:53.997396 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:32:53.997638 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m23:32:53.998392 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:53.998654 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:32:53.998863 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m23:32:54.099832 [debug] [Thread-1 (]: SQL status: OK in 0.101 seconds
[0m23:32:54.101503 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:32:54.101955 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    

  
[0m23:32:54.102482 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:32:54.105329 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m23:32:54.105795 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:32:54.106231 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m23:32:54.209988 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m23:32:54.212576 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_organes"
[0m23:32:54.214207 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:32:54.214717 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m23:32:54.216260 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:54.216821 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:32:54.217377 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

  
    
    

    create  table
      "an_data_pipeline"."main"."int_organes__dbt_tmp"
  
    as (
      

with __dbt__cte__stg_organes as (
SELECT * 
FROM "database"."stg"."raw_organes"
) SELECT 
json_extract_string(json, '$.organe.uid') as uid,
json_extract_string(json, '$.organe.codeType') as codeType,
json_extract_string(json, '$.organe.libelle') as libelle,
json_extract_string(json, '$.organe.libelleEdition') as libelleEdition,
json_extract_string(json, '$.organe.libelleAbrege') as libelleAbrege,
json_extract_string(json, '$.organe.libelleAbrev') as libelleAbrev,
json_extract_string(json, '$.organe.viMoDe.dateDebut') as dateDebut,
json_extract_string(json, '$.organe.viMoDe.dateAgrement') as dateAgrement,
json_extract_string(json, '$.organe.viMoDe.dateFin') as dateFin,
json_extract_string(json, '$.organe.organeParent') as organeParent,
json_extract_string(json, '$.organe.chambre') as chambre,
json_extract_string(json, '$.organe.regime') as regime,
json_extract_string(json, '$.organe.legislature') as legislature
FROM __dbt__cte__stg_organes
    );
  
  
  
[0m23:32:54.680696 [debug] [Thread-1 (]: SQL status: OK in 0.462 seconds
[0m23:32:54.684272 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:32:54.685191 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_organes'
  
[0m23:32:54.687238 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:54.689532 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:32:54.690038 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_organes'
  
[0m23:32:54.691142 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:54.699323 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:32:54.699776 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */
alter table "an_data_pipeline"."main"."int_organes" rename to "int_organes__dbt_backup"
[0m23:32:54.816491 [debug] [Thread-1 (]: SQL status: OK in 0.116 seconds
[0m23:32:54.823920 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:32:54.825682 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */
alter table "an_data_pipeline"."main"."int_organes__dbt_tmp" rename to "int_organes"
[0m23:32:54.939704 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m23:32:54.943882 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m23:32:54.944808 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:32:54.945701 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m23:32:55.209503 [debug] [Thread-1 (]: SQL status: OK in 0.263 seconds
[0m23:32:55.213360 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:32:55.213997 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__14501409dfbe" cascade
    
[0m23:32:55.324794 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m23:32:55.331002 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:32:55.331622 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."main"."int_organes__dbt_backup" cascade
    
[0m23:32:55.559006 [debug] [Thread-1 (]: SQL status: OK in 0.227 seconds
[0m23:32:55.560683 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:32:55.560860 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__14501409dfbe" cascade
    
[0m23:32:55.667001 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m23:32:55.667973 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: Close
[0m23:32:55.668337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b064e5f6-c86b-474e-a699-91eca678d0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e818b0>]}
[0m23:32:55.668710 [info ] [Thread-1 (]: 6 of 10 OK created sql incremental model main.int_organes ...................... [[32mOK[0m in 1.81s]
[0m23:32:55.669025 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_organes
[0m23:32:55.669258 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_pays
[0m23:32:55.669576 [info ] [Thread-1 (]: 7 of 10 START sql incremental model main.int_pays .............................. [RUN]
[0m23:32:55.669901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_organes, now model.dbt_an_data.int_pays)
[0m23:32:55.670119 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_pays
[0m23:32:55.675533 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_pays"
[0m23:32:55.676049 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_pays
[0m23:32:55.678360 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:32:55.678573 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__6049a312c49a" cascade
    
[0m23:32:55.678849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:55.785789 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m23:32:55.790882 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:32:55.791504 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:32:55.793802 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:32:55.796063 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:32:55.796543 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m23:32:55.797653 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:55.797956 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:32:55.798228 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m23:32:55.903638 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m23:32:55.906881 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:32:55.907660 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    

  
[0m23:32:55.908633 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:32:55.911061 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m23:32:55.911901 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:32:55.912597 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m23:32:56.014636 [debug] [Thread-1 (]: SQL status: OK in 0.101 seconds
[0m23:32:56.015187 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_pays"
[0m23:32:56.015649 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:32:56.015808 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m23:32:56.016379 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:32:56.016581 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:32:56.016768 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

  
    
    

    create  table
      "an_data_pipeline"."main"."int_pays__dbt_tmp"
  
    as (
      

with __dbt__cte__stg_pays as (
SELECT * 
FROM "database"."stg"."raw_pays"
) SELECT
json_extract_string(json, '$.pays.uid') as uid,
json_extract_string(json, '$.pays.code_insee') as code_insee,
json_extract_string(json, '$.pays.libelleInsee') as libelleInsee,
json_extract_string(json, '$.pays.nomCourant') as nomCourant,
json_extract_string(json, '$.pays.code_iso2A') as code_iso2A,
json_extract_string(json, '$.pays.code_iso3A') as code_iso3A,
json_extract_string(json, '$.pays.code_iso3N') as code_iso3N,
json_extract_string(json, '$.pays.libelleIso') as libelleIso,
json_extract_string(json, '$.pays.libelleANCourt') as libelleANCourt,
json_extract_string(json, '$.pays.libelleANLong') as libelleANLong,
json_extract_string(json, '$.pays.sourceJuridique') as sourceJuridique,
json_extract_string(json, '$.pays.activ') as activ
FROM __dbt__cte__stg_pays
    );
  
  
  
[0m23:32:56.341033 [debug] [Thread-1 (]: SQL status: OK in 0.324 seconds
[0m23:32:56.343786 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:32:56.344578 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_pays'
  
[0m23:32:56.347018 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:56.349192 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:32:56.349704 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_pays'
  
[0m23:32:56.350809 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:56.355313 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:32:56.355804 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */
alter table "an_data_pipeline"."main"."int_pays" rename to "int_pays__dbt_backup"
[0m23:32:56.473363 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m23:32:56.481728 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:32:56.482507 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */
alter table "an_data_pipeline"."main"."int_pays__dbt_tmp" rename to "int_pays"
[0m23:32:56.597904 [debug] [Thread-1 (]: SQL status: OK in 0.114 seconds
[0m23:32:56.602738 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m23:32:56.603543 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:32:56.604881 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m23:32:56.839021 [debug] [Thread-1 (]: SQL status: OK in 0.233 seconds
[0m23:32:56.843850 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:32:56.844601 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__6049a312c49a" cascade
    
[0m23:32:56.964361 [debug] [Thread-1 (]: SQL status: OK in 0.119 seconds
[0m23:32:56.972427 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:32:56.973289 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."main"."int_pays__dbt_backup" cascade
    
[0m23:32:57.201557 [debug] [Thread-1 (]: SQL status: OK in 0.228 seconds
[0m23:32:57.203205 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:32:57.203382 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__6049a312c49a" cascade
    
[0m23:32:57.315196 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m23:32:57.316189 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: Close
[0m23:32:57.316542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b064e5f6-c86b-474e-a699-91eca678d0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e44f20>]}
[0m23:32:57.316930 [info ] [Thread-1 (]: 7 of 10 OK created sql incremental model main.int_pays ......................... [[32mOK[0m in 1.65s]
[0m23:32:57.317258 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_pays
[0m23:32:57.317478 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_reunions
[0m23:32:57.317831 [info ] [Thread-1 (]: 8 of 10 START sql incremental model main.int_reunions .......................... [RUN]
[0m23:32:57.318148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_pays, now model.dbt_an_data.int_reunions)
[0m23:32:57.318431 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_reunions
[0m23:32:57.325627 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_reunions"
[0m23:32:57.326375 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_reunions
[0m23:32:57.328691 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:32:57.328933 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__65ccfc094f69" cascade
    
[0m23:32:57.329130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:57.435557 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m23:32:57.439471 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:32:57.440064 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:32:57.442058 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:57.444236 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:32:57.444832 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m23:32:57.445818 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:57.446141 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:32:57.446420 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m23:32:57.555527 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m23:32:57.559775 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:32:57.560792 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    

  
[0m23:32:57.561717 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:32:57.564465 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m23:32:57.565260 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:32:57.565959 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m23:32:57.670402 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m23:32:57.671006 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_reunions"
[0m23:32:57.671622 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:32:57.671799 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m23:32:57.672441 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:32:57.672598 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:32:57.672788 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

  
    
    

    create  table
      "an_data_pipeline"."main"."int_reunions__dbt_tmp"
  
    as (
      

with __dbt__cte__stg_reunions as (
SELECT * 
FROM "database"."stg"."raw_reunions"
) SELECT
json_extract_string(json, '$.reunion.uid') AS uid,
json_extract_string(json, '$.reunion.timeStampDebut') AS timeStampDebut,
json_extract_string(json, '$.reunion.lieu.lieuRef') AS lieuRef,
json_extract_string(json, '$.reunion.lieu.libelleLong') AS lieuLibelle,
json_extract_string(json, '$.reunion.cycleDeVie.etat') AS cycleDeVieEtat,
json_extract_string(json, '$.reunion.demandeur') AS demandeur,
json_extract_string(json, '$.reunion.organeReuniRef') AS organeReuniRef,
json_extract_string(json, '$.reunion.visioConference') AS visioConference,
json_extract_string(json, '$.reunion.sessionRef') AS sessionRef,
json_extract_string(json, '$.reunion.ouverturePresse') AS ouverturePresse,
json_extract_string(json, '$.reunion.captationVideo') AS captationVideo,
json_extract_string(json, '$.reunion.ODJ.convocationODJ.item') AS convocationODJ,
json_extract_string(json, '$.reunion.ODJ.resumeODJ.item') AS resumeODJ,
json_extract_string(json, '$.reunion.compteRenduRef') AS compteRenduRef,
json_extract_string(json, '$.reunion.identifiants.numSeanceJO') AS numSeanceJO,
json_extract_string(json, '$.reunion.identifiants.idJO') AS idJO,
json_extract_string(json, '$.reunion.identifiants.quantieme') AS quantieme,
json_extract_string(json, '$.reunion.identifiants.DataSeance') AS DataSeance
FROM __dbt__cte__stg_reunions
    );
  
  
  
[0m23:32:58.587403 [debug] [Thread-1 (]: SQL status: OK in 0.914 seconds
[0m23:32:58.589728 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:32:58.590442 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_reunions'
  
[0m23:32:58.592250 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:58.594006 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:32:58.594468 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_reunions'
  
[0m23:32:58.595597 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:58.599855 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:32:58.600255 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */
alter table "an_data_pipeline"."main"."int_reunions" rename to "int_reunions__dbt_backup"
[0m23:32:58.716028 [debug] [Thread-1 (]: SQL status: OK in 0.115 seconds
[0m23:32:58.724702 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:32:58.725488 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */
alter table "an_data_pipeline"."main"."int_reunions__dbt_tmp" rename to "int_reunions"
[0m23:32:58.842175 [debug] [Thread-1 (]: SQL status: OK in 0.116 seconds
[0m23:32:58.845520 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m23:32:58.846360 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:32:58.846823 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m23:32:59.146359 [debug] [Thread-1 (]: SQL status: OK in 0.299 seconds
[0m23:32:59.150562 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:32:59.151119 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__65ccfc094f69" cascade
    
[0m23:32:59.262199 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m23:32:59.269839 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:32:59.270658 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."main"."int_reunions__dbt_backup" cascade
    
[0m23:32:59.495259 [debug] [Thread-1 (]: SQL status: OK in 0.224 seconds
[0m23:32:59.500593 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:32:59.501311 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__65ccfc094f69" cascade
    
[0m23:32:59.610173 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m23:32:59.612240 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: Close
[0m23:32:59.612979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b064e5f6-c86b-474e-a699-91eca678d0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057ca4b0>]}
[0m23:32:59.613761 [info ] [Thread-1 (]: 8 of 10 OK created sql incremental model main.int_reunions ..................... [[32mOK[0m in 2.29s]
[0m23:32:59.614653 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_reunions
[0m23:32:59.615238 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins
[0m23:32:59.615850 [info ] [Thread-1 (]: 9 of 10 START sql incremental model main.int_scrutins .......................... [RUN]
[0m23:32:59.616444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_reunions, now model.dbt_an_data.int_scrutins)
[0m23:32:59.616902 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins
[0m23:32:59.632207 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins"
[0m23:32:59.632871 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins
[0m23:32:59.635523 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:32:59.635827 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__3ef16f72fbf4" cascade
    
[0m23:32:59.636266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:59.745161 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m23:32:59.749175 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:32:59.749739 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:32:59.751523 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:59.753398 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:32:59.753867 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m23:32:59.755192 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:59.755784 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:32:59.756307 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m23:32:59.872581 [debug] [Thread-1 (]: SQL status: OK in 0.115 seconds
[0m23:32:59.875271 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:32:59.876070 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    

  
[0m23:32:59.877101 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:32:59.886511 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m23:32:59.887230 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:32:59.887781 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m23:32:59.989877 [debug] [Thread-1 (]: SQL status: OK in 0.101 seconds
[0m23:32:59.991327 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins"
[0m23:32:59.992597 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:32:59.993188 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m23:32:59.994859 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:59.995394 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:32:59.995969 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

  
    
    

    create  table
      "an_data_pipeline"."main"."int_scrutins__dbt_tmp"
  
    as (
      

with __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
) SELECT
date_T_insert,
json_extract_string(json, '$.scrutin.uid') AS uid,
json_extract_string(json, '$.scrutin.numero') AS numero,
json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
json_extract_string(json, '$.scrutin.legislature') AS legislature,
json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
json_extract_string(json, '$.scrutin.titre') AS titre,
json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote
FROM __dbt__cte__stg_scrutins
    );
  
  
  
[0m23:33:01.650119 [debug] [Thread-1 (]: SQL status: OK in 1.647 seconds
[0m23:33:01.659924 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:33:01.660455 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_scrutins'
  
[0m23:33:01.662318 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:33:01.664112 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:33:01.665478 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_scrutins'
  
[0m23:33:01.666474 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:33:01.673713 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:33:01.674278 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */
alter table "an_data_pipeline"."main"."int_scrutins" rename to "int_scrutins__dbt_backup"
[0m23:33:01.792839 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m23:33:01.801057 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:33:01.802235 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */
alter table "an_data_pipeline"."main"."int_scrutins__dbt_tmp" rename to "int_scrutins"
[0m23:33:01.916239 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m23:33:01.920384 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m23:33:01.921198 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:33:01.921899 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m23:33:02.191276 [debug] [Thread-1 (]: SQL status: OK in 0.269 seconds
[0m23:33:02.192754 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:33:02.192936 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__3ef16f72fbf4" cascade
    
[0m23:33:02.297028 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m23:33:02.300234 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:33:02.300608 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."main"."int_scrutins__dbt_backup" cascade
    
[0m23:33:02.520763 [debug] [Thread-1 (]: SQL status: OK in 0.220 seconds
[0m23:33:02.522544 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:33:02.522723 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__3ef16f72fbf4" cascade
    
[0m23:33:02.626677 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m23:33:02.628503 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: Close
[0m23:33:02.631378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b064e5f6-c86b-474e-a699-91eca678d0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10588bd10>]}
[0m23:33:02.632301 [info ] [Thread-1 (]: 9 of 10 OK created sql incremental model main.int_scrutins ..................... [[32mOK[0m in 3.01s]
[0m23:33:02.632751 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins
[0m23:33:02.633319 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins_votes
[0m23:33:02.633904 [info ] [Thread-1 (]: 10 of 10 START sql incremental model main.int_scrutins_votes ................... [RUN]
[0m23:33:02.634297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_scrutins, now model.dbt_an_data.int_scrutins_votes)
[0m23:33:02.634556 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins_votes
[0m23:33:02.663003 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins_votes"
[0m23:33:02.664196 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins_votes
[0m23:33:02.666464 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:33:02.666676 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__f61b046139ce" cascade
    
[0m23:33:02.666858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:33:02.770988 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m23:33:02.774347 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:33:02.774749 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:33:02.776242 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:33:02.777599 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:33:02.777942 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m23:33:02.778794 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:33:02.779101 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:33:02.779403 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m23:33:02.884986 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m23:33:02.889066 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:33:02.890213 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    

  
[0m23:33:02.891327 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:33:02.893878 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m23:33:02.894585 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:33:02.895165 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m23:33:03.013214 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m23:33:03.013871 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins_votes"
[0m23:33:03.015281 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:33:03.015447 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m23:33:03.015996 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:33:03.016144 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:33:03.016449 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

  
    
    

    create  table
      "an_data_pipeline"."main"."int_scrutins_votes__dbt_tmp"
  
    as (
      

WITH  __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
), grp AS (
      -- explode les groupes (1 par groupe)
      SELECT
          json_extract_string(j.json, '$.scrutin.uid') AS uid,
          json_extract_string(g.value, '$.organeRef') AS groupe_organe,
          g.value AS groupe_json
      FROM __dbt__cte__stg_scrutins j,
           json_each(json->'scrutin'->'ventilationVotes'->'organe'->'groupes'->'groupe') g
  ),

  positions_array AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          p.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'pours'->'votant') p
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          c.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'contres'->'votant') c
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          a.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'abstentions'->'votant') a
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          n.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'nonVotants'->'votant') n
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[ARRAY]'
  ),
  positions_object AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[OBJECT]'
  ),

  clean AS (
      -- sécurise les champs (souvent string ou null)
      SELECT
          uid,
          groupe_organe,
          type_vote,
          json_extract_string(vote_json, '$.acteurRef') AS acteurRef,
          json_extract_string(vote_json, '$.mandatRef') AS mandatRef,
          json_extract_string(vote_json, '$.parDelegation') AS parDelegation,
          json_extract_string(vote_json, '$.numPlace') AS numPlace,
          json_extract_string(vote_json, '$.causePositionVote') AS cause
      FROM positions_array
      UNION ALL
      SELECT * 
      FROM positions_object
  )

  SELECT * FROM clean
    );
  
  
  
[0m23:33:14.320316 [debug] [Thread-1 (]: SQL status: OK in 11.302 seconds
[0m23:33:14.323708 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:33:14.323959 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_scrutins_votes'
  
[0m23:33:14.338130 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m23:33:14.340176 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:33:14.340387 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_scrutins_votes'
  
[0m23:33:14.341310 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:33:14.344652 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:33:14.344844 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */
alter table "an_data_pipeline"."main"."int_scrutins_votes" rename to "int_scrutins_votes__dbt_backup"
[0m23:33:14.458418 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m23:33:14.461221 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:33:14.461553 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */
alter table "an_data_pipeline"."main"."int_scrutins_votes__dbt_tmp" rename to "int_scrutins_votes"
[0m23:33:14.572025 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m23:33:14.576113 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m23:33:14.576883 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:33:14.577441 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m23:33:16.667196 [debug] [Thread-1 (]: SQL status: OK in 2.089 seconds
[0m23:33:16.668632 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:33:16.668819 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__f61b046139ce" cascade
    
[0m23:33:16.777172 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m23:33:16.780526 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:33:16.780948 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."main"."int_scrutins_votes__dbt_backup" cascade
    
[0m23:33:16.999690 [debug] [Thread-1 (]: SQL status: OK in 0.218 seconds
[0m23:33:17.001429 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:33:17.001611 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__f61b046139ce" cascade
    
[0m23:33:17.106884 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m23:33:17.108182 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: Close
[0m23:33:17.109290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b064e5f6-c86b-474e-a699-91eca678d0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e8e7b0>]}
[0m23:33:17.110298 [info ] [Thread-1 (]: 10 of 10 OK created sql incremental model main.int_scrutins_votes .............. [[32mOK[0m in 14.47s]
[0m23:33:17.110796 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins_votes
[0m23:33:17.117306 [debug] [MainThread]: Using duckdb connection "master"
[0m23:33:17.117636 [debug] [MainThread]: On master: BEGIN
[0m23:33:17.117872 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:33:17.119036 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:33:17.119322 [debug] [MainThread]: On master: COMMIT
[0m23:33:17.119536 [debug] [MainThread]: Using duckdb connection "master"
[0m23:33:17.119724 [debug] [MainThread]: On master: COMMIT
[0m23:33:17.120087 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:33:17.120283 [debug] [MainThread]: On master: Close
[0m23:33:17.120551 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:33:17.120736 [debug] [MainThread]: Connection 'model.dbt_an_data.int_scrutins_votes' was properly closed.
[0m23:33:17.121452 [info ] [MainThread]: 
[0m23:33:17.122204 [info ] [MainThread]: Finished running 10 incremental models, 1 project hook in 0 hours 0 minutes and 36.04 seconds (36.04s).
[0m23:33:17.123487 [debug] [MainThread]: Command end result
[0m23:33:17.146337 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m23:33:17.150320 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m23:33:17.154938 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m23:33:17.155123 [info ] [MainThread]: 
[0m23:33:17.155307 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:33:17.155437 [info ] [MainThread]: 
[0m23:33:17.155626 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m23:33:17.157157 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 37.04585, "process_in_blocks": "0", "process_kernel_time": 6.532136, "process_mem_max_rss": "2653323264", "process_out_blocks": "0", "process_user_time": 20.195784}
[0m23:33:17.157516 [debug] [MainThread]: Command `dbt run` succeeded at 23:33:17.157459 after 37.05 seconds
[0m23:33:17.157961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105554860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea5580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c0a10>]}
[0m23:33:17.158149 [debug] [MainThread]: Flushing usage events
[0m23:33:17.773039 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:36:26.089159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f5b9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a8c0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c1f260>]}


============================== 23:36:26.091997 | ad77a318-9d2a-4fa0-bbf5-78b50c389a98 ==============================
[0m23:36:26.091997 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:36:26.092301 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'version_check': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'write_json': 'True', 'debug': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'empty': 'False', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'log_format': 'default', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'static_parser': 'True'}
[0m23:36:26.217120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad77a318-9d2a-4fa0-bbf5-78b50c389a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dc3650>]}
[0m23:36:26.243901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad77a318-9d2a-4fa0-bbf5-78b50c389a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c1f440>]}
[0m23:36:26.246138 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m23:36:26.302449 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m23:36:26.366616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:36:26.366830 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:36:26.369864 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_an_data.mart
[0m23:36:26.386744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad77a318-9d2a-4fa0-bbf5-78b50c389a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105004110>]}
[0m23:36:26.425411 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m23:36:26.426494 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m23:36:26.438852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad77a318-9d2a-4fa0-bbf5-78b50c389a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105076d50>]}
[0m23:36:26.439116 [info ] [MainThread]: Found 17 models, 1 operation, 9 sources, 469 macros
[0m23:36:26.439279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad77a318-9d2a-4fa0-bbf5-78b50c389a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ea65d0>]}
[0m23:36:26.440342 [info ] [MainThread]: 
[0m23:36:26.440519 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m23:36:26.440653 [info ] [MainThread]: 
[0m23:36:26.440887 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:36:26.443151 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_an_data_pipeline'
[0m23:36:26.474713 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline"
[0m23:36:26.474976 [debug] [ThreadPool]: On list_an_data_pipeline: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"an_data_pipeline"'
    
  
  
[0m23:36:26.475127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:28.117211 [debug] [ThreadPool]: SQL status: OK in 1.642 seconds
[0m23:36:28.121334 [debug] [ThreadPool]: On list_an_data_pipeline: Close
[0m23:36:28.122896 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_an_data_pipeline, now create_an_data_pipeline_main)
[0m23:36:28.123896 [debug] [ThreadPool]: Creating schema "database: "an_data_pipeline"
schema: "main"
"
[0m23:36:28.135847 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m23:36:28.136655 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:36:28.137158 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:36:28.139199 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:36:28.141083 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m23:36:28.141483 [debug] [ThreadPool]: On create_an_data_pipeline_main: BEGIN
[0m23:36:28.142475 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:36:28.142817 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m23:36:28.143182 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
    
        create schema if not exists "an_data_pipeline"."main"
    
[0m23:36:28.251973 [debug] [ThreadPool]: SQL status: OK in 0.108 seconds
[0m23:36:28.255082 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m23:36:28.255954 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m23:36:28.256773 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m23:36:28.365377 [debug] [ThreadPool]: SQL status: OK in 0.108 seconds
[0m23:36:28.366841 [debug] [ThreadPool]: On create_an_data_pipeline_main: Close
[0m23:36:28.372274 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_an_data_pipeline_main, now list_an_data_pipeline_main)
[0m23:36:28.385255 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m23:36:28.386077 [debug] [ThreadPool]: On list_an_data_pipeline_main: BEGIN
[0m23:36:28.386531 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:36:28.388195 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:36:28.388838 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m23:36:28.389362 [debug] [ThreadPool]: On list_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline_main"} */
select
      'an_data_pipeline' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'an_data_pipeline'
  
[0m23:36:28.410126 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m23:36:28.411836 [debug] [ThreadPool]: On list_an_data_pipeline_main: ROLLBACK
[0m23:36:28.413752 [debug] [ThreadPool]: Failed to rollback 'list_an_data_pipeline_main'
[0m23:36:28.414071 [debug] [ThreadPool]: On list_an_data_pipeline_main: Close
[0m23:36:28.415856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad77a318-9d2a-4fa0-bbf5-78b50c389a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e74b00>]}
[0m23:36:28.416322 [debug] [MainThread]: Using duckdb connection "master"
[0m23:36:28.416593 [debug] [MainThread]: On master: BEGIN
[0m23:36:28.416804 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:36:28.417543 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:36:28.417782 [debug] [MainThread]: On master: COMMIT
[0m23:36:28.418007 [debug] [MainThread]: Using duckdb connection "master"
[0m23:36:28.418211 [debug] [MainThread]: On master: COMMIT
[0m23:36:28.418575 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:36:28.425014 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_an_data.dbt_an_data-on-run-start-0"
[0m23:36:28.428755 [info ] [MainThread]: 1 of 1 START hook: dbt_an_data.on-run-start.0 .................................. [RUN]
[0m23:36:28.429114 [debug] [MainThread]: Using duckdb connection "master"
[0m23:36:28.429366 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "master"} */
ATTACH '../data/database/database.duckdb' AS database (READ_ONLY)
[0m23:36:28.437215 [debug] [MainThread]: SQL status: OK in 0.008 seconds
[0m23:36:28.437924 [info ] [MainThread]: 1 of 1 OK hook: dbt_an_data.on-run-start.0 ..................................... [[32mOK[0m in 0.02s]
[0m23:36:28.438138 [info ] [MainThread]: 
[0m23:36:28.438337 [debug] [MainThread]: On master: Close
[0m23:36:28.440052 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_acteurs
[0m23:36:28.440392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_an_data_pipeline_main, now model.dbt_an_data.stg_acteurs)
[0m23:36:28.440759 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_acteurs
[0m23:36:28.442498 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_acteurs"
[0m23:36:28.443160 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_acteurs
[0m23:36:28.443390 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_agenda
[0m23:36:28.443640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_acteurs, now model.dbt_an_data.stg_agenda)
[0m23:36:28.443855 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_agenda
[0m23:36:28.445262 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_agenda"
[0m23:36:28.445850 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_agenda
[0m23:36:28.446062 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_amendements
[0m23:36:28.446282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_agenda, now model.dbt_an_data.stg_amendements)
[0m23:36:28.446485 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_amendements
[0m23:36:28.447849 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_amendements"
[0m23:36:28.449134 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_amendements
[0m23:36:28.449346 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_organes
[0m23:36:28.449553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_amendements, now model.dbt_an_data.stg_organes)
[0m23:36:28.449747 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_organes
[0m23:36:28.451161 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_organes"
[0m23:36:28.451914 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_organes
[0m23:36:28.452127 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_pays
[0m23:36:28.452352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_organes, now model.dbt_an_data.stg_pays)
[0m23:36:28.452539 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_pays
[0m23:36:28.454165 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_pays"
[0m23:36:28.455126 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_pays
[0m23:36:28.455317 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_reunions
[0m23:36:28.455529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_pays, now model.dbt_an_data.stg_reunions)
[0m23:36:28.455727 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_reunions
[0m23:36:28.456941 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_reunions"
[0m23:36:28.457434 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_reunions
[0m23:36:28.457600 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_scrutins
[0m23:36:28.457766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_reunions, now model.dbt_an_data.stg_scrutins)
[0m23:36:28.457920 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_scrutins
[0m23:36:28.459003 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_scrutins"
[0m23:36:28.459460 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_scrutins
[0m23:36:28.459622 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_acteurs
[0m23:36:28.459842 [info ] [Thread-1 (]: 1 of 10 START sql incremental model main.int_acteurs ........................... [RUN]
[0m23:36:28.460129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_scrutins, now model.dbt_an_data.int_acteurs)
[0m23:36:28.460333 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_acteurs
[0m23:36:28.464621 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_acteurs"
[0m23:36:28.464946 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_acteurs
[0m23:36:28.468454 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:36:28.468658 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__046476a15850" cascade
    
[0m23:36:28.468815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:28.574202 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m23:36:28.604213 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:36:28.604500 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:36:28.605356 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:36:28.606132 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:36:28.606326 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m23:36:28.606873 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:36:28.607087 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:36:28.607272 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m23:36:28.711342 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m23:36:28.712805 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:36:28.713264 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    

  
[0m23:36:28.713771 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:36:28.715116 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m23:36:28.715489 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:36:28.715825 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m23:36:28.818295 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m23:36:28.845459 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:36:28.846396 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_acteurs__046476a15850"
  
    as (
      

with __dbt__cte__stg_acteurs as (
SELECT * 
FROM "database"."stg"."raw_acteurs"
) SELECT 
json_extract_string(json, '$.acteur.uid.#text') as uid,
json_extract_string(json, '$.acteur.etatCivil.ident.civ') as civ,
json_extract_string(json, '$.acteur.etatCivil.ident.prenom') as prenom,
json_extract_string(json, '$.acteur.etatCivil.ident.nom') as nom,
json_extract_string(json, '$.acteur.etatCivil.ident.trigramme') as trigramme,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.dateNais') as dateNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.villeNais') as villeNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.depNais') as depNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.paysNais') as paysNais,
json_extract_string(json, '$.acteur.etatCivil.dateDeces') as dateDeces,
json_extract_string(json, '$.acteur.profession.libelleCourant') as libelleCourant,
json_extract_string(json, '$.acteur.profession.socProcINSEE.catSocPro') as catSocPro,
json_extract_string(json, '$.acteur.profession.socProcINSEE.famSocPro') as famSocPro,
json_extract_string(json, '$.acteur.uri_hatvp') as uri_hatvp
FROM __dbt__cte__stg_acteurs
    );
  
  
  
[0m23:36:29.450444 [debug] [Thread-1 (]: SQL status: OK in 0.603 seconds
[0m23:36:29.464517 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:36:29.465171 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m23:36:29.466714 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:36:29.467173 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:36:29.467578 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs__046476a15850'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m23:36:29.476975 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m23:36:29.484057 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:36:29.484500 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m23:36:29.487362 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:36:29.493975 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:36:29.494366 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m23:36:29.496941 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:36:29.498309 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:36:29.498578 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */
SELECT version()
[0m23:36:29.499073 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:36:29.510773 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_acteurs"
[0m23:36:29.511602 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:36:29.511840 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

        
            delete from "an_data_pipeline"."main"."int_acteurs"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_acteurs__046476a15850"
            );

        
    

    insert into "an_data_pipeline"."main"."int_acteurs" ("uid", "civ", "prenom", "nom", "trigramme", "dateNais", "villeNais", "depNais", "paysNais", "dateDeces", "libelleCourant", "catSocPro", "famSocPro", "uri_hatvp")
    (
        select "uid", "civ", "prenom", "nom", "trigramme", "dateNais", "villeNais", "depNais", "paysNais", "dateDeces", "libelleCourant", "catSocPro", "famSocPro", "uri_hatvp"
        from "an_data_pipeline"."dbt_temp"."int_acteurs__046476a15850"
    )
  
[0m23:36:29.742604 [debug] [Thread-1 (]: SQL status: OK in 0.230 seconds
[0m23:36:29.765268 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m23:36:29.766155 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:36:29.766639 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m23:36:29.891171 [debug] [Thread-1 (]: SQL status: OK in 0.124 seconds
[0m23:36:29.899479 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:36:29.900381 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__046476a15850" cascade
    
[0m23:36:30.134913 [debug] [Thread-1 (]: SQL status: OK in 0.233 seconds
[0m23:36:30.142341 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m23:36:30.143014 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__046476a15850" cascade
    
[0m23:36:30.251527 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m23:36:30.255861 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: Close
[0m23:36:30.260258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad77a318-9d2a-4fa0-bbf5-78b50c389a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101404f50>]}
[0m23:36:30.261794 [info ] [Thread-1 (]: 1 of 10 OK created sql incremental model main.int_acteurs ...................... [[32mOK[0m in 1.80s]
[0m23:36:30.262822 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_acteurs
[0m23:36:30.263795 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_mandats
[0m23:36:30.264807 [info ] [Thread-1 (]: 2 of 10 START sql incremental model main.int_mandats ........................... [RUN]
[0m23:36:30.266157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_acteurs, now model.dbt_an_data.int_mandats)
[0m23:36:30.266956 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_mandats
[0m23:36:30.279498 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_mandats"
[0m23:36:30.280626 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_mandats
[0m23:36:30.285458 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:36:30.285877 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__8504f430d216" cascade
    
[0m23:36:30.286236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:30.397254 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m23:36:30.403023 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:36:30.403695 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:36:30.407199 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:36:30.409727 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:36:30.410333 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m23:36:30.411781 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:36:30.412350 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:36:30.412875 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m23:36:30.521623 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m23:36:30.526018 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:36:30.526847 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    

  
[0m23:36:30.527779 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:36:30.530099 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m23:36:30.530719 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:36:30.531302 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m23:36:30.635514 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m23:36:30.639218 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:36:30.640379 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_mandats__8504f430d216"
  
    as (
      

with __dbt__cte__stg_acteurs as (
SELECT * 
FROM "database"."stg"."raw_acteurs"
) SELECT 
json_extract_string(mandat.value, '$.uid') as uid,
json_extract_string(mandat.value, '$.acteurRef') as acteurRef,
json_extract_string(mandat.value, '$.legislature') as legislature,
json_extract_string(mandat.value, '$.typeOrgane') as typeOrgane,
json_extract_string(mandat.value, '$.dateDebut') as dateDebut,
json_extract_string(mandat.value, '$.dateFin') as dateFin,
json_extract_string(mandat.value, '$.preseance') as preseance,
json_extract_string(mandat.value, '$.nominPrincipale') as nominPrincipale,
json_extract_string(mandat.value, '$.infosQualite.codeQualite') as codeQualite,
json_extract_string(mandat.value, '$.organes.organeRef') as organeRef,
FROM __dbt__cte__stg_acteurs act, json_each(json->'acteur'->'mandats'->'mandat') mandat
    );
  
  
  
[0m23:36:31.466953 [debug] [Thread-1 (]: SQL status: OK in 0.825 seconds
[0m23:36:31.472332 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:36:31.472855 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m23:36:31.474187 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:36:31.474664 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:36:31.475085 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats__8504f430d216'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m23:36:31.479305 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:36:31.485157 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:36:31.485602 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m23:36:31.488714 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:36:31.538852 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:36:31.539147 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m23:36:31.540804 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:36:31.541886 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_mandats"
[0m23:36:31.542539 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:36:31.542768 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

        
            delete from "an_data_pipeline"."main"."int_mandats"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_mandats__8504f430d216"
            );

        
    

    insert into "an_data_pipeline"."main"."int_mandats" ("uid", "acteurRef", "legislature", "typeOrgane", "dateDebut", "dateFin", "preseance", "nominPrincipale", "codeQualite", "organeRef")
    (
        select "uid", "acteurRef", "legislature", "typeOrgane", "dateDebut", "dateFin", "preseance", "nominPrincipale", "codeQualite", "organeRef"
        from "an_data_pipeline"."dbt_temp"."int_mandats__8504f430d216"
    )
  
[0m23:36:31.798283 [debug] [Thread-1 (]: SQL status: OK in 0.255 seconds
[0m23:36:31.802583 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m23:36:31.803439 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:36:31.804244 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m23:36:31.996141 [debug] [Thread-1 (]: SQL status: OK in 0.191 seconds
[0m23:36:32.004849 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:36:32.005968 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__8504f430d216" cascade
    
[0m23:36:32.246888 [debug] [Thread-1 (]: SQL status: OK in 0.240 seconds
[0m23:36:32.249249 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m23:36:32.249437 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__8504f430d216" cascade
    
[0m23:36:32.353661 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m23:36:32.354726 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: Close
[0m23:36:32.355167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad77a318-9d2a-4fa0-bbf5-78b50c389a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10593bce0>]}
[0m23:36:32.355600 [info ] [Thread-1 (]: 2 of 10 OK created sql incremental model main.int_mandats ...................... [[32mOK[0m in 2.09s]
[0m23:36:32.355989 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_mandats
[0m23:36:32.356271 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_agenda
[0m23:36:32.356550 [info ] [Thread-1 (]: 3 of 10 START sql incremental model main.int_agenda ............................ [RUN]
[0m23:36:32.356808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_mandats, now model.dbt_an_data.int_agenda)
[0m23:36:32.356995 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_agenda
[0m23:36:32.358990 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_agenda"
[0m23:36:32.359426 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_agenda
[0m23:36:32.361474 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:36:32.361676 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__6e7031de2385" cascade
    
[0m23:36:32.361855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:32.481657 [debug] [Thread-1 (]: SQL status: OK in 0.120 seconds
[0m23:36:32.484994 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:36:32.485500 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:36:32.487415 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:36:32.489374 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:36:32.489882 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m23:36:32.490955 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:36:32.491315 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:36:32.491677 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m23:36:32.599390 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m23:36:32.603123 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:36:32.604195 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    

  
[0m23:36:32.605190 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:36:32.607696 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m23:36:32.608406 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:36:32.608915 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m23:36:32.709837 [debug] [Thread-1 (]: SQL status: OK in 0.100 seconds
[0m23:36:32.710333 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:36:32.710496 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_agenda__6e7031de2385"
  
    as (
      

with __dbt__cte__stg_agenda as (
SELECT * 
FROM "database"."stg"."raw_agenda"
) SELECT * 
FROM __dbt__cte__stg_agenda
    );
  
  
  
[0m23:36:33.053164 [debug] [Thread-1 (]: SQL status: OK in 0.342 seconds
[0m23:36:33.056656 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:36:33.057370 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m23:36:33.058650 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:36:33.059092 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:36:33.059536 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda__6e7031de2385'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m23:36:33.063363 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:36:33.066673 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:36:33.067094 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m23:36:33.070360 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:36:33.073822 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:36:33.074201 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m23:36:33.077081 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:36:33.079679 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_agenda"
[0m23:36:33.080562 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:36:33.080977 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

        
            delete from "an_data_pipeline"."main"."int_agenda" as DBT_INCREMENTAL_TARGET
            using "an_data_pipeline"."dbt_temp"."int_agenda__6e7031de2385"
            where (
                
                    "an_data_pipeline"."dbt_temp"."int_agenda__6e7031de2385".Date = DBT_INCREMENTAL_TARGET.Date
                    and 
                
                    "an_data_pipeline"."dbt_temp"."int_agenda__6e7031de2385".Heure = DBT_INCREMENTAL_TARGET.Heure
                    
                
                
            );
        
    

    insert into "an_data_pipeline"."main"."int_agenda" ("Date", "Heure", "Ordre(s) du jour", "filename", "date_T_insert")
    (
        select "Date", "Heure", "Ordre(s) du jour", "filename", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_agenda__6e7031de2385"
    )
  
[0m23:36:33.306191 [debug] [Thread-1 (]: SQL status: OK in 0.224 seconds
[0m23:36:33.310054 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m23:36:33.310873 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:36:33.311573 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m23:36:33.428083 [debug] [Thread-1 (]: SQL status: OK in 0.116 seconds
[0m23:36:33.429503 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:36:33.429683 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__6e7031de2385" cascade
    
[0m23:36:33.650318 [debug] [Thread-1 (]: SQL status: OK in 0.220 seconds
[0m23:36:33.652926 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m23:36:33.653109 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__6e7031de2385" cascade
    
[0m23:36:33.757463 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m23:36:33.758935 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: Close
[0m23:36:33.759472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad77a318-9d2a-4fa0-bbf5-78b50c389a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b7ec0>]}
[0m23:36:33.760086 [info ] [Thread-1 (]: 3 of 10 OK created sql incremental model main.int_agenda ....................... [[32mOK[0m in 1.40s]
[0m23:36:33.760601 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_agenda
[0m23:36:33.760917 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements
[0m23:36:33.761302 [info ] [Thread-1 (]: 4 of 10 START sql incremental model main.int_amendements ....................... [RUN]
[0m23:36:33.761644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_agenda, now model.dbt_an_data.int_amendements)
[0m23:36:33.761916 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements
[0m23:36:33.774935 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements"
[0m23:36:33.775486 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements
[0m23:36:33.778045 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:36:33.778315 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__57362b0a19d4" cascade
    
[0m23:36:33.778538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:33.884150 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m23:36:33.887870 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:36:33.888401 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:36:33.890249 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:36:33.892126 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:36:33.892602 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m23:36:33.893670 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:36:33.894095 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:36:33.894507 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m23:36:34.001933 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m23:36:34.005501 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:36:34.006528 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    

  
[0m23:36:34.007657 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:36:34.010679 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m23:36:34.011476 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:36:34.012133 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m23:36:34.118449 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m23:36:34.121360 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:36:34.122777 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_amendements__57362b0a19d4"
  
    as (
      

with __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
) SELECT
json_extract_string(json, '$.amendement.uid') AS uid,
json_extract_string(json, '$.amendement.chronotag') AS chronotag,
json_extract_string(json, '$.amendement.examenRef') AS examenRef,
json_extract_string(json, '$.amendement.amendementParentRef') AS amendementParentRef,
json_extract_string(json, '$.amendement.signataires.auteur.typeAuteur') AS typeAuteur,
json_extract_string(json, '$.amendement.signataires.auteur.acteurRef') AS refAuteur,
json_extract_string(json, '$.amendement.signataires.auteur.groupePolitique') AS groupePolitiqueAuteur,
json_extract_string(json, '$.amendement.cycleDeVie.dateDepot') AS dateDepot,
json_extract_string(json, '$.amendement.cycleDeVie.datePublication') AS datePublication,
json_extract_string(json, '$.amendement.cycleDeVie.soumisArticle40') AS soumisArticle40,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.code') AS codeEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.libelle') AS libelleEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.code') AS codeSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.dateSort') AS dateSort,
json_extract_string(json, '$.amendement.cycleDeVie.sort') AS sort,
split_part(replace(filename, '.json', ''), '/', -1) AS id_amendement,
split_part(replace(filename, '.json', ''), '/', -2) AS id_texte,
split_part(replace(filename, '.json', ''), '/', -3) AS id_dossier_legislatif,
id_texte[:4] AS nature_texte,
id_texte[5:6] AS source_texte,
regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 1) AS prefix_bibard,
regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 2) AS numero_bibard,
regexp_extract(id_amendement, '(SEA|PO\d*)', 1) AS code_organe,
regexp_extract(id_amendement, '(P)(\d*)(D)', 2) AS numero_partie,
regexp_extract(id_amendement, '(D)(\d*)(N)', 2) AS numero_deliberation,
regexp_extract(id_amendement, '(D)(\d*)(N)(\d*)', 4) AS numero_court
from __dbt__cte__stg_amendements
    );
  
  
  
[0m23:36:34.494996 [debug] [Thread-1 (]: SQL status: OK in 0.371 seconds
[0m23:36:34.499953 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:36:34.500392 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m23:36:34.501608 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:36:34.502015 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:36:34.502395 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements__57362b0a19d4'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m23:36:34.506080 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:36:34.509516 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:36:34.509900 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m23:36:34.512638 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:36:34.515800 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:36:34.516125 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m23:36:34.518537 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:36:34.520694 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements"
[0m23:36:34.521377 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:36:34.521673 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

        
            delete from "an_data_pipeline"."main"."int_amendements"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_amendements__57362b0a19d4"
            );

        
    

    insert into "an_data_pipeline"."main"."int_amendements" ("uid", "chronotag", "examenRef", "amendementParentRef", "typeAuteur", "refAuteur", "groupePolitiqueAuteur", "dateDepot", "datePublication", "soumisArticle40", "codeEtat", "libelleEtat", "codeSousEtat", "libelleSousEtat", "libelleSousEtat_1", "dateSort", "sort", "id_amendement", "id_texte", "id_dossier_legislatif", "nature_texte", "source_texte", "prefix_bibard", "numero_bibard", "code_organe", "numero_partie", "numero_deliberation", "numero_court")
    (
        select "uid", "chronotag", "examenRef", "amendementParentRef", "typeAuteur", "refAuteur", "groupePolitiqueAuteur", "dateDepot", "datePublication", "soumisArticle40", "codeEtat", "libelleEtat", "codeSousEtat", "libelleSousEtat", "libelleSousEtat_1", "dateSort", "sort", "id_amendement", "id_texte", "id_dossier_legislatif", "nature_texte", "source_texte", "prefix_bibard", "numero_bibard", "code_organe", "numero_partie", "numero_deliberation", "numero_court"
        from "an_data_pipeline"."dbt_temp"."int_amendements__57362b0a19d4"
    )
  
[0m23:36:34.754993 [debug] [Thread-1 (]: SQL status: OK in 0.233 seconds
[0m23:36:34.757533 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m23:36:34.758167 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:36:34.758700 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m23:36:34.862008 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m23:36:34.863404 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:36:34.863589 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__57362b0a19d4" cascade
    
[0m23:36:35.092886 [debug] [Thread-1 (]: SQL status: OK in 0.229 seconds
[0m23:36:35.094731 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m23:36:35.094926 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__57362b0a19d4" cascade
    
[0m23:36:35.198625 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m23:36:35.200114 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: Close
[0m23:36:35.200666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad77a318-9d2a-4fa0-bbf5-78b50c389a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056524e0>]}
[0m23:36:35.201249 [info ] [Thread-1 (]: 4 of 10 OK created sql incremental model main.int_amendements .................. [[32mOK[0m in 1.44s]
[0m23:36:35.201750 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements
[0m23:36:35.202093 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements_cosignataires
[0m23:36:35.202533 [info ] [Thread-1 (]: 5 of 10 START sql incremental model main.int_amendements_cosignataires ......... [RUN]
[0m23:36:35.202965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements, now model.dbt_an_data.int_amendements_cosignataires)
[0m23:36:35.203276 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements_cosignataires
[0m23:36:35.211816 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements_cosignataires"
[0m23:36:35.212546 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements_cosignataires
[0m23:36:35.215328 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:36:35.215603 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__b03a7f337c19" cascade
    
[0m23:36:35.215848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:35.342060 [debug] [Thread-1 (]: SQL status: OK in 0.126 seconds
[0m23:36:35.348183 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:36:35.349007 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:36:35.351179 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:36:35.353234 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:36:35.353688 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m23:36:35.354679 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:36:35.355116 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:36:35.355546 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m23:36:35.462849 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m23:36:35.466779 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:36:35.467812 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    

  
[0m23:36:35.469039 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:36:35.471782 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m23:36:35.472552 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:36:35.473225 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m23:36:35.577650 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m23:36:35.580979 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:36:35.582209 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__b03a7f337c19"
  
    as (
      

WITH  __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
), cosignataires_arr AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef[*]') AS acteurRef
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') == 'ARRAY' AND acteurRef IS NOT NULL
), cosignataires_str AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef') AS acteurRef
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') <> 'ARRAY' AND acteurRef IS NOT NULL
)
SELECT 
  uid, 
  unnest(acteurRef) as acteurRef
FROM cosignataires_arr
UNION ALL
SELECT 
  uid, 
  acteurRef
FROM cosignataires_str
    );
  
  
  
[0m23:36:35.938094 [debug] [Thread-1 (]: SQL status: OK in 0.355 seconds
[0m23:36:35.942396 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:36:35.942944 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m23:36:35.944507 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:36:35.944886 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:36:35.945336 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires__b03a7f337c19'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m23:36:35.949399 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:36:35.952802 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:36:35.953239 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m23:36:35.956238 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:36:35.959742 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:36:35.960105 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m23:36:35.962546 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:36:35.964067 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements_cosignataires"
[0m23:36:35.964728 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:36:35.965037 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

        
            delete from "an_data_pipeline"."main"."int_amendements_cosignataires" as DBT_INCREMENTAL_TARGET
            using "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__b03a7f337c19"
            where (
                
                    "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__b03a7f337c19".uid = DBT_INCREMENTAL_TARGET.uid
                    and 
                
                    "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__b03a7f337c19".acteurRef = DBT_INCREMENTAL_TARGET.acteurRef
                    
                
                
            );
        
    

    insert into "an_data_pipeline"."main"."int_amendements_cosignataires" ("uid", "acteurRef")
    (
        select "uid", "acteurRef"
        from "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__b03a7f337c19"
    )
  
[0m23:36:36.190860 [debug] [Thread-1 (]: SQL status: OK in 0.225 seconds
[0m23:36:36.195936 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m23:36:36.196888 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:36:36.197672 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m23:36:36.301843 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m23:36:36.303639 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:36:36.303866 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__b03a7f337c19" cascade
    
[0m23:36:36.523679 [debug] [Thread-1 (]: SQL status: OK in 0.220 seconds
[0m23:36:36.525810 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m23:36:36.525994 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__b03a7f337c19" cascade
    
[0m23:36:36.629693 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m23:36:36.631174 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: Close
[0m23:36:36.631709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad77a318-9d2a-4fa0-bbf5-78b50c389a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056c9fd0>]}
[0m23:36:36.632291 [info ] [Thread-1 (]: 5 of 10 OK created sql incremental model main.int_amendements_cosignataires .... [[32mOK[0m in 1.43s]
[0m23:36:36.632783 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements_cosignataires
[0m23:36:36.633121 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_organes
[0m23:36:36.633599 [info ] [Thread-1 (]: 6 of 10 START sql incremental model main.int_organes ........................... [RUN]
[0m23:36:36.634030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements_cosignataires, now model.dbt_an_data.int_organes)
[0m23:36:36.634349 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_organes
[0m23:36:36.641632 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_organes"
[0m23:36:36.643098 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_organes
[0m23:36:36.647204 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:36:36.647478 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__08dfb349755b" cascade
    
[0m23:36:36.647832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:36.756466 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m23:36:36.762620 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:36:36.763487 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:36:36.765984 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:36:36.768057 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:36:36.768528 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m23:36:36.769593 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:36:36.770024 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:36:36.770439 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m23:36:36.880040 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m23:36:36.883494 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:36:36.884266 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    

  
[0m23:36:36.885114 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:36:36.887496 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m23:36:36.888223 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:36:36.888878 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m23:36:36.992175 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m23:36:36.992630 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:36:36.992826 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_organes__08dfb349755b"
  
    as (
      

with __dbt__cte__stg_organes as (
SELECT * 
FROM "database"."stg"."raw_organes"
) SELECT 
json_extract_string(json, '$.organe.uid') as uid,
json_extract_string(json, '$.organe.codeType') as codeType,
json_extract_string(json, '$.organe.libelle') as libelle,
json_extract_string(json, '$.organe.libelleEdition') as libelleEdition,
json_extract_string(json, '$.organe.libelleAbrege') as libelleAbrege,
json_extract_string(json, '$.organe.libelleAbrev') as libelleAbrev,
json_extract_string(json, '$.organe.viMoDe.dateDebut') as dateDebut,
json_extract_string(json, '$.organe.viMoDe.dateAgrement') as dateAgrement,
json_extract_string(json, '$.organe.viMoDe.dateFin') as dateFin,
json_extract_string(json, '$.organe.organeParent') as organeParent,
json_extract_string(json, '$.organe.chambre') as chambre,
json_extract_string(json, '$.organe.regime') as regime,
json_extract_string(json, '$.organe.legislature') as legislature
FROM __dbt__cte__stg_organes
    );
  
  
  
[0m23:36:37.523844 [debug] [Thread-1 (]: SQL status: OK in 0.530 seconds
[0m23:36:37.530795 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:36:37.531683 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m23:36:37.533669 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:36:37.534306 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:36:37.534831 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes__08dfb349755b'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m23:36:37.539789 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:36:37.545263 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:36:37.545844 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m23:36:37.549276 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:36:37.552802 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:36:37.553214 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m23:36:37.556340 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:36:37.559332 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_organes"
[0m23:36:37.560078 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:36:37.560400 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

        
            delete from "an_data_pipeline"."main"."int_organes"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_organes__08dfb349755b"
            );

        
    

    insert into "an_data_pipeline"."main"."int_organes" ("uid", "codeType", "libelle", "libelleEdition", "libelleAbrege", "libelleAbrev", "dateDebut", "dateAgrement", "dateFin", "organeParent", "chambre", "regime", "legislature")
    (
        select "uid", "codeType", "libelle", "libelleEdition", "libelleAbrege", "libelleAbrev", "dateDebut", "dateAgrement", "dateFin", "organeParent", "chambre", "regime", "legislature"
        from "an_data_pipeline"."dbt_temp"."int_organes__08dfb349755b"
    )
  
[0m23:36:37.811864 [debug] [Thread-1 (]: SQL status: OK in 0.251 seconds
[0m23:36:37.815830 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m23:36:37.816640 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:36:37.817318 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m23:36:38.015807 [debug] [Thread-1 (]: SQL status: OK in 0.197 seconds
[0m23:36:38.023789 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:36:38.024653 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__08dfb349755b" cascade
    
[0m23:36:38.243154 [debug] [Thread-1 (]: SQL status: OK in 0.218 seconds
[0m23:36:38.244852 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m23:36:38.245030 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__08dfb349755b" cascade
    
[0m23:36:38.347066 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m23:36:38.348360 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: Close
[0m23:36:38.348849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad77a318-9d2a-4fa0-bbf5-78b50c389a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b6ae0>]}
[0m23:36:38.349353 [info ] [Thread-1 (]: 6 of 10 OK created sql incremental model main.int_organes ...................... [[32mOK[0m in 1.71s]
[0m23:36:38.349777 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_organes
[0m23:36:38.350068 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_pays
[0m23:36:38.350498 [info ] [Thread-1 (]: 7 of 10 START sql incremental model main.int_pays .............................. [RUN]
[0m23:36:38.350924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_organes, now model.dbt_an_data.int_pays)
[0m23:36:38.351234 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_pays
[0m23:36:38.357656 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_pays"
[0m23:36:38.358241 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_pays
[0m23:36:38.361107 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:36:38.361418 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__ceb183b66b70" cascade
    
[0m23:36:38.361639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:38.467834 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m23:36:38.472709 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:36:38.473337 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:36:38.475307 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:36:38.477346 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:36:38.477819 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m23:36:38.478935 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:36:38.479375 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:36:38.479849 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m23:36:38.585131 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m23:36:38.587112 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:36:38.587617 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    

  
[0m23:36:38.588198 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:36:38.589757 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m23:36:38.590227 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:36:38.590770 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m23:36:38.694701 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m23:36:38.696656 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:36:38.697353 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_pays__ceb183b66b70"
  
    as (
      

with __dbt__cte__stg_pays as (
SELECT * 
FROM "database"."stg"."raw_pays"
) SELECT
json_extract_string(json, '$.pays.uid') as uid,
json_extract_string(json, '$.pays.code_insee') as code_insee,
json_extract_string(json, '$.pays.libelleInsee') as libelleInsee,
json_extract_string(json, '$.pays.nomCourant') as nomCourant,
json_extract_string(json, '$.pays.code_iso2A') as code_iso2A,
json_extract_string(json, '$.pays.code_iso3A') as code_iso3A,
json_extract_string(json, '$.pays.code_iso3N') as code_iso3N,
json_extract_string(json, '$.pays.libelleIso') as libelleIso,
json_extract_string(json, '$.pays.libelleANCourt') as libelleANCourt,
json_extract_string(json, '$.pays.libelleANLong') as libelleANLong,
json_extract_string(json, '$.pays.sourceJuridique') as sourceJuridique,
json_extract_string(json, '$.pays.activ') as activ
FROM __dbt__cte__stg_pays
    );
  
  
  
[0m23:36:39.055994 [debug] [Thread-1 (]: SQL status: OK in 0.358 seconds
[0m23:36:39.065006 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:36:39.065679 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m23:36:39.067523 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:36:39.068014 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:36:39.068485 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays__ceb183b66b70'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m23:36:39.072694 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:36:39.076631 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:36:39.077457 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m23:36:39.081166 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:36:39.085530 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:36:39.086033 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m23:36:39.089279 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:36:39.091215 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_pays"
[0m23:36:39.091927 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:36:39.092243 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

        
            delete from "an_data_pipeline"."main"."int_pays"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_pays__ceb183b66b70"
            );

        
    

    insert into "an_data_pipeline"."main"."int_pays" ("uid", "code_insee", "libelleInsee", "nomCourant", "code_iso2A", "code_iso3A", "code_iso3N", "libelleIso", "libelleANCourt", "libelleANLong", "sourceJuridique", "activ")
    (
        select "uid", "code_insee", "libelleInsee", "nomCourant", "code_iso2A", "code_iso3A", "code_iso3N", "libelleIso", "libelleANCourt", "libelleANLong", "sourceJuridique", "activ"
        from "an_data_pipeline"."dbt_temp"."int_pays__ceb183b66b70"
    )
  
[0m23:36:39.324919 [debug] [Thread-1 (]: SQL status: OK in 0.232 seconds
[0m23:36:39.329366 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m23:36:39.330293 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:36:39.331104 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m23:36:39.449176 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m23:36:39.452860 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:36:39.453400 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__ceb183b66b70" cascade
    
[0m23:36:39.682326 [debug] [Thread-1 (]: SQL status: OK in 0.228 seconds
[0m23:36:39.688292 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m23:36:39.689201 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__ceb183b66b70" cascade
    
[0m23:36:39.795646 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m23:36:39.798199 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: Close
[0m23:36:39.799253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad77a318-9d2a-4fa0-bbf5-78b50c389a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105966000>]}
[0m23:36:39.800381 [info ] [Thread-1 (]: 7 of 10 OK created sql incremental model main.int_pays ......................... [[32mOK[0m in 1.45s]
[0m23:36:39.801622 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_pays
[0m23:36:39.802389 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_reunions
[0m23:36:39.803281 [info ] [Thread-1 (]: 8 of 10 START sql incremental model main.int_reunions .......................... [RUN]
[0m23:36:39.804128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_pays, now model.dbt_an_data.int_reunions)
[0m23:36:39.804972 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_reunions
[0m23:36:39.820157 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_reunions"
[0m23:36:39.820842 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_reunions
[0m23:36:39.823739 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:36:39.824010 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__11acefc849f4" cascade
    
[0m23:36:39.824227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:39.931783 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m23:36:39.937803 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:36:39.938630 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:36:39.941095 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:36:39.943338 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:36:39.943963 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m23:36:39.945528 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:36:39.946101 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:36:39.946638 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m23:36:40.057280 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m23:36:40.061151 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:36:40.061996 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    

  
[0m23:36:40.062932 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:36:40.065416 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m23:36:40.066232 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:36:40.066881 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m23:36:40.171023 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m23:36:40.173601 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:36:40.174437 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_reunions__11acefc849f4"
  
    as (
      

with __dbt__cte__stg_reunions as (
SELECT * 
FROM "database"."stg"."raw_reunions"
) SELECT
json_extract_string(json, '$.reunion.uid') AS uid,
json_extract_string(json, '$.reunion.timeStampDebut') AS timeStampDebut,
json_extract_string(json, '$.reunion.lieu.lieuRef') AS lieuRef,
json_extract_string(json, '$.reunion.lieu.libelleLong') AS lieuLibelle,
json_extract_string(json, '$.reunion.cycleDeVie.etat') AS cycleDeVieEtat,
json_extract_string(json, '$.reunion.demandeur') AS demandeur,
json_extract_string(json, '$.reunion.organeReuniRef') AS organeReuniRef,
json_extract_string(json, '$.reunion.visioConference') AS visioConference,
json_extract_string(json, '$.reunion.sessionRef') AS sessionRef,
json_extract_string(json, '$.reunion.ouverturePresse') AS ouverturePresse,
json_extract_string(json, '$.reunion.captationVideo') AS captationVideo,
json_extract_string(json, '$.reunion.ODJ.convocationODJ.item') AS convocationODJ,
json_extract_string(json, '$.reunion.ODJ.resumeODJ.item') AS resumeODJ,
json_extract_string(json, '$.reunion.compteRenduRef') AS compteRenduRef,
json_extract_string(json, '$.reunion.identifiants.numSeanceJO') AS numSeanceJO,
json_extract_string(json, '$.reunion.identifiants.idJO') AS idJO,
json_extract_string(json, '$.reunion.identifiants.quantieme') AS quantieme,
json_extract_string(json, '$.reunion.identifiants.DataSeance') AS DataSeance
FROM __dbt__cte__stg_reunions
    );
  
  
  
[0m23:36:41.086870 [debug] [Thread-1 (]: SQL status: OK in 0.912 seconds
[0m23:36:41.088785 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:36:41.088988 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m23:36:41.089626 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:36:41.089786 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:36:41.089941 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions__11acefc849f4'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m23:36:41.091688 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:36:41.093195 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:36:41.093369 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m23:36:41.094724 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:36:41.097226 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:36:41.097421 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m23:36:41.098797 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:36:41.100468 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_reunions"
[0m23:36:41.100878 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:36:41.101051 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

        
            delete from "an_data_pipeline"."main"."int_reunions"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_reunions__11acefc849f4"
            );

        
    

    insert into "an_data_pipeline"."main"."int_reunions" ("uid", "timeStampDebut", "lieuRef", "lieuLibelle", "cycleDeVieEtat", "demandeur", "organeReuniRef", "visioConference", "sessionRef", "ouverturePresse", "captationVideo", "convocationODJ", "resumeODJ", "compteRenduRef", "numSeanceJO", "idJO", "quantieme", "DataSeance")
    (
        select "uid", "timeStampDebut", "lieuRef", "lieuLibelle", "cycleDeVieEtat", "demandeur", "organeReuniRef", "visioConference", "sessionRef", "ouverturePresse", "captationVideo", "convocationODJ", "resumeODJ", "compteRenduRef", "numSeanceJO", "idJO", "quantieme", "DataSeance"
        from "an_data_pipeline"."dbt_temp"."int_reunions__11acefc849f4"
    )
  
[0m23:36:41.344358 [debug] [Thread-1 (]: SQL status: OK in 0.242 seconds
[0m23:36:41.349865 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m23:36:41.350906 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:36:41.351665 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m23:36:41.561813 [debug] [Thread-1 (]: SQL status: OK in 0.209 seconds
[0m23:36:41.568992 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:36:41.570075 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__11acefc849f4" cascade
    
[0m23:36:41.817031 [debug] [Thread-1 (]: SQL status: OK in 0.246 seconds
[0m23:36:41.825486 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m23:36:41.826245 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__11acefc849f4" cascade
    
[0m23:36:41.941334 [debug] [Thread-1 (]: SQL status: OK in 0.114 seconds
[0m23:36:41.945274 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: Close
[0m23:36:41.946534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad77a318-9d2a-4fa0-bbf5-78b50c389a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b67e0>]}
[0m23:36:41.947722 [info ] [Thread-1 (]: 8 of 10 OK created sql incremental model main.int_reunions ..................... [[32mOK[0m in 2.14s]
[0m23:36:41.948821 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_reunions
[0m23:36:41.949562 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins
[0m23:36:41.950701 [info ] [Thread-1 (]: 9 of 10 START sql incremental model main.int_scrutins .......................... [RUN]
[0m23:36:41.951758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_reunions, now model.dbt_an_data.int_scrutins)
[0m23:36:41.952500 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins
[0m23:36:41.965390 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins"
[0m23:36:41.967402 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins
[0m23:36:41.972091 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:36:41.972512 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__26d2c96fb2ac" cascade
    
[0m23:36:41.972877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:42.084631 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m23:36:42.094066 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:36:42.094987 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:36:42.098455 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:36:42.100879 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:36:42.101392 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m23:36:42.102538 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:36:42.103003 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:36:42.103494 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m23:36:42.214421 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m23:36:42.218515 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:36:42.219357 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    

  
[0m23:36:42.220274 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:36:42.223078 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m23:36:42.223766 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:36:42.224282 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m23:36:42.327210 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m23:36:42.327731 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:36:42.327917 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_scrutins__26d2c96fb2ac"
  
    as (
      

with __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
) SELECT
date_T_insert,
json_extract_string(json, '$.scrutin.uid') AS uid,
json_extract_string(json, '$.scrutin.numero') AS numero,
json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
json_extract_string(json, '$.scrutin.legislature') AS legislature,
json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
json_extract_string(json, '$.scrutin.titre') AS titre,
json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote
FROM __dbt__cte__stg_scrutins
    );
  
  
  
[0m23:36:43.782077 [debug] [Thread-1 (]: SQL status: OK in 1.454 seconds
[0m23:36:43.783871 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:36:43.784047 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m23:36:43.784556 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:36:43.784703 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:36:43.784849 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins__26d2c96fb2ac'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m23:36:43.786507 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:36:43.787917 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:36:43.788091 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m23:36:43.789413 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:36:43.790786 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:36:43.790950 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m23:36:43.792285 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:36:43.793243 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins"
[0m23:36:43.793664 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:36:43.793837 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

        
            delete from "an_data_pipeline"."main"."int_scrutins"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_scrutins__26d2c96fb2ac"
            );

        
    

    insert into "an_data_pipeline"."main"."int_scrutins" ("date_T_insert", "uid", "numero", "organeRef", "legislature", "date_scrutin", "titre", "resultat_code", "resultat_libelle", "nb_votants", "suffrages_exprimes", "seuil", "lieu_vote")
    (
        select "date_T_insert", "uid", "numero", "organeRef", "legislature", "date_scrutin", "titre", "resultat_code", "resultat_libelle", "nb_votants", "suffrages_exprimes", "seuil", "lieu_vote"
        from "an_data_pipeline"."dbt_temp"."int_scrutins__26d2c96fb2ac"
    )
  
[0m23:36:44.028830 [debug] [Thread-1 (]: SQL status: OK in 0.234 seconds
[0m23:36:44.033890 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m23:36:44.034787 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:36:44.035554 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m23:36:44.201718 [debug] [Thread-1 (]: SQL status: OK in 0.166 seconds
[0m23:36:44.203205 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:36:44.203383 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__26d2c96fb2ac" cascade
    
[0m23:36:44.424048 [debug] [Thread-1 (]: SQL status: OK in 0.220 seconds
[0m23:36:44.426821 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m23:36:44.427004 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__26d2c96fb2ac" cascade
    
[0m23:36:44.530962 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m23:36:44.532431 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: Close
[0m23:36:44.532972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad77a318-9d2a-4fa0-bbf5-78b50c389a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10594ea50>]}
[0m23:36:44.533539 [info ] [Thread-1 (]: 9 of 10 OK created sql incremental model main.int_scrutins ..................... [[32mOK[0m in 2.58s]
[0m23:36:44.534017 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins
[0m23:36:44.534346 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins_votes
[0m23:36:44.534780 [info ] [Thread-1 (]: 10 of 10 START sql incremental model main.int_scrutins_votes ................... [RUN]
[0m23:36:44.535216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_scrutins, now model.dbt_an_data.int_scrutins_votes)
[0m23:36:44.535525 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins_votes
[0m23:36:44.562318 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins_votes"
[0m23:36:44.563125 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins_votes
[0m23:36:44.565183 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:36:44.565386 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__60bfd27f762c" cascade
    
[0m23:36:44.565562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:44.673257 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m23:36:44.676154 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:36:44.676591 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m23:36:44.678171 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:36:44.679991 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:36:44.680401 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m23:36:44.681189 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:36:44.681498 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:36:44.681798 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m23:36:44.789869 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m23:36:44.793571 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:36:44.794685 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    

  
[0m23:36:44.795882 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:36:44.799103 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m23:36:44.800106 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:36:44.800895 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m23:36:44.903579 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m23:36:44.906612 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:36:44.908415 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_scrutins_votes__60bfd27f762c"
  
    as (
      

WITH  __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
), grp AS (
      -- explode les groupes (1 par groupe)
      SELECT
          json_extract_string(j.json, '$.scrutin.uid') AS uid,
          json_extract_string(g.value, '$.organeRef') AS groupe_organe,
          g.value AS groupe_json
      FROM __dbt__cte__stg_scrutins j,
           json_each(json->'scrutin'->'ventilationVotes'->'organe'->'groupes'->'groupe') g
  ),

  positions_array AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          p.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'pours'->'votant') p
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          c.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'contres'->'votant') c
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          a.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'abstentions'->'votant') a
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          n.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'nonVotants'->'votant') n
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[ARRAY]'
  ),
  positions_object AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.causePositionVote') AS cause
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[OBJECT]'
  ),

  clean AS (
      -- sécurise les champs (souvent string ou null)
      SELECT
          uid,
          groupe_organe,
          type_vote,
          json_extract_string(vote_json, '$.acteurRef') AS acteurRef,
          json_extract_string(vote_json, '$.mandatRef') AS mandatRef,
          json_extract_string(vote_json, '$.parDelegation') AS parDelegation,
          json_extract_string(vote_json, '$.numPlace') AS numPlace,
          json_extract_string(vote_json, '$.causePositionVote') AS cause
      FROM positions_array
      UNION ALL
      SELECT * 
      FROM positions_object
  )

  SELECT * FROM clean
    );
  
  
  
[0m23:36:56.985990 [debug] [Thread-1 (]: SQL status: OK in 12.072 seconds
[0m23:36:56.998384 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:36:56.998790 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m23:36:56.999765 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:36:56.999991 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:36:57.000268 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins_votes__60bfd27f762c'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m23:36:57.003180 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:36:57.007449 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:36:57.007776 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins_votes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m23:36:57.009966 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:36:57.012756 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:36:57.012961 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins_votes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m23:36:57.014468 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:36:57.015847 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins_votes"
[0m23:36:57.016487 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:36:57.016669 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

        
            delete from "an_data_pipeline"."main"."int_scrutins_votes" as DBT_INCREMENTAL_TARGET
            using "an_data_pipeline"."dbt_temp"."int_scrutins_votes__60bfd27f762c"
            where (
                
                    "an_data_pipeline"."dbt_temp"."int_scrutins_votes__60bfd27f762c".uid = DBT_INCREMENTAL_TARGET.uid
                    and 
                
                    "an_data_pipeline"."dbt_temp"."int_scrutins_votes__60bfd27f762c".acteurRef = DBT_INCREMENTAL_TARGET.acteurRef
                    
                
                
            );
        
    

    insert into "an_data_pipeline"."main"."int_scrutins_votes" ("uid", "groupe_organe", "type_vote", "acteurRef", "mandatRef", "parDelegation", "numPlace", "cause")
    (
        select "uid", "groupe_organe", "type_vote", "acteurRef", "mandatRef", "parDelegation", "numPlace", "cause"
        from "an_data_pipeline"."dbt_temp"."int_scrutins_votes__60bfd27f762c"
    )
  
[0m23:36:57.660717 [debug] [Thread-1 (]: SQL status: OK in 0.643 seconds
[0m23:36:57.666100 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m23:36:57.667198 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:36:57.667994 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m23:36:58.245653 [debug] [Thread-1 (]: SQL status: OK in 0.577 seconds
[0m23:36:58.248706 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:36:58.248905 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__60bfd27f762c" cascade
    
[0m23:36:58.475917 [debug] [Thread-1 (]: SQL status: OK in 0.227 seconds
[0m23:36:58.477876 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m23:36:58.478063 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__60bfd27f762c" cascade
    
[0m23:36:58.581112 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m23:36:58.582853 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: Close
[0m23:36:58.586466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad77a318-9d2a-4fa0-bbf5-78b50c389a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10563eea0>]}
[0m23:36:58.587413 [info ] [Thread-1 (]: 10 of 10 OK created sql incremental model main.int_scrutins_votes .............. [[32mOK[0m in 14.05s]
[0m23:36:58.587977 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins_votes
[0m23:36:58.590337 [debug] [MainThread]: Using duckdb connection "master"
[0m23:36:58.590593 [debug] [MainThread]: On master: BEGIN
[0m23:36:58.590796 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:36:58.591849 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:36:58.592084 [debug] [MainThread]: On master: COMMIT
[0m23:36:58.592282 [debug] [MainThread]: Using duckdb connection "master"
[0m23:36:58.592463 [debug] [MainThread]: On master: COMMIT
[0m23:36:58.592814 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:36:58.593031 [debug] [MainThread]: On master: Close
[0m23:36:58.593293 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:36:58.593475 [debug] [MainThread]: Connection 'model.dbt_an_data.int_scrutins_votes' was properly closed.
[0m23:36:58.593813 [info ] [MainThread]: 
[0m23:36:58.594071 [info ] [MainThread]: Finished running 10 incremental models, 1 project hook in 0 hours 0 minutes and 32.15 seconds (32.15s).
[0m23:36:58.595283 [debug] [MainThread]: Command end result
[0m23:36:58.612468 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m23:36:58.615278 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m23:36:58.619664 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m23:36:58.619866 [info ] [MainThread]: 
[0m23:36:58.620067 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:36:58.620217 [info ] [MainThread]: 
[0m23:36:58.620556 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m23:36:58.621515 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 32.571312, "process_in_blocks": "0", "process_kernel_time": 5.40148, "process_mem_max_rss": "3062808576", "process_out_blocks": "0", "process_user_time": 17.126963}
[0m23:36:58.621822 [debug] [MainThread]: Command `dbt run` succeeded at 23:36:58.621769 after 32.57 seconds
[0m23:36:58.622151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c1f260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c1f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105265e50>]}
[0m23:36:58.622358 [debug] [MainThread]: Flushing usage events
[0m23:36:59.236768 [debug] [MainThread]: An error was encountered while trying to flush usage events
==================== 2025-12-08 19:27:37.819630 | 019aff6f-0750-7401-a743-d207364def78 ====================
dbt-fusion 2.0.0-preview.72
   Loading profiles.yml
19:27:37.852575 [error]: dbt1501: Failed to eval the compiled Jinja expression invalid operation: 'env_var': environment variable 'MOTHERDUCK_TOKEN' not found
(in :1:2)
  --> profiles.yml:10:14
19:27:38.032707 [info ]: 
==================== Execution Summary =====================
Finished 'build' with 1 error [213ms]
==================== 2025-12-08 19:28:22.432488 | 019aff6f-b595-7f82-9065-c88f13f52ee7 ====================
dbt-fusion 2.0.0-preview.72
   Loading profiles.yml
19:28:22.464877 [error]: dbt1501: Failed to eval the compiled Jinja expression invalid operation: 'env_var': environment variable 'MOTHERDUCK_TOKEN' not found
(in :1:2)
  --> profiles.yml:10:14
19:28:22.588682 [info ]: 
==================== Execution Summary =====================
Finished 'run' with 1 error [156ms]
==================== 2025-12-08 19:28:35.270363 | 019aff6f-e7b7-74b2-b454-5c8a5aa84e5a ====================
dbt-fusion 2.0.0-preview.72
   Loading profiles.yml
19:28:35.318736 [error]: dbt1501: Failed to eval the compiled Jinja expression invalid operation: 'env_var': environment variable 'MOTHERDUCK_TOKEN' not found
(in :1:2)
  --> profiles.yml:10:14
19:28:35.459784 [info ]: 
==================== Execution Summary =====================
Finished 'build' with 1 error [189ms]
==================== 2025-12-08 19:33:45.158844 | 019aff74-a23c-7e12-b6f8-6bafac6fd9ab ====================
dbt-fusion 2.0.0-preview.72
   Loading profiles.yml
19:33:45.190378 [error]: dbt1005: Failed to parse profiles.yml: unknown variant `duckdb`, expected one of `redshift`, `snowflake`, `postgres`, `bigquery`, `trino`, `datafusion`, `databricks`, `salesforce`
19:33:45.338665 [info ]: 
==================== Execution Summary =====================
Finished 'build' with 1 error [179ms]
==================== 2025-12-08 19:34:16.554040 | 019aff75-1cdf-7112-a7d6-6ae140b6035d ====================
dbt-fusion 2.0.0-preview.72
   Loading profiles.yml
19:34:16.598345 [error]: dbt1005: Failed to parse profiles.yml: unknown variant `duckdb`, expected one of `redshift`, `snowflake`, `postgres`, `bigquery`, `trino`, `datafusion`, `databricks`, `salesforce`
19:34:16.758487 [info ]: 
==================== Execution Summary =====================
Finished 'run' with 1 error [204ms]
==================== 2025-12-08 19:39:24.003339 | 019aff79-cdd8-7d31-aca0-e20b37f31970 ====================
dbt-fusion 2.0.0-preview.72
   Loading profiles.yml
19:39:24.034039 [error]: dbt1501: Failed to eval the compiled Jinja expression invalid operation: 'env_var': environment variable 'MOTHERDUCK_TOKEN' not found
(in :1:2)
  --> profiles.yml:10:14
19:39:24.221069 [info ]: 
==================== Execution Summary =====================
Finished 'build' with 1 error [217ms]
[0m20:41:32.668524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053728d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aab5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aab290>]}


============================== 20:41:32.671750 | 1d4a024d-b964-4cbe-b829-54149ac837f5 ==============================
[0m20:41:32.671750 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:41:32.672064 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'partial_parse': 'True', 'target_path': 'None', 'log_format': 'default', 'write_json': 'True', 'invocation_command': 'dbt build', 'warn_error': 'None', 'indirect_selection': 'eager', 'no_print': 'None', 'introspect': 'True', 'printer_width': '80', 'fail_fast': 'False', 'static_parser': 'True', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt'}
[0m20:41:32.860646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d4a024d-b964-4cbe-b829-54149ac837f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10541a8a0>]}
[0m20:41:32.898026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d4a024d-b964-4cbe-b829-54149ac837f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b1eff0>]}
[0m20:41:32.899854 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:41:32.963147 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:41:33.031832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 9 files changed.
[0m20:41:33.032175 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_scrutins.sql
[0m20:41:33.032360 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_amendements.sql
[0m20:41:33.032530 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_reunions.sql
[0m20:41:33.032694 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_scrutins_votes.sql
[0m20:41:33.032852 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_amendements_cosignataires.sql
[0m20:41:33.033003 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_mandats.sql
[0m20:41:33.033151 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_organes.sql
[0m20:41:33.033297 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_pays.sql
[0m20:41:33.033437 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_acteurs.sql
[0m20:41:33.153472 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_an_data.mart
[0m20:41:33.159419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d4a024d-b964-4cbe-b829-54149ac837f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061a1e80>]}
[0m20:41:33.197484 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m20:41:33.199414 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m20:41:33.222261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d4a024d-b964-4cbe-b829-54149ac837f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061a3530>]}
[0m20:41:33.222536 [info ] [MainThread]: Found 17 models, 1 operation, 9 sources, 469 macros
[0m20:41:33.223857 [info ] [MainThread]: 
[0m20:41:33.224031 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m20:41:33.224161 [info ] [MainThread]: 
[0m20:41:33.224404 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:41:33.226685 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_an_data_pipeline'
[0m20:41:33.313301 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline"
[0m20:41:33.313578 [debug] [ThreadPool]: On list_an_data_pipeline: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"an_data_pipeline"'
    
  
  
[0m20:41:33.313734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:38.393768 [debug] [ThreadPool]: SQL status: OK in 5.080 seconds
[0m20:41:38.396967 [debug] [ThreadPool]: On list_an_data_pipeline: Close
[0m20:41:38.398026 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_an_data_pipeline, now create_an_data_pipeline_main)
[0m20:41:38.398687 [debug] [ThreadPool]: Creating schema "database: "an_data_pipeline"
schema: "main"
"
[0m20:41:38.405807 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m20:41:38.406077 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:41:38.406217 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:41:38.407580 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:41:38.408318 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m20:41:38.408461 [debug] [ThreadPool]: On create_an_data_pipeline_main: BEGIN
[0m20:41:38.408833 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:41:38.408957 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m20:41:38.409078 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
    
        create schema if not exists "an_data_pipeline"."main"
    
[0m20:41:38.532527 [debug] [ThreadPool]: SQL status: OK in 0.123 seconds
[0m20:41:38.535113 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m20:41:38.535950 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m20:41:38.536709 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m20:41:38.650424 [debug] [ThreadPool]: SQL status: OK in 0.113 seconds
[0m20:41:38.650642 [debug] [ThreadPool]: On create_an_data_pipeline_main: Close
[0m20:41:38.651550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_an_data_pipeline_main, now list_an_data_pipeline_main)
[0m20:41:38.654345 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m20:41:38.654530 [debug] [ThreadPool]: On list_an_data_pipeline_main: BEGIN
[0m20:41:38.654657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:41:38.655199 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:41:38.655330 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m20:41:38.655459 [debug] [ThreadPool]: On list_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline_main"} */
select
      'an_data_pipeline' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'an_data_pipeline'
  
[0m20:41:38.665449 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m20:41:38.666415 [debug] [ThreadPool]: On list_an_data_pipeline_main: ROLLBACK
[0m20:41:38.667403 [debug] [ThreadPool]: Failed to rollback 'list_an_data_pipeline_main'
[0m20:41:38.667567 [debug] [ThreadPool]: On list_an_data_pipeline_main: Close
[0m20:41:38.668457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d4a024d-b964-4cbe-b829-54149ac837f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f5af0>]}
[0m20:41:38.668738 [debug] [MainThread]: Using duckdb connection "master"
[0m20:41:38.668873 [debug] [MainThread]: On master: BEGIN
[0m20:41:38.668994 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:41:38.669514 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:41:38.669662 [debug] [MainThread]: On master: COMMIT
[0m20:41:38.669793 [debug] [MainThread]: Using duckdb connection "master"
[0m20:41:38.669918 [debug] [MainThread]: On master: COMMIT
[0m20:41:38.670144 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:41:38.674689 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_an_data.dbt_an_data-on-run-start-0"
[0m20:41:38.677524 [info ] [MainThread]: 1 of 1 START hook: dbt_an_data.on-run-start.0 .................................. [RUN]
[0m20:41:38.677795 [debug] [MainThread]: Using duckdb connection "master"
[0m20:41:38.677952 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "master"} */
ATTACH '../data/database/database.duckdb' AS database (READ_ONLY)
[0m20:41:38.684677 [debug] [MainThread]: SQL status: OK in 0.007 seconds
[0m20:41:38.685272 [info ] [MainThread]: 1 of 1 OK hook: dbt_an_data.on-run-start.0 ..................................... [[32mOK[0m in 0.01s]
[0m20:41:38.685433 [info ] [MainThread]: 
[0m20:41:38.685581 [debug] [MainThread]: On master: Close
[0m20:41:38.687144 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_acteurs
[0m20:41:38.687367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_an_data_pipeline_main, now model.dbt_an_data.stg_acteurs)
[0m20:41:38.721514 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_acteurs
[0m20:41:38.723151 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_acteurs"
[0m20:41:38.724144 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_acteurs
[0m20:41:38.724335 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_agenda
[0m20:41:38.724507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_acteurs, now model.dbt_an_data.stg_agenda)
[0m20:41:38.724662 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_agenda
[0m20:41:38.725891 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_agenda"
[0m20:41:38.726387 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_agenda
[0m20:41:38.726552 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_amendements
[0m20:41:38.726725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_agenda, now model.dbt_an_data.stg_amendements)
[0m20:41:38.726887 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_amendements
[0m20:41:38.728088 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_amendements"
[0m20:41:38.728690 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_amendements
[0m20:41:38.728860 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_organes
[0m20:41:38.729035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_amendements, now model.dbt_an_data.stg_organes)
[0m20:41:38.729202 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_organes
[0m20:41:38.730393 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_organes"
[0m20:41:38.730852 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_organes
[0m20:41:38.731028 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_pays
[0m20:41:38.731203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_organes, now model.dbt_an_data.stg_pays)
[0m20:41:38.731366 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_pays
[0m20:41:38.732558 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_pays"
[0m20:41:38.732995 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_pays
[0m20:41:38.733166 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_reunions
[0m20:41:38.733338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_pays, now model.dbt_an_data.stg_reunions)
[0m20:41:38.733502 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_reunions
[0m20:41:38.734693 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_reunions"
[0m20:41:38.735120 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_reunions
[0m20:41:38.735286 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_scrutins
[0m20:41:38.735453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_reunions, now model.dbt_an_data.stg_scrutins)
[0m20:41:38.735649 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_scrutins
[0m20:41:38.736967 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_scrutins"
[0m20:41:38.737412 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_scrutins
[0m20:41:38.737593 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_acteurs
[0m20:41:38.737833 [info ] [Thread-1 (]: 1 of 10 START sql incremental model main.int_acteurs ........................... [RUN]
[0m20:41:38.738053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_scrutins, now model.dbt_an_data.int_acteurs)
[0m20:41:38.738204 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_acteurs
[0m20:41:38.742580 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_acteurs"
[0m20:41:38.742925 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_acteurs
[0m20:41:38.746582 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:41:38.746781 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__79ba03123788" cascade
    
[0m20:41:38.746935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:38.875445 [debug] [Thread-1 (]: SQL status: OK in 0.128 seconds
[0m20:41:38.897788 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:41:38.898064 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:41:38.898877 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:38.899574 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:41:38.899741 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m20:41:38.900121 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:41:38.900269 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:41:38.900416 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:41:39.009430 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m20:41:39.011749 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:41:39.012410 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    

  
[0m20:41:39.013049 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:41:39.014765 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m20:41:39.015307 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:41:39.015815 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m20:41:39.120241 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m20:41:39.125909 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:41:39.126182 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_acteurs__79ba03123788"
  
    as (
      

with __dbt__cte__stg_acteurs as (
SELECT * 
FROM "database"."stg"."raw_acteurs"
) SELECT 
json_extract_string(json, '$.acteur.uid.#text') as uid,
json_extract_string(json, '$.acteur.etatCivil.ident.civ') as civ,
json_extract_string(json, '$.acteur.etatCivil.ident.prenom') as prenom,
json_extract_string(json, '$.acteur.etatCivil.ident.nom') as nom,
json_extract_string(json, '$.acteur.etatCivil.ident.trigramme') as trigramme,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.dateNais') as dateNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.villeNais') as villeNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.depNais') as depNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.paysNais') as paysNais,
json_extract_string(json, '$.acteur.etatCivil.dateDeces') as dateDeces,
json_extract_string(json, '$.acteur.profession.libelleCourant') as libelleCourant,
json_extract_string(json, '$.acteur.profession.socProcINSEE.catSocPro') as catSocPro,
json_extract_string(json, '$.acteur.profession.socProcINSEE.famSocPro') as famSocPro,
json_extract_string(json, '$.acteur.uri_hatvp') as uri_hatvp,
date_T_insert
FROM __dbt__cte__stg_acteurs
    );
  
  
  
[0m20:41:39.743140 [debug] [Thread-1 (]: SQL status: OK in 0.616 seconds
[0m20:41:39.749712 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:41:39.749992 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m20:41:39.750737 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:39.750966 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:41:39.751188 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs__79ba03123788'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:41:39.756401 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:41:39.759726 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:41:39.759979 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:41:39.761675 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:39.765778 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:41:39.766000 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:41:39.767551 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:39.768432 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:41:39.768623 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */
SELECT version()
[0m20:41:39.768933 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:41:39.775919 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_acteurs"
[0m20:41:39.776742 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:41:39.776933 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

        
            delete from "an_data_pipeline"."main"."int_acteurs"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_acteurs__79ba03123788"
            );

        
    

    insert into "an_data_pipeline"."main"."int_acteurs" ("uid", "civ", "prenom", "nom", "trigramme", "dateNais", "villeNais", "depNais", "paysNais", "dateDeces", "libelleCourant", "catSocPro", "famSocPro", "uri_hatvp")
    (
        select "uid", "civ", "prenom", "nom", "trigramme", "dateNais", "villeNais", "depNais", "paysNais", "dateDeces", "libelleCourant", "catSocPro", "famSocPro", "uri_hatvp"
        from "an_data_pipeline"."dbt_temp"."int_acteurs__79ba03123788"
    )
  
[0m20:41:40.030579 [debug] [Thread-1 (]: SQL status: OK in 0.253 seconds
[0m20:41:40.052499 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m20:41:40.053143 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:41:40.053604 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m20:41:40.312728 [debug] [Thread-1 (]: SQL status: OK in 0.258 seconds
[0m20:41:40.321006 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:41:40.321885 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__79ba03123788" cascade
    
[0m20:41:40.555042 [debug] [Thread-1 (]: SQL status: OK in 0.233 seconds
[0m20:41:40.556803 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:41:40.556966 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__79ba03123788" cascade
    
[0m20:41:40.677189 [debug] [Thread-1 (]: SQL status: OK in 0.120 seconds
[0m20:41:40.680233 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: Close
[0m20:41:40.683617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4a024d-b964-4cbe-b829-54149ac837f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d35490>]}
[0m20:41:40.684279 [info ] [Thread-1 (]: 1 of 10 OK created sql incremental model main.int_acteurs ...................... [[32mOK[0m in 1.94s]
[0m20:41:40.684794 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_acteurs
[0m20:41:40.685170 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_mandats
[0m20:41:40.685672 [info ] [Thread-1 (]: 2 of 10 START sql incremental model main.int_mandats ........................... [RUN]
[0m20:41:40.686123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_acteurs, now model.dbt_an_data.int_mandats)
[0m20:41:40.686455 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_mandats
[0m20:41:40.694488 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_mandats"
[0m20:41:40.695158 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_mandats
[0m20:41:40.699665 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:41:40.699944 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__57d98fe17d07" cascade
    
[0m20:41:40.700180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:40.832596 [debug] [Thread-1 (]: SQL status: OK in 0.132 seconds
[0m20:41:40.840479 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:41:40.841250 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:41:40.843559 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:41:40.845847 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:41:40.846478 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m20:41:40.848088 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:40.848745 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:41:40.849464 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:41:40.964551 [debug] [Thread-1 (]: SQL status: OK in 0.114 seconds
[0m20:41:40.968525 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:41:40.969421 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    

  
[0m20:41:40.970392 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:41:40.972913 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m20:41:40.973660 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:41:40.974337 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m20:41:41.098624 [debug] [Thread-1 (]: SQL status: OK in 0.123 seconds
[0m20:41:41.102591 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:41:41.103792 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_mandats__57d98fe17d07"
  
    as (
      

with __dbt__cte__stg_acteurs as (
SELECT * 
FROM "database"."stg"."raw_acteurs"
) SELECT 
json_extract_string(mandat.value, '$.uid') as uid,
json_extract_string(mandat.value, '$.acteurRef') as acteurRef,
json_extract_string(mandat.value, '$.legislature') as legislature,
json_extract_string(mandat.value, '$.typeOrgane') as typeOrgane,
json_extract_string(mandat.value, '$.dateDebut') as dateDebut,
json_extract_string(mandat.value, '$.dateFin') as dateFin,
json_extract_string(mandat.value, '$.preseance') as preseance,
json_extract_string(mandat.value, '$.nominPrincipale') as nominPrincipale,
json_extract_string(mandat.value, '$.infosQualite.codeQualite') as codeQualite,
json_extract_string(mandat.value, '$.organes.organeRef') as organeRef,
date_T_insert
FROM __dbt__cte__stg_acteurs act, json_each(json->'acteur'->'mandats'->'mandat') mandat
    );
  
  
  
[0m20:41:42.149885 [debug] [Thread-1 (]: SQL status: OK in 1.045 seconds
[0m20:41:42.158906 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:41:42.159278 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m20:41:42.159952 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:41:42.160130 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:41:42.160291 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats__57d98fe17d07'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:41:42.162258 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:41:42.165414 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:41:42.165624 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:41:42.167203 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:42.168837 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:41:42.169022 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:41:42.170436 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:42.171893 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_mandats"
[0m20:41:42.173976 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:41:42.174171 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

        
            delete from "an_data_pipeline"."main"."int_mandats"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_mandats__57d98fe17d07"
            );

        
    

    insert into "an_data_pipeline"."main"."int_mandats" ("uid", "acteurRef", "legislature", "typeOrgane", "dateDebut", "dateFin", "preseance", "nominPrincipale", "codeQualite", "organeRef")
    (
        select "uid", "acteurRef", "legislature", "typeOrgane", "dateDebut", "dateFin", "preseance", "nominPrincipale", "codeQualite", "organeRef"
        from "an_data_pipeline"."dbt_temp"."int_mandats__57d98fe17d07"
    )
  
[0m20:41:42.660974 [debug] [Thread-1 (]: SQL status: OK in 0.486 seconds
[0m20:41:42.665912 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m20:41:42.666861 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:41:42.667566 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m20:41:42.867420 [debug] [Thread-1 (]: SQL status: OK in 0.199 seconds
[0m20:41:42.869079 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:41:42.869257 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__57d98fe17d07" cascade
    
[0m20:41:43.116336 [debug] [Thread-1 (]: SQL status: OK in 0.247 seconds
[0m20:41:43.118176 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:41:43.118350 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__57d98fe17d07" cascade
    
[0m20:41:43.233892 [debug] [Thread-1 (]: SQL status: OK in 0.115 seconds
[0m20:41:43.235675 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: Close
[0m20:41:43.240382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4a024d-b964-4cbe-b829-54149ac837f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc8710>]}
[0m20:41:43.242373 [info ] [Thread-1 (]: 2 of 10 OK created sql incremental model main.int_mandats ...................... [[32mOK[0m in 2.55s]
[0m20:41:43.243198 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_mandats
[0m20:41:43.243603 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_agenda
[0m20:41:43.244534 [info ] [Thread-1 (]: 3 of 10 START sql incremental model main.int_agenda ............................ [RUN]
[0m20:41:43.245159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_mandats, now model.dbt_an_data.int_agenda)
[0m20:41:43.245611 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_agenda
[0m20:41:43.254980 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_agenda"
[0m20:41:43.256081 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_agenda
[0m20:41:43.259193 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:41:43.259501 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__8778e65218cf" cascade
    
[0m20:41:43.259760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:43.370859 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m20:41:43.375972 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:41:43.376644 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:41:43.379100 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:41:43.382129 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:41:43.382973 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m20:41:43.384768 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:43.385232 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:41:43.385680 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:41:43.501693 [debug] [Thread-1 (]: SQL status: OK in 0.115 seconds
[0m20:41:43.505651 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:41:43.506550 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    

  
[0m20:41:43.507447 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:41:43.509851 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m20:41:43.510590 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:41:43.511324 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m20:41:43.623426 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m20:41:43.626540 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:41:43.627600 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_agenda__8778e65218cf"
  
    as (
      

with __dbt__cte__stg_agenda as (
SELECT * 
FROM "database"."stg"."raw_agenda"
) SELECT * 
FROM __dbt__cte__stg_agenda
    );
  
  
  
[0m20:41:43.993612 [debug] [Thread-1 (]: SQL status: OK in 0.365 seconds
[0m20:41:43.999937 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:41:44.000919 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m20:41:44.002597 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:44.003279 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:41:44.003838 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda__8778e65218cf'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:41:44.009278 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:41:44.017748 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:41:44.018484 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:41:44.023235 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:41:44.026944 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:41:44.027417 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:41:44.030956 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:41:44.032898 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_agenda"
[0m20:41:44.033803 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:41:44.034180 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

        
            delete from "an_data_pipeline"."main"."int_agenda" as DBT_INCREMENTAL_TARGET
            using "an_data_pipeline"."dbt_temp"."int_agenda__8778e65218cf"
            where (
                
                    "an_data_pipeline"."dbt_temp"."int_agenda__8778e65218cf".Date = DBT_INCREMENTAL_TARGET.Date
                    and 
                
                    "an_data_pipeline"."dbt_temp"."int_agenda__8778e65218cf".Heure = DBT_INCREMENTAL_TARGET.Heure
                    
                
                
            );
        
    

    insert into "an_data_pipeline"."main"."int_agenda" ("Date", "Heure", "Ordre(s) du jour", "filename", "date_T_insert")
    (
        select "Date", "Heure", "Ordre(s) du jour", "filename", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_agenda__8778e65218cf"
    )
  
[0m20:41:44.320928 [debug] [Thread-1 (]: SQL status: OK in 0.286 seconds
[0m20:41:44.324538 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m20:41:44.325499 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:41:44.326169 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m20:41:44.446978 [debug] [Thread-1 (]: SQL status: OK in 0.120 seconds
[0m20:41:44.451201 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:41:44.452331 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__8778e65218cf" cascade
    
[0m20:41:44.699482 [debug] [Thread-1 (]: SQL status: OK in 0.247 seconds
[0m20:41:44.701280 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:41:44.701459 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__8778e65218cf" cascade
    
[0m20:41:44.825632 [debug] [Thread-1 (]: SQL status: OK in 0.124 seconds
[0m20:41:44.827136 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: Close
[0m20:41:44.827808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4a024d-b964-4cbe-b829-54149ac837f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10660fad0>]}
[0m20:41:44.828451 [info ] [Thread-1 (]: 3 of 10 OK created sql incremental model main.int_agenda ....................... [[32mOK[0m in 1.58s]
[0m20:41:44.828953 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_agenda
[0m20:41:44.829332 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements
[0m20:41:44.829822 [info ] [Thread-1 (]: 4 of 10 START sql incremental model main.int_amendements ....................... [RUN]
[0m20:41:44.830290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_agenda, now model.dbt_an_data.int_amendements)
[0m20:41:44.830642 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements
[0m20:41:44.845799 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements"
[0m20:41:44.847333 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements
[0m20:41:44.850328 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:41:44.850641 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__377780e4a19d" cascade
    
[0m20:41:44.850880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:44.963980 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m20:41:44.968757 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:41:44.969393 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:41:44.971544 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:41:44.974400 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:41:44.975044 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m20:41:44.976414 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:44.976854 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:41:44.977283 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:41:45.098734 [debug] [Thread-1 (]: SQL status: OK in 0.121 seconds
[0m20:41:45.102519 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:41:45.103610 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    

  
[0m20:41:45.104815 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:41:45.107732 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m20:41:45.108532 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:41:45.109192 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m20:41:45.221457 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m20:41:45.224536 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:41:45.225821 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_amendements__377780e4a19d"
  
    as (
      

with __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
) SELECT
json_extract_string(json, '$.amendement.uid') AS uid,
json_extract_string(json, '$.amendement.chronotag') AS chronotag,
json_extract_string(json, '$.amendement.examenRef') AS examenRef,
json_extract_string(json, '$.amendement.amendementParentRef') AS amendementParentRef,
json_extract_string(json, '$.amendement.signataires.auteur.typeAuteur') AS typeAuteur,
json_extract_string(json, '$.amendement.signataires.auteur.acteurRef') AS refAuteur,
json_extract_string(json, '$.amendement.signataires.auteur.groupePolitique') AS groupePolitiqueAuteur,
json_extract_string(json, '$.amendement.cycleDeVie.dateDepot') AS dateDepot,
json_extract_string(json, '$.amendement.cycleDeVie.datePublication') AS datePublication,
json_extract_string(json, '$.amendement.cycleDeVie.soumisArticle40') AS soumisArticle40,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.code') AS codeEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.libelle') AS libelleEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.code') AS codeSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.dateSort') AS dateSort,
json_extract_string(json, '$.amendement.cycleDeVie.sort') AS sort,
split_part(replace(filename, '.json', ''), '/', -1) AS id_amendement,
split_part(replace(filename, '.json', ''), '/', -2) AS id_texte,
split_part(replace(filename, '.json', ''), '/', -3) AS id_dossier_legislatif,
id_texte[:4] AS nature_texte,
id_texte[5:6] AS source_texte,
regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 1) AS prefix_bibard,
regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 2) AS numero_bibard,
regexp_extract(id_amendement, '(SEA|PO\d*)', 1) AS code_organe,
regexp_extract(id_amendement, '(P)(\d*)(D)', 2) AS numero_partie,
regexp_extract(id_amendement, '(D)(\d*)(N)', 2) AS numero_deliberation,
regexp_extract(id_amendement, '(D)(\d*)(N)(\d*)', 4) AS numero_court,
date_T_insert
from __dbt__cte__stg_amendements
    );
  
  
  
[0m20:41:45.593917 [debug] [Thread-1 (]: SQL status: OK in 0.367 seconds
[0m20:41:45.597669 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:41:45.598114 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m20:41:45.599479 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:45.599854 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:41:45.600227 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements__377780e4a19d'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:41:45.604420 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:41:45.607751 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:41:45.608113 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:41:45.610974 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:41:45.615729 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:41:45.616064 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:41:45.618544 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:41:45.620697 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements"
[0m20:41:45.622458 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:41:45.622766 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

        
            delete from "an_data_pipeline"."main"."int_amendements"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_amendements__377780e4a19d"
            );

        
    

    insert into "an_data_pipeline"."main"."int_amendements" ("uid", "chronotag", "examenRef", "amendementParentRef", "typeAuteur", "refAuteur", "groupePolitiqueAuteur", "dateDepot", "datePublication", "soumisArticle40", "codeEtat", "libelleEtat", "codeSousEtat", "libelleSousEtat", "libelleSousEtat_1", "dateSort", "sort", "id_amendement", "id_texte", "id_dossier_legislatif", "nature_texte", "source_texte", "prefix_bibard", "numero_bibard", "code_organe", "numero_partie", "numero_deliberation", "numero_court")
    (
        select "uid", "chronotag", "examenRef", "amendementParentRef", "typeAuteur", "refAuteur", "groupePolitiqueAuteur", "dateDepot", "datePublication", "soumisArticle40", "codeEtat", "libelleEtat", "codeSousEtat", "libelleSousEtat", "libelleSousEtat_1", "dateSort", "sort", "id_amendement", "id_texte", "id_dossier_legislatif", "nature_texte", "source_texte", "prefix_bibard", "numero_bibard", "code_organe", "numero_partie", "numero_deliberation", "numero_court"
        from "an_data_pipeline"."dbt_temp"."int_amendements__377780e4a19d"
    )
  
[0m20:41:45.871876 [debug] [Thread-1 (]: SQL status: OK in 0.249 seconds
[0m20:41:45.874904 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m20:41:45.875536 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:41:45.876112 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m20:41:45.987255 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m20:41:45.995801 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:41:45.996852 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__377780e4a19d" cascade
    
[0m20:41:46.248742 [debug] [Thread-1 (]: SQL status: OK in 0.251 seconds
[0m20:41:46.257702 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:41:46.258397 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__377780e4a19d" cascade
    
[0m20:41:46.379523 [debug] [Thread-1 (]: SQL status: OK in 0.120 seconds
[0m20:41:46.384507 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: Close
[0m20:41:46.385969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4a024d-b964-4cbe-b829-54149ac837f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a84890>]}
[0m20:41:46.387522 [info ] [Thread-1 (]: 4 of 10 OK created sql incremental model main.int_amendements .................. [[32mOK[0m in 1.56s]
[0m20:41:46.388664 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements
[0m20:41:46.389406 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements_cosignataires
[0m20:41:46.390277 [info ] [Thread-1 (]: 5 of 10 START sql incremental model main.int_amendements_cosignataires ......... [RUN]
[0m20:41:46.391106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements, now model.dbt_an_data.int_amendements_cosignataires)
[0m20:41:46.391708 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements_cosignataires
[0m20:41:46.406300 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements_cosignataires"
[0m20:41:46.407464 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements_cosignataires
[0m20:41:46.412707 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:41:46.413168 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__9bb15a216f22" cascade
    
[0m20:41:46.413543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:46.544960 [debug] [Thread-1 (]: SQL status: OK in 0.131 seconds
[0m20:41:46.552756 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:41:46.553735 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:41:46.557232 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:41:46.559565 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:41:46.560077 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m20:41:46.561241 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:46.561752 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:41:46.562199 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:41:46.680819 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m20:41:46.685444 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:41:46.686240 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    

  
[0m20:41:46.687192 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:41:46.689873 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m20:41:46.690516 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:41:46.691056 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m20:41:46.799271 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m20:41:46.799861 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:41:46.800069 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__9bb15a216f22"
  
    as (
      

WITH  __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
), cosignataires_arr AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef[*]') AS acteurRef
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') == 'ARRAY' AND acteurRef IS NOT NULL
), cosignataires_str AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef') AS acteurRef
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') <> 'ARRAY' AND acteurRef IS NOT NULL
)
SELECT 
  uid, 
  unnest(acteurRef) as acteurRef,
  date_T_insert
FROM cosignataires_arr
UNION ALL
SELECT 
  uid, 
  acteurRef,
  date_T_insert
FROM cosignataires_str
    );
  
  
  
[0m20:41:47.040644 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__9bb15a216f22"
  
    as (
      

WITH  __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
), cosignataires_arr AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef[*]') AS acteurRef
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') == 'ARRAY' AND acteurRef IS NOT NULL
), cosignataires_str AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef') AS acteurRef
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') <> 'ARRAY' AND acteurRef IS NOT NULL
)
SELECT 
  uid, 
  unnest(acteurRef) as acteurRef,
  date_T_insert
FROM cosignataires_arr
UNION ALL
SELECT 
  uid, 
  acteurRef,
  date_T_insert
FROM cosignataires_str
    );
  
  
  
[0m20:41:47.041590 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:41:47.046615 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:41:47.047360 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__9bb15a216f22" cascade
    
[0m20:41:47.178304 [debug] [Thread-1 (]: SQL status: OK in 0.130 seconds
[0m20:41:47.182134 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: Close
[0m20:41:47.198575 [debug] [Thread-1 (]: Runtime Error in model int_amendements_cosignataires (models/int/int_amendements_cosignataires.sql)
  Binder Error: Referenced column "date_T_insert" not found in FROM clause!
  Candidate bindings: "acteurRef"
  
  LINE 33:   date_T_insert
             ^
[0m20:41:47.199770 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4a024d-b964-4cbe-b829-54149ac837f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066280b0>]}
[0m20:41:47.200983 [error] [Thread-1 (]: 5 of 10 ERROR creating sql incremental model main.int_amendements_cosignataires  [[31mERROR[0m in 0.81s]
[0m20:41:47.201953 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements_cosignataires
[0m20:41:47.202621 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_organes
[0m20:41:47.203521 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.int_amendements_cosignataires' to be skipped because of status 'error'.  Reason: Runtime Error in model int_amendements_cosignataires (models/int/int_amendements_cosignataires.sql)
  Binder Error: Referenced column "date_T_insert" not found in FROM clause!
  Candidate bindings: "acteurRef"
  
  LINE 33:   date_T_insert
             ^.
[0m20:41:47.204330 [info ] [Thread-1 (]: 6 of 10 START sql incremental model main.int_organes ........................... [RUN]
[0m20:41:47.206040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements_cosignataires, now model.dbt_an_data.int_organes)
[0m20:41:47.206517 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_organes
[0m20:41:47.217644 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_organes"
[0m20:41:47.218737 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_organes
[0m20:41:47.222871 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:41:47.223270 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__179b219556cd" cascade
    
[0m20:41:47.223591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:47.337123 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m20:41:47.349320 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:41:47.350291 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:41:47.353291 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:41:47.355842 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:41:47.356672 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m20:41:47.358636 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:47.359322 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:41:47.359833 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:41:47.478587 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m20:41:47.482304 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:41:47.483140 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    

  
[0m20:41:47.484011 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:41:47.486311 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m20:41:47.487048 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:41:47.487707 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m20:41:47.602058 [debug] [Thread-1 (]: SQL status: OK in 0.114 seconds
[0m20:41:47.602632 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:41:47.602835 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_organes__179b219556cd"
  
    as (
      

with __dbt__cte__stg_organes as (
SELECT * 
FROM "database"."stg"."raw_organes"
) SELECT 
json_extract_string(json, '$.organe.uid') as uid,
json_extract_string(json, '$.organe.codeType') as codeType,
json_extract_string(json, '$.organe.libelle') as libelle,
json_extract_string(json, '$.organe.libelleEdition') as libelleEdition,
json_extract_string(json, '$.organe.libelleAbrege') as libelleAbrege,
json_extract_string(json, '$.organe.libelleAbrev') as libelleAbrev,
json_extract_string(json, '$.organe.viMoDe.dateDebut') as dateDebut,
json_extract_string(json, '$.organe.viMoDe.dateAgrement') as dateAgrement,
json_extract_string(json, '$.organe.viMoDe.dateFin') as dateFin,
json_extract_string(json, '$.organe.organeParent') as organeParent,
json_extract_string(json, '$.organe.chambre') as chambre,
json_extract_string(json, '$.organe.regime') as regime,
json_extract_string(json, '$.organe.legislature') as legislature,
date_T_insert
FROM __dbt__cte__stg_organes
    );
  
  
  
[0m20:41:48.155451 [debug] [Thread-1 (]: SQL status: OK in 0.552 seconds
[0m20:41:48.157507 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:41:48.157735 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m20:41:48.158372 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:41:48.158555 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:41:48.158745 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes__179b219556cd'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:41:48.160623 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:41:48.162279 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:41:48.162479 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:41:48.163904 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:48.165493 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:41:48.165679 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:41:48.167102 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:48.168231 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_organes"
[0m20:41:48.169016 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:41:48.169234 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

        
            delete from "an_data_pipeline"."main"."int_organes"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_organes__179b219556cd"
            );

        
    

    insert into "an_data_pipeline"."main"."int_organes" ("uid", "codeType", "libelle", "libelleEdition", "libelleAbrege", "libelleAbrev", "dateDebut", "dateAgrement", "dateFin", "organeParent", "chambre", "regime", "legislature")
    (
        select "uid", "codeType", "libelle", "libelleEdition", "libelleAbrege", "libelleAbrev", "dateDebut", "dateAgrement", "dateFin", "organeParent", "chambre", "regime", "legislature"
        from "an_data_pipeline"."dbt_temp"."int_organes__179b219556cd"
    )
  
[0m20:41:48.453468 [debug] [Thread-1 (]: SQL status: OK in 0.284 seconds
[0m20:41:48.457672 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m20:41:48.458472 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:41:48.459099 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m20:41:48.637679 [debug] [Thread-1 (]: SQL status: OK in 0.178 seconds
[0m20:41:48.645610 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:41:48.646461 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__179b219556cd" cascade
    
[0m20:41:48.883542 [debug] [Thread-1 (]: SQL status: OK in 0.236 seconds
[0m20:41:48.885258 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:41:48.885432 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__179b219556cd" cascade
    
[0m20:41:49.000782 [debug] [Thread-1 (]: SQL status: OK in 0.115 seconds
[0m20:41:49.002069 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: Close
[0m20:41:49.002590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4a024d-b964-4cbe-b829-54149ac837f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f3be00>]}
[0m20:41:49.003189 [info ] [Thread-1 (]: 6 of 10 OK created sql incremental model main.int_organes ...................... [[32mOK[0m in 1.80s]
[0m20:41:49.003692 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_organes
[0m20:41:49.004041 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_pays
[0m20:41:49.004527 [info ] [Thread-1 (]: 7 of 10 START sql incremental model main.int_pays .............................. [RUN]
[0m20:41:49.004963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_organes, now model.dbt_an_data.int_pays)
[0m20:41:49.005295 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_pays
[0m20:41:49.012594 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_pays"
[0m20:41:49.013524 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_pays
[0m20:41:49.016507 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:41:49.016763 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__ed2c222de175" cascade
    
[0m20:41:49.017000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:49.132146 [debug] [Thread-1 (]: SQL status: OK in 0.115 seconds
[0m20:41:49.139105 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:41:49.139850 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:41:49.142872 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:41:49.144923 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:41:49.145402 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m20:41:49.147032 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:49.147915 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:41:49.148542 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:41:49.279824 [debug] [Thread-1 (]: SQL status: OK in 0.130 seconds
[0m20:41:49.283366 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:41:49.284168 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    

  
[0m20:41:49.285041 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:41:49.287456 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m20:41:49.288232 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:41:49.288919 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m20:41:49.397000 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m20:41:49.400301 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:41:49.401556 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_pays__ed2c222de175"
  
    as (
      

with __dbt__cte__stg_pays as (
SELECT * 
FROM "database"."stg"."raw_pays"
) SELECT
json_extract_string(json, '$.pays.uid') as uid,
json_extract_string(json, '$.pays.code_insee') as code_insee,
json_extract_string(json, '$.pays.libelleInsee') as libelleInsee,
json_extract_string(json, '$.pays.nomCourant') as nomCourant,
json_extract_string(json, '$.pays.code_iso2A') as code_iso2A,
json_extract_string(json, '$.pays.code_iso3A') as code_iso3A,
json_extract_string(json, '$.pays.code_iso3N') as code_iso3N,
json_extract_string(json, '$.pays.libelleIso') as libelleIso,
json_extract_string(json, '$.pays.libelleANCourt') as libelleANCourt,
json_extract_string(json, '$.pays.libelleANLong') as libelleANLong,
json_extract_string(json, '$.pays.sourceJuridique') as sourceJuridique,
json_extract_string(json, '$.pays.activ') as activ,
date_T_insert
FROM __dbt__cte__stg_pays
    );
  
  
  
[0m20:41:49.764691 [debug] [Thread-1 (]: SQL status: OK in 0.362 seconds
[0m20:41:49.769625 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:41:49.770100 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m20:41:49.771318 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:49.771681 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:41:49.772054 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays__ed2c222de175'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:41:49.775616 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:41:49.780619 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:41:49.780979 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:41:49.783530 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:41:49.786243 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:41:49.786564 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:41:49.788972 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:41:49.790568 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_pays"
[0m20:41:49.791387 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:41:49.791657 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

        
            delete from "an_data_pipeline"."main"."int_pays"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_pays__ed2c222de175"
            );

        
    

    insert into "an_data_pipeline"."main"."int_pays" ("uid", "code_insee", "libelleInsee", "nomCourant", "code_iso2A", "code_iso3A", "code_iso3N", "libelleIso", "libelleANCourt", "libelleANLong", "sourceJuridique", "activ")
    (
        select "uid", "code_insee", "libelleInsee", "nomCourant", "code_iso2A", "code_iso3A", "code_iso3N", "libelleIso", "libelleANCourt", "libelleANLong", "sourceJuridique", "activ"
        from "an_data_pipeline"."dbt_temp"."int_pays__ed2c222de175"
    )
  
[0m20:41:50.062740 [debug] [Thread-1 (]: SQL status: OK in 0.271 seconds
[0m20:41:50.066078 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m20:41:50.066799 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:41:50.067307 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m20:41:50.264372 [debug] [Thread-1 (]: SQL status: OK in 0.196 seconds
[0m20:41:50.271084 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:41:50.271959 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__ed2c222de175" cascade
    
[0m20:41:50.515082 [debug] [Thread-1 (]: SQL status: OK in 0.242 seconds
[0m20:41:50.522957 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:41:50.523765 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__ed2c222de175" cascade
    
[0m20:41:50.649175 [debug] [Thread-1 (]: SQL status: OK in 0.124 seconds
[0m20:41:50.653448 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: Close
[0m20:41:50.654942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4a024d-b964-4cbe-b829-54149ac837f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e9a00>]}
[0m20:41:50.656448 [info ] [Thread-1 (]: 7 of 10 OK created sql incremental model main.int_pays ......................... [[32mOK[0m in 1.65s]
[0m20:41:50.657618 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_pays
[0m20:41:50.658442 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_reunions
[0m20:41:50.659491 [info ] [Thread-1 (]: 8 of 10 START sql incremental model main.int_reunions .......................... [RUN]
[0m20:41:50.660396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_pays, now model.dbt_an_data.int_reunions)
[0m20:41:50.661023 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_reunions
[0m20:41:50.678767 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_reunions"
[0m20:41:50.680170 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_reunions
[0m20:41:50.684540 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:41:50.684946 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__8572a662b6a5" cascade
    
[0m20:41:50.685304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:50.799035 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m20:41:50.808383 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:41:50.809260 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:41:50.812873 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:41:50.815754 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:41:50.816455 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m20:41:50.817931 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:50.818436 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:41:50.818941 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:41:50.936967 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m20:41:50.941771 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:41:50.942880 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    

  
[0m20:41:50.944092 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:41:50.946765 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m20:41:50.947541 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:41:50.948206 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m20:41:51.053803 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m20:41:51.054336 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:41:51.054531 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_reunions__8572a662b6a5"
  
    as (
      

with __dbt__cte__stg_reunions as (
SELECT * 
FROM "database"."stg"."raw_reunions"
) SELECT
json_extract_string(json, '$.reunion.uid') AS uid,
json_extract_string(json, '$.reunion.timeStampDebut') AS timeStampDebut,
json_extract_string(json, '$.reunion.lieu.lieuRef') AS lieuRef,
json_extract_string(json, '$.reunion.lieu.libelleLong') AS lieuLibelle,
json_extract_string(json, '$.reunion.cycleDeVie.etat') AS cycleDeVieEtat,
json_extract_string(json, '$.reunion.demandeur') AS demandeur,
json_extract_string(json, '$.reunion.organeReuniRef') AS organeReuniRef,
json_extract_string(json, '$.reunion.visioConference') AS visioConference,
json_extract_string(json, '$.reunion.sessionRef') AS sessionRef,
json_extract_string(json, '$.reunion.ouverturePresse') AS ouverturePresse,
json_extract_string(json, '$.reunion.captationVideo') AS captationVideo,
json_extract_string(json, '$.reunion.ODJ.convocationODJ.item') AS convocationODJ,
json_extract_string(json, '$.reunion.ODJ.resumeODJ.item') AS resumeODJ,
json_extract_string(json, '$.reunion.compteRenduRef') AS compteRenduRef,
json_extract_string(json, '$.reunion.identifiants.numSeanceJO') AS numSeanceJO,
json_extract_string(json, '$.reunion.identifiants.idJO') AS idJO,
json_extract_string(json, '$.reunion.identifiants.quantieme') AS quantieme,
json_extract_string(json, '$.reunion.identifiants.DataSeance') AS DataSeance,
date_T_insert
FROM __dbt__cte__stg_reunions
    );
  
  
  
[0m20:41:52.132831 [debug] [Thread-1 (]: SQL status: OK in 1.077 seconds
[0m20:41:52.137004 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:41:52.137205 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m20:41:52.137789 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:41:52.137938 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:41:52.138087 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions__8572a662b6a5'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:41:52.139718 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:52.141250 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:41:52.141427 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:41:52.142744 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:52.144218 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:41:52.144392 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:41:52.145727 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:52.148133 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_reunions"
[0m20:41:52.148826 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:41:52.149009 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

        
            delete from "an_data_pipeline"."main"."int_reunions"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_reunions__8572a662b6a5"
            );

        
    

    insert into "an_data_pipeline"."main"."int_reunions" ("uid", "timeStampDebut", "lieuRef", "lieuLibelle", "cycleDeVieEtat", "demandeur", "organeReuniRef", "visioConference", "sessionRef", "ouverturePresse", "captationVideo", "convocationODJ", "resumeODJ", "compteRenduRef", "numSeanceJO", "idJO", "quantieme", "DataSeance")
    (
        select "uid", "timeStampDebut", "lieuRef", "lieuLibelle", "cycleDeVieEtat", "demandeur", "organeReuniRef", "visioConference", "sessionRef", "ouverturePresse", "captationVideo", "convocationODJ", "resumeODJ", "compteRenduRef", "numSeanceJO", "idJO", "quantieme", "DataSeance"
        from "an_data_pipeline"."dbt_temp"."int_reunions__8572a662b6a5"
    )
  
[0m20:41:52.468251 [debug] [Thread-1 (]: SQL status: OK in 0.318 seconds
[0m20:41:52.472966 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m20:41:52.473670 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:41:52.474257 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m20:41:52.659725 [debug] [Thread-1 (]: SQL status: OK in 0.184 seconds
[0m20:41:52.668704 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:41:52.669932 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__8572a662b6a5" cascade
    
[0m20:41:52.914526 [debug] [Thread-1 (]: SQL status: OK in 0.244 seconds
[0m20:41:52.916419 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:41:52.916603 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__8572a662b6a5" cascade
    
[0m20:41:53.027868 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m20:41:53.029791 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: Close
[0m20:41:53.030884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4a024d-b964-4cbe-b829-54149ac837f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678d4f0>]}
[0m20:41:53.031807 [info ] [Thread-1 (]: 8 of 10 OK created sql incremental model main.int_reunions ..................... [[32mOK[0m in 2.37s]
[0m20:41:53.032455 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_reunions
[0m20:41:53.032895 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins
[0m20:41:53.033772 [info ] [Thread-1 (]: 9 of 10 START sql incremental model main.int_scrutins .......................... [RUN]
[0m20:41:53.034614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_reunions, now model.dbt_an_data.int_scrutins)
[0m20:41:53.035014 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins
[0m20:41:53.043593 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins"
[0m20:41:53.044343 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins
[0m20:41:53.047388 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:41:53.047669 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__6d0337a3ddcc" cascade
    
[0m20:41:53.047915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:53.167028 [debug] [Thread-1 (]: SQL status: OK in 0.119 seconds
[0m20:41:53.173133 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:41:53.173874 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:41:53.176067 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:41:53.177933 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:41:53.178408 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m20:41:53.180285 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:53.181021 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:41:53.181660 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:41:53.302545 [debug] [Thread-1 (]: SQL status: OK in 0.120 seconds
[0m20:41:53.306399 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:41:53.307548 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    

  
[0m20:41:53.308717 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:41:53.311450 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m20:41:53.312330 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:41:53.313079 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m20:41:53.429799 [debug] [Thread-1 (]: SQL status: OK in 0.116 seconds
[0m20:41:53.433042 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:41:53.434190 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_scrutins__6d0337a3ddcc"
  
    as (
      

with __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
) SELECT
date_T_insert,
json_extract_string(json, '$.scrutin.uid') AS uid,
json_extract_string(json, '$.scrutin.numero') AS numero,
json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
json_extract_string(json, '$.scrutin.legislature') AS legislature,
json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
json_extract_string(json, '$.scrutin.titre') AS titre,
json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote,
date_T_insert
FROM __dbt__cte__stg_scrutins
    );
  
  
  
[0m20:41:55.153780 [debug] [Thread-1 (]: SQL status: OK in 1.718 seconds
[0m20:41:55.164395 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:41:55.164615 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m20:41:55.165235 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:41:55.165391 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:41:55.165548 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins__6d0337a3ddcc'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:41:55.167527 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:41:55.169087 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:41:55.169262 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:41:55.170628 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:55.172080 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:41:55.172247 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:41:55.173817 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:55.175199 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins"
[0m20:41:55.176303 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:41:55.176472 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

        
            delete from "an_data_pipeline"."main"."int_scrutins"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_scrutins__6d0337a3ddcc"
            );

        
    

    insert into "an_data_pipeline"."main"."int_scrutins" ("date_T_insert", "uid", "numero", "organeRef", "legislature", "date_scrutin", "titre", "resultat_code", "resultat_libelle", "nb_votants", "suffrages_exprimes", "seuil", "lieu_vote")
    (
        select "date_T_insert", "uid", "numero", "organeRef", "legislature", "date_scrutin", "titre", "resultat_code", "resultat_libelle", "nb_votants", "suffrages_exprimes", "seuil", "lieu_vote"
        from "an_data_pipeline"."dbt_temp"."int_scrutins__6d0337a3ddcc"
    )
  
[0m20:41:55.467183 [debug] [Thread-1 (]: SQL status: OK in 0.290 seconds
[0m20:41:55.472176 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m20:41:55.473927 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:41:55.474804 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m20:41:55.629571 [debug] [Thread-1 (]: SQL status: OK in 0.154 seconds
[0m20:41:55.637217 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:41:55.638606 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__6d0337a3ddcc" cascade
    
[0m20:41:56.488576 [debug] [Thread-1 (]: SQL status: OK in 0.849 seconds
[0m20:41:56.491792 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:41:56.491992 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__6d0337a3ddcc" cascade
    
[0m20:41:56.607478 [debug] [Thread-1 (]: SQL status: OK in 0.115 seconds
[0m20:41:56.608994 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: Close
[0m20:41:56.609723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4a024d-b964-4cbe-b829-54149ac837f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106824470>]}
[0m20:41:56.610425 [info ] [Thread-1 (]: 9 of 10 OK created sql incremental model main.int_scrutins ..................... [[32mOK[0m in 3.58s]
[0m20:41:56.610972 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins
[0m20:41:56.611376 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins_votes
[0m20:41:56.611976 [info ] [Thread-1 (]: 10 of 10 START sql incremental model main.int_scrutins_votes ................... [RUN]
[0m20:41:56.612478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_scrutins, now model.dbt_an_data.int_scrutins_votes)
[0m20:41:56.612829 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins_votes
[0m20:41:56.642332 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins_votes"
[0m20:41:56.644437 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins_votes
[0m20:41:56.646756 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:41:56.646961 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__546f4fc680b8" cascade
    
[0m20:41:56.647137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:56.757479 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m20:41:56.761142 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:41:56.761607 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:41:56.763011 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:56.764549 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:41:56.764954 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m20:41:56.765809 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:56.766160 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:41:56.766508 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:41:56.883108 [debug] [Thread-1 (]: SQL status: OK in 0.116 seconds
[0m20:41:56.886746 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:41:56.887741 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    

  
[0m20:41:56.888657 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:41:56.890951 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m20:41:56.891700 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:41:56.892354 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m20:41:57.005320 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m20:41:57.005829 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:41:57.006153 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_scrutins_votes__546f4fc680b8"
  
    as (
      

WITH  __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
), grp AS (
      -- explode les groupes (1 par groupe)
    SELECT
        json_extract_string(j.json, '$.scrutin.uid') AS uid,
        json_extract_string(g.value, '$.organeRef') AS groupe_organe,
        g.value AS groupe_json,
        date_T_insert
    FROM __dbt__cte__stg_scrutins j,
    json_each(json->'scrutin'->'ventilationVotes'->'organe'->'groupes'->'groupe') g
  ),

  positions_array AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,,
          date_T_insert
          groupe_organe,
          'pour' AS type_vote,
          p.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'pours'->'votant') p
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,,
          date_T_insert
          groupe_organe,
          'contre' AS type_vote,
          c.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'contres'->'votant') c
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,,
          date_T_insert
          groupe_organe,
          'abstention' AS type_vote,
          a.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'abstentions'->'votant') a
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,,
          date_T_insert
          groupe_organe,
          'nonVotant' AS type_vote,
          n.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'nonVotants'->'votant') n
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[ARRAY]'
  ),
  positions_object AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[OBJECT]'
  ),

  clean AS (
      -- sécurise les champs (souvent string ou null)
      SELECT
          uid,
          groupe_organe,
          type_vote,
          json_extract_string(vote_json, '$.acteurRef') AS acteurRef,
          json_extract_string(vote_json, '$.mandatRef') AS mandatRef,
          json_extract_string(vote_json, '$.parDelegation') AS parDelegation,
          json_extract_string(vote_json, '$.numPlace') AS numPlace,
          json_extract_string(vote_json, '$.causePositionVote') AS cause,
          date_T_insert
      FROM positions_array
      UNION ALL
      SELECT * 
      FROM positions_object
  )

  SELECT * FROM clean
    );
  
  
  
[0m20:41:57.024148 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_scrutins_votes__546f4fc680b8"
  
    as (
      

WITH  __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
), grp AS (
      -- explode les groupes (1 par groupe)
    SELECT
        json_extract_string(j.json, '$.scrutin.uid') AS uid,
        json_extract_string(g.value, '$.organeRef') AS groupe_organe,
        g.value AS groupe_json,
        date_T_insert
    FROM __dbt__cte__stg_scrutins j,
    json_each(json->'scrutin'->'ventilationVotes'->'organe'->'groupes'->'groupe') g
  ),

  positions_array AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,,
          date_T_insert
          groupe_organe,
          'pour' AS type_vote,
          p.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'pours'->'votant') p
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,,
          date_T_insert
          groupe_organe,
          'contre' AS type_vote,
          c.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'contres'->'votant') c
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,,
          date_T_insert
          groupe_organe,
          'abstention' AS type_vote,
          a.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'abstentions'->'votant') a
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,,
          date_T_insert
          groupe_organe,
          'nonVotant' AS type_vote,
          n.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'nonVotants'->'votant') n
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[ARRAY]'
  ),
  positions_object AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[OBJECT]'
  ),

  clean AS (
      -- sécurise les champs (souvent string ou null)
      SELECT
          uid,
          groupe_organe,
          type_vote,
          json_extract_string(vote_json, '$.acteurRef') AS acteurRef,
          json_extract_string(vote_json, '$.mandatRef') AS mandatRef,
          json_extract_string(vote_json, '$.parDelegation') AS parDelegation,
          json_extract_string(vote_json, '$.numPlace') AS numPlace,
          json_extract_string(vote_json, '$.causePositionVote') AS cause,
          date_T_insert
      FROM positions_array
      UNION ALL
      SELECT * 
      FROM positions_object
  )

  SELECT * FROM clean
    );
  
  
  
[0m20:41:57.024481 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:41:57.025614 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:41:57.025776 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__546f4fc680b8" cascade
    
[0m20:41:57.155932 [debug] [Thread-1 (]: SQL status: OK in 0.130 seconds
[0m20:41:57.157113 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: Close
[0m20:41:57.161919 [debug] [Thread-1 (]: Runtime Error in model int_scrutins_votes (models/int/int_scrutins_votes.sql)
  Parser Error: syntax error at or near ","
  
  LINE 31:           uid,,
                         ^
[0m20:41:57.162481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4a024d-b964-4cbe-b829-54149ac837f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a2630>]}
[0m20:41:57.163173 [error] [Thread-1 (]: 10 of 10 ERROR creating sql incremental model main.int_scrutins_votes .......... [[31mERROR[0m in 0.55s]
[0m20:41:57.163765 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins_votes
[0m20:41:57.164305 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.int_scrutins_votes' to be skipped because of status 'error'.  Reason: Runtime Error in model int_scrutins_votes (models/int/int_scrutins_votes.sql)
  Parser Error: syntax error at or near ","
  
  LINE 31:           uid,,
                         ^.
[0m20:41:57.170480 [debug] [MainThread]: Using duckdb connection "master"
[0m20:41:57.170786 [debug] [MainThread]: On master: BEGIN
[0m20:41:57.171033 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:41:57.172029 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:41:57.172289 [debug] [MainThread]: On master: COMMIT
[0m20:41:57.172547 [debug] [MainThread]: Using duckdb connection "master"
[0m20:41:57.172785 [debug] [MainThread]: On master: COMMIT
[0m20:41:57.173197 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:41:57.173444 [debug] [MainThread]: On master: Close
[0m20:41:57.173769 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:41:57.174027 [debug] [MainThread]: Connection 'model.dbt_an_data.int_scrutins_votes' was properly closed.
[0m20:41:57.174450 [info ] [MainThread]: 
[0m20:41:57.174741 [info ] [MainThread]: Finished running 10 incremental models, 1 project hook in 0 hours 0 minutes and 23.95 seconds (23.95s).
[0m20:41:57.176280 [debug] [MainThread]: Command end result
[0m20:41:57.197444 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m20:41:57.199898 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m20:41:57.204549 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m20:41:57.204757 [info ] [MainThread]: 
[0m20:41:57.204973 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m20:41:57.205146 [info ] [MainThread]: 
[0m20:41:57.205352 [error] [MainThread]: [31mFailure in model int_amendements_cosignataires (models/int/int_amendements_cosignataires.sql)[0m
[0m20:41:57.205545 [error] [MainThread]:   Runtime Error in model int_amendements_cosignataires (models/int/int_amendements_cosignataires.sql)
  Binder Error: Referenced column "date_T_insert" not found in FROM clause!
  Candidate bindings: "acteurRef"
  
  LINE 33:   date_T_insert
             ^
[0m20:41:57.205691 [info ] [MainThread]: 
[0m20:41:57.205861 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/int/int_amendements_cosignataires.sql
[0m20:41:57.206002 [info ] [MainThread]: 
[0m20:41:57.206163 [error] [MainThread]: [31mFailure in model int_scrutins_votes (models/int/int_scrutins_votes.sql)[0m
[0m20:41:57.206326 [error] [MainThread]:   Runtime Error in model int_scrutins_votes (models/int/int_scrutins_votes.sql)
  Parser Error: syntax error at or near ","
  
  LINE 31:           uid,,
                         ^
[0m20:41:57.206454 [info ] [MainThread]: 
[0m20:41:57.206602 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/int/int_scrutins_votes.sql
[0m20:41:57.206732 [info ] [MainThread]: 
[0m20:41:57.207272 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=11
[0m20:41:57.208720 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 24.580433, "process_in_blocks": "0", "process_kernel_time": 1.68993, "process_mem_max_rss": "928661504", "process_out_blocks": "0", "process_user_time": 6.82961}
[0m20:41:57.208997 [debug] [MainThread]: Command `dbt build` failed at 20:41:57.208952 after 24.58 seconds
[0m20:41:57.209256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d96ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aab4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aab770>]}
[0m20:41:57.209433 [debug] [MainThread]: Flushing usage events
[0m20:41:57.824963 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:42:41.934678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b45dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10955b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10955b170>]}


============================== 20:42:41.940067 | aaf5b9bb-160f-4f7f-820c-b6be33292e2c ==============================
[0m20:42:41.940067 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:42:41.940401 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'write_json': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'printer_width': '80', 'use_colors': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'static_parser': 'True', 'debug': 'False', 'partial_parse': 'True', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'quiet': 'False', 'version_check': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None'}
[0m20:42:42.164635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aaf5b9bb-160f-4f7f-820c-b6be33292e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095ca1e0>]}
[0m20:42:42.203453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aaf5b9bb-160f-4f7f-820c-b6be33292e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095cacf0>]}
[0m20:42:42.205229 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:42:42.272702 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:42:42.351984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:42:42.352344 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_amendements_cosignataires.sql
[0m20:42:42.462247 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_an_data.mart
[0m20:42:42.468329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aaf5b9bb-160f-4f7f-820c-b6be33292e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9dac60>]}
[0m20:42:42.505386 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m20:42:42.506740 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m20:42:42.527863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aaf5b9bb-160f-4f7f-820c-b6be33292e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b995400>]}
[0m20:42:42.528136 [info ] [MainThread]: Found 17 models, 1 operation, 9 sources, 469 macros
[0m20:42:42.529459 [info ] [MainThread]: 
[0m20:42:42.529632 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m20:42:42.529759 [info ] [MainThread]: 
[0m20:42:42.529986 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:42:42.532309 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_an_data_pipeline'
[0m20:42:42.608743 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline"
[0m20:42:42.608976 [debug] [ThreadPool]: On list_an_data_pipeline: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"an_data_pipeline"'
    
  
  
[0m20:42:42.609114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:42:44.740538 [debug] [ThreadPool]: SQL status: OK in 2.131 seconds
[0m20:42:44.743946 [debug] [ThreadPool]: On list_an_data_pipeline: Close
[0m20:42:44.745196 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_an_data_pipeline, now create_an_data_pipeline_main)
[0m20:42:44.745811 [debug] [ThreadPool]: Creating schema "database: "an_data_pipeline"
schema: "main"
"
[0m20:42:44.756380 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m20:42:44.757373 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:42:44.757914 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:42:44.761111 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:42:44.763016 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m20:42:44.763426 [debug] [ThreadPool]: On create_an_data_pipeline_main: BEGIN
[0m20:42:44.764422 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:42:44.764773 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m20:42:44.765111 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
    
        create schema if not exists "an_data_pipeline"."main"
    
[0m20:42:44.874019 [debug] [ThreadPool]: SQL status: OK in 0.108 seconds
[0m20:42:44.875753 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m20:42:44.876215 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m20:42:44.876589 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m20:42:44.981495 [debug] [ThreadPool]: SQL status: OK in 0.104 seconds
[0m20:42:44.982375 [debug] [ThreadPool]: On create_an_data_pipeline_main: Close
[0m20:42:44.985388 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_an_data_pipeline_main, now list_an_data_pipeline_main)
[0m20:42:44.994519 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m20:42:44.995201 [debug] [ThreadPool]: On list_an_data_pipeline_main: BEGIN
[0m20:42:44.995576 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:42:44.997139 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:42:44.997636 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m20:42:44.998022 [debug] [ThreadPool]: On list_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline_main"} */
select
      'an_data_pipeline' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'an_data_pipeline'
  
[0m20:42:45.021869 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m20:42:45.023948 [debug] [ThreadPool]: On list_an_data_pipeline_main: ROLLBACK
[0m20:42:45.025769 [debug] [ThreadPool]: Failed to rollback 'list_an_data_pipeline_main'
[0m20:42:45.026121 [debug] [ThreadPool]: On list_an_data_pipeline_main: Close
[0m20:42:45.027861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aaf5b9bb-160f-4f7f-820c-b6be33292e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8833b0>]}
[0m20:42:45.028334 [debug] [MainThread]: Using duckdb connection "master"
[0m20:42:45.028593 [debug] [MainThread]: On master: BEGIN
[0m20:42:45.028821 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:42:45.029674 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:42:45.029928 [debug] [MainThread]: On master: COMMIT
[0m20:42:45.030171 [debug] [MainThread]: Using duckdb connection "master"
[0m20:42:45.030398 [debug] [MainThread]: On master: COMMIT
[0m20:42:45.030822 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:42:45.037257 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_an_data.dbt_an_data-on-run-start-0"
[0m20:42:45.041562 [info ] [MainThread]: 1 of 1 START hook: dbt_an_data.on-run-start.0 .................................. [RUN]
[0m20:42:45.041940 [debug] [MainThread]: Using duckdb connection "master"
[0m20:42:45.042196 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "master"} */
ATTACH '../data/database/database.duckdb' AS database (READ_ONLY)
[0m20:42:45.050792 [debug] [MainThread]: SQL status: OK in 0.008 seconds
[0m20:42:45.051533 [info ] [MainThread]: 1 of 1 OK hook: dbt_an_data.on-run-start.0 ..................................... [[32mOK[0m in 0.02s]
[0m20:42:45.051743 [info ] [MainThread]: 
[0m20:42:45.051942 [debug] [MainThread]: On master: Close
[0m20:42:45.053898 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_acteurs
[0m20:42:45.054197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_an_data_pipeline_main, now model.dbt_an_data.stg_acteurs)
[0m20:42:45.054429 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_acteurs
[0m20:42:45.057542 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_acteurs"
[0m20:42:45.058264 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_acteurs
[0m20:42:45.058488 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_agenda
[0m20:42:45.058732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_acteurs, now model.dbt_an_data.stg_agenda)
[0m20:42:45.058949 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_agenda
[0m20:42:45.093409 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_agenda"
[0m20:42:45.094149 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_agenda
[0m20:42:45.094354 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_amendements
[0m20:42:45.094537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_agenda, now model.dbt_an_data.stg_amendements)
[0m20:42:45.094702 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_amendements
[0m20:42:45.095952 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_amendements"
[0m20:42:45.096508 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_amendements
[0m20:42:45.096674 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_organes
[0m20:42:45.096820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_amendements, now model.dbt_an_data.stg_organes)
[0m20:42:45.096960 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_organes
[0m20:42:45.098123 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_organes"
[0m20:42:45.098631 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_organes
[0m20:42:45.098802 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_pays
[0m20:42:45.098981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_organes, now model.dbt_an_data.stg_pays)
[0m20:42:45.099145 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_pays
[0m20:42:45.100279 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_pays"
[0m20:42:45.100614 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_pays
[0m20:42:45.100772 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_reunions
[0m20:42:45.100929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_pays, now model.dbt_an_data.stg_reunions)
[0m20:42:45.101087 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_reunions
[0m20:42:45.102201 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_reunions"
[0m20:42:45.102544 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_reunions
[0m20:42:45.102701 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_scrutins
[0m20:42:45.102863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_reunions, now model.dbt_an_data.stg_scrutins)
[0m20:42:45.103015 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_scrutins
[0m20:42:45.104122 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_scrutins"
[0m20:42:45.104697 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_scrutins
[0m20:42:45.104854 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_acteurs
[0m20:42:45.105068 [info ] [Thread-1 (]: 1 of 10 START sql incremental model main.int_acteurs ........................... [RUN]
[0m20:42:45.105260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_scrutins, now model.dbt_an_data.int_acteurs)
[0m20:42:45.105402 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_acteurs
[0m20:42:45.109571 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_acteurs"
[0m20:42:45.109851 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_acteurs
[0m20:42:45.113209 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:42:45.113391 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__949b4f50e291" cascade
    
[0m20:42:45.113541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:42:45.230207 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m20:42:45.262589 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:42:45.262895 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:42:45.263838 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:42:45.264649 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:42:45.264844 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m20:42:45.265344 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:42:45.265561 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:42:45.265750 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:42:45.371454 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m20:42:45.372712 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:42:45.373074 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    

  
[0m20:42:45.373470 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:42:45.374506 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m20:42:45.374823 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:42:45.375107 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m20:42:45.484818 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m20:42:45.512940 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:42:45.513712 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_acteurs__949b4f50e291"
  
    as (
      

with __dbt__cte__stg_acteurs as (
SELECT * 
FROM "database"."stg"."raw_acteurs"
) SELECT 
json_extract_string(json, '$.acteur.uid.#text') as uid,
json_extract_string(json, '$.acteur.etatCivil.ident.civ') as civ,
json_extract_string(json, '$.acteur.etatCivil.ident.prenom') as prenom,
json_extract_string(json, '$.acteur.etatCivil.ident.nom') as nom,
json_extract_string(json, '$.acteur.etatCivil.ident.trigramme') as trigramme,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.dateNais') as dateNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.villeNais') as villeNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.depNais') as depNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.paysNais') as paysNais,
json_extract_string(json, '$.acteur.etatCivil.dateDeces') as dateDeces,
json_extract_string(json, '$.acteur.profession.libelleCourant') as libelleCourant,
json_extract_string(json, '$.acteur.profession.socProcINSEE.catSocPro') as catSocPro,
json_extract_string(json, '$.acteur.profession.socProcINSEE.famSocPro') as famSocPro,
json_extract_string(json, '$.acteur.uri_hatvp') as uri_hatvp,
date_T_insert
FROM __dbt__cte__stg_acteurs
    );
  
  
  
[0m20:42:46.172141 [debug] [Thread-1 (]: SQL status: OK in 0.658 seconds
[0m20:42:46.180423 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:42:46.180882 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m20:42:46.181921 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:42:46.182202 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:42:46.182508 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs__949b4f50e291'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:42:46.188590 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:42:46.193164 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:42:46.193474 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:42:46.195942 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:42:46.201959 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:42:46.202235 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:42:46.204240 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:42:46.206072 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:42:46.206305 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */
SELECT version()
[0m20:42:46.206688 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:42:46.215080 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_acteurs"
[0m20:42:46.215671 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:42:46.215880 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

        
            delete from "an_data_pipeline"."main"."int_acteurs"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_acteurs__949b4f50e291"
            );

        
    

    insert into "an_data_pipeline"."main"."int_acteurs" ("uid", "civ", "prenom", "nom", "trigramme", "dateNais", "villeNais", "depNais", "paysNais", "dateDeces", "libelleCourant", "catSocPro", "famSocPro", "uri_hatvp")
    (
        select "uid", "civ", "prenom", "nom", "trigramme", "dateNais", "villeNais", "depNais", "paysNais", "dateDeces", "libelleCourant", "catSocPro", "famSocPro", "uri_hatvp"
        from "an_data_pipeline"."dbt_temp"."int_acteurs__949b4f50e291"
    )
  
[0m20:42:46.469132 [debug] [Thread-1 (]: SQL status: OK in 0.253 seconds
[0m20:42:46.491089 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m20:42:46.491824 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:42:46.492282 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m20:42:46.622130 [debug] [Thread-1 (]: SQL status: OK in 0.129 seconds
[0m20:42:46.630297 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:42:46.631479 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__949b4f50e291" cascade
    
[0m20:42:46.871421 [debug] [Thread-1 (]: SQL status: OK in 0.239 seconds
[0m20:42:46.873206 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:42:46.873369 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__949b4f50e291" cascade
    
[0m20:42:46.983857 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m20:42:46.986348 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: Close
[0m20:42:46.988459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaf5b9bb-160f-4f7f-820c-b6be33292e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095e3080>]}
[0m20:42:46.989054 [info ] [Thread-1 (]: 1 of 10 OK created sql incremental model main.int_acteurs ...................... [[32mOK[0m in 1.88s]
[0m20:42:46.989543 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_acteurs
[0m20:42:46.989884 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_mandats
[0m20:42:46.990377 [info ] [Thread-1 (]: 2 of 10 START sql incremental model main.int_mandats ........................... [RUN]
[0m20:42:46.990837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_acteurs, now model.dbt_an_data.int_mandats)
[0m20:42:46.991177 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_mandats
[0m20:42:46.998620 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_mandats"
[0m20:42:46.999262 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_mandats
[0m20:42:47.002064 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:42:47.002350 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__84a9e367ffc0" cascade
    
[0m20:42:47.002585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:42:47.117462 [debug] [Thread-1 (]: SQL status: OK in 0.115 seconds
[0m20:42:47.121729 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:42:47.122580 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:42:47.124996 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:42:47.127666 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:42:47.128353 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m20:42:47.130028 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:42:47.130571 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:42:47.131102 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:42:47.244231 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m20:42:47.246591 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:42:47.247581 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    

  
[0m20:42:47.248560 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:42:47.251271 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m20:42:47.252067 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:42:47.252701 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m20:42:47.363734 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m20:42:47.366822 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:42:47.367994 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_mandats__84a9e367ffc0"
  
    as (
      

with __dbt__cte__stg_acteurs as (
SELECT * 
FROM "database"."stg"."raw_acteurs"
) SELECT 
json_extract_string(mandat.value, '$.uid') as uid,
json_extract_string(mandat.value, '$.acteurRef') as acteurRef,
json_extract_string(mandat.value, '$.legislature') as legislature,
json_extract_string(mandat.value, '$.typeOrgane') as typeOrgane,
json_extract_string(mandat.value, '$.dateDebut') as dateDebut,
json_extract_string(mandat.value, '$.dateFin') as dateFin,
json_extract_string(mandat.value, '$.preseance') as preseance,
json_extract_string(mandat.value, '$.nominPrincipale') as nominPrincipale,
json_extract_string(mandat.value, '$.infosQualite.codeQualite') as codeQualite,
json_extract_string(mandat.value, '$.organes.organeRef') as organeRef,
date_T_insert
FROM __dbt__cte__stg_acteurs act, json_each(json->'acteur'->'mandats'->'mandat') mandat
    );
  
  
  
[0m20:42:48.466861 [debug] [Thread-1 (]: SQL status: OK in 1.093 seconds
[0m20:42:48.486197 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:42:48.486899 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m20:42:48.488632 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:42:48.489103 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:42:48.489564 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats__84a9e367ffc0'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:42:48.493872 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:42:48.497644 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:42:48.498110 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:42:48.501573 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:42:48.504887 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:42:48.505251 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:42:48.507983 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:42:48.510128 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_mandats"
[0m20:42:48.511034 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:42:48.511348 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

        
            delete from "an_data_pipeline"."main"."int_mandats"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_mandats__84a9e367ffc0"
            );

        
    

    insert into "an_data_pipeline"."main"."int_mandats" ("uid", "acteurRef", "legislature", "typeOrgane", "dateDebut", "dateFin", "preseance", "nominPrincipale", "codeQualite", "organeRef")
    (
        select "uid", "acteurRef", "legislature", "typeOrgane", "dateDebut", "dateFin", "preseance", "nominPrincipale", "codeQualite", "organeRef"
        from "an_data_pipeline"."dbt_temp"."int_mandats__84a9e367ffc0"
    )
  
[0m20:42:48.779004 [debug] [Thread-1 (]: SQL status: OK in 0.267 seconds
[0m20:42:48.781604 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m20:42:48.782256 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:42:48.782720 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m20:42:48.982978 [debug] [Thread-1 (]: SQL status: OK in 0.200 seconds
[0m20:42:48.986979 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:42:48.987646 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__84a9e367ffc0" cascade
    
[0m20:42:49.244013 [debug] [Thread-1 (]: SQL status: OK in 0.256 seconds
[0m20:42:49.246230 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:42:49.246433 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__84a9e367ffc0" cascade
    
[0m20:42:49.370052 [debug] [Thread-1 (]: SQL status: OK in 0.123 seconds
[0m20:42:49.372023 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: Close
[0m20:42:49.373124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaf5b9bb-160f-4f7f-820c-b6be33292e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c130290>]}
[0m20:42:49.374049 [info ] [Thread-1 (]: 2 of 10 OK created sql incremental model main.int_mandats ...................... [[32mOK[0m in 2.38s]
[0m20:42:49.374996 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_mandats
[0m20:42:49.375554 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_agenda
[0m20:42:49.376634 [info ] [Thread-1 (]: 3 of 10 START sql incremental model main.int_agenda ............................ [RUN]
[0m20:42:49.377106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_mandats, now model.dbt_an_data.int_agenda)
[0m20:42:49.377513 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_agenda
[0m20:42:49.381993 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_agenda"
[0m20:42:49.383052 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_agenda
[0m20:42:49.386522 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:42:49.386849 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__68d164b79e08" cascade
    
[0m20:42:49.387132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:42:49.503172 [debug] [Thread-1 (]: SQL status: OK in 0.116 seconds
[0m20:42:49.507555 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:42:49.508274 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:42:49.510778 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:42:49.513302 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:42:49.513962 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m20:42:49.515512 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:42:49.516241 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:42:49.516751 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:42:49.626337 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m20:42:49.628196 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:42:49.628805 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    

  
[0m20:42:49.629406 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:42:49.631080 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m20:42:49.631617 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:42:49.632091 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m20:42:49.740053 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m20:42:49.741543 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:42:49.742160 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_agenda__68d164b79e08"
  
    as (
      

with __dbt__cte__stg_agenda as (
SELECT * 
FROM "database"."stg"."raw_agenda"
) SELECT * 
FROM __dbt__cte__stg_agenda
    );
  
  
  
[0m20:42:50.091198 [debug] [Thread-1 (]: SQL status: OK in 0.348 seconds
[0m20:42:50.096760 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:42:50.097398 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m20:42:50.098855 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:42:50.099319 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:42:50.099779 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda__68d164b79e08'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:42:50.104769 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:42:50.108221 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:42:50.108653 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:42:50.112056 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:42:50.115102 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:42:50.115503 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:42:50.118747 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:42:50.122509 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_agenda"
[0m20:42:50.123217 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:42:50.123534 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

        
            delete from "an_data_pipeline"."main"."int_agenda" as DBT_INCREMENTAL_TARGET
            using "an_data_pipeline"."dbt_temp"."int_agenda__68d164b79e08"
            where (
                
                    "an_data_pipeline"."dbt_temp"."int_agenda__68d164b79e08".Date = DBT_INCREMENTAL_TARGET.Date
                    and 
                
                    "an_data_pipeline"."dbt_temp"."int_agenda__68d164b79e08".Heure = DBT_INCREMENTAL_TARGET.Heure
                    
                
                
            );
        
    

    insert into "an_data_pipeline"."main"."int_agenda" ("Date", "Heure", "Ordre(s) du jour", "filename", "date_T_insert")
    (
        select "Date", "Heure", "Ordre(s) du jour", "filename", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_agenda__68d164b79e08"
    )
  
[0m20:42:50.387014 [debug] [Thread-1 (]: SQL status: OK in 0.262 seconds
[0m20:42:50.391016 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m20:42:50.391551 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:42:50.392003 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m20:42:50.516271 [debug] [Thread-1 (]: SQL status: OK in 0.123 seconds
[0m20:42:50.524420 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:42:50.525548 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__68d164b79e08" cascade
    
[0m20:42:50.769880 [debug] [Thread-1 (]: SQL status: OK in 0.244 seconds
[0m20:42:50.771833 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:42:50.772031 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__68d164b79e08" cascade
    
[0m20:42:50.880571 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m20:42:50.882033 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: Close
[0m20:42:50.882580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaf5b9bb-160f-4f7f-820c-b6be33292e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c117c50>]}
[0m20:42:50.883184 [info ] [Thread-1 (]: 3 of 10 OK created sql incremental model main.int_agenda ....................... [[32mOK[0m in 1.51s]
[0m20:42:50.883670 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_agenda
[0m20:42:50.884104 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements
[0m20:42:50.884663 [info ] [Thread-1 (]: 4 of 10 START sql incremental model main.int_amendements ....................... [RUN]
[0m20:42:50.885109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_agenda, now model.dbt_an_data.int_amendements)
[0m20:42:50.885434 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements
[0m20:42:50.899528 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements"
[0m20:42:50.900220 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements
[0m20:42:50.903173 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:42:50.903461 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__d6a6a63c3661" cascade
    
[0m20:42:50.903685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:42:51.022374 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m20:42:51.027700 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:42:51.028485 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:42:51.031183 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:42:51.033902 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:42:51.034431 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m20:42:51.035612 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:42:51.036071 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:42:51.036523 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:42:51.147008 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m20:42:51.150840 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:42:51.151952 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    

  
[0m20:42:51.152940 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:42:51.156260 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m20:42:51.157219 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:42:51.157933 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m20:42:51.265395 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m20:42:51.268399 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:42:51.269744 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_amendements__d6a6a63c3661"
  
    as (
      

with __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
) SELECT
json_extract_string(json, '$.amendement.uid') AS uid,
json_extract_string(json, '$.amendement.chronotag') AS chronotag,
json_extract_string(json, '$.amendement.examenRef') AS examenRef,
json_extract_string(json, '$.amendement.amendementParentRef') AS amendementParentRef,
json_extract_string(json, '$.amendement.signataires.auteur.typeAuteur') AS typeAuteur,
json_extract_string(json, '$.amendement.signataires.auteur.acteurRef') AS refAuteur,
json_extract_string(json, '$.amendement.signataires.auteur.groupePolitique') AS groupePolitiqueAuteur,
json_extract_string(json, '$.amendement.cycleDeVie.dateDepot') AS dateDepot,
json_extract_string(json, '$.amendement.cycleDeVie.datePublication') AS datePublication,
json_extract_string(json, '$.amendement.cycleDeVie.soumisArticle40') AS soumisArticle40,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.code') AS codeEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.libelle') AS libelleEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.code') AS codeSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.dateSort') AS dateSort,
json_extract_string(json, '$.amendement.cycleDeVie.sort') AS sort,
split_part(replace(filename, '.json', ''), '/', -1) AS id_amendement,
split_part(replace(filename, '.json', ''), '/', -2) AS id_texte,
split_part(replace(filename, '.json', ''), '/', -3) AS id_dossier_legislatif,
id_texte[:4] AS nature_texte,
id_texte[5:6] AS source_texte,
regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 1) AS prefix_bibard,
regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 2) AS numero_bibard,
regexp_extract(id_amendement, '(SEA|PO\d*)', 1) AS code_organe,
regexp_extract(id_amendement, '(P)(\d*)(D)', 2) AS numero_partie,
regexp_extract(id_amendement, '(D)(\d*)(N)', 2) AS numero_deliberation,
regexp_extract(id_amendement, '(D)(\d*)(N)(\d*)', 4) AS numero_court,
date_T_insert
from __dbt__cte__stg_amendements
    );
  
  
  
[0m20:42:51.640309 [debug] [Thread-1 (]: SQL status: OK in 0.369 seconds
[0m20:42:51.643513 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:42:51.643886 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m20:42:51.644886 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:42:51.645210 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:42:51.645551 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements__d6a6a63c3661'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:42:51.648850 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:42:51.652249 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:42:51.652680 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:42:51.655709 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:42:51.659123 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:42:51.659512 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:42:51.662399 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:42:51.664935 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements"
[0m20:42:51.665678 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:42:51.666025 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

        
            delete from "an_data_pipeline"."main"."int_amendements"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_amendements__d6a6a63c3661"
            );

        
    

    insert into "an_data_pipeline"."main"."int_amendements" ("uid", "chronotag", "examenRef", "amendementParentRef", "typeAuteur", "refAuteur", "groupePolitiqueAuteur", "dateDepot", "datePublication", "soumisArticle40", "codeEtat", "libelleEtat", "codeSousEtat", "libelleSousEtat", "libelleSousEtat_1", "dateSort", "sort", "id_amendement", "id_texte", "id_dossier_legislatif", "nature_texte", "source_texte", "prefix_bibard", "numero_bibard", "code_organe", "numero_partie", "numero_deliberation", "numero_court")
    (
        select "uid", "chronotag", "examenRef", "amendementParentRef", "typeAuteur", "refAuteur", "groupePolitiqueAuteur", "dateDepot", "datePublication", "soumisArticle40", "codeEtat", "libelleEtat", "codeSousEtat", "libelleSousEtat", "libelleSousEtat_1", "dateSort", "sort", "id_amendement", "id_texte", "id_dossier_legislatif", "nature_texte", "source_texte", "prefix_bibard", "numero_bibard", "code_organe", "numero_partie", "numero_deliberation", "numero_court"
        from "an_data_pipeline"."dbt_temp"."int_amendements__d6a6a63c3661"
    )
  
[0m20:42:51.947324 [debug] [Thread-1 (]: SQL status: OK in 0.281 seconds
[0m20:42:51.950413 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m20:42:51.951213 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:42:51.951976 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m20:42:52.070648 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m20:42:52.072093 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:42:52.072270 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__d6a6a63c3661" cascade
    
[0m20:42:52.321635 [debug] [Thread-1 (]: SQL status: OK in 0.249 seconds
[0m20:42:52.325117 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:42:52.325311 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__d6a6a63c3661" cascade
    
[0m20:42:52.438855 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m20:42:52.440235 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: Close
[0m20:42:52.440785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaf5b9bb-160f-4f7f-820c-b6be33292e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c13e570>]}
[0m20:42:52.441370 [info ] [Thread-1 (]: 4 of 10 OK created sql incremental model main.int_amendements .................. [[32mOK[0m in 1.56s]
[0m20:42:52.441895 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements
[0m20:42:52.442257 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements_cosignataires
[0m20:42:52.442733 [info ] [Thread-1 (]: 5 of 10 START sql incremental model main.int_amendements_cosignataires ......... [RUN]
[0m20:42:52.443149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements, now model.dbt_an_data.int_amendements_cosignataires)
[0m20:42:52.443476 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements_cosignataires
[0m20:42:52.451699 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements_cosignataires"
[0m20:42:52.452397 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements_cosignataires
[0m20:42:52.455595 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:42:52.455929 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__4f25bdffd71c" cascade
    
[0m20:42:52.456198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:42:52.567265 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m20:42:52.573086 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:42:52.573926 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:42:52.576922 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:42:52.579205 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:42:52.579722 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m20:42:52.580814 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:42:52.581261 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:42:52.581717 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:42:52.693563 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m20:42:52.697764 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:42:52.698995 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    

  
[0m20:42:52.700168 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:42:52.702844 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m20:42:52.704689 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:42:52.705503 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m20:42:52.812476 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m20:42:52.813130 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:42:52.813315 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__4f25bdffd71c"
  
    as (
      

WITH  __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
), cosignataires_arr AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef[*]') AS acteurRef,
    date_T_insert
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') == 'ARRAY' AND acteurRef IS NOT NULL
), cosignataires_str AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef') AS acteurRef,
    date_T_insert
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') <> 'ARRAY' AND acteurRef IS NOT NULL
)
SELECT 
  uid, 
  unnest(acteurRef) as acteurRef,
  date_T_insert
FROM cosignataires_arr
UNION ALL
SELECT 
  uid, 
  acteurRef,
  date_T_insert
FROM cosignataires_str
    );
  
  
  
[0m20:42:53.177511 [debug] [Thread-1 (]: SQL status: OK in 0.364 seconds
[0m20:42:53.182909 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:42:53.183642 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m20:42:53.185155 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:42:53.185789 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:42:53.186329 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires__4f25bdffd71c'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:42:53.190018 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:42:53.192098 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:42:53.192320 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:42:53.194078 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:42:53.195595 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:42:53.195806 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:42:53.197538 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:42:53.198718 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements_cosignataires"
[0m20:42:53.199642 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:42:53.199850 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

        
            delete from "an_data_pipeline"."main"."int_amendements_cosignataires" as DBT_INCREMENTAL_TARGET
            using "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__4f25bdffd71c"
            where (
                
                    "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__4f25bdffd71c".uid = DBT_INCREMENTAL_TARGET.uid
                    and 
                
                    "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__4f25bdffd71c".acteurRef = DBT_INCREMENTAL_TARGET.acteurRef
                    
                
                
            );
        
    

    insert into "an_data_pipeline"."main"."int_amendements_cosignataires" ("uid", "acteurRef")
    (
        select "uid", "acteurRef"
        from "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__4f25bdffd71c"
    )
  
[0m20:42:53.446979 [debug] [Thread-1 (]: SQL status: OK in 0.246 seconds
[0m20:42:53.451782 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m20:42:53.452662 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:42:53.453376 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m20:42:53.563496 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m20:42:53.564870 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:42:53.565048 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__4f25bdffd71c" cascade
    
[0m20:42:53.802094 [debug] [Thread-1 (]: SQL status: OK in 0.237 seconds
[0m20:42:53.807794 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:42:53.808585 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__4f25bdffd71c" cascade
    
[0m20:42:53.932320 [debug] [Thread-1 (]: SQL status: OK in 0.122 seconds
[0m20:42:53.937573 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: Close
[0m20:42:53.939224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaf5b9bb-160f-4f7f-820c-b6be33292e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9884a0>]}
[0m20:42:53.940690 [info ] [Thread-1 (]: 5 of 10 OK created sql incremental model main.int_amendements_cosignataires .... [[32mOK[0m in 1.50s]
[0m20:42:53.941640 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements_cosignataires
[0m20:42:53.942324 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_organes
[0m20:42:53.943216 [info ] [Thread-1 (]: 6 of 10 START sql incremental model main.int_organes ........................... [RUN]
[0m20:42:53.944010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements_cosignataires, now model.dbt_an_data.int_organes)
[0m20:42:53.944619 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_organes
[0m20:42:53.962436 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_organes"
[0m20:42:53.963203 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_organes
[0m20:42:53.966264 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:42:53.966796 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__a16a111aff94" cascade
    
[0m20:42:53.967181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:42:54.085397 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m20:42:54.092682 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:42:54.093614 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:42:54.097448 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:42:54.099932 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:42:54.100539 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m20:42:54.101918 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:42:54.102404 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:42:54.102859 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:42:54.215967 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m20:42:54.219788 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:42:54.220716 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    

  
[0m20:42:54.221691 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:42:54.224135 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m20:42:54.224910 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:42:54.225443 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m20:42:54.350343 [debug] [Thread-1 (]: SQL status: OK in 0.124 seconds
[0m20:42:54.351589 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:42:54.351913 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_organes__a16a111aff94"
  
    as (
      

with __dbt__cte__stg_organes as (
SELECT * 
FROM "database"."stg"."raw_organes"
) SELECT 
json_extract_string(json, '$.organe.uid') as uid,
json_extract_string(json, '$.organe.codeType') as codeType,
json_extract_string(json, '$.organe.libelle') as libelle,
json_extract_string(json, '$.organe.libelleEdition') as libelleEdition,
json_extract_string(json, '$.organe.libelleAbrege') as libelleAbrege,
json_extract_string(json, '$.organe.libelleAbrev') as libelleAbrev,
json_extract_string(json, '$.organe.viMoDe.dateDebut') as dateDebut,
json_extract_string(json, '$.organe.viMoDe.dateAgrement') as dateAgrement,
json_extract_string(json, '$.organe.viMoDe.dateFin') as dateFin,
json_extract_string(json, '$.organe.organeParent') as organeParent,
json_extract_string(json, '$.organe.chambre') as chambre,
json_extract_string(json, '$.organe.regime') as regime,
json_extract_string(json, '$.organe.legislature') as legislature,
date_T_insert
FROM __dbt__cte__stg_organes
    );
  
  
  
[0m20:42:54.954997 [debug] [Thread-1 (]: SQL status: OK in 0.603 seconds
[0m20:42:54.956790 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:42:54.956968 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m20:42:54.957596 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:42:54.957781 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:42:54.957947 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes__a16a111aff94'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:42:54.959697 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:42:54.961176 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:42:54.961361 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:42:54.962733 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:42:54.964204 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:42:54.964379 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:42:54.965919 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:42:54.966879 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_organes"
[0m20:42:54.967622 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:42:54.967793 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

        
            delete from "an_data_pipeline"."main"."int_organes"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_organes__a16a111aff94"
            );

        
    

    insert into "an_data_pipeline"."main"."int_organes" ("uid", "codeType", "libelle", "libelleEdition", "libelleAbrege", "libelleAbrev", "dateDebut", "dateAgrement", "dateFin", "organeParent", "chambre", "regime", "legislature")
    (
        select "uid", "codeType", "libelle", "libelleEdition", "libelleAbrege", "libelleAbrev", "dateDebut", "dateAgrement", "dateFin", "organeParent", "chambre", "regime", "legislature"
        from "an_data_pipeline"."dbt_temp"."int_organes__a16a111aff94"
    )
  
[0m20:42:55.225888 [debug] [Thread-1 (]: SQL status: OK in 0.258 seconds
[0m20:42:55.229397 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m20:42:55.230529 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:42:55.231403 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m20:42:55.405714 [debug] [Thread-1 (]: SQL status: OK in 0.174 seconds
[0m20:42:55.407056 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:42:55.407228 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__a16a111aff94" cascade
    
[0m20:42:55.655087 [debug] [Thread-1 (]: SQL status: OK in 0.247 seconds
[0m20:42:55.659682 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:42:55.660253 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__a16a111aff94" cascade
    
[0m20:42:55.768835 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m20:42:55.770275 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: Close
[0m20:42:55.770837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaf5b9bb-160f-4f7f-820c-b6be33292e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be59670>]}
[0m20:42:55.771265 [info ] [Thread-1 (]: 6 of 10 OK created sql incremental model main.int_organes ...................... [[32mOK[0m in 1.83s]
[0m20:42:55.771551 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_organes
[0m20:42:55.771852 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_pays
[0m20:42:55.772949 [info ] [Thread-1 (]: 7 of 10 START sql incremental model main.int_pays .............................. [RUN]
[0m20:42:55.774447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_organes, now model.dbt_an_data.int_pays)
[0m20:42:55.774796 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_pays
[0m20:42:55.795793 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_pays"
[0m20:42:55.796830 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_pays
[0m20:42:55.799825 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:42:55.800060 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__bbd4dbf06cd6" cascade
    
[0m20:42:55.800333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:42:55.931606 [debug] [Thread-1 (]: SQL status: OK in 0.131 seconds
[0m20:42:55.948377 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:42:55.949961 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:42:55.952794 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:42:55.955224 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:42:55.955732 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m20:42:55.956972 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:42:55.957357 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:42:55.957569 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:42:56.069565 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m20:42:56.071421 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:42:56.072106 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    

  
[0m20:42:56.072694 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:42:56.074348 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m20:42:56.074846 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:42:56.075293 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m20:42:56.182757 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m20:42:56.184382 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:42:56.185006 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_pays__bbd4dbf06cd6"
  
    as (
      

with __dbt__cte__stg_pays as (
SELECT * 
FROM "database"."stg"."raw_pays"
) SELECT
json_extract_string(json, '$.pays.uid') as uid,
json_extract_string(json, '$.pays.code_insee') as code_insee,
json_extract_string(json, '$.pays.libelleInsee') as libelleInsee,
json_extract_string(json, '$.pays.nomCourant') as nomCourant,
json_extract_string(json, '$.pays.code_iso2A') as code_iso2A,
json_extract_string(json, '$.pays.code_iso3A') as code_iso3A,
json_extract_string(json, '$.pays.code_iso3N') as code_iso3N,
json_extract_string(json, '$.pays.libelleIso') as libelleIso,
json_extract_string(json, '$.pays.libelleANCourt') as libelleANCourt,
json_extract_string(json, '$.pays.libelleANLong') as libelleANLong,
json_extract_string(json, '$.pays.sourceJuridique') as sourceJuridique,
json_extract_string(json, '$.pays.activ') as activ,
date_T_insert
FROM __dbt__cte__stg_pays
    );
  
  
  
[0m20:42:56.550984 [debug] [Thread-1 (]: SQL status: OK in 0.365 seconds
[0m20:42:56.556344 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:42:56.556851 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m20:42:56.558171 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:42:56.558643 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:42:56.559059 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays__bbd4dbf06cd6'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:42:56.563434 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:42:56.567500 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:42:56.567922 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:42:56.570999 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:42:56.574097 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:42:56.574441 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:42:56.577166 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:42:56.579477 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_pays"
[0m20:42:56.580198 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:42:56.580487 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

        
            delete from "an_data_pipeline"."main"."int_pays"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_pays__bbd4dbf06cd6"
            );

        
    

    insert into "an_data_pipeline"."main"."int_pays" ("uid", "code_insee", "libelleInsee", "nomCourant", "code_iso2A", "code_iso3A", "code_iso3N", "libelleIso", "libelleANCourt", "libelleANLong", "sourceJuridique", "activ")
    (
        select "uid", "code_insee", "libelleInsee", "nomCourant", "code_iso2A", "code_iso3A", "code_iso3N", "libelleIso", "libelleANCourt", "libelleANLong", "sourceJuridique", "activ"
        from "an_data_pipeline"."dbt_temp"."int_pays__bbd4dbf06cd6"
    )
  
[0m20:42:56.810626 [debug] [Thread-1 (]: SQL status: OK in 0.230 seconds
[0m20:42:56.813811 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m20:42:56.814553 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:42:56.815015 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m20:42:56.942494 [debug] [Thread-1 (]: SQL status: OK in 0.127 seconds
[0m20:42:56.949577 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:42:56.950700 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__bbd4dbf06cd6" cascade
    
[0m20:42:57.179324 [debug] [Thread-1 (]: SQL status: OK in 0.228 seconds
[0m20:42:57.181103 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:42:57.181284 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__bbd4dbf06cd6" cascade
    
[0m20:42:57.299949 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m20:42:57.301688 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: Close
[0m20:42:57.302652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaf5b9bb-160f-4f7f-820c-b6be33292e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107934620>]}
[0m20:42:57.303504 [info ] [Thread-1 (]: 7 of 10 OK created sql incremental model main.int_pays ......................... [[32mOK[0m in 1.53s]
[0m20:42:57.304188 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_pays
[0m20:42:57.304658 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_reunions
[0m20:42:57.305349 [info ] [Thread-1 (]: 8 of 10 START sql incremental model main.int_reunions .......................... [RUN]
[0m20:42:57.305789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_pays, now model.dbt_an_data.int_reunions)
[0m20:42:57.306140 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_reunions
[0m20:42:57.317264 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_reunions"
[0m20:42:57.318015 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_reunions
[0m20:42:57.321540 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:42:57.321876 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__718c3771ced6" cascade
    
[0m20:42:57.322161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:42:57.436396 [debug] [Thread-1 (]: SQL status: OK in 0.114 seconds
[0m20:42:57.440054 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:42:57.440960 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:42:57.443322 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:42:57.445276 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:42:57.445598 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m20:42:57.446328 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:42:57.446550 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:42:57.446753 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:42:57.556347 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m20:42:57.559112 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:42:57.560150 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    

  
[0m20:42:57.561280 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:42:57.563572 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m20:42:57.564345 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:42:57.565007 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m20:42:57.676594 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m20:42:57.677171 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:42:57.677404 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_reunions__718c3771ced6"
  
    as (
      

with __dbt__cte__stg_reunions as (
SELECT * 
FROM "database"."stg"."raw_reunions"
) SELECT
json_extract_string(json, '$.reunion.uid') AS uid,
json_extract_string(json, '$.reunion.timeStampDebut') AS timeStampDebut,
json_extract_string(json, '$.reunion.lieu.lieuRef') AS lieuRef,
json_extract_string(json, '$.reunion.lieu.libelleLong') AS lieuLibelle,
json_extract_string(json, '$.reunion.cycleDeVie.etat') AS cycleDeVieEtat,
json_extract_string(json, '$.reunion.demandeur') AS demandeur,
json_extract_string(json, '$.reunion.organeReuniRef') AS organeReuniRef,
json_extract_string(json, '$.reunion.visioConference') AS visioConference,
json_extract_string(json, '$.reunion.sessionRef') AS sessionRef,
json_extract_string(json, '$.reunion.ouverturePresse') AS ouverturePresse,
json_extract_string(json, '$.reunion.captationVideo') AS captationVideo,
json_extract_string(json, '$.reunion.ODJ.convocationODJ.item') AS convocationODJ,
json_extract_string(json, '$.reunion.ODJ.resumeODJ.item') AS resumeODJ,
json_extract_string(json, '$.reunion.compteRenduRef') AS compteRenduRef,
json_extract_string(json, '$.reunion.identifiants.numSeanceJO') AS numSeanceJO,
json_extract_string(json, '$.reunion.identifiants.idJO') AS idJO,
json_extract_string(json, '$.reunion.identifiants.quantieme') AS quantieme,
json_extract_string(json, '$.reunion.identifiants.DataSeance') AS DataSeance,
date_T_insert
FROM __dbt__cte__stg_reunions
    );
  
  
  
[0m20:42:58.747524 [debug] [Thread-1 (]: SQL status: OK in 1.070 seconds
[0m20:42:58.752962 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:42:58.753315 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m20:42:58.754264 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:42:58.754475 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:42:58.754646 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions__718c3771ced6'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:42:58.756797 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:42:58.760215 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:42:58.760504 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:42:58.762880 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:42:58.765633 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:42:58.766149 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:42:58.768313 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:42:58.769783 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_reunions"
[0m20:42:58.770293 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:42:58.770487 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

        
            delete from "an_data_pipeline"."main"."int_reunions"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_reunions__718c3771ced6"
            );

        
    

    insert into "an_data_pipeline"."main"."int_reunions" ("uid", "timeStampDebut", "lieuRef", "lieuLibelle", "cycleDeVieEtat", "demandeur", "organeReuniRef", "visioConference", "sessionRef", "ouverturePresse", "captationVideo", "convocationODJ", "resumeODJ", "compteRenduRef", "numSeanceJO", "idJO", "quantieme", "DataSeance")
    (
        select "uid", "timeStampDebut", "lieuRef", "lieuLibelle", "cycleDeVieEtat", "demandeur", "organeReuniRef", "visioConference", "sessionRef", "ouverturePresse", "captationVideo", "convocationODJ", "resumeODJ", "compteRenduRef", "numSeanceJO", "idJO", "quantieme", "DataSeance"
        from "an_data_pipeline"."dbt_temp"."int_reunions__718c3771ced6"
    )
  
[0m20:42:59.015568 [debug] [Thread-1 (]: SQL status: OK in 0.245 seconds
[0m20:42:59.018527 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m20:42:59.019280 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:42:59.019974 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m20:42:59.222820 [debug] [Thread-1 (]: SQL status: OK in 0.202 seconds
[0m20:42:59.232372 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:42:59.232615 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__718c3771ced6" cascade
    
[0m20:42:59.470792 [debug] [Thread-1 (]: SQL status: OK in 0.238 seconds
[0m20:42:59.472737 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:42:59.472918 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__718c3771ced6" cascade
    
[0m20:42:59.582413 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m20:42:59.587809 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: Close
[0m20:42:59.589825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaf5b9bb-160f-4f7f-820c-b6be33292e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1140e0>]}
[0m20:42:59.590661 [info ] [Thread-1 (]: 8 of 10 OK created sql incremental model main.int_reunions ..................... [[32mOK[0m in 2.28s]
[0m20:42:59.591187 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_reunions
[0m20:42:59.591539 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins
[0m20:42:59.592075 [info ] [Thread-1 (]: 9 of 10 START sql incremental model main.int_scrutins .......................... [RUN]
[0m20:42:59.592554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_reunions, now model.dbt_an_data.int_scrutins)
[0m20:42:59.592905 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins
[0m20:42:59.600498 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins"
[0m20:42:59.601231 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins
[0m20:42:59.604076 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:42:59.604333 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__81094e855336" cascade
    
[0m20:42:59.604568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:42:59.718619 [debug] [Thread-1 (]: SQL status: OK in 0.114 seconds
[0m20:42:59.723108 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:42:59.723668 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:42:59.725453 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:42:59.727181 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:42:59.727674 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m20:42:59.728428 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:42:59.728662 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:42:59.728850 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:42:59.840822 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m20:42:59.844646 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:42:59.845678 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    

  
[0m20:42:59.846808 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:42:59.849540 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m20:42:59.850280 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:42:59.850920 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m20:42:59.958100 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m20:42:59.958641 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:42:59.958839 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_scrutins__81094e855336"
  
    as (
      

with __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
) SELECT
date_T_insert,
json_extract_string(json, '$.scrutin.uid') AS uid,
json_extract_string(json, '$.scrutin.numero') AS numero,
json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
json_extract_string(json, '$.scrutin.legislature') AS legislature,
json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
json_extract_string(json, '$.scrutin.titre') AS titre,
json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote,
date_T_insert
FROM __dbt__cte__stg_scrutins
    );
  
  
  
[0m20:43:01.786677 [debug] [Thread-1 (]: SQL status: OK in 1.826 seconds
[0m20:43:01.793615 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:43:01.793852 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m20:43:01.794495 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:43:01.794654 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:43:01.794808 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins__81094e855336'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:43:01.796732 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:43:01.798344 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:43:01.798513 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:43:01.799937 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:43:01.801528 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:43:01.801725 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:43:01.803349 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:43:01.806019 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins"
[0m20:43:01.806539 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:43:01.806713 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

        
            delete from "an_data_pipeline"."main"."int_scrutins"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_scrutins__81094e855336"
            );

        
    

    insert into "an_data_pipeline"."main"."int_scrutins" ("date_T_insert", "uid", "numero", "organeRef", "legislature", "date_scrutin", "titre", "resultat_code", "resultat_libelle", "nb_votants", "suffrages_exprimes", "seuil", "lieu_vote")
    (
        select "date_T_insert", "uid", "numero", "organeRef", "legislature", "date_scrutin", "titre", "resultat_code", "resultat_libelle", "nb_votants", "suffrages_exprimes", "seuil", "lieu_vote"
        from "an_data_pipeline"."dbt_temp"."int_scrutins__81094e855336"
    )
  
[0m20:43:02.036106 [debug] [Thread-1 (]: SQL status: OK in 0.229 seconds
[0m20:43:02.038553 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m20:43:02.039133 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:43:02.040001 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m20:43:02.208858 [debug] [Thread-1 (]: SQL status: OK in 0.168 seconds
[0m20:43:02.210369 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:43:02.210636 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__81094e855336" cascade
    
[0m20:43:04.885190 [debug] [Thread-1 (]: SQL status: OK in 2.674 seconds
[0m20:43:04.892530 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:43:04.893339 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__81094e855336" cascade
    
[0m20:43:05.003858 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m20:43:05.006631 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: Close
[0m20:43:05.007935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaf5b9bb-160f-4f7f-820c-b6be33292e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c19a900>]}
[0m20:43:05.009034 [info ] [Thread-1 (]: 9 of 10 OK created sql incremental model main.int_scrutins ..................... [[32mOK[0m in 5.41s]
[0m20:43:05.010585 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins
[0m20:43:05.011606 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins_votes
[0m20:43:05.013058 [info ] [Thread-1 (]: 10 of 10 START sql incremental model main.int_scrutins_votes ................... [RUN]
[0m20:43:05.014172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_scrutins, now model.dbt_an_data.int_scrutins_votes)
[0m20:43:05.014994 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins_votes
[0m20:43:05.046334 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins_votes"
[0m20:43:05.047110 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins_votes
[0m20:43:05.049474 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:43:05.049775 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__23a7d403cd12" cascade
    
[0m20:43:05.050020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:43:05.160685 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m20:43:05.165818 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:43:05.166469 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:43:05.169090 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:43:05.171647 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:43:05.172325 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m20:43:05.173677 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:43:05.174243 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:43:05.174682 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:43:05.284080 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m20:43:05.287111 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:43:05.287823 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    

  
[0m20:43:05.288626 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:43:05.290745 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m20:43:05.291416 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:43:05.292054 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m20:43:05.398393 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m20:43:05.400972 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:43:05.402655 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_scrutins_votes__23a7d403cd12"
  
    as (
      

WITH  __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
), grp AS (
      -- explode les groupes (1 par groupe)
    SELECT
        json_extract_string(j.json, '$.scrutin.uid') AS uid,
        json_extract_string(g.value, '$.organeRef') AS groupe_organe,
        g.value AS groupe_json,
        date_T_insert
    FROM __dbt__cte__stg_scrutins j,
    json_each(json->'scrutin'->'ventilationVotes'->'organe'->'groupes'->'groupe') g
  ),

  positions_array AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,,
          date_T_insert
          groupe_organe,
          'pour' AS type_vote,
          p.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'pours'->'votant') p
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,,
          date_T_insert
          groupe_organe,
          'contre' AS type_vote,
          c.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'contres'->'votant') c
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,,
          date_T_insert
          groupe_organe,
          'abstention' AS type_vote,
          a.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'abstentions'->'votant') a
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,,
          date_T_insert
          groupe_organe,
          'nonVotant' AS type_vote,
          n.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'nonVotants'->'votant') n
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[ARRAY]'
  ),
  positions_object AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[OBJECT]'
  ),

  clean AS (
      -- sécurise les champs (souvent string ou null)
      SELECT
          uid,
          groupe_organe,
          type_vote,
          json_extract_string(vote_json, '$.acteurRef') AS acteurRef,
          json_extract_string(vote_json, '$.mandatRef') AS mandatRef,
          json_extract_string(vote_json, '$.parDelegation') AS parDelegation,
          json_extract_string(vote_json, '$.numPlace') AS numPlace,
          json_extract_string(vote_json, '$.causePositionVote') AS cause,
          date_T_insert
      FROM positions_array
      UNION ALL
      SELECT * 
      FROM positions_object
  )

  SELECT * FROM clean
    );
  
  
  
[0m20:43:05.459629 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_scrutins_votes__23a7d403cd12"
  
    as (
      

WITH  __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
), grp AS (
      -- explode les groupes (1 par groupe)
    SELECT
        json_extract_string(j.json, '$.scrutin.uid') AS uid,
        json_extract_string(g.value, '$.organeRef') AS groupe_organe,
        g.value AS groupe_json,
        date_T_insert
    FROM __dbt__cte__stg_scrutins j,
    json_each(json->'scrutin'->'ventilationVotes'->'organe'->'groupes'->'groupe') g
  ),

  positions_array AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,,
          date_T_insert
          groupe_organe,
          'pour' AS type_vote,
          p.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'pours'->'votant') p
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,,
          date_T_insert
          groupe_organe,
          'contre' AS type_vote,
          c.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'contres'->'votant') c
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,,
          date_T_insert
          groupe_organe,
          'abstention' AS type_vote,
          a.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'abstentions'->'votant') a
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,,
          date_T_insert
          groupe_organe,
          'nonVotant' AS type_vote,
          n.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'nonVotants'->'votant') n
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[ARRAY]'
  ),
  positions_object AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[OBJECT]'
  ),

  clean AS (
      -- sécurise les champs (souvent string ou null)
      SELECT
          uid,
          groupe_organe,
          type_vote,
          json_extract_string(vote_json, '$.acteurRef') AS acteurRef,
          json_extract_string(vote_json, '$.mandatRef') AS mandatRef,
          json_extract_string(vote_json, '$.parDelegation') AS parDelegation,
          json_extract_string(vote_json, '$.numPlace') AS numPlace,
          json_extract_string(vote_json, '$.causePositionVote') AS cause,
          date_T_insert
      FROM positions_array
      UNION ALL
      SELECT * 
      FROM positions_object
  )

  SELECT * FROM clean
    );
  
  
  
[0m20:43:05.460492 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:43:05.462912 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:43:05.463206 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__23a7d403cd12" cascade
    
[0m20:43:05.577467 [debug] [Thread-1 (]: SQL status: OK in 0.114 seconds
[0m20:43:05.580209 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: Close
[0m20:43:05.602453 [debug] [Thread-1 (]: Runtime Error in model int_scrutins_votes (models/int/int_scrutins_votes.sql)
  Parser Error: syntax error at or near ","
  
  LINE 31:           uid,,
                         ^
[0m20:43:05.603490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaf5b9bb-160f-4f7f-820c-b6be33292e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c123f80>]}
[0m20:43:05.604325 [error] [Thread-1 (]: 10 of 10 ERROR creating sql incremental model main.int_scrutins_votes .......... [[31mERROR[0m in 0.59s]
[0m20:43:05.604974 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins_votes
[0m20:43:05.606000 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.int_scrutins_votes' to be skipped because of status 'error'.  Reason: Runtime Error in model int_scrutins_votes (models/int/int_scrutins_votes.sql)
  Parser Error: syntax error at or near ","
  
  LINE 31:           uid,,
                         ^.
[0m20:43:05.611625 [debug] [MainThread]: Using duckdb connection "master"
[0m20:43:05.611979 [debug] [MainThread]: On master: BEGIN
[0m20:43:05.612262 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:43:05.613441 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:43:05.613706 [debug] [MainThread]: On master: COMMIT
[0m20:43:05.613951 [debug] [MainThread]: Using duckdb connection "master"
[0m20:43:05.614184 [debug] [MainThread]: On master: COMMIT
[0m20:43:05.614607 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:43:05.614849 [debug] [MainThread]: On master: Close
[0m20:43:05.615173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:43:05.615409 [debug] [MainThread]: Connection 'model.dbt_an_data.int_scrutins_votes' was properly closed.
[0m20:43:05.615826 [info ] [MainThread]: 
[0m20:43:05.616127 [info ] [MainThread]: Finished running 10 incremental models, 1 project hook in 0 hours 0 minutes and 23.09 seconds (23.09s).
[0m20:43:05.617965 [debug] [MainThread]: Command end result
[0m20:43:05.642496 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m20:43:05.647169 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m20:43:05.652230 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m20:43:05.652421 [info ] [MainThread]: 
[0m20:43:05.652618 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:43:05.652779 [info ] [MainThread]: 
[0m20:43:05.652992 [error] [MainThread]: [31mFailure in model int_scrutins_votes (models/int/int_scrutins_votes.sql)[0m
[0m20:43:05.653166 [error] [MainThread]:   Runtime Error in model int_scrutins_votes (models/int/int_scrutins_votes.sql)
  Parser Error: syntax error at or near ","
  
  LINE 31:           uid,,
                         ^
[0m20:43:05.653297 [info ] [MainThread]: 
[0m20:43:05.653451 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/int/int_scrutins_votes.sql
[0m20:43:05.653584 [info ] [MainThread]: 
[0m20:43:05.657006 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=11
[0m20:43:05.658157 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 23.774954, "process_in_blocks": "0", "process_kernel_time": 1.876602, "process_mem_max_rss": "777207808", "process_out_blocks": "0", "process_user_time": 8.432875}
[0m20:43:05.659012 [debug] [MainThread]: Command `dbt build` failed at 20:43:05.658960 after 23.78 seconds
[0m20:43:05.659465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10955b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10955b3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10955b380>]}
[0m20:43:05.659696 [debug] [MainThread]: Flushing usage events
[0m20:43:06.197107 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:46:01.027818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8f3ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa5b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa5afc0>]}


============================== 20:46:01.031205 | 6141e386-82be-4d6a-b5b1-488fc489bed1 ==============================
[0m20:46:01.031205 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:46:01.031523 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'log_cache_events': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'target_path': 'None', 'write_json': 'True', 'debug': 'False', 'introspect': 'True', 'version_check': 'True', 'log_format': 'default', 'static_parser': 'True', 'printer_width': '80', 'warn_error': 'None', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs'}
[0m20:46:01.216430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6141e386-82be-4d6a-b5b1-488fc489bed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10584b110>]}
[0m20:46:01.243447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6141e386-82be-4d6a-b5b1-488fc489bed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac87c20>]}
[0m20:46:01.244749 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:46:01.301995 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:46:01.371895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:46:01.372233 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_scrutins_votes.sql
[0m20:46:01.481783 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_an_data.mart
[0m20:46:01.487708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6141e386-82be-4d6a-b5b1-488fc489bed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10baf2b10>]}
[0m20:46:01.525195 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m20:46:01.526695 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m20:46:01.540032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6141e386-82be-4d6a-b5b1-488fc489bed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba93aa0>]}
[0m20:46:01.540298 [info ] [MainThread]: Found 17 models, 1 operation, 9 sources, 469 macros
[0m20:46:01.540452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6141e386-82be-4d6a-b5b1-488fc489bed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b873560>]}
[0m20:46:01.541484 [info ] [MainThread]: 
[0m20:46:01.541654 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m20:46:01.541776 [info ] [MainThread]: 
[0m20:46:01.541992 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:46:01.544237 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_an_data_pipeline'
[0m20:46:01.631610 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline"
[0m20:46:01.631841 [debug] [ThreadPool]: On list_an_data_pipeline: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"an_data_pipeline"'
    
  
  
[0m20:46:01.631979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:03.514090 [debug] [ThreadPool]: SQL status: OK in 1.882 seconds
[0m20:46:03.517726 [debug] [ThreadPool]: On list_an_data_pipeline: Close
[0m20:46:03.519110 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_an_data_pipeline, now create_an_data_pipeline_main)
[0m20:46:03.519749 [debug] [ThreadPool]: Creating schema "database: "an_data_pipeline"
schema: "main"
"
[0m20:46:03.530937 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m20:46:03.531544 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:46:03.531941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:46:03.534246 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:46:03.535931 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m20:46:03.536287 [debug] [ThreadPool]: On create_an_data_pipeline_main: BEGIN
[0m20:46:03.537109 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:46:03.537401 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m20:46:03.537699 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
    
        create schema if not exists "an_data_pipeline"."main"
    
[0m20:46:03.646845 [debug] [ThreadPool]: SQL status: OK in 0.109 seconds
[0m20:46:03.649923 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m20:46:03.650844 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m20:46:03.651642 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m20:46:03.756834 [debug] [ThreadPool]: SQL status: OK in 0.105 seconds
[0m20:46:03.757103 [debug] [ThreadPool]: On create_an_data_pipeline_main: Close
[0m20:46:03.758002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_an_data_pipeline_main, now list_an_data_pipeline_main)
[0m20:46:03.760677 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m20:46:03.760844 [debug] [ThreadPool]: On list_an_data_pipeline_main: BEGIN
[0m20:46:03.760965 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:46:03.761391 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:46:03.761514 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m20:46:03.761638 [debug] [ThreadPool]: On list_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline_main"} */
select
      'an_data_pipeline' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'an_data_pipeline'
  
[0m20:46:03.771886 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m20:46:03.772685 [debug] [ThreadPool]: On list_an_data_pipeline_main: ROLLBACK
[0m20:46:03.773761 [debug] [ThreadPool]: Failed to rollback 'list_an_data_pipeline_main'
[0m20:46:03.773929 [debug] [ThreadPool]: On list_an_data_pipeline_main: Close
[0m20:46:03.774795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6141e386-82be-4d6a-b5b1-488fc489bed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9af320>]}
[0m20:46:03.775037 [debug] [MainThread]: Using duckdb connection "master"
[0m20:46:03.775164 [debug] [MainThread]: On master: BEGIN
[0m20:46:03.775275 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:46:03.775701 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:46:03.775831 [debug] [MainThread]: On master: COMMIT
[0m20:46:03.775951 [debug] [MainThread]: Using duckdb connection "master"
[0m20:46:03.776060 [debug] [MainThread]: On master: COMMIT
[0m20:46:03.776265 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:46:03.779572 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_an_data.dbt_an_data-on-run-start-0"
[0m20:46:03.782125 [info ] [MainThread]: 1 of 1 START hook: dbt_an_data.on-run-start.0 .................................. [RUN]
[0m20:46:03.782348 [debug] [MainThread]: Using duckdb connection "master"
[0m20:46:03.782500 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "master"} */
ATTACH '../data/database/database.duckdb' AS database (READ_ONLY)
[0m20:46:03.790087 [debug] [MainThread]: SQL status: OK in 0.007 seconds
[0m20:46:03.790627 [info ] [MainThread]: 1 of 1 OK hook: dbt_an_data.on-run-start.0 ..................................... [[32mOK[0m in 0.01s]
[0m20:46:03.790788 [info ] [MainThread]: 
[0m20:46:03.790927 [debug] [MainThread]: On master: Close
[0m20:46:03.792323 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_acteurs
[0m20:46:03.792518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_an_data_pipeline_main, now model.dbt_an_data.stg_acteurs)
[0m20:46:03.792668 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_acteurs
[0m20:46:03.794063 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_acteurs"
[0m20:46:03.794860 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_acteurs
[0m20:46:03.795034 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_agenda
[0m20:46:03.795225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_acteurs, now model.dbt_an_data.stg_agenda)
[0m20:46:03.795443 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_agenda
[0m20:46:03.796520 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_agenda"
[0m20:46:03.797086 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_agenda
[0m20:46:03.797248 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_amendements
[0m20:46:03.797505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_agenda, now model.dbt_an_data.stg_amendements)
[0m20:46:03.797668 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_amendements
[0m20:46:03.798698 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_amendements"
[0m20:46:03.799178 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_amendements
[0m20:46:03.799335 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_organes
[0m20:46:03.799496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_amendements, now model.dbt_an_data.stg_organes)
[0m20:46:03.799749 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_organes
[0m20:46:03.800760 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_organes"
[0m20:46:03.801101 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_organes
[0m20:46:03.801263 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_pays
[0m20:46:03.801532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_organes, now model.dbt_an_data.stg_pays)
[0m20:46:03.801705 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_pays
[0m20:46:03.802745 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_pays"
[0m20:46:03.803217 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_pays
[0m20:46:03.803382 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_reunions
[0m20:46:03.803546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_pays, now model.dbt_an_data.stg_reunions)
[0m20:46:03.803805 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_reunions
[0m20:46:03.804911 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_reunions"
[0m20:46:03.805376 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_reunions
[0m20:46:03.805556 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_scrutins
[0m20:46:03.805771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_reunions, now model.dbt_an_data.stg_scrutins)
[0m20:46:03.806882 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_scrutins
[0m20:46:03.808089 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_scrutins"
[0m20:46:03.808674 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_scrutins
[0m20:46:03.808858 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_acteurs
[0m20:46:03.809103 [info ] [Thread-1 (]: 1 of 10 START sql incremental model main.int_acteurs ........................... [RUN]
[0m20:46:03.841729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_scrutins, now model.dbt_an_data.int_acteurs)
[0m20:46:03.841949 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_acteurs
[0m20:46:03.846267 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_acteurs"
[0m20:46:03.846674 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_acteurs
[0m20:46:03.850130 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:46:03.850311 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__016e77f3d702" cascade
    
[0m20:46:03.850456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:03.956242 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m20:46:03.986884 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:46:03.987158 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:46:03.988018 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:46:03.988794 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:46:03.988984 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m20:46:03.989411 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:46:03.989582 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:46:03.989753 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:46:04.094791 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m20:46:04.096443 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:46:04.096881 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    

  
[0m20:46:04.097323 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:46:04.098581 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m20:46:04.098961 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:46:04.099301 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m20:46:04.203183 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m20:46:04.231137 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:46:04.232012 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_acteurs__016e77f3d702"
  
    as (
      

with __dbt__cte__stg_acteurs as (
SELECT * 
FROM "database"."stg"."raw_acteurs"
) SELECT 
json_extract_string(json, '$.acteur.uid.#text') as uid,
json_extract_string(json, '$.acteur.etatCivil.ident.civ') as civ,
json_extract_string(json, '$.acteur.etatCivil.ident.prenom') as prenom,
json_extract_string(json, '$.acteur.etatCivil.ident.nom') as nom,
json_extract_string(json, '$.acteur.etatCivil.ident.trigramme') as trigramme,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.dateNais') as dateNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.villeNais') as villeNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.depNais') as depNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.paysNais') as paysNais,
json_extract_string(json, '$.acteur.etatCivil.dateDeces') as dateDeces,
json_extract_string(json, '$.acteur.profession.libelleCourant') as libelleCourant,
json_extract_string(json, '$.acteur.profession.socProcINSEE.catSocPro') as catSocPro,
json_extract_string(json, '$.acteur.profession.socProcINSEE.famSocPro') as famSocPro,
json_extract_string(json, '$.acteur.uri_hatvp') as uri_hatvp,
date_T_insert
FROM __dbt__cte__stg_acteurs
    );
  
  
  
[0m20:46:04.920417 [debug] [Thread-1 (]: SQL status: OK in 0.688 seconds
[0m20:46:04.932738 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:46:04.933464 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m20:46:04.935154 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:46:04.935652 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:46:04.936110 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs__016e77f3d702'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:46:04.944359 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:46:04.950104 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:46:04.950524 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:46:04.953494 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:46:04.962726 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:46:04.963074 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:46:04.965551 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:46:04.966780 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:46:04.967046 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */
SELECT version()
[0m20:46:04.967482 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:46:04.977045 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_acteurs"
[0m20:46:04.977863 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:46:04.978114 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

        
            delete from "an_data_pipeline"."main"."int_acteurs"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_acteurs__016e77f3d702"
            );

        
    

    insert into "an_data_pipeline"."main"."int_acteurs" ("uid", "civ", "prenom", "nom", "trigramme", "dateNais", "villeNais", "depNais", "paysNais", "dateDeces", "libelleCourant", "catSocPro", "famSocPro", "uri_hatvp")
    (
        select "uid", "civ", "prenom", "nom", "trigramme", "dateNais", "villeNais", "depNais", "paysNais", "dateDeces", "libelleCourant", "catSocPro", "famSocPro", "uri_hatvp"
        from "an_data_pipeline"."dbt_temp"."int_acteurs__016e77f3d702"
    )
  
[0m20:46:05.201161 [debug] [Thread-1 (]: SQL status: OK in 0.223 seconds
[0m20:46:05.225097 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m20:46:05.225888 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:46:05.226407 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m20:46:05.356353 [debug] [Thread-1 (]: SQL status: OK in 0.129 seconds
[0m20:46:05.362251 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:46:05.363090 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__016e77f3d702" cascade
    
[0m20:46:05.581021 [debug] [Thread-1 (]: SQL status: OK in 0.217 seconds
[0m20:46:05.582756 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:46:05.582933 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__016e77f3d702" cascade
    
[0m20:46:05.688474 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m20:46:05.690916 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: Close
[0m20:46:05.693779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6141e386-82be-4d6a-b5b1-488fc489bed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adb5d00>]}
[0m20:46:05.694332 [info ] [Thread-1 (]: 1 of 10 OK created sql incremental model main.int_acteurs ...................... [[32mOK[0m in 1.85s]
[0m20:46:05.694794 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_acteurs
[0m20:46:05.695119 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_mandats
[0m20:46:05.695640 [info ] [Thread-1 (]: 2 of 10 START sql incremental model main.int_mandats ........................... [RUN]
[0m20:46:05.695982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_acteurs, now model.dbt_an_data.int_mandats)
[0m20:46:05.696252 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_mandats
[0m20:46:05.703127 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_mandats"
[0m20:46:05.703702 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_mandats
[0m20:46:05.706511 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:46:05.706771 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__e20724c0d8fc" cascade
    
[0m20:46:05.707003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:05.812112 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m20:46:05.817039 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:46:05.817864 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:46:05.820059 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:46:05.822025 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:46:05.822514 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m20:46:05.823597 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:46:05.824023 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:46:05.824441 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:46:05.932849 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m20:46:05.936472 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:46:05.937397 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    

  
[0m20:46:05.938223 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:46:05.940730 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m20:46:05.941613 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:46:05.942300 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m20:46:06.049805 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m20:46:06.050318 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:46:06.050511 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_mandats__e20724c0d8fc"
  
    as (
      

with __dbt__cte__stg_acteurs as (
SELECT * 
FROM "database"."stg"."raw_acteurs"
) SELECT 
json_extract_string(mandat.value, '$.uid') as uid,
json_extract_string(mandat.value, '$.acteurRef') as acteurRef,
json_extract_string(mandat.value, '$.legislature') as legislature,
json_extract_string(mandat.value, '$.typeOrgane') as typeOrgane,
json_extract_string(mandat.value, '$.dateDebut') as dateDebut,
json_extract_string(mandat.value, '$.dateFin') as dateFin,
json_extract_string(mandat.value, '$.preseance') as preseance,
json_extract_string(mandat.value, '$.nominPrincipale') as nominPrincipale,
json_extract_string(mandat.value, '$.infosQualite.codeQualite') as codeQualite,
json_extract_string(mandat.value, '$.organes.organeRef') as organeRef,
date_T_insert
FROM __dbt__cte__stg_acteurs act, json_each(json->'acteur'->'mandats'->'mandat') mandat
    );
  
  
  
[0m20:46:07.164284 [debug] [Thread-1 (]: SQL status: OK in 1.108 seconds
[0m20:46:07.185689 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:46:07.186215 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m20:46:07.187587 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:46:07.187906 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:46:07.188236 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats__e20724c0d8fc'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:46:07.191939 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:46:07.195153 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:46:07.195473 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:46:07.197905 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:46:07.200618 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:46:07.200930 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:46:07.203364 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:46:07.205575 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_mandats"
[0m20:46:07.206463 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:46:07.206742 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

        
            delete from "an_data_pipeline"."main"."int_mandats"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_mandats__e20724c0d8fc"
            );

        
    

    insert into "an_data_pipeline"."main"."int_mandats" ("uid", "acteurRef", "legislature", "typeOrgane", "dateDebut", "dateFin", "preseance", "nominPrincipale", "codeQualite", "organeRef")
    (
        select "uid", "acteurRef", "legislature", "typeOrgane", "dateDebut", "dateFin", "preseance", "nominPrincipale", "codeQualite", "organeRef"
        from "an_data_pipeline"."dbt_temp"."int_mandats__e20724c0d8fc"
    )
  
[0m20:46:07.480299 [debug] [Thread-1 (]: SQL status: OK in 0.273 seconds
[0m20:46:07.484107 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m20:46:07.485157 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:46:07.486021 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m20:46:07.681951 [debug] [Thread-1 (]: SQL status: OK in 0.195 seconds
[0m20:46:07.683528 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:46:07.683710 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__e20724c0d8fc" cascade
    
[0m20:46:07.900686 [debug] [Thread-1 (]: SQL status: OK in 0.217 seconds
[0m20:46:07.907477 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:46:07.907676 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__e20724c0d8fc" cascade
    
[0m20:46:08.012568 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m20:46:08.014297 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: Close
[0m20:46:08.015350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6141e386-82be-4d6a-b5b1-488fc489bed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd387d0>]}
[0m20:46:08.016159 [info ] [Thread-1 (]: 2 of 10 OK created sql incremental model main.int_mandats ...................... [[32mOK[0m in 2.32s]
[0m20:46:08.016675 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_mandats
[0m20:46:08.017030 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_agenda
[0m20:46:08.017655 [info ] [Thread-1 (]: 3 of 10 START sql incremental model main.int_agenda ............................ [RUN]
[0m20:46:08.018082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_mandats, now model.dbt_an_data.int_agenda)
[0m20:46:08.018379 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_agenda
[0m20:46:08.022225 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_agenda"
[0m20:46:08.023229 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_agenda
[0m20:46:08.026505 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:46:08.026786 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__9aac6567b7a1" cascade
    
[0m20:46:08.027200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:08.137729 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m20:46:08.143595 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:46:08.144284 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:46:08.146962 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:46:08.149518 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:46:08.150030 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m20:46:08.151145 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:46:08.151583 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:46:08.152026 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:46:08.260237 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m20:46:08.263612 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:46:08.264639 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    

  
[0m20:46:08.265872 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:46:08.268705 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m20:46:08.269505 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:46:08.270201 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m20:46:08.372624 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m20:46:08.373164 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:46:08.373450 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_agenda__9aac6567b7a1"
  
    as (
      

with __dbt__cte__stg_agenda as (
SELECT * 
FROM "database"."stg"."raw_agenda"
) SELECT * 
FROM __dbt__cte__stg_agenda
    );
  
  
  
[0m20:46:08.709471 [debug] [Thread-1 (]: SQL status: OK in 0.336 seconds
[0m20:46:08.713630 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:46:08.714387 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m20:46:08.716055 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:46:08.716666 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:46:08.717189 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda__9aac6567b7a1'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:46:08.721588 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:46:08.725275 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:46:08.725740 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:46:08.728660 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:46:08.731574 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:46:08.731934 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:46:08.734566 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:46:08.736313 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_agenda"
[0m20:46:08.738045 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:46:08.738369 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

        
            delete from "an_data_pipeline"."main"."int_agenda" as DBT_INCREMENTAL_TARGET
            using "an_data_pipeline"."dbt_temp"."int_agenda__9aac6567b7a1"
            where (
                
                    "an_data_pipeline"."dbt_temp"."int_agenda__9aac6567b7a1".Date = DBT_INCREMENTAL_TARGET.Date
                    and 
                
                    "an_data_pipeline"."dbt_temp"."int_agenda__9aac6567b7a1".Heure = DBT_INCREMENTAL_TARGET.Heure
                    
                
                
            );
        
    

    insert into "an_data_pipeline"."main"."int_agenda" ("Date", "Heure", "Ordre(s) du jour", "filename", "date_T_insert")
    (
        select "Date", "Heure", "Ordre(s) du jour", "filename", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_agenda__9aac6567b7a1"
    )
  
[0m20:46:08.967361 [debug] [Thread-1 (]: SQL status: OK in 0.228 seconds
[0m20:46:08.971907 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m20:46:08.972971 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:46:08.973966 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m20:46:09.091751 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m20:46:09.099125 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:46:09.100126 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__9aac6567b7a1" cascade
    
[0m20:46:09.333148 [debug] [Thread-1 (]: SQL status: OK in 0.232 seconds
[0m20:46:09.341548 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:46:09.342428 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__9aac6567b7a1" cascade
    
[0m20:46:09.453602 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m20:46:09.457688 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: Close
[0m20:46:09.459176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6141e386-82be-4d6a-b5b1-488fc489bed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd380e0>]}
[0m20:46:09.460546 [info ] [Thread-1 (]: 3 of 10 OK created sql incremental model main.int_agenda ....................... [[32mOK[0m in 1.44s]
[0m20:46:09.461730 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_agenda
[0m20:46:09.462597 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements
[0m20:46:09.463612 [info ] [Thread-1 (]: 4 of 10 START sql incremental model main.int_amendements ....................... [RUN]
[0m20:46:09.464417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_agenda, now model.dbt_an_data.int_amendements)
[0m20:46:09.465023 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements
[0m20:46:09.490432 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements"
[0m20:46:09.492275 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements
[0m20:46:09.498243 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:46:09.498611 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__5b0909f154d3" cascade
    
[0m20:46:09.498920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:09.607875 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m20:46:09.614867 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:46:09.615706 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:46:09.618642 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:46:09.621075 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:46:09.621678 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m20:46:09.623205 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:46:09.624056 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:46:09.624835 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:46:09.732584 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m20:46:09.736843 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:46:09.737848 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    

  
[0m20:46:09.739103 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:46:09.742139 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m20:46:09.742992 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:46:09.743666 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m20:46:09.852179 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m20:46:09.852727 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:46:09.852971 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_amendements__5b0909f154d3"
  
    as (
      

with __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
) SELECT
json_extract_string(json, '$.amendement.uid') AS uid,
json_extract_string(json, '$.amendement.chronotag') AS chronotag,
json_extract_string(json, '$.amendement.examenRef') AS examenRef,
json_extract_string(json, '$.amendement.amendementParentRef') AS amendementParentRef,
json_extract_string(json, '$.amendement.signataires.auteur.typeAuteur') AS typeAuteur,
json_extract_string(json, '$.amendement.signataires.auteur.acteurRef') AS refAuteur,
json_extract_string(json, '$.amendement.signataires.auteur.groupePolitique') AS groupePolitiqueAuteur,
json_extract_string(json, '$.amendement.cycleDeVie.dateDepot') AS dateDepot,
json_extract_string(json, '$.amendement.cycleDeVie.datePublication') AS datePublication,
json_extract_string(json, '$.amendement.cycleDeVie.soumisArticle40') AS soumisArticle40,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.code') AS codeEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.libelle') AS libelleEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.code') AS codeSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.dateSort') AS dateSort,
json_extract_string(json, '$.amendement.cycleDeVie.sort') AS sort,
split_part(replace(filename, '.json', ''), '/', -1) AS id_amendement,
split_part(replace(filename, '.json', ''), '/', -2) AS id_texte,
split_part(replace(filename, '.json', ''), '/', -3) AS id_dossier_legislatif,
id_texte[:4] AS nature_texte,
id_texte[5:6] AS source_texte,
regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 1) AS prefix_bibard,
regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 2) AS numero_bibard,
regexp_extract(id_amendement, '(SEA|PO\d*)', 1) AS code_organe,
regexp_extract(id_amendement, '(P)(\d*)(D)', 2) AS numero_partie,
regexp_extract(id_amendement, '(D)(\d*)(N)', 2) AS numero_deliberation,
regexp_extract(id_amendement, '(D)(\d*)(N)(\d*)', 4) AS numero_court,
date_T_insert
from __dbt__cte__stg_amendements
    );
  
  
  
[0m20:46:10.212280 [debug] [Thread-1 (]: SQL status: OK in 0.359 seconds
[0m20:46:10.215891 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:46:10.216305 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m20:46:10.217320 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:46:10.217649 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:46:10.217979 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements__5b0909f154d3'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:46:10.221405 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:46:10.224627 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:46:10.224947 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:46:10.227788 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:46:10.230617 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:46:10.230920 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:46:10.233281 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:46:10.235227 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements"
[0m20:46:10.235882 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:46:10.236168 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

        
            delete from "an_data_pipeline"."main"."int_amendements"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_amendements__5b0909f154d3"
            );

        
    

    insert into "an_data_pipeline"."main"."int_amendements" ("uid", "chronotag", "examenRef", "amendementParentRef", "typeAuteur", "refAuteur", "groupePolitiqueAuteur", "dateDepot", "datePublication", "soumisArticle40", "codeEtat", "libelleEtat", "codeSousEtat", "libelleSousEtat", "libelleSousEtat_1", "dateSort", "sort", "id_amendement", "id_texte", "id_dossier_legislatif", "nature_texte", "source_texte", "prefix_bibard", "numero_bibard", "code_organe", "numero_partie", "numero_deliberation", "numero_court")
    (
        select "uid", "chronotag", "examenRef", "amendementParentRef", "typeAuteur", "refAuteur", "groupePolitiqueAuteur", "dateDepot", "datePublication", "soumisArticle40", "codeEtat", "libelleEtat", "codeSousEtat", "libelleSousEtat", "libelleSousEtat_1", "dateSort", "sort", "id_amendement", "id_texte", "id_dossier_legislatif", "nature_texte", "source_texte", "prefix_bibard", "numero_bibard", "code_organe", "numero_partie", "numero_deliberation", "numero_court"
        from "an_data_pipeline"."dbt_temp"."int_amendements__5b0909f154d3"
    )
  
[0m20:46:10.468888 [debug] [Thread-1 (]: SQL status: OK in 0.232 seconds
[0m20:46:10.472252 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m20:46:10.472868 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:46:10.473301 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m20:46:10.580716 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m20:46:10.584255 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:46:10.584824 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__5b0909f154d3" cascade
    
[0m20:46:10.823606 [debug] [Thread-1 (]: SQL status: OK in 0.238 seconds
[0m20:46:10.832463 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:46:10.833401 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__5b0909f154d3" cascade
    
[0m20:46:10.945549 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m20:46:10.949310 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: Close
[0m20:46:10.950825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6141e386-82be-4d6a-b5b1-488fc489bed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd09c40>]}
[0m20:46:10.952191 [info ] [Thread-1 (]: 4 of 10 OK created sql incremental model main.int_amendements .................. [[32mOK[0m in 1.49s]
[0m20:46:10.953384 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements
[0m20:46:10.954224 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements_cosignataires
[0m20:46:10.955241 [info ] [Thread-1 (]: 5 of 10 START sql incremental model main.int_amendements_cosignataires ......... [RUN]
[0m20:46:10.956550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements, now model.dbt_an_data.int_amendements_cosignataires)
[0m20:46:10.957523 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements_cosignataires
[0m20:46:10.972423 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements_cosignataires"
[0m20:46:10.973876 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements_cosignataires
[0m20:46:10.978704 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:46:10.979139 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__bab283a41edf" cascade
    
[0m20:46:10.979506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:11.093317 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m20:46:11.106199 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:46:11.107273 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:46:11.110255 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:46:11.113041 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:46:11.113757 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m20:46:11.115412 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:46:11.115968 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:46:11.116404 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:46:11.228088 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m20:46:11.232210 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:46:11.233485 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    

  
[0m20:46:11.234687 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:46:11.237474 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m20:46:11.238319 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:46:11.239016 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m20:46:11.343731 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m20:46:11.346748 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:46:11.347962 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__bab283a41edf"
  
    as (
      

WITH  __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
), cosignataires_arr AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef[*]') AS acteurRef,
    date_T_insert
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') == 'ARRAY' AND acteurRef IS NOT NULL
), cosignataires_str AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef') AS acteurRef,
    date_T_insert
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') <> 'ARRAY' AND acteurRef IS NOT NULL
)
SELECT 
  uid, 
  unnest(acteurRef) as acteurRef,
  date_T_insert
FROM cosignataires_arr
UNION ALL
SELECT 
  uid, 
  acteurRef,
  date_T_insert
FROM cosignataires_str
    );
  
  
  
[0m20:46:11.692071 [debug] [Thread-1 (]: SQL status: OK in 0.343 seconds
[0m20:46:11.696179 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:46:11.696589 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m20:46:11.697748 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:46:11.698107 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:46:11.698485 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires__bab283a41edf'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:46:11.702283 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:46:11.705419 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:46:11.705777 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:46:11.708498 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:46:11.711299 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:46:11.711657 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:46:11.714077 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:46:11.715616 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements_cosignataires"
[0m20:46:11.716373 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:46:11.716690 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

        
            delete from "an_data_pipeline"."main"."int_amendements_cosignataires" as DBT_INCREMENTAL_TARGET
            using "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__bab283a41edf"
            where (
                
                    "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__bab283a41edf".uid = DBT_INCREMENTAL_TARGET.uid
                    and 
                
                    "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__bab283a41edf".acteurRef = DBT_INCREMENTAL_TARGET.acteurRef
                    
                
                
            );
        
    

    insert into "an_data_pipeline"."main"."int_amendements_cosignataires" ("uid", "acteurRef")
    (
        select "uid", "acteurRef"
        from "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__bab283a41edf"
    )
  
[0m20:46:11.938804 [debug] [Thread-1 (]: SQL status: OK in 0.221 seconds
[0m20:46:11.944394 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m20:46:11.945322 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:46:11.946098 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m20:46:12.051738 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m20:46:12.059948 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:46:12.061127 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__bab283a41edf" cascade
    
[0m20:46:12.287270 [debug] [Thread-1 (]: SQL status: OK in 0.225 seconds
[0m20:46:12.288990 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:46:12.289182 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__bab283a41edf" cascade
    
[0m20:46:12.398426 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m20:46:12.399962 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: Close
[0m20:46:12.400513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6141e386-82be-4d6a-b5b1-488fc489bed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd2dd00>]}
[0m20:46:12.401108 [info ] [Thread-1 (]: 5 of 10 OK created sql incremental model main.int_amendements_cosignataires .... [[32mOK[0m in 1.44s]
[0m20:46:12.401605 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements_cosignataires
[0m20:46:12.401933 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_organes
[0m20:46:12.402360 [info ] [Thread-1 (]: 6 of 10 START sql incremental model main.int_organes ........................... [RUN]
[0m20:46:12.402764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements_cosignataires, now model.dbt_an_data.int_organes)
[0m20:46:12.403061 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_organes
[0m20:46:12.410471 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_organes"
[0m20:46:12.411072 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_organes
[0m20:46:12.413845 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:46:12.414124 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__c7ae2a69249e" cascade
    
[0m20:46:12.414356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:12.524955 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m20:46:12.530008 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:46:12.530693 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:46:12.533303 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:46:12.536066 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:46:12.536718 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m20:46:12.538171 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:46:12.538657 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:46:12.539091 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:46:12.644109 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m20:46:12.646621 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:46:12.647600 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    

  
[0m20:46:12.648688 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:46:12.651025 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m20:46:12.651778 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:46:12.652732 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m20:46:12.756368 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m20:46:12.757222 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:46:12.757436 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_organes__c7ae2a69249e"
  
    as (
      

with __dbt__cte__stg_organes as (
SELECT * 
FROM "database"."stg"."raw_organes"
) SELECT 
json_extract_string(json, '$.organe.uid') as uid,
json_extract_string(json, '$.organe.codeType') as codeType,
json_extract_string(json, '$.organe.libelle') as libelle,
json_extract_string(json, '$.organe.libelleEdition') as libelleEdition,
json_extract_string(json, '$.organe.libelleAbrege') as libelleAbrege,
json_extract_string(json, '$.organe.libelleAbrev') as libelleAbrev,
json_extract_string(json, '$.organe.viMoDe.dateDebut') as dateDebut,
json_extract_string(json, '$.organe.viMoDe.dateAgrement') as dateAgrement,
json_extract_string(json, '$.organe.viMoDe.dateFin') as dateFin,
json_extract_string(json, '$.organe.organeParent') as organeParent,
json_extract_string(json, '$.organe.chambre') as chambre,
json_extract_string(json, '$.organe.regime') as regime,
json_extract_string(json, '$.organe.legislature') as legislature,
date_T_insert
FROM __dbt__cte__stg_organes
    );
  
  
  
[0m20:46:13.296631 [debug] [Thread-1 (]: SQL status: OK in 0.539 seconds
[0m20:46:13.298377 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:46:13.298553 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m20:46:13.299045 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:46:13.299193 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:46:13.299345 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes__c7ae2a69249e'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:46:13.301121 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:46:13.303463 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:46:13.303643 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:46:13.305012 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:46:13.306398 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:46:13.306562 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:46:13.307906 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:46:13.308930 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_organes"
[0m20:46:13.310580 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:46:13.310782 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

        
            delete from "an_data_pipeline"."main"."int_organes"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_organes__c7ae2a69249e"
            );

        
    

    insert into "an_data_pipeline"."main"."int_organes" ("uid", "codeType", "libelle", "libelleEdition", "libelleAbrege", "libelleAbrev", "dateDebut", "dateAgrement", "dateFin", "organeParent", "chambre", "regime", "legislature")
    (
        select "uid", "codeType", "libelle", "libelleEdition", "libelleAbrege", "libelleAbrev", "dateDebut", "dateAgrement", "dateFin", "organeParent", "chambre", "regime", "legislature"
        from "an_data_pipeline"."dbt_temp"."int_organes__c7ae2a69249e"
    )
  
[0m20:46:13.555772 [debug] [Thread-1 (]: SQL status: OK in 0.244 seconds
[0m20:46:13.560011 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m20:46:13.560836 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:46:13.561530 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m20:46:13.741098 [debug] [Thread-1 (]: SQL status: OK in 0.178 seconds
[0m20:46:13.749320 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:46:13.750560 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__c7ae2a69249e" cascade
    
[0m20:46:13.978988 [debug] [Thread-1 (]: SQL status: OK in 0.228 seconds
[0m20:46:13.980623 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:46:13.980797 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__c7ae2a69249e" cascade
    
[0m20:46:14.086922 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m20:46:14.088416 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: Close
[0m20:46:14.088933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6141e386-82be-4d6a-b5b1-488fc489bed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd54920>]}
[0m20:46:14.089448 [info ] [Thread-1 (]: 6 of 10 OK created sql incremental model main.int_organes ...................... [[32mOK[0m in 1.69s]
[0m20:46:14.089893 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_organes
[0m20:46:14.090200 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_pays
[0m20:46:14.090600 [info ] [Thread-1 (]: 7 of 10 START sql incremental model main.int_pays .............................. [RUN]
[0m20:46:14.090979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_organes, now model.dbt_an_data.int_pays)
[0m20:46:14.091268 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_pays
[0m20:46:14.098120 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_pays"
[0m20:46:14.098819 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_pays
[0m20:46:14.101551 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:46:14.101818 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__c0d5702694c4" cascade
    
[0m20:46:14.102051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:14.212551 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m20:46:14.217446 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:46:14.218152 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:46:14.220918 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:46:14.223456 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:46:14.223953 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m20:46:14.225127 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:46:14.225552 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:46:14.225981 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:46:14.338553 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m20:46:14.342247 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:46:14.343045 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    

  
[0m20:46:14.343916 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:46:14.346335 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m20:46:14.347047 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:46:14.347710 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m20:46:14.450800 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m20:46:14.451286 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:46:14.451478 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_pays__c0d5702694c4"
  
    as (
      

with __dbt__cte__stg_pays as (
SELECT * 
FROM "database"."stg"."raw_pays"
) SELECT
json_extract_string(json, '$.pays.uid') as uid,
json_extract_string(json, '$.pays.code_insee') as code_insee,
json_extract_string(json, '$.pays.libelleInsee') as libelleInsee,
json_extract_string(json, '$.pays.nomCourant') as nomCourant,
json_extract_string(json, '$.pays.code_iso2A') as code_iso2A,
json_extract_string(json, '$.pays.code_iso3A') as code_iso3A,
json_extract_string(json, '$.pays.code_iso3N') as code_iso3N,
json_extract_string(json, '$.pays.libelleIso') as libelleIso,
json_extract_string(json, '$.pays.libelleANCourt') as libelleANCourt,
json_extract_string(json, '$.pays.libelleANLong') as libelleANLong,
json_extract_string(json, '$.pays.sourceJuridique') as sourceJuridique,
json_extract_string(json, '$.pays.activ') as activ,
date_T_insert
FROM __dbt__cte__stg_pays
    );
  
  
  
[0m20:46:14.791071 [debug] [Thread-1 (]: SQL status: OK in 0.339 seconds
[0m20:46:14.793056 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:46:14.793453 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m20:46:14.794757 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:46:14.795183 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:46:14.795630 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays__c0d5702694c4'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:46:14.800004 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:46:14.803619 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:46:14.804028 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:46:14.807247 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:46:14.810649 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:46:14.811050 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:46:14.813229 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:46:14.815168 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_pays"
[0m20:46:14.815841 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:46:14.816102 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

        
            delete from "an_data_pipeline"."main"."int_pays"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_pays__c0d5702694c4"
            );

        
    

    insert into "an_data_pipeline"."main"."int_pays" ("uid", "code_insee", "libelleInsee", "nomCourant", "code_iso2A", "code_iso3A", "code_iso3N", "libelleIso", "libelleANCourt", "libelleANLong", "sourceJuridique", "activ")
    (
        select "uid", "code_insee", "libelleInsee", "nomCourant", "code_iso2A", "code_iso3A", "code_iso3N", "libelleIso", "libelleANCourt", "libelleANLong", "sourceJuridique", "activ"
        from "an_data_pipeline"."dbt_temp"."int_pays__c0d5702694c4"
    )
  
[0m20:46:15.049348 [debug] [Thread-1 (]: SQL status: OK in 0.232 seconds
[0m20:46:15.058513 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m20:46:15.059213 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:46:15.059711 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m20:46:15.189157 [debug] [Thread-1 (]: SQL status: OK in 0.128 seconds
[0m20:46:15.197100 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:46:15.197920 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__c0d5702694c4" cascade
    
[0m20:46:15.444745 [debug] [Thread-1 (]: SQL status: OK in 0.246 seconds
[0m20:46:15.446372 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:46:15.446547 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__c0d5702694c4" cascade
    
[0m20:46:15.553579 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m20:46:15.554863 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: Close
[0m20:46:15.555428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6141e386-82be-4d6a-b5b1-488fc489bed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf96a50>]}
[0m20:46:15.556059 [info ] [Thread-1 (]: 7 of 10 OK created sql incremental model main.int_pays ......................... [[32mOK[0m in 1.46s]
[0m20:46:15.556552 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_pays
[0m20:46:15.556914 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_reunions
[0m20:46:15.557410 [info ] [Thread-1 (]: 8 of 10 START sql incremental model main.int_reunions .......................... [RUN]
[0m20:46:15.557889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_pays, now model.dbt_an_data.int_reunions)
[0m20:46:15.558198 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_reunions
[0m20:46:15.567343 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_reunions"
[0m20:46:15.567917 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_reunions
[0m20:46:15.570669 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:46:15.570932 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__38ca99b51e7b" cascade
    
[0m20:46:15.571162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:15.677820 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m20:46:15.682584 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:46:15.683175 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:46:15.685897 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:46:15.688603 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:46:15.689072 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m20:46:15.690191 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:46:15.690608 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:46:15.691037 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:46:15.797944 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m20:46:15.801746 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:46:15.802795 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    

  
[0m20:46:15.803684 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:46:15.806045 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m20:46:15.806795 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:46:15.807303 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m20:46:15.913219 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m20:46:15.913707 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:46:15.913918 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_reunions__38ca99b51e7b"
  
    as (
      

with __dbt__cte__stg_reunions as (
SELECT * 
FROM "database"."stg"."raw_reunions"
) SELECT
json_extract_string(json, '$.reunion.uid') AS uid,
json_extract_string(json, '$.reunion.timeStampDebut') AS timeStampDebut,
json_extract_string(json, '$.reunion.lieu.lieuRef') AS lieuRef,
json_extract_string(json, '$.reunion.lieu.libelleLong') AS lieuLibelle,
json_extract_string(json, '$.reunion.cycleDeVie.etat') AS cycleDeVieEtat,
json_extract_string(json, '$.reunion.demandeur') AS demandeur,
json_extract_string(json, '$.reunion.organeReuniRef') AS organeReuniRef,
json_extract_string(json, '$.reunion.visioConference') AS visioConference,
json_extract_string(json, '$.reunion.sessionRef') AS sessionRef,
json_extract_string(json, '$.reunion.ouverturePresse') AS ouverturePresse,
json_extract_string(json, '$.reunion.captationVideo') AS captationVideo,
json_extract_string(json, '$.reunion.ODJ.convocationODJ.item') AS convocationODJ,
json_extract_string(json, '$.reunion.ODJ.resumeODJ.item') AS resumeODJ,
json_extract_string(json, '$.reunion.compteRenduRef') AS compteRenduRef,
json_extract_string(json, '$.reunion.identifiants.numSeanceJO') AS numSeanceJO,
json_extract_string(json, '$.reunion.identifiants.idJO') AS idJO,
json_extract_string(json, '$.reunion.identifiants.quantieme') AS quantieme,
json_extract_string(json, '$.reunion.identifiants.DataSeance') AS DataSeance,
date_T_insert
FROM __dbt__cte__stg_reunions
    );
  
  
  
[0m20:46:16.859614 [debug] [Thread-1 (]: SQL status: OK in 0.945 seconds
[0m20:46:16.862028 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:46:16.862218 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m20:46:16.862709 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:46:16.862858 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:46:16.863009 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions__38ca99b51e7b'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:46:16.864624 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:46:16.866296 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:46:16.866464 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:46:16.867787 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:46:16.869245 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:46:16.869410 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:46:16.870749 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:46:16.871945 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_reunions"
[0m20:46:16.872340 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:46:16.872508 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

        
            delete from "an_data_pipeline"."main"."int_reunions"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_reunions__38ca99b51e7b"
            );

        
    

    insert into "an_data_pipeline"."main"."int_reunions" ("uid", "timeStampDebut", "lieuRef", "lieuLibelle", "cycleDeVieEtat", "demandeur", "organeReuniRef", "visioConference", "sessionRef", "ouverturePresse", "captationVideo", "convocationODJ", "resumeODJ", "compteRenduRef", "numSeanceJO", "idJO", "quantieme", "DataSeance")
    (
        select "uid", "timeStampDebut", "lieuRef", "lieuLibelle", "cycleDeVieEtat", "demandeur", "organeReuniRef", "visioConference", "sessionRef", "ouverturePresse", "captationVideo", "convocationODJ", "resumeODJ", "compteRenduRef", "numSeanceJO", "idJO", "quantieme", "DataSeance"
        from "an_data_pipeline"."dbt_temp"."int_reunions__38ca99b51e7b"
    )
  
[0m20:46:17.112591 [debug] [Thread-1 (]: SQL status: OK in 0.239 seconds
[0m20:46:17.117214 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m20:46:17.118411 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:46:17.119328 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m20:46:17.302960 [debug] [Thread-1 (]: SQL status: OK in 0.183 seconds
[0m20:46:17.311165 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:46:17.312071 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__38ca99b51e7b" cascade
    
[0m20:46:17.536166 [debug] [Thread-1 (]: SQL status: OK in 0.223 seconds
[0m20:46:17.538892 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:46:17.539082 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__38ca99b51e7b" cascade
    
[0m20:46:17.643508 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m20:46:17.644892 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: Close
[0m20:46:17.645500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6141e386-82be-4d6a-b5b1-488fc489bed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd67b30>]}
[0m20:46:17.646122 [info ] [Thread-1 (]: 8 of 10 OK created sql incremental model main.int_reunions ..................... [[32mOK[0m in 2.09s]
[0m20:46:17.646642 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_reunions
[0m20:46:17.646989 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins
[0m20:46:17.647441 [info ] [Thread-1 (]: 9 of 10 START sql incremental model main.int_scrutins .......................... [RUN]
[0m20:46:17.647799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_reunions, now model.dbt_an_data.int_scrutins)
[0m20:46:17.648078 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins
[0m20:46:17.655281 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins"
[0m20:46:17.656661 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins
[0m20:46:17.659365 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:46:17.659628 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__2816e2c11a0e" cascade
    
[0m20:46:17.659861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:17.766871 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m20:46:17.772894 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:46:17.773687 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:46:17.776056 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:46:17.778091 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:46:17.778568 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m20:46:17.779623 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:46:17.780043 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:46:17.780476 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:46:17.889792 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m20:46:17.893505 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:46:17.894556 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    

  
[0m20:46:17.895513 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:46:17.897935 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m20:46:17.898689 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:46:17.899401 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m20:46:18.004669 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m20:46:18.007567 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:46:18.008736 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_scrutins__2816e2c11a0e"
  
    as (
      

with __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
) SELECT
date_T_insert,
json_extract_string(json, '$.scrutin.uid') AS uid,
json_extract_string(json, '$.scrutin.numero') AS numero,
json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
json_extract_string(json, '$.scrutin.legislature') AS legislature,
json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
json_extract_string(json, '$.scrutin.titre') AS titre,
json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote,
date_T_insert
FROM __dbt__cte__stg_scrutins
    );
  
  
  
[0m20:46:19.623290 [debug] [Thread-1 (]: SQL status: OK in 1.613 seconds
[0m20:46:19.631588 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:46:19.632388 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m20:46:19.634304 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:46:19.634794 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:46:19.635256 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins__2816e2c11a0e'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:46:19.640568 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:46:19.644760 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:46:19.645190 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:46:19.648583 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:46:19.651777 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:46:19.652150 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:46:19.655018 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:46:19.657181 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins"
[0m20:46:19.658060 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:46:19.658364 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

        
            delete from "an_data_pipeline"."main"."int_scrutins"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_scrutins__2816e2c11a0e"
            );

        
    

    insert into "an_data_pipeline"."main"."int_scrutins" ("date_T_insert", "uid", "numero", "organeRef", "legislature", "date_scrutin", "titre", "resultat_code", "resultat_libelle", "nb_votants", "suffrages_exprimes", "seuil", "lieu_vote")
    (
        select "date_T_insert", "uid", "numero", "organeRef", "legislature", "date_scrutin", "titre", "resultat_code", "resultat_libelle", "nb_votants", "suffrages_exprimes", "seuil", "lieu_vote"
        from "an_data_pipeline"."dbt_temp"."int_scrutins__2816e2c11a0e"
    )
  
[0m20:46:19.906294 [debug] [Thread-1 (]: SQL status: OK in 0.247 seconds
[0m20:46:19.910340 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m20:46:19.911256 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:46:19.911946 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m20:46:20.074932 [debug] [Thread-1 (]: SQL status: OK in 0.161 seconds
[0m20:46:20.082848 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:46:20.083915 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__2816e2c11a0e" cascade
    
[0m20:46:20.961195 [debug] [Thread-1 (]: SQL status: OK in 0.877 seconds
[0m20:46:20.963119 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:46:20.963334 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__2816e2c11a0e" cascade
    
[0m20:46:21.066493 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m20:46:21.068352 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: Close
[0m20:46:21.069375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6141e386-82be-4d6a-b5b1-488fc489bed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd9ac00>]}
[0m20:46:21.070144 [info ] [Thread-1 (]: 9 of 10 OK created sql incremental model main.int_scrutins ..................... [[32mOK[0m in 3.42s]
[0m20:46:21.070651 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins
[0m20:46:21.071018 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins_votes
[0m20:46:21.071687 [info ] [Thread-1 (]: 10 of 10 START sql incremental model main.int_scrutins_votes ................... [RUN]
[0m20:46:21.072159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_scrutins, now model.dbt_an_data.int_scrutins_votes)
[0m20:46:21.072471 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins_votes
[0m20:46:21.101186 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins_votes"
[0m20:46:21.102803 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins_votes
[0m20:46:21.104973 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:46:21.105177 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__3faa07e6c416" cascade
    
[0m20:46:21.105356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:21.210311 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m20:46:21.213345 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:46:21.213735 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:46:21.215041 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:46:21.216370 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:46:21.216710 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m20:46:21.217456 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:46:21.217752 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:46:21.218056 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:46:21.329098 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m20:46:21.332681 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:46:21.333739 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    

  
[0m20:46:21.334659 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:46:21.337059 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m20:46:21.337781 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:46:21.338428 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m20:46:21.443238 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m20:46:21.446253 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:46:21.447969 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_scrutins_votes__3faa07e6c416"
  
    as (
      

WITH  __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
), grp AS (
      -- explode les groupes (1 par groupe)
    SELECT
        json_extract_string(j.json, '$.scrutin.uid') AS uid,
        json_extract_string(g.value, '$.organeRef') AS groupe_organe,
        g.value AS groupe_json,
        date_T_insert
    FROM __dbt__cte__stg_scrutins j,
    json_each(json->'scrutin'->'ventilationVotes'->'organe'->'groupes'->'groupe') g
  ),

  positions_array AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          date_T_insert
          groupe_organe,
          'pour' AS type_vote,
          p.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'pours'->'votant') p
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          date_T_insert
          groupe_organe,
          'contre' AS type_vote,
          c.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'contres'->'votant') c
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          date_T_insert
          groupe_organe,
          'abstention' AS type_vote,
          a.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'abstentions'->'votant') a
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          date_T_insert
          groupe_organe,
          'nonVotant' AS type_vote,
          n.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'nonVotants'->'votant') n
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[ARRAY]'
  ),
  positions_object AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[OBJECT]'
  ),

  clean AS (
      -- sécurise les champs (souvent string ou null)
      SELECT
          uid,
          groupe_organe,
          type_vote,
          json_extract_string(vote_json, '$.acteurRef') AS acteurRef,
          json_extract_string(vote_json, '$.mandatRef') AS mandatRef,
          json_extract_string(vote_json, '$.parDelegation') AS parDelegation,
          json_extract_string(vote_json, '$.numPlace') AS numPlace,
          json_extract_string(vote_json, '$.causePositionVote') AS cause,
          date_T_insert
      FROM positions_array
      UNION ALL
      SELECT * 
      FROM positions_object
  )

  SELECT * FROM clean
    );
  
  
  
[0m20:46:21.732531 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_scrutins_votes__3faa07e6c416"
  
    as (
      

WITH  __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
), grp AS (
      -- explode les groupes (1 par groupe)
    SELECT
        json_extract_string(j.json, '$.scrutin.uid') AS uid,
        json_extract_string(g.value, '$.organeRef') AS groupe_organe,
        g.value AS groupe_json,
        date_T_insert
    FROM __dbt__cte__stg_scrutins j,
    json_each(json->'scrutin'->'ventilationVotes'->'organe'->'groupes'->'groupe') g
  ),

  positions_array AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          date_T_insert
          groupe_organe,
          'pour' AS type_vote,
          p.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'pours'->'votant') p
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          date_T_insert
          groupe_organe,
          'contre' AS type_vote,
          c.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'contres'->'votant') c
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          date_T_insert
          groupe_organe,
          'abstention' AS type_vote,
          a.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'abstentions'->'votant') a
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          date_T_insert
          groupe_organe,
          'nonVotant' AS type_vote,
          n.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'nonVotants'->'votant') n
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[ARRAY]'
  ),
  positions_object AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[OBJECT]'
  ),

  clean AS (
      -- sécurise les champs (souvent string ou null)
      SELECT
          uid,
          groupe_organe,
          type_vote,
          json_extract_string(vote_json, '$.acteurRef') AS acteurRef,
          json_extract_string(vote_json, '$.mandatRef') AS mandatRef,
          json_extract_string(vote_json, '$.parDelegation') AS parDelegation,
          json_extract_string(vote_json, '$.numPlace') AS numPlace,
          json_extract_string(vote_json, '$.causePositionVote') AS cause,
          date_T_insert
      FROM positions_array
      UNION ALL
      SELECT * 
      FROM positions_object
  )

  SELECT * FROM clean
    );
  
  
  
[0m20:46:21.733349 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:46:21.735638 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:46:21.735935 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__3faa07e6c416" cascade
    
[0m20:46:21.916737 [debug] [Thread-1 (]: SQL status: OK in 0.180 seconds
[0m20:46:21.919902 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: Close
[0m20:46:21.941836 [debug] [Thread-1 (]: Runtime Error in model int_scrutins_votes (models/int/int_scrutins_votes.sql)
  Binder Error: Referenced column "date_T_insert" not found in FROM clause!
  Candidate bindings: "type_vote", "vote_json", "groupe_organe"
  
  LINE 142:           date_T_insert
                      ^
[0m20:46:21.942643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6141e386-82be-4d6a-b5b1-488fc489bed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd04560>]}
[0m20:46:21.943516 [error] [Thread-1 (]: 10 of 10 ERROR creating sql incremental model main.int_scrutins_votes .......... [[31mERROR[0m in 0.87s]
[0m20:46:21.944266 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins_votes
[0m20:46:21.944926 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.int_scrutins_votes' to be skipped because of status 'error'.  Reason: Runtime Error in model int_scrutins_votes (models/int/int_scrutins_votes.sql)
  Binder Error: Referenced column "date_T_insert" not found in FROM clause!
  Candidate bindings: "type_vote", "vote_json", "groupe_organe"
  
  LINE 142:           date_T_insert
                      ^.
[0m20:46:21.950558 [debug] [MainThread]: Using duckdb connection "master"
[0m20:46:21.950915 [debug] [MainThread]: On master: BEGIN
[0m20:46:21.951195 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:46:21.952219 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:46:21.952538 [debug] [MainThread]: On master: COMMIT
[0m20:46:21.952819 [debug] [MainThread]: Using duckdb connection "master"
[0m20:46:21.953089 [debug] [MainThread]: On master: COMMIT
[0m20:46:21.953564 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:46:21.953847 [debug] [MainThread]: On master: Close
[0m20:46:21.954212 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:46:21.954475 [debug] [MainThread]: Connection 'model.dbt_an_data.int_scrutins_votes' was properly closed.
[0m20:46:21.955174 [info ] [MainThread]: 
[0m20:46:21.955473 [info ] [MainThread]: Finished running 10 incremental models, 1 project hook in 0 hours 0 minutes and 20.41 seconds (20.41s).
[0m20:46:21.957090 [debug] [MainThread]: Command end result
[0m20:46:21.980363 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m20:46:21.983247 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m20:46:21.988219 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m20:46:21.988433 [info ] [MainThread]: 
[0m20:46:21.988639 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:46:21.988811 [info ] [MainThread]: 
[0m20:46:21.989026 [error] [MainThread]: [31mFailure in model int_scrutins_votes (models/int/int_scrutins_votes.sql)[0m
[0m20:46:21.989225 [error] [MainThread]:   Runtime Error in model int_scrutins_votes (models/int/int_scrutins_votes.sql)
  Binder Error: Referenced column "date_T_insert" not found in FROM clause!
  Candidate bindings: "type_vote", "vote_json", "groupe_organe"
  
  LINE 142:           date_T_insert
                      ^
[0m20:46:21.989375 [info ] [MainThread]: 
[0m20:46:21.989550 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/int/int_scrutins_votes.sql
[0m20:46:21.989700 [info ] [MainThread]: 
[0m20:46:21.990289 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=11
[0m20:46:21.991214 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 21.00443, "process_in_blocks": "0", "process_kernel_time": 1.556046, "process_mem_max_rss": "1108459520", "process_out_blocks": "0", "process_user_time": 6.560411}
[0m20:46:21.991509 [debug] [MainThread]: Command `dbt run` failed at 20:46:21.991467 after 21.00 seconds
[0m20:46:21.991750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10981ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b932ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b91c200>]}
[0m20:46:21.991936 [debug] [MainThread]: Flushing usage events
[0m20:46:22.598505 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:48:54.020679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b8d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10741f6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10741f380>]}


============================== 20:48:54.024056 | cdad19b8-6714-49f5-8c9d-fcec381145f7 ==============================
[0m20:48:54.024056 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:48:54.024369 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'introspect': 'True', 'empty': 'False', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'no_print': 'None', 'printer_width': '80', 'warn_error': 'None', 'use_colors': 'True', 'write_json': 'True', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'version_check': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'static_parser': 'True', 'debug': 'False', 'partial_parse': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m20:48:54.218165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdad19b8-6714-49f5-8c9d-fcec381145f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107632f90>]}
[0m20:48:54.245077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdad19b8-6714-49f5-8c9d-fcec381145f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b8d430>]}
[0m20:48:54.246530 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:48:54.302110 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:48:54.372219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:48:54.372557 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_scrutins_votes.sql
[0m20:48:54.482720 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_an_data.mart
[0m20:48:54.488730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdad19b8-6714-49f5-8c9d-fcec381145f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bae4b0>]}
[0m20:48:54.525561 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m20:48:54.527059 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m20:48:54.540568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdad19b8-6714-49f5-8c9d-fcec381145f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b604d0>]}
[0m20:48:54.540818 [info ] [MainThread]: Found 17 models, 1 operation, 9 sources, 469 macros
[0m20:48:54.540980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdad19b8-6714-49f5-8c9d-fcec381145f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a78a10>]}
[0m20:48:54.542013 [info ] [MainThread]: 
[0m20:48:54.542186 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m20:48:54.542311 [info ] [MainThread]: 
[0m20:48:54.542526 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:48:54.544792 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_an_data_pipeline'
[0m20:48:54.630815 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline"
[0m20:48:54.631054 [debug] [ThreadPool]: On list_an_data_pipeline: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"an_data_pipeline"'
    
  
  
[0m20:48:54.631194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:48:56.957850 [debug] [ThreadPool]: SQL status: OK in 2.326 seconds
[0m20:48:56.961603 [debug] [ThreadPool]: On list_an_data_pipeline: Close
[0m20:48:56.962798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_an_data_pipeline, now create_an_data_pipeline_main)
[0m20:48:56.963449 [debug] [ThreadPool]: Creating schema "database: "an_data_pipeline"
schema: "main"
"
[0m20:48:56.974604 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m20:48:56.975218 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:48:56.975624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:48:56.977938 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:48:56.979625 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m20:48:56.979992 [debug] [ThreadPool]: On create_an_data_pipeline_main: BEGIN
[0m20:48:56.980886 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:48:56.981193 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m20:48:56.981486 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
    
        create schema if not exists "an_data_pipeline"."main"
    
[0m20:48:57.110492 [debug] [ThreadPool]: SQL status: OK in 0.128 seconds
[0m20:48:57.113686 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m20:48:57.114576 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m20:48:57.115409 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m20:48:57.236956 [debug] [ThreadPool]: SQL status: OK in 0.121 seconds
[0m20:48:57.238495 [debug] [ThreadPool]: On create_an_data_pipeline_main: Close
[0m20:48:57.243970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_an_data_pipeline_main, now list_an_data_pipeline_main)
[0m20:48:57.255708 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m20:48:57.256529 [debug] [ThreadPool]: On list_an_data_pipeline_main: BEGIN
[0m20:48:57.256990 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:48:57.258643 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:48:57.259127 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m20:48:57.259644 [debug] [ThreadPool]: On list_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline_main"} */
select
      'an_data_pipeline' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'an_data_pipeline'
  
[0m20:48:57.282162 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m20:48:57.283740 [debug] [ThreadPool]: On list_an_data_pipeline_main: ROLLBACK
[0m20:48:57.285628 [debug] [ThreadPool]: Failed to rollback 'list_an_data_pipeline_main'
[0m20:48:57.285998 [debug] [ThreadPool]: On list_an_data_pipeline_main: Close
[0m20:48:57.287775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdad19b8-6714-49f5-8c9d-fcec381145f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a4b410>]}
[0m20:48:57.288246 [debug] [MainThread]: Using duckdb connection "master"
[0m20:48:57.288532 [debug] [MainThread]: On master: BEGIN
[0m20:48:57.288771 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:48:57.289621 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:48:57.289890 [debug] [MainThread]: On master: COMMIT
[0m20:48:57.290130 [debug] [MainThread]: Using duckdb connection "master"
[0m20:48:57.290342 [debug] [MainThread]: On master: COMMIT
[0m20:48:57.290709 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:48:57.297267 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_an_data.dbt_an_data-on-run-start-0"
[0m20:48:57.301229 [info ] [MainThread]: 1 of 1 START hook: dbt_an_data.on-run-start.0 .................................. [RUN]
[0m20:48:57.301605 [debug] [MainThread]: Using duckdb connection "master"
[0m20:48:57.301862 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "master"} */
ATTACH '../data/database/database.duckdb' AS database (READ_ONLY)
[0m20:48:57.309666 [debug] [MainThread]: SQL status: OK in 0.008 seconds
[0m20:48:57.310352 [info ] [MainThread]: 1 of 1 OK hook: dbt_an_data.on-run-start.0 ..................................... [[32mOK[0m in 0.02s]
[0m20:48:57.310547 [info ] [MainThread]: 
[0m20:48:57.310736 [debug] [MainThread]: On master: Close
[0m20:48:57.312349 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_acteurs
[0m20:48:57.312619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_an_data_pipeline_main, now model.dbt_an_data.stg_acteurs)
[0m20:48:57.312827 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_acteurs
[0m20:48:57.314691 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_acteurs"
[0m20:48:57.315470 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_acteurs
[0m20:48:57.315696 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_agenda
[0m20:48:57.315950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_acteurs, now model.dbt_an_data.stg_agenda)
[0m20:48:57.316250 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_agenda
[0m20:48:57.317724 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_agenda"
[0m20:48:57.318504 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_agenda
[0m20:48:57.318708 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_amendements
[0m20:48:57.319028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_agenda, now model.dbt_an_data.stg_amendements)
[0m20:48:57.319208 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_amendements
[0m20:48:57.320711 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_amendements"
[0m20:48:57.321637 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_amendements
[0m20:48:57.321849 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_organes
[0m20:48:57.322068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_amendements, now model.dbt_an_data.stg_organes)
[0m20:48:57.322367 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_organes
[0m20:48:57.323650 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_organes"
[0m20:48:57.324077 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_organes
[0m20:48:57.324251 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_pays
[0m20:48:57.324545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_organes, now model.dbt_an_data.stg_pays)
[0m20:48:57.324722 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_pays
[0m20:48:57.325887 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_pays"
[0m20:48:57.326263 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_pays
[0m20:48:57.326428 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_reunions
[0m20:48:57.326739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_pays, now model.dbt_an_data.stg_reunions)
[0m20:48:57.326944 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_reunions
[0m20:48:57.328115 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_reunions"
[0m20:48:57.328510 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_reunions
[0m20:48:57.328686 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_scrutins
[0m20:48:57.328865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_reunions, now model.dbt_an_data.stg_scrutins)
[0m20:48:57.329764 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_scrutins
[0m20:48:57.330920 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_scrutins"
[0m20:48:57.331324 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_scrutins
[0m20:48:57.331490 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_acteurs
[0m20:48:57.331720 [info ] [Thread-1 (]: 1 of 10 START sql incremental model main.int_acteurs ........................... [RUN]
[0m20:48:57.363158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_scrutins, now model.dbt_an_data.int_acteurs)
[0m20:48:57.363430 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_acteurs
[0m20:48:57.367665 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_acteurs"
[0m20:48:57.368027 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_acteurs
[0m20:48:57.371472 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:48:57.371652 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__6427842e7256" cascade
    
[0m20:48:57.371800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:57.490656 [debug] [Thread-1 (]: SQL status: OK in 0.119 seconds
[0m20:48:57.524623 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:48:57.524924 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:48:57.525854 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:48:57.526704 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:48:57.526922 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m20:48:57.527402 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:48:57.527592 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:48:57.527782 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:48:57.632859 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m20:48:57.634277 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:48:57.634739 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    

  
[0m20:48:57.635252 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:48:57.636730 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m20:48:57.637182 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:48:57.637599 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m20:48:57.744494 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m20:48:57.772041 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:48:57.772903 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_acteurs__6427842e7256"
  
    as (
      

with __dbt__cte__stg_acteurs as (
SELECT * 
FROM "database"."stg"."raw_acteurs"
) SELECT 
json_extract_string(json, '$.acteur.uid.#text') as uid,
json_extract_string(json, '$.acteur.etatCivil.ident.civ') as civ,
json_extract_string(json, '$.acteur.etatCivil.ident.prenom') as prenom,
json_extract_string(json, '$.acteur.etatCivil.ident.nom') as nom,
json_extract_string(json, '$.acteur.etatCivil.ident.trigramme') as trigramme,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.dateNais') as dateNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.villeNais') as villeNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.depNais') as depNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.paysNais') as paysNais,
json_extract_string(json, '$.acteur.etatCivil.dateDeces') as dateDeces,
json_extract_string(json, '$.acteur.profession.libelleCourant') as libelleCourant,
json_extract_string(json, '$.acteur.profession.socProcINSEE.catSocPro') as catSocPro,
json_extract_string(json, '$.acteur.profession.socProcINSEE.famSocPro') as famSocPro,
json_extract_string(json, '$.acteur.uri_hatvp') as uri_hatvp,
date_T_insert
FROM __dbt__cte__stg_acteurs
    );
  
  
  
[0m20:48:58.410848 [debug] [Thread-1 (]: SQL status: OK in 0.637 seconds
[0m20:48:58.416906 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:48:58.417208 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m20:48:58.417991 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:48:58.418240 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:48:58.418491 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs__6427842e7256'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:48:58.424728 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:48:58.428386 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:48:58.428671 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:48:58.430583 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:48:58.435388 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:48:58.435620 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:48:58.437159 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:48:58.438010 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:48:58.438191 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */
SELECT version()
[0m20:48:58.438489 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:48:58.445913 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_acteurs"
[0m20:48:58.446613 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:48:58.446803 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

        
            delete from "an_data_pipeline"."main"."int_acteurs"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_acteurs__6427842e7256"
            );

        
    

    insert into "an_data_pipeline"."main"."int_acteurs" ("uid", "civ", "prenom", "nom", "trigramme", "dateNais", "villeNais", "depNais", "paysNais", "dateDeces", "libelleCourant", "catSocPro", "famSocPro", "uri_hatvp")
    (
        select "uid", "civ", "prenom", "nom", "trigramme", "dateNais", "villeNais", "depNais", "paysNais", "dateDeces", "libelleCourant", "catSocPro", "famSocPro", "uri_hatvp"
        from "an_data_pipeline"."dbt_temp"."int_acteurs__6427842e7256"
    )
  
[0m20:48:58.681454 [debug] [Thread-1 (]: SQL status: OK in 0.234 seconds
[0m20:48:58.706048 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m20:48:58.706724 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:48:58.707167 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m20:48:58.836270 [debug] [Thread-1 (]: SQL status: OK in 0.128 seconds
[0m20:48:58.844260 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:48:58.845134 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__6427842e7256" cascade
    
[0m20:48:59.081513 [debug] [Thread-1 (]: SQL status: OK in 0.235 seconds
[0m20:48:59.089062 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:48:59.089765 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__6427842e7256" cascade
    
[0m20:48:59.201123 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m20:48:59.208039 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: Close
[0m20:48:59.212257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdad19b8-6714-49f5-8c9d-fcec381145f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f0f20>]}
[0m20:48:59.213595 [info ] [Thread-1 (]: 1 of 10 OK created sql incremental model main.int_acteurs ...................... [[32mOK[0m in 1.88s]
[0m20:48:59.214571 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_acteurs
[0m20:48:59.215241 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_mandats
[0m20:48:59.215947 [info ] [Thread-1 (]: 2 of 10 START sql incremental model main.int_mandats ........................... [RUN]
[0m20:48:59.216606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_acteurs, now model.dbt_an_data.int_mandats)
[0m20:48:59.217134 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_mandats
[0m20:48:59.230905 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_mandats"
[0m20:48:59.231785 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_mandats
[0m20:48:59.235899 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:48:59.236298 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__eba786c27fbe" cascade
    
[0m20:48:59.236658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:59.346032 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m20:48:59.353889 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:48:59.354971 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:48:59.358461 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:48:59.361996 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:48:59.362837 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m20:48:59.364679 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:48:59.365374 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:48:59.365950 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:48:59.477560 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m20:48:59.481492 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:48:59.482387 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    

  
[0m20:48:59.483410 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:48:59.486114 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m20:48:59.487175 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:48:59.487967 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m20:48:59.594145 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m20:48:59.595986 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:48:59.596884 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_mandats__eba786c27fbe"
  
    as (
      

with __dbt__cte__stg_acteurs as (
SELECT * 
FROM "database"."stg"."raw_acteurs"
) SELECT 
json_extract_string(mandat.value, '$.uid') as uid,
json_extract_string(mandat.value, '$.acteurRef') as acteurRef,
json_extract_string(mandat.value, '$.legislature') as legislature,
json_extract_string(mandat.value, '$.typeOrgane') as typeOrgane,
json_extract_string(mandat.value, '$.dateDebut') as dateDebut,
json_extract_string(mandat.value, '$.dateFin') as dateFin,
json_extract_string(mandat.value, '$.preseance') as preseance,
json_extract_string(mandat.value, '$.nominPrincipale') as nominPrincipale,
json_extract_string(mandat.value, '$.infosQualite.codeQualite') as codeQualite,
json_extract_string(mandat.value, '$.organes.organeRef') as organeRef,
date_T_insert
FROM __dbt__cte__stg_acteurs act, json_each(json->'acteur'->'mandats'->'mandat') mandat
    );
  
  
  
[0m20:49:00.595382 [debug] [Thread-1 (]: SQL status: OK in 0.997 seconds
[0m20:49:00.601275 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:49:00.601856 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m20:49:00.603933 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:49:00.604495 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:49:00.604990 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats__eba786c27fbe'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:49:00.609681 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:49:00.613237 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:49:00.613704 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:49:00.616794 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:49:00.619766 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:49:00.620138 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:49:00.622905 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:49:00.624855 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_mandats"
[0m20:49:00.625613 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:49:00.625915 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

        
            delete from "an_data_pipeline"."main"."int_mandats"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_mandats__eba786c27fbe"
            );

        
    

    insert into "an_data_pipeline"."main"."int_mandats" ("uid", "acteurRef", "legislature", "typeOrgane", "dateDebut", "dateFin", "preseance", "nominPrincipale", "codeQualite", "organeRef")
    (
        select "uid", "acteurRef", "legislature", "typeOrgane", "dateDebut", "dateFin", "preseance", "nominPrincipale", "codeQualite", "organeRef"
        from "an_data_pipeline"."dbt_temp"."int_mandats__eba786c27fbe"
    )
  
[0m20:49:00.891303 [debug] [Thread-1 (]: SQL status: OK in 0.265 seconds
[0m20:49:00.895672 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m20:49:00.896512 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:49:00.897218 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m20:49:01.084887 [debug] [Thread-1 (]: SQL status: OK in 0.187 seconds
[0m20:49:01.086218 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:49:01.086389 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__eba786c27fbe" cascade
    
[0m20:49:01.312541 [debug] [Thread-1 (]: SQL status: OK in 0.226 seconds
[0m20:49:01.315131 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:49:01.315306 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__eba786c27fbe" cascade
    
[0m20:49:01.419192 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m20:49:01.420443 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: Close
[0m20:49:01.420980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdad19b8-6714-49f5-8c9d-fcec381145f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108008560>]}
[0m20:49:01.421553 [info ] [Thread-1 (]: 2 of 10 OK created sql incremental model main.int_mandats ...................... [[32mOK[0m in 2.20s]
[0m20:49:01.422039 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_mandats
[0m20:49:01.422372 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_agenda
[0m20:49:01.422777 [info ] [Thread-1 (]: 3 of 10 START sql incremental model main.int_agenda ............................ [RUN]
[0m20:49:01.423140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_mandats, now model.dbt_an_data.int_agenda)
[0m20:49:01.423416 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_agenda
[0m20:49:01.426262 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_agenda"
[0m20:49:01.427700 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_agenda
[0m20:49:01.430681 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:49:01.430945 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__0d9efed154bc" cascade
    
[0m20:49:01.431177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:01.544564 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m20:49:01.550486 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:49:01.551292 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:49:01.554599 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:49:01.557385 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:49:01.557931 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m20:49:01.559225 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:49:01.559665 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:49:01.560103 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:49:01.671191 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m20:49:01.675075 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:49:01.675882 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    

  
[0m20:49:01.676732 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:49:01.679210 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m20:49:01.679911 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:49:01.680418 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m20:49:01.784545 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m20:49:01.785068 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:49:01.785377 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_agenda__0d9efed154bc"
  
    as (
      

with __dbt__cte__stg_agenda as (
SELECT * 
FROM "database"."stg"."raw_agenda"
) SELECT * 
FROM __dbt__cte__stg_agenda
    );
  
  
  
[0m20:49:02.164589 [debug] [Thread-1 (]: SQL status: OK in 0.379 seconds
[0m20:49:02.168623 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:49:02.169330 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m20:49:02.170785 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:49:02.171285 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:49:02.171763 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda__0d9efed154bc'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:49:02.175930 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:49:02.179316 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:49:02.179775 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:49:02.182699 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:49:02.187639 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:49:02.188005 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:49:02.190572 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:49:02.192207 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_agenda"
[0m20:49:02.192947 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:49:02.193266 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

        
            delete from "an_data_pipeline"."main"."int_agenda" as DBT_INCREMENTAL_TARGET
            using "an_data_pipeline"."dbt_temp"."int_agenda__0d9efed154bc"
            where (
                
                    "an_data_pipeline"."dbt_temp"."int_agenda__0d9efed154bc".Date = DBT_INCREMENTAL_TARGET.Date
                    and 
                
                    "an_data_pipeline"."dbt_temp"."int_agenda__0d9efed154bc".Heure = DBT_INCREMENTAL_TARGET.Heure
                    
                
                
            );
        
    

    insert into "an_data_pipeline"."main"."int_agenda" ("Date", "Heure", "Ordre(s) du jour", "filename", "date_T_insert")
    (
        select "Date", "Heure", "Ordre(s) du jour", "filename", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_agenda__0d9efed154bc"
    )
  
[0m20:49:02.425498 [debug] [Thread-1 (]: SQL status: OK in 0.232 seconds
[0m20:49:02.427648 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m20:49:02.428237 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:49:02.428667 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m20:49:02.546448 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m20:49:02.553368 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:49:02.554205 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__0d9efed154bc" cascade
    
[0m20:49:02.788039 [debug] [Thread-1 (]: SQL status: OK in 0.233 seconds
[0m20:49:02.796747 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:49:02.797575 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__0d9efed154bc" cascade
    
[0m20:49:02.909363 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m20:49:02.913960 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: Close
[0m20:49:02.915370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdad19b8-6714-49f5-8c9d-fcec381145f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107493890>]}
[0m20:49:02.916675 [info ] [Thread-1 (]: 3 of 10 OK created sql incremental model main.int_agenda ....................... [[32mOK[0m in 1.49s]
[0m20:49:02.917889 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_agenda
[0m20:49:02.918710 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements
[0m20:49:02.919748 [info ] [Thread-1 (]: 4 of 10 START sql incremental model main.int_amendements ....................... [RUN]
[0m20:49:02.920713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_agenda, now model.dbt_an_data.int_amendements)
[0m20:49:02.921393 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements
[0m20:49:02.945302 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements"
[0m20:49:02.946287 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements
[0m20:49:02.952591 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:49:02.952974 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__7061400dcbaa" cascade
    
[0m20:49:02.953285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:03.064303 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m20:49:03.072362 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:49:03.073276 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:49:03.076540 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:49:03.079131 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:49:03.079743 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m20:49:03.081003 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:49:03.081463 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:49:03.081967 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:49:03.190833 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m20:49:03.195497 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:49:03.196508 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    

  
[0m20:49:03.197447 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:49:03.200055 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m20:49:03.200824 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:49:03.201492 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m20:49:03.314074 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m20:49:03.317219 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:49:03.318701 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_amendements__7061400dcbaa"
  
    as (
      

with __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
) SELECT
json_extract_string(json, '$.amendement.uid') AS uid,
json_extract_string(json, '$.amendement.chronotag') AS chronotag,
json_extract_string(json, '$.amendement.examenRef') AS examenRef,
json_extract_string(json, '$.amendement.amendementParentRef') AS amendementParentRef,
json_extract_string(json, '$.amendement.signataires.auteur.typeAuteur') AS typeAuteur,
json_extract_string(json, '$.amendement.signataires.auteur.acteurRef') AS refAuteur,
json_extract_string(json, '$.amendement.signataires.auteur.groupePolitique') AS groupePolitiqueAuteur,
json_extract_string(json, '$.amendement.cycleDeVie.dateDepot') AS dateDepot,
json_extract_string(json, '$.amendement.cycleDeVie.datePublication') AS datePublication,
json_extract_string(json, '$.amendement.cycleDeVie.soumisArticle40') AS soumisArticle40,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.code') AS codeEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.libelle') AS libelleEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.code') AS codeSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.dateSort') AS dateSort,
json_extract_string(json, '$.amendement.cycleDeVie.sort') AS sort,
split_part(replace(filename, '.json', ''), '/', -1) AS id_amendement,
split_part(replace(filename, '.json', ''), '/', -2) AS id_texte,
split_part(replace(filename, '.json', ''), '/', -3) AS id_dossier_legislatif,
id_texte[:4] AS nature_texte,
id_texte[5:6] AS source_texte,
regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 1) AS prefix_bibard,
regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 2) AS numero_bibard,
regexp_extract(id_amendement, '(SEA|PO\d*)', 1) AS code_organe,
regexp_extract(id_amendement, '(P)(\d*)(D)', 2) AS numero_partie,
regexp_extract(id_amendement, '(D)(\d*)(N)', 2) AS numero_deliberation,
regexp_extract(id_amendement, '(D)(\d*)(N)(\d*)', 4) AS numero_court,
date_T_insert
from __dbt__cte__stg_amendements
    );
  
  
  
[0m20:49:03.694344 [debug] [Thread-1 (]: SQL status: OK in 0.374 seconds
[0m20:49:03.698721 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:49:03.699258 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m20:49:03.700778 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:49:03.701220 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:49:03.701717 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements__7061400dcbaa'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:49:03.705992 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:49:03.712376 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:49:03.712800 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:49:03.715939 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:49:03.719292 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:49:03.719632 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:49:03.722115 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:49:03.724406 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements"
[0m20:49:03.725193 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:49:03.725539 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

        
            delete from "an_data_pipeline"."main"."int_amendements"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_amendements__7061400dcbaa"
            );

        
    

    insert into "an_data_pipeline"."main"."int_amendements" ("uid", "chronotag", "examenRef", "amendementParentRef", "typeAuteur", "refAuteur", "groupePolitiqueAuteur", "dateDepot", "datePublication", "soumisArticle40", "codeEtat", "libelleEtat", "codeSousEtat", "libelleSousEtat", "libelleSousEtat_1", "dateSort", "sort", "id_amendement", "id_texte", "id_dossier_legislatif", "nature_texte", "source_texte", "prefix_bibard", "numero_bibard", "code_organe", "numero_partie", "numero_deliberation", "numero_court")
    (
        select "uid", "chronotag", "examenRef", "amendementParentRef", "typeAuteur", "refAuteur", "groupePolitiqueAuteur", "dateDepot", "datePublication", "soumisArticle40", "codeEtat", "libelleEtat", "codeSousEtat", "libelleSousEtat", "libelleSousEtat_1", "dateSort", "sort", "id_amendement", "id_texte", "id_dossier_legislatif", "nature_texte", "source_texte", "prefix_bibard", "numero_bibard", "code_organe", "numero_partie", "numero_deliberation", "numero_court"
        from "an_data_pipeline"."dbt_temp"."int_amendements__7061400dcbaa"
    )
  
[0m20:49:03.963498 [debug] [Thread-1 (]: SQL status: OK in 0.237 seconds
[0m20:49:03.966795 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m20:49:03.967506 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:49:03.968063 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m20:49:04.075175 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m20:49:04.081530 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:49:04.082586 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__7061400dcbaa" cascade
    
[0m20:49:04.321223 [debug] [Thread-1 (]: SQL status: OK in 0.238 seconds
[0m20:49:04.329248 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:49:04.329951 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__7061400dcbaa" cascade
    
[0m20:49:04.440280 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m20:49:04.442294 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: Close
[0m20:49:04.443034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdad19b8-6714-49f5-8c9d-fcec381145f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107493890>]}
[0m20:49:04.443834 [info ] [Thread-1 (]: 4 of 10 OK created sql incremental model main.int_amendements .................. [[32mOK[0m in 1.52s]
[0m20:49:04.444762 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements
[0m20:49:04.445570 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements_cosignataires
[0m20:49:04.446549 [info ] [Thread-1 (]: 5 of 10 START sql incremental model main.int_amendements_cosignataires ......... [RUN]
[0m20:49:04.447483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements, now model.dbt_an_data.int_amendements_cosignataires)
[0m20:49:04.448234 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements_cosignataires
[0m20:49:04.461414 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements_cosignataires"
[0m20:49:04.462639 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements_cosignataires
[0m20:49:04.467780 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:49:04.468283 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__7283edb5ecd6" cascade
    
[0m20:49:04.468619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:04.581923 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m20:49:04.593117 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:49:04.593947 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:49:04.596282 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:49:04.598482 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:49:04.599066 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m20:49:04.600398 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:49:04.601034 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:49:04.601851 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:49:04.710850 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m20:49:04.715170 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:49:04.716302 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    

  
[0m20:49:04.717521 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:49:04.720618 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m20:49:04.721367 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:49:04.722061 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m20:49:04.827521 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m20:49:04.830808 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:49:04.832048 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__7283edb5ecd6"
  
    as (
      

WITH  __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
), cosignataires_arr AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef[*]') AS acteurRef,
    date_T_insert
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') == 'ARRAY' AND acteurRef IS NOT NULL
), cosignataires_str AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef') AS acteurRef,
    date_T_insert
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') <> 'ARRAY' AND acteurRef IS NOT NULL
)
SELECT 
  uid, 
  unnest(acteurRef) as acteurRef,
  date_T_insert
FROM cosignataires_arr
UNION ALL
SELECT 
  uid, 
  acteurRef,
  date_T_insert
FROM cosignataires_str
    );
  
  
  
[0m20:49:05.179112 [debug] [Thread-1 (]: SQL status: OK in 0.346 seconds
[0m20:49:05.183630 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:49:05.184156 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m20:49:05.185749 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:49:05.186334 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:49:05.186881 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires__7283edb5ecd6'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:49:05.191283 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:49:05.196834 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:49:05.197226 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:49:05.200115 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:49:05.204045 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:49:05.204417 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:49:05.206909 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:49:05.208538 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements_cosignataires"
[0m20:49:05.209345 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:49:05.209686 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

        
            delete from "an_data_pipeline"."main"."int_amendements_cosignataires" as DBT_INCREMENTAL_TARGET
            using "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__7283edb5ecd6"
            where (
                
                    "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__7283edb5ecd6".uid = DBT_INCREMENTAL_TARGET.uid
                    and 
                
                    "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__7283edb5ecd6".acteurRef = DBT_INCREMENTAL_TARGET.acteurRef
                    
                
                
            );
        
    

    insert into "an_data_pipeline"."main"."int_amendements_cosignataires" ("uid", "acteurRef")
    (
        select "uid", "acteurRef"
        from "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__7283edb5ecd6"
    )
  
[0m20:49:05.434626 [debug] [Thread-1 (]: SQL status: OK in 0.224 seconds
[0m20:49:05.439888 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m20:49:05.440877 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:49:05.441597 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m20:49:05.548779 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m20:49:05.556706 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:49:05.558419 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__7283edb5ecd6" cascade
    
[0m20:49:05.779267 [debug] [Thread-1 (]: SQL status: OK in 0.220 seconds
[0m20:49:05.781038 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:49:05.781213 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__7283edb5ecd6" cascade
    
[0m20:49:05.887943 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m20:49:05.889352 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: Close
[0m20:49:05.889942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdad19b8-6714-49f5-8c9d-fcec381145f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f10ec0>]}
[0m20:49:05.890518 [info ] [Thread-1 (]: 5 of 10 OK created sql incremental model main.int_amendements_cosignataires .... [[32mOK[0m in 1.44s]
[0m20:49:05.890987 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements_cosignataires
[0m20:49:05.891300 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_organes
[0m20:49:05.891718 [info ] [Thread-1 (]: 6 of 10 START sql incremental model main.int_organes ........................... [RUN]
[0m20:49:05.892105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements_cosignataires, now model.dbt_an_data.int_organes)
[0m20:49:05.892407 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_organes
[0m20:49:05.899585 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_organes"
[0m20:49:05.900219 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_organes
[0m20:49:05.902926 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:49:05.903194 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__b016f4f7d3ed" cascade
    
[0m20:49:05.903430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:06.010058 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m20:49:06.014680 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:49:06.015473 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:49:06.017979 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:49:06.020286 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:49:06.020795 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m20:49:06.021865 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:49:06.022299 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:49:06.022732 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:49:06.138730 [debug] [Thread-1 (]: SQL status: OK in 0.115 seconds
[0m20:49:06.142435 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:49:06.143457 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    

  
[0m20:49:06.144569 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:49:06.146909 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m20:49:06.147633 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:49:06.148302 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m20:49:06.254309 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m20:49:06.254928 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:49:06.255113 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_organes__b016f4f7d3ed"
  
    as (
      

with __dbt__cte__stg_organes as (
SELECT * 
FROM "database"."stg"."raw_organes"
) SELECT 
json_extract_string(json, '$.organe.uid') as uid,
json_extract_string(json, '$.organe.codeType') as codeType,
json_extract_string(json, '$.organe.libelle') as libelle,
json_extract_string(json, '$.organe.libelleEdition') as libelleEdition,
json_extract_string(json, '$.organe.libelleAbrege') as libelleAbrege,
json_extract_string(json, '$.organe.libelleAbrev') as libelleAbrev,
json_extract_string(json, '$.organe.viMoDe.dateDebut') as dateDebut,
json_extract_string(json, '$.organe.viMoDe.dateAgrement') as dateAgrement,
json_extract_string(json, '$.organe.viMoDe.dateFin') as dateFin,
json_extract_string(json, '$.organe.organeParent') as organeParent,
json_extract_string(json, '$.organe.chambre') as chambre,
json_extract_string(json, '$.organe.regime') as regime,
json_extract_string(json, '$.organe.legislature') as legislature,
date_T_insert
FROM __dbt__cte__stg_organes
    );
  
  
  
[0m20:49:06.802465 [debug] [Thread-1 (]: SQL status: OK in 0.547 seconds
[0m20:49:06.805085 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:49:06.805285 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m20:49:06.805825 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:49:06.805991 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:49:06.806162 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes__b016f4f7d3ed'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:49:06.807983 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:49:06.810824 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:49:06.811034 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:49:06.812529 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:49:06.814022 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:49:06.814201 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:49:06.815564 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:49:06.816632 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_organes"
[0m20:49:06.818002 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:49:06.818210 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

        
            delete from "an_data_pipeline"."main"."int_organes"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_organes__b016f4f7d3ed"
            );

        
    

    insert into "an_data_pipeline"."main"."int_organes" ("uid", "codeType", "libelle", "libelleEdition", "libelleAbrege", "libelleAbrev", "dateDebut", "dateAgrement", "dateFin", "organeParent", "chambre", "regime", "legislature")
    (
        select "uid", "codeType", "libelle", "libelleEdition", "libelleAbrege", "libelleAbrev", "dateDebut", "dateAgrement", "dateFin", "organeParent", "chambre", "regime", "legislature"
        from "an_data_pipeline"."dbt_temp"."int_organes__b016f4f7d3ed"
    )
  
[0m20:49:07.061559 [debug] [Thread-1 (]: SQL status: OK in 0.242 seconds
[0m20:49:07.066905 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m20:49:07.067998 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:49:07.068656 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m20:49:07.251093 [debug] [Thread-1 (]: SQL status: OK in 0.182 seconds
[0m20:49:07.254043 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:49:07.254320 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__b016f4f7d3ed" cascade
    
[0m20:49:07.474513 [debug] [Thread-1 (]: SQL status: OK in 0.220 seconds
[0m20:49:07.476580 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:49:07.476762 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__b016f4f7d3ed" cascade
    
[0m20:49:07.581825 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m20:49:07.583502 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: Close
[0m20:49:07.584466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdad19b8-6714-49f5-8c9d-fcec381145f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107493260>]}
[0m20:49:07.585233 [info ] [Thread-1 (]: 6 of 10 OK created sql incremental model main.int_organes ...................... [[32mOK[0m in 1.69s]
[0m20:49:07.585756 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_organes
[0m20:49:07.586139 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_pays
[0m20:49:07.586751 [info ] [Thread-1 (]: 7 of 10 START sql incremental model main.int_pays .............................. [RUN]
[0m20:49:07.587160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_organes, now model.dbt_an_data.int_pays)
[0m20:49:07.587469 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_pays
[0m20:49:07.604313 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_pays"
[0m20:49:07.605802 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_pays
[0m20:49:07.608992 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:49:07.609256 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__5e94549e74ff" cascade
    
[0m20:49:07.609509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:07.724807 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m20:49:07.730296 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:49:07.731054 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:49:07.733213 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:49:07.735273 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:49:07.735789 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m20:49:07.736933 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:49:07.737377 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:49:07.737811 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:49:07.845935 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m20:49:07.849560 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:49:07.850650 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    

  
[0m20:49:07.851814 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:49:07.854961 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m20:49:07.855691 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:49:07.856360 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m20:49:07.963444 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m20:49:07.966047 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:49:07.966748 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_pays__5e94549e74ff"
  
    as (
      

with __dbt__cte__stg_pays as (
SELECT * 
FROM "database"."stg"."raw_pays"
) SELECT
json_extract_string(json, '$.pays.uid') as uid,
json_extract_string(json, '$.pays.code_insee') as code_insee,
json_extract_string(json, '$.pays.libelleInsee') as libelleInsee,
json_extract_string(json, '$.pays.nomCourant') as nomCourant,
json_extract_string(json, '$.pays.code_iso2A') as code_iso2A,
json_extract_string(json, '$.pays.code_iso3A') as code_iso3A,
json_extract_string(json, '$.pays.code_iso3N') as code_iso3N,
json_extract_string(json, '$.pays.libelleIso') as libelleIso,
json_extract_string(json, '$.pays.libelleANCourt') as libelleANCourt,
json_extract_string(json, '$.pays.libelleANLong') as libelleANLong,
json_extract_string(json, '$.pays.sourceJuridique') as sourceJuridique,
json_extract_string(json, '$.pays.activ') as activ,
date_T_insert
FROM __dbt__cte__stg_pays
    );
  
  
  
[0m20:49:08.319060 [debug] [Thread-1 (]: SQL status: OK in 0.352 seconds
[0m20:49:08.322912 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:49:08.323345 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m20:49:08.324519 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:49:08.324914 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:49:08.325311 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays__5e94549e74ff'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:49:08.329426 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:49:08.332529 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:49:08.332881 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:49:08.335705 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:49:08.338245 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:49:08.338553 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:49:08.340938 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:49:08.342748 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_pays"
[0m20:49:08.343512 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:49:08.343799 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

        
            delete from "an_data_pipeline"."main"."int_pays"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_pays__5e94549e74ff"
            );

        
    

    insert into "an_data_pipeline"."main"."int_pays" ("uid", "code_insee", "libelleInsee", "nomCourant", "code_iso2A", "code_iso3A", "code_iso3N", "libelleIso", "libelleANCourt", "libelleANLong", "sourceJuridique", "activ")
    (
        select "uid", "code_insee", "libelleInsee", "nomCourant", "code_iso2A", "code_iso3A", "code_iso3N", "libelleIso", "libelleANCourt", "libelleANLong", "sourceJuridique", "activ"
        from "an_data_pipeline"."dbt_temp"."int_pays__5e94549e74ff"
    )
  
[0m20:49:08.578547 [debug] [Thread-1 (]: SQL status: OK in 0.234 seconds
[0m20:49:08.584389 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m20:49:08.585088 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:49:08.585547 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m20:49:08.704041 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m20:49:08.705390 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:49:08.705576 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__5e94549e74ff" cascade
    
[0m20:49:08.934069 [debug] [Thread-1 (]: SQL status: OK in 0.228 seconds
[0m20:49:08.935859 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:49:08.936067 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__5e94549e74ff" cascade
    
[0m20:49:09.048014 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m20:49:09.048971 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: Close
[0m20:49:09.049320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdad19b8-6714-49f5-8c9d-fcec381145f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108057bf0>]}
[0m20:49:09.049672 [info ] [Thread-1 (]: 7 of 10 OK created sql incremental model main.int_pays ......................... [[32mOK[0m in 1.46s]
[0m20:49:09.050057 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_pays
[0m20:49:09.050297 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_reunions
[0m20:49:09.050597 [info ] [Thread-1 (]: 8 of 10 START sql incremental model main.int_reunions .......................... [RUN]
[0m20:49:09.050863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_pays, now model.dbt_an_data.int_reunions)
[0m20:49:09.051068 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_reunions
[0m20:49:09.058278 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_reunions"
[0m20:49:09.058744 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_reunions
[0m20:49:09.060999 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:49:09.061217 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__3cd971593d0a" cascade
    
[0m20:49:09.061410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:09.168163 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m20:49:09.173358 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:49:09.173904 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:49:09.175893 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:49:09.178265 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:49:09.179023 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m20:49:09.180569 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:49:09.181091 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:49:09.181568 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:49:09.289214 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m20:49:09.293452 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:49:09.294239 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    

  
[0m20:49:09.295167 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:49:09.297496 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m20:49:09.298237 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:49:09.298899 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m20:49:09.401368 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m20:49:09.401958 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:49:09.402172 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_reunions__3cd971593d0a"
  
    as (
      

with __dbt__cte__stg_reunions as (
SELECT * 
FROM "database"."stg"."raw_reunions"
) SELECT
json_extract_string(json, '$.reunion.uid') AS uid,
json_extract_string(json, '$.reunion.timeStampDebut') AS timeStampDebut,
json_extract_string(json, '$.reunion.lieu.lieuRef') AS lieuRef,
json_extract_string(json, '$.reunion.lieu.libelleLong') AS lieuLibelle,
json_extract_string(json, '$.reunion.cycleDeVie.etat') AS cycleDeVieEtat,
json_extract_string(json, '$.reunion.demandeur') AS demandeur,
json_extract_string(json, '$.reunion.organeReuniRef') AS organeReuniRef,
json_extract_string(json, '$.reunion.visioConference') AS visioConference,
json_extract_string(json, '$.reunion.sessionRef') AS sessionRef,
json_extract_string(json, '$.reunion.ouverturePresse') AS ouverturePresse,
json_extract_string(json, '$.reunion.captationVideo') AS captationVideo,
json_extract_string(json, '$.reunion.ODJ.convocationODJ.item') AS convocationODJ,
json_extract_string(json, '$.reunion.ODJ.resumeODJ.item') AS resumeODJ,
json_extract_string(json, '$.reunion.compteRenduRef') AS compteRenduRef,
json_extract_string(json, '$.reunion.identifiants.numSeanceJO') AS numSeanceJO,
json_extract_string(json, '$.reunion.identifiants.idJO') AS idJO,
json_extract_string(json, '$.reunion.identifiants.quantieme') AS quantieme,
json_extract_string(json, '$.reunion.identifiants.DataSeance') AS DataSeance,
date_T_insert
FROM __dbt__cte__stg_reunions
    );
  
  
  
[0m20:49:10.434133 [debug] [Thread-1 (]: SQL status: OK in 1.031 seconds
[0m20:49:10.437250 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:49:10.437434 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m20:49:10.437980 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:49:10.438132 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:49:10.438291 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions__3cd971593d0a'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:49:10.440347 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:49:10.442090 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:49:10.442291 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:49:10.443896 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:49:10.446283 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:49:10.446476 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:49:10.447878 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:49:10.449074 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_reunions"
[0m20:49:10.449523 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:49:10.449700 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

        
            delete from "an_data_pipeline"."main"."int_reunions"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_reunions__3cd971593d0a"
            );

        
    

    insert into "an_data_pipeline"."main"."int_reunions" ("uid", "timeStampDebut", "lieuRef", "lieuLibelle", "cycleDeVieEtat", "demandeur", "organeReuniRef", "visioConference", "sessionRef", "ouverturePresse", "captationVideo", "convocationODJ", "resumeODJ", "compteRenduRef", "numSeanceJO", "idJO", "quantieme", "DataSeance")
    (
        select "uid", "timeStampDebut", "lieuRef", "lieuLibelle", "cycleDeVieEtat", "demandeur", "organeReuniRef", "visioConference", "sessionRef", "ouverturePresse", "captationVideo", "convocationODJ", "resumeODJ", "compteRenduRef", "numSeanceJO", "idJO", "quantieme", "DataSeance"
        from "an_data_pipeline"."dbt_temp"."int_reunions__3cd971593d0a"
    )
  
[0m20:49:10.686118 [debug] [Thread-1 (]: SQL status: OK in 0.236 seconds
[0m20:49:10.688651 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m20:49:10.689291 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:49:10.689748 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m20:49:10.869757 [debug] [Thread-1 (]: SQL status: OK in 0.180 seconds
[0m20:49:10.871139 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:49:10.871321 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__3cd971593d0a" cascade
    
[0m20:49:11.098054 [debug] [Thread-1 (]: SQL status: OK in 0.226 seconds
[0m20:49:11.109732 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:49:11.110743 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__3cd971593d0a" cascade
    
[0m20:49:11.221886 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m20:49:11.224991 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: Close
[0m20:49:11.226190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdad19b8-6714-49f5-8c9d-fcec381145f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10805e2d0>]}
[0m20:49:11.227221 [info ] [Thread-1 (]: 8 of 10 OK created sql incremental model main.int_reunions ..................... [[32mOK[0m in 2.18s]
[0m20:49:11.228187 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_reunions
[0m20:49:11.228880 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins
[0m20:49:11.229765 [info ] [Thread-1 (]: 9 of 10 START sql incremental model main.int_scrutins .......................... [RUN]
[0m20:49:11.230576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_reunions, now model.dbt_an_data.int_scrutins)
[0m20:49:11.231135 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins
[0m20:49:11.246633 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins"
[0m20:49:11.247955 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins
[0m20:49:11.253238 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:49:11.253679 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__20feb52f4348" cascade
    
[0m20:49:11.254043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:11.362507 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m20:49:11.369760 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:49:11.370893 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:49:11.374577 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:49:11.378135 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:49:11.378823 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m20:49:11.380583 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:49:11.381151 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:49:11.381722 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:49:11.488397 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m20:49:11.492001 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:49:11.492930 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    

  
[0m20:49:11.493876 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:49:11.496285 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m20:49:11.497033 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:49:11.497689 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m20:49:11.606126 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m20:49:11.609766 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:49:11.610851 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_scrutins__20feb52f4348"
  
    as (
      

with __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
) SELECT
date_T_insert,
json_extract_string(json, '$.scrutin.uid') AS uid,
json_extract_string(json, '$.scrutin.numero') AS numero,
json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
json_extract_string(json, '$.scrutin.legislature') AS legislature,
json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
json_extract_string(json, '$.scrutin.titre') AS titre,
json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote,
date_T_insert
FROM __dbt__cte__stg_scrutins
    );
  
  
  
[0m20:49:13.379277 [debug] [Thread-1 (]: SQL status: OK in 1.766 seconds
[0m20:49:13.388164 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:49:13.388518 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m20:49:13.389796 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:49:13.390446 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:49:13.390979 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins__20feb52f4348'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:49:13.395889 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:49:13.399309 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:49:13.399747 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:49:13.403494 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:49:13.406839 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:49:13.407194 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:49:13.410058 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:49:13.412645 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins"
[0m20:49:13.413551 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:49:13.413855 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

        
            delete from "an_data_pipeline"."main"."int_scrutins"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_scrutins__20feb52f4348"
            );

        
    

    insert into "an_data_pipeline"."main"."int_scrutins" ("date_T_insert", "uid", "numero", "organeRef", "legislature", "date_scrutin", "titre", "resultat_code", "resultat_libelle", "nb_votants", "suffrages_exprimes", "seuil", "lieu_vote")
    (
        select "date_T_insert", "uid", "numero", "organeRef", "legislature", "date_scrutin", "titre", "resultat_code", "resultat_libelle", "nb_votants", "suffrages_exprimes", "seuil", "lieu_vote"
        from "an_data_pipeline"."dbt_temp"."int_scrutins__20feb52f4348"
    )
  
[0m20:49:13.648103 [debug] [Thread-1 (]: SQL status: OK in 0.234 seconds
[0m20:49:13.650924 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m20:49:13.651552 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:49:13.652017 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m20:49:13.817720 [debug] [Thread-1 (]: SQL status: OK in 0.165 seconds
[0m20:49:13.819361 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:49:13.819635 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__20feb52f4348" cascade
    
[0m20:49:14.685254 [debug] [Thread-1 (]: SQL status: OK in 0.865 seconds
[0m20:49:14.687185 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:49:14.687366 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__20feb52f4348" cascade
    
[0m20:49:14.793019 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m20:49:14.794769 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: Close
[0m20:49:14.795863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdad19b8-6714-49f5-8c9d-fcec381145f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075d6570>]}
[0m20:49:14.796857 [info ] [Thread-1 (]: 9 of 10 OK created sql incremental model main.int_scrutins ..................... [[32mOK[0m in 3.57s]
[0m20:49:14.797527 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins
[0m20:49:14.798001 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins_votes
[0m20:49:14.798676 [info ] [Thread-1 (]: 10 of 10 START sql incremental model main.int_scrutins_votes ................... [RUN]
[0m20:49:14.799108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_scrutins, now model.dbt_an_data.int_scrutins_votes)
[0m20:49:14.799422 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins_votes
[0m20:49:14.830120 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins_votes"
[0m20:49:14.830983 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins_votes
[0m20:49:14.833242 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:49:14.833454 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__7daec9787134" cascade
    
[0m20:49:14.833634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:14.938887 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m20:49:14.941262 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:49:14.941599 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:49:14.942836 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:49:14.943977 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:49:14.944243 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m20:49:14.944894 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:49:14.945120 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:49:14.945348 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:49:15.053536 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m20:49:15.057310 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:49:15.058504 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    

  
[0m20:49:15.059702 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:49:15.062049 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m20:49:15.062774 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:49:15.063429 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m20:49:15.166608 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m20:49:15.167194 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:49:15.167536 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_scrutins_votes__7daec9787134"
  
    as (
      

WITH  __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
), grp AS (
      -- explode les groupes (1 par groupe)
    SELECT
        json_extract_string(j.json, '$.scrutin.uid') AS uid,
        json_extract_string(g.value, '$.organeRef') AS groupe_organe,
        g.value AS groupe_json,
        j.date_T_insert
    FROM __dbt__cte__stg_scrutins j,
    json_each(json->'scrutin'->'ventilationVotes'->'organe'->'groupes'->'groupe') g
  ),

  positions_array AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          date_T_insert
          groupe_organe,
          'pour' AS type_vote,
          p.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'pours'->'votant') p
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          date_T_insert
          groupe_organe,
          'contre' AS type_vote,
          c.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'contres'->'votant') c
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          date_T_insert
          groupe_organe,
          'abstention' AS type_vote,
          a.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'abstentions'->'votant') a
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          date_T_insert
          groupe_organe,
          'nonVotant' AS type_vote,
          n.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'nonVotants'->'votant') n
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[ARRAY]'
  ),
  positions_object AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[OBJECT]'
  ),

  clean AS (
      -- sécurise les champs (souvent string ou null)
      SELECT
          uid,
          groupe_organe,
          type_vote,
          json_extract_string(vote_json, '$.acteurRef') AS acteurRef,
          json_extract_string(vote_json, '$.mandatRef') AS mandatRef,
          json_extract_string(vote_json, '$.parDelegation') AS parDelegation,
          json_extract_string(vote_json, '$.numPlace') AS numPlace,
          json_extract_string(vote_json, '$.causePositionVote') AS cause,
          date_T_insert
      FROM positions_array
      UNION ALL
      SELECT * 
      FROM positions_object
  )

  SELECT * FROM clean
    );
  
  
  
[0m20:49:15.432206 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_scrutins_votes__7daec9787134"
  
    as (
      

WITH  __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
), grp AS (
      -- explode les groupes (1 par groupe)
    SELECT
        json_extract_string(j.json, '$.scrutin.uid') AS uid,
        json_extract_string(g.value, '$.organeRef') AS groupe_organe,
        g.value AS groupe_json,
        j.date_T_insert
    FROM __dbt__cte__stg_scrutins j,
    json_each(json->'scrutin'->'ventilationVotes'->'organe'->'groupes'->'groupe') g
  ),

  positions_array AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          date_T_insert
          groupe_organe,
          'pour' AS type_vote,
          p.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'pours'->'votant') p
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          date_T_insert
          groupe_organe,
          'contre' AS type_vote,
          c.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'contres'->'votant') c
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          date_T_insert
          groupe_organe,
          'abstention' AS type_vote,
          a.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'abstentions'->'votant') a
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          date_T_insert
          groupe_organe,
          'nonVotant' AS type_vote,
          n.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'nonVotants'->'votant') n
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[ARRAY]'
  ),
  positions_object AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[OBJECT]'
  ),

  clean AS (
      -- sécurise les champs (souvent string ou null)
      SELECT
          uid,
          groupe_organe,
          type_vote,
          json_extract_string(vote_json, '$.acteurRef') AS acteurRef,
          json_extract_string(vote_json, '$.mandatRef') AS mandatRef,
          json_extract_string(vote_json, '$.parDelegation') AS parDelegation,
          json_extract_string(vote_json, '$.numPlace') AS numPlace,
          json_extract_string(vote_json, '$.causePositionVote') AS cause,
          date_T_insert
      FROM positions_array
      UNION ALL
      SELECT * 
      FROM positions_object
  )

  SELECT * FROM clean
    );
  
  
  
[0m20:49:15.433040 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:49:15.435375 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:49:15.435682 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__7daec9787134" cascade
    
[0m20:49:15.549760 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m20:49:15.553134 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: Close
[0m20:49:15.570932 [debug] [Thread-1 (]: Runtime Error in model int_scrutins_votes (models/int/int_scrutins_votes.sql)
  Binder Error: Referenced column "date_T_insert" not found in FROM clause!
  Candidate bindings: "type_vote", "vote_json", "groupe_organe"
  
  LINE 142:           date_T_insert
                      ^
[0m20:49:15.571747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdad19b8-6714-49f5-8c9d-fcec381145f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f05af0>]}
[0m20:49:15.572656 [error] [Thread-1 (]: 10 of 10 ERROR creating sql incremental model main.int_scrutins_votes .......... [[31mERROR[0m in 0.77s]
[0m20:49:15.573426 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins_votes
[0m20:49:15.574081 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.int_scrutins_votes' to be skipped because of status 'error'.  Reason: Runtime Error in model int_scrutins_votes (models/int/int_scrutins_votes.sql)
  Binder Error: Referenced column "date_T_insert" not found in FROM clause!
  Candidate bindings: "type_vote", "vote_json", "groupe_organe"
  
  LINE 142:           date_T_insert
                      ^.
[0m20:49:15.579880 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:15.580300 [debug] [MainThread]: On master: BEGIN
[0m20:49:15.580618 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:49:15.581721 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:49:15.582035 [debug] [MainThread]: On master: COMMIT
[0m20:49:15.582318 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:15.582589 [debug] [MainThread]: On master: COMMIT
[0m20:49:15.583079 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:49:15.583363 [debug] [MainThread]: On master: Close
[0m20:49:15.583744 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:15.584039 [debug] [MainThread]: Connection 'model.dbt_an_data.int_scrutins_votes' was properly closed.
[0m20:49:15.584765 [info ] [MainThread]: 
[0m20:49:15.585175 [info ] [MainThread]: Finished running 10 incremental models, 1 project hook in 0 hours 0 minutes and 21.04 seconds (21.04s).
[0m20:49:15.586837 [debug] [MainThread]: Command end result
[0m20:49:15.609802 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m20:49:15.612317 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m20:49:15.617283 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m20:49:15.617491 [info ] [MainThread]: 
[0m20:49:15.617696 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:49:15.617881 [info ] [MainThread]: 
[0m20:49:15.618128 [error] [MainThread]: [31mFailure in model int_scrutins_votes (models/int/int_scrutins_votes.sql)[0m
[0m20:49:15.618339 [error] [MainThread]:   Runtime Error in model int_scrutins_votes (models/int/int_scrutins_votes.sql)
  Binder Error: Referenced column "date_T_insert" not found in FROM clause!
  Candidate bindings: "type_vote", "vote_json", "groupe_organe"
  
  LINE 142:           date_T_insert
                      ^
[0m20:49:15.618495 [info ] [MainThread]: 
[0m20:49:15.618669 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/int/int_scrutins_votes.sql
[0m20:49:15.618821 [info ] [MainThread]: 
[0m20:49:15.619422 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=11
[0m20:49:15.620246 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 21.640041, "process_in_blocks": "0", "process_kernel_time": 1.655765, "process_mem_max_rss": "946814976", "process_out_blocks": "0", "process_user_time": 7.782645}
[0m20:49:15.620578 [debug] [MainThread]: Command `dbt run` failed at 20:49:15.620531 after 21.64 seconds
[0m20:49:15.620871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058ff560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e6f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10728c920>]}
[0m20:49:15.621069 [debug] [MainThread]: Flushing usage events
[0m20:49:16.260988 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:56:46.623062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043ae240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10535b7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10535b470>]}


============================== 20:56:46.626091 | f5363d1b-e774-47d8-95db-04ecd4a8bae1 ==============================
[0m20:56:46.626091 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:56:46.626401 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'write_json': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'warn_error': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'debug': 'False', 'no_print': 'None', 'printer_width': '80', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'version_check': 'True', 'log_cache_events': 'False'}
[0m20:56:46.776885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5363d1b-e774-47d8-95db-04ecd4a8bae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1019b1d60>]}
[0m20:56:46.803687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5363d1b-e774-47d8-95db-04ecd4a8bae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10517fe00>]}
[0m20:56:46.804959 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:56:46.860967 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:56:46.931174 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:56:46.931512 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_scrutins_votes.sql
[0m20:56:47.040188 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_an_data.mart
[0m20:56:47.046108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5363d1b-e774-47d8-95db-04ecd4a8bae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ce2f30>]}
[0m20:56:47.082774 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m20:56:47.084259 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m20:56:47.104933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5363d1b-e774-47d8-95db-04ecd4a8bae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c9b6e0>]}
[0m20:56:47.105207 [info ] [MainThread]: Found 17 models, 1 operation, 9 sources, 469 macros
[0m20:56:47.106486 [info ] [MainThread]: 
[0m20:56:47.106660 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m20:56:47.106793 [info ] [MainThread]: 
[0m20:56:47.107023 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:56:47.109297 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_an_data_pipeline'
[0m20:56:47.178786 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline"
[0m20:56:47.179051 [debug] [ThreadPool]: On list_an_data_pipeline: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"an_data_pipeline"'
    
  
  
[0m20:56:47.179210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:49.377210 [debug] [ThreadPool]: SQL status: OK in 2.198 seconds
[0m20:56:49.380596 [debug] [ThreadPool]: On list_an_data_pipeline: Close
[0m20:56:49.381880 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_an_data_pipeline, now create_an_data_pipeline_main)
[0m20:56:49.382564 [debug] [ThreadPool]: Creating schema "database: "an_data_pipeline"
schema: "main"
"
[0m20:56:49.396432 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m20:56:49.397754 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:56:49.398190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:49.400899 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:56:49.405108 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m20:56:49.405603 [debug] [ThreadPool]: On create_an_data_pipeline_main: BEGIN
[0m20:56:49.406723 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:56:49.407045 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m20:56:49.407344 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
    
        create schema if not exists "an_data_pipeline"."main"
    
[0m20:56:49.537537 [debug] [ThreadPool]: SQL status: OK in 0.130 seconds
[0m20:56:49.539856 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m20:56:49.540615 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m20:56:49.541226 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m20:56:49.650960 [debug] [ThreadPool]: SQL status: OK in 0.109 seconds
[0m20:56:49.652543 [debug] [ThreadPool]: On create_an_data_pipeline_main: Close
[0m20:56:49.657002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_an_data_pipeline_main, now list_an_data_pipeline_main)
[0m20:56:49.667962 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m20:56:49.668710 [debug] [ThreadPool]: On list_an_data_pipeline_main: BEGIN
[0m20:56:49.669143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:49.671222 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:56:49.671785 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m20:56:49.672264 [debug] [ThreadPool]: On list_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline_main"} */
select
      'an_data_pipeline' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'an_data_pipeline'
  
[0m20:56:49.692667 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m20:56:49.694499 [debug] [ThreadPool]: On list_an_data_pipeline_main: ROLLBACK
[0m20:56:49.696283 [debug] [ThreadPool]: Failed to rollback 'list_an_data_pipeline_main'
[0m20:56:49.696582 [debug] [ThreadPool]: On list_an_data_pipeline_main: Close
[0m20:56:49.698488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5363d1b-e774-47d8-95db-04ecd4a8bae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055f6f00>]}
[0m20:56:49.699004 [debug] [MainThread]: Using duckdb connection "master"
[0m20:56:49.699289 [debug] [MainThread]: On master: BEGIN
[0m20:56:49.699531 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:56:49.700426 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:56:49.700686 [debug] [MainThread]: On master: COMMIT
[0m20:56:49.700924 [debug] [MainThread]: Using duckdb connection "master"
[0m20:56:49.701155 [debug] [MainThread]: On master: COMMIT
[0m20:56:49.701564 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:56:49.707760 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_an_data.dbt_an_data-on-run-start-0"
[0m20:56:49.711783 [info ] [MainThread]: 1 of 1 START hook: dbt_an_data.on-run-start.0 .................................. [RUN]
[0m20:56:49.712151 [debug] [MainThread]: Using duckdb connection "master"
[0m20:56:49.712410 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "master"} */
ATTACH '../data/database/database.duckdb' AS database (READ_ONLY)
[0m20:56:49.720115 [debug] [MainThread]: SQL status: OK in 0.007 seconds
[0m20:56:49.720838 [info ] [MainThread]: 1 of 1 OK hook: dbt_an_data.on-run-start.0 ..................................... [[32mOK[0m in 0.02s]
[0m20:56:49.721055 [info ] [MainThread]: 
[0m20:56:49.721262 [debug] [MainThread]: On master: Close
[0m20:56:49.723398 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_acteurs
[0m20:56:49.723687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_an_data_pipeline_main, now model.dbt_an_data.stg_acteurs)
[0m20:56:49.723886 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_acteurs
[0m20:56:49.726697 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_acteurs"
[0m20:56:49.727512 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_acteurs
[0m20:56:49.727731 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_agenda
[0m20:56:49.727975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_acteurs, now model.dbt_an_data.stg_agenda)
[0m20:56:49.728194 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_agenda
[0m20:56:49.766075 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_agenda"
[0m20:56:49.766716 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_agenda
[0m20:56:49.766904 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_amendements
[0m20:56:49.767073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_agenda, now model.dbt_an_data.stg_amendements)
[0m20:56:49.767228 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_amendements
[0m20:56:49.768484 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_amendements"
[0m20:56:49.769110 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_amendements
[0m20:56:49.769296 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_organes
[0m20:56:49.769479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_amendements, now model.dbt_an_data.stg_organes)
[0m20:56:49.769646 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_organes
[0m20:56:49.770829 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_organes"
[0m20:56:49.771193 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_organes
[0m20:56:49.771353 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_pays
[0m20:56:49.771516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_organes, now model.dbt_an_data.stg_pays)
[0m20:56:49.771667 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_pays
[0m20:56:49.772758 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_pays"
[0m20:56:49.773074 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_pays
[0m20:56:49.773225 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_reunions
[0m20:56:49.773379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_pays, now model.dbt_an_data.stg_reunions)
[0m20:56:49.773520 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_reunions
[0m20:56:49.774709 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_reunions"
[0m20:56:49.775054 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_reunions
[0m20:56:49.775203 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_scrutins
[0m20:56:49.775360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_reunions, now model.dbt_an_data.stg_scrutins)
[0m20:56:49.775515 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_scrutins
[0m20:56:49.776625 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_scrutins"
[0m20:56:49.776954 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_scrutins
[0m20:56:49.777105 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_acteurs
[0m20:56:49.777316 [info ] [Thread-1 (]: 1 of 10 START sql incremental model main.int_acteurs ........................... [RUN]
[0m20:56:49.777512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_scrutins, now model.dbt_an_data.int_acteurs)
[0m20:56:49.777653 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_acteurs
[0m20:56:49.781846 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_acteurs"
[0m20:56:49.782274 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_acteurs
[0m20:56:49.785749 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:56:49.785937 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__01d419f4593a" cascade
    
[0m20:56:49.786092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:49.891696 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m20:56:49.921758 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:56:49.922029 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:56:49.922880 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:49.923656 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:56:49.923849 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m20:56:49.924281 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:49.924454 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:56:49.924620 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:56:50.028814 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m20:56:50.030508 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:56:50.031031 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    

  
[0m20:56:50.031585 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:50.033087 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m20:56:50.033563 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:56:50.033979 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m20:56:50.298921 [debug] [Thread-1 (]: SQL status: OK in 0.264 seconds
[0m20:56:50.325516 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:56:50.326291 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_acteurs__01d419f4593a"
  
    as (
      

with __dbt__cte__stg_acteurs as (
SELECT * 
FROM "database"."stg"."raw_acteurs"
) SELECT 
json_extract_string(json, '$.acteur.uid.#text') as uid,
json_extract_string(json, '$.acteur.etatCivil.ident.civ') as civ,
json_extract_string(json, '$.acteur.etatCivil.ident.prenom') as prenom,
json_extract_string(json, '$.acteur.etatCivil.ident.nom') as nom,
json_extract_string(json, '$.acteur.etatCivil.ident.trigramme') as trigramme,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.dateNais') as dateNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.villeNais') as villeNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.depNais') as depNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.paysNais') as paysNais,
json_extract_string(json, '$.acteur.etatCivil.dateDeces') as dateDeces,
json_extract_string(json, '$.acteur.profession.libelleCourant') as libelleCourant,
json_extract_string(json, '$.acteur.profession.socProcINSEE.catSocPro') as catSocPro,
json_extract_string(json, '$.acteur.profession.socProcINSEE.famSocPro') as famSocPro,
json_extract_string(json, '$.acteur.uri_hatvp') as uri_hatvp,
date_T_insert
FROM __dbt__cte__stg_acteurs
    );
  
  
  
[0m20:56:50.990658 [debug] [Thread-1 (]: SQL status: OK in 0.663 seconds
[0m20:56:51.002535 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:56:51.003024 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m20:56:51.004381 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:51.004757 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:56:51.005132 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs__01d419f4593a'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:56:51.012496 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:56:51.018054 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:56:51.018432 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:56:51.021253 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:56:51.027596 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:56:51.027955 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:56:51.030378 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:56:51.031599 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:56:51.031858 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */
SELECT version()
[0m20:56:51.032303 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:51.042103 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_acteurs"
[0m20:56:51.043010 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:56:51.043250 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

        
            delete from "an_data_pipeline"."main"."int_acteurs"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_acteurs__01d419f4593a"
            );

        
    

    insert into "an_data_pipeline"."main"."int_acteurs" ("uid", "civ", "prenom", "nom", "trigramme", "dateNais", "villeNais", "depNais", "paysNais", "dateDeces", "libelleCourant", "catSocPro", "famSocPro", "uri_hatvp")
    (
        select "uid", "civ", "prenom", "nom", "trigramme", "dateNais", "villeNais", "depNais", "paysNais", "dateDeces", "libelleCourant", "catSocPro", "famSocPro", "uri_hatvp"
        from "an_data_pipeline"."dbt_temp"."int_acteurs__01d419f4593a"
    )
  
[0m20:56:51.360481 [debug] [Thread-1 (]: SQL status: OK in 0.316 seconds
[0m20:56:51.380434 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m20:56:51.381123 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:56:51.381596 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m20:56:51.516188 [debug] [Thread-1 (]: SQL status: OK in 0.134 seconds
[0m20:56:51.517517 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:56:51.517676 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__01d419f4593a" cascade
    
[0m20:56:51.761780 [debug] [Thread-1 (]: SQL status: OK in 0.244 seconds
[0m20:56:51.763457 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:56:51.763638 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__01d419f4593a" cascade
    
[0m20:56:51.936653 [debug] [Thread-1 (]: SQL status: OK in 0.173 seconds
[0m20:56:51.940534 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: Close
[0m20:56:51.943718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5363d1b-e774-47d8-95db-04ecd4a8bae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104498f50>]}
[0m20:56:51.944783 [info ] [Thread-1 (]: 1 of 10 OK created sql incremental model main.int_acteurs ...................... [[32mOK[0m in 2.16s]
[0m20:56:51.945669 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_acteurs
[0m20:56:51.946222 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_mandats
[0m20:56:51.946928 [info ] [Thread-1 (]: 2 of 10 START sql incremental model main.int_mandats ........................... [RUN]
[0m20:56:51.947561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_acteurs, now model.dbt_an_data.int_mandats)
[0m20:56:51.948026 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_mandats
[0m20:56:51.959683 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_mandats"
[0m20:56:51.960709 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_mandats
[0m20:56:51.964952 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:56:51.965336 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__2345533debf6" cascade
    
[0m20:56:51.965646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:52.090299 [debug] [Thread-1 (]: SQL status: OK in 0.124 seconds
[0m20:56:52.099105 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:56:52.099967 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:56:52.103607 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:56:52.106995 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:56:52.107792 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m20:56:52.109499 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:52.109956 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:56:52.110377 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:56:52.226524 [debug] [Thread-1 (]: SQL status: OK in 0.115 seconds
[0m20:56:52.230231 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:56:52.231355 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    

  
[0m20:56:52.232303 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:52.234671 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m20:56:52.235504 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:56:52.236352 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m20:56:52.401541 [debug] [Thread-1 (]: SQL status: OK in 0.165 seconds
[0m20:56:52.402099 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:56:52.402290 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_mandats__2345533debf6"
  
    as (
      

with __dbt__cte__stg_acteurs as (
SELECT * 
FROM "database"."stg"."raw_acteurs"
) SELECT 
json_extract_string(mandat.value, '$.uid') as uid,
json_extract_string(mandat.value, '$.acteurRef') as acteurRef,
json_extract_string(mandat.value, '$.legislature') as legislature,
json_extract_string(mandat.value, '$.typeOrgane') as typeOrgane,
json_extract_string(mandat.value, '$.dateDebut') as dateDebut,
json_extract_string(mandat.value, '$.dateFin') as dateFin,
json_extract_string(mandat.value, '$.preseance') as preseance,
json_extract_string(mandat.value, '$.nominPrincipale') as nominPrincipale,
json_extract_string(mandat.value, '$.infosQualite.codeQualite') as codeQualite,
json_extract_string(mandat.value, '$.organes.organeRef') as organeRef,
date_T_insert
FROM __dbt__cte__stg_acteurs act, json_each(json->'acteur'->'mandats'->'mandat') mandat
    );
  
  
  
[0m20:56:53.598382 [debug] [Thread-1 (]: SQL status: OK in 1.195 seconds
[0m20:56:53.614457 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:56:53.614968 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m20:56:53.616388 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:53.616762 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:56:53.617149 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats__2345533debf6'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:56:53.620992 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:56:53.624627 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:56:53.624948 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:56:53.627422 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:56:53.630566 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:56:53.630876 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:56:53.633116 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:56:53.635511 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_mandats"
[0m20:56:53.636433 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:56:53.636729 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

        
            delete from "an_data_pipeline"."main"."int_mandats"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_mandats__2345533debf6"
            );

        
    

    insert into "an_data_pipeline"."main"."int_mandats" ("uid", "acteurRef", "legislature", "typeOrgane", "dateDebut", "dateFin", "preseance", "nominPrincipale", "codeQualite", "organeRef")
    (
        select "uid", "acteurRef", "legislature", "typeOrgane", "dateDebut", "dateFin", "preseance", "nominPrincipale", "codeQualite", "organeRef"
        from "an_data_pipeline"."dbt_temp"."int_mandats__2345533debf6"
    )
  
[0m20:56:53.978508 [debug] [Thread-1 (]: SQL status: OK in 0.341 seconds
[0m20:56:53.983878 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m20:56:53.984773 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:56:53.985457 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m20:56:54.223076 [debug] [Thread-1 (]: SQL status: OK in 0.236 seconds
[0m20:56:54.232581 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:56:54.233846 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__2345533debf6" cascade
    
[0m20:56:54.495948 [debug] [Thread-1 (]: SQL status: OK in 0.261 seconds
[0m20:56:54.497672 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:56:54.497845 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__2345533debf6" cascade
    
[0m20:56:54.606335 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m20:56:54.608050 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: Close
[0m20:56:54.609076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5363d1b-e774-47d8-95db-04ecd4a8bae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059de7e0>]}
[0m20:56:54.609964 [info ] [Thread-1 (]: 2 of 10 OK created sql incremental model main.int_mandats ...................... [[32mOK[0m in 2.66s]
[0m20:56:54.610585 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_mandats
[0m20:56:54.610960 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_agenda
[0m20:56:54.611606 [info ] [Thread-1 (]: 3 of 10 START sql incremental model main.int_agenda ............................ [RUN]
[0m20:56:54.612111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_mandats, now model.dbt_an_data.int_agenda)
[0m20:56:54.612442 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_agenda
[0m20:56:54.616421 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_agenda"
[0m20:56:54.617254 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_agenda
[0m20:56:54.620163 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:56:54.620421 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__78c31416354a" cascade
    
[0m20:56:54.620664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:54.737606 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m20:56:54.741871 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:56:54.742496 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:56:54.744408 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:54.746472 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:56:54.746975 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m20:56:54.748406 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:54.749878 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:56:54.750416 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:56:54.860787 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m20:56:54.863432 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:56:54.864174 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    

  
[0m20:56:54.864982 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:54.867249 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m20:56:54.868019 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:56:54.868684 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m20:56:55.018289 [debug] [Thread-1 (]: SQL status: OK in 0.149 seconds
[0m20:56:55.018851 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:56:55.019039 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_agenda__78c31416354a"
  
    as (
      

with __dbt__cte__stg_agenda as (
SELECT * 
FROM "database"."stg"."raw_agenda"
) SELECT * 
FROM __dbt__cte__stg_agenda
    );
  
  
  
[0m20:56:55.379858 [debug] [Thread-1 (]: SQL status: OK in 0.361 seconds
[0m20:56:55.382623 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:56:55.382965 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m20:56:55.383987 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:55.384345 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:56:55.384716 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda__78c31416354a'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:56:55.388759 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:56:55.393555 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:56:55.394247 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:56:55.398780 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:56:55.403222 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:56:55.403708 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:56:55.407257 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:56:55.411806 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_agenda"
[0m20:56:55.412634 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:56:55.413004 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

        
            delete from "an_data_pipeline"."main"."int_agenda" as DBT_INCREMENTAL_TARGET
            using "an_data_pipeline"."dbt_temp"."int_agenda__78c31416354a"
            where (
                
                    "an_data_pipeline"."dbt_temp"."int_agenda__78c31416354a".Date = DBT_INCREMENTAL_TARGET.Date
                    and 
                
                    "an_data_pipeline"."dbt_temp"."int_agenda__78c31416354a".Heure = DBT_INCREMENTAL_TARGET.Heure
                    
                
                
            );
        
    

    insert into "an_data_pipeline"."main"."int_agenda" ("Date", "Heure", "Ordre(s) du jour", "filename", "date_T_insert")
    (
        select "Date", "Heure", "Ordre(s) du jour", "filename", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_agenda__78c31416354a"
    )
  
[0m20:56:55.676368 [debug] [Thread-1 (]: SQL status: OK in 0.263 seconds
[0m20:56:55.678391 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m20:56:55.678931 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:56:55.679386 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m20:56:55.814247 [debug] [Thread-1 (]: SQL status: OK in 0.134 seconds
[0m20:56:55.815670 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:56:55.815875 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__78c31416354a" cascade
    
[0m20:56:56.066573 [debug] [Thread-1 (]: SQL status: OK in 0.250 seconds
[0m20:56:56.068180 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:56:56.068354 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__78c31416354a" cascade
    
[0m20:56:56.174719 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m20:56:56.175891 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: Close
[0m20:56:56.176331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5363d1b-e774-47d8-95db-04ecd4a8bae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a4d9dc0>]}
[0m20:56:56.176796 [info ] [Thread-1 (]: 3 of 10 OK created sql incremental model main.int_agenda ....................... [[32mOK[0m in 1.56s]
[0m20:56:56.177182 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_agenda
[0m20:56:56.177469 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements
[0m20:56:56.177879 [info ] [Thread-1 (]: 4 of 10 START sql incremental model main.int_amendements ....................... [RUN]
[0m20:56:56.178254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_agenda, now model.dbt_an_data.int_amendements)
[0m20:56:56.178503 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements
[0m20:56:56.189670 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements"
[0m20:56:56.190147 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements
[0m20:56:56.192165 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:56:56.192365 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__10ff5f867d55" cascade
    
[0m20:56:56.192539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:56.307363 [debug] [Thread-1 (]: SQL status: OK in 0.115 seconds
[0m20:56:56.308915 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:56:56.309141 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:56:56.309934 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:56.310691 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:56:56.310891 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m20:56:56.311328 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:56.311502 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:56:56.311676 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:56:56.419320 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m20:56:56.420938 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:56:56.421472 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    

  
[0m20:56:56.422030 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:56.423716 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m20:56:56.424106 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:56:56.424449 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m20:56:56.593169 [debug] [Thread-1 (]: SQL status: OK in 0.168 seconds
[0m20:56:56.594732 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:56:56.595671 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_amendements__10ff5f867d55"
  
    as (
      

with __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
) SELECT
json_extract_string(json, '$.amendement.uid') AS uid,
json_extract_string(json, '$.amendement.chronotag') AS chronotag,
json_extract_string(json, '$.amendement.examenRef') AS examenRef,
json_extract_string(json, '$.amendement.amendementParentRef') AS amendementParentRef,
json_extract_string(json, '$.amendement.signataires.auteur.typeAuteur') AS typeAuteur,
json_extract_string(json, '$.amendement.signataires.auteur.acteurRef') AS refAuteur,
json_extract_string(json, '$.amendement.signataires.auteur.groupePolitique') AS groupePolitiqueAuteur,
json_extract_string(json, '$.amendement.cycleDeVie.dateDepot') AS dateDepot,
json_extract_string(json, '$.amendement.cycleDeVie.datePublication') AS datePublication,
json_extract_string(json, '$.amendement.cycleDeVie.soumisArticle40') AS soumisArticle40,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.code') AS codeEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.libelle') AS libelleEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.code') AS codeSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.dateSort') AS dateSort,
json_extract_string(json, '$.amendement.cycleDeVie.sort') AS sort,
split_part(replace(filename, '.json', ''), '/', -1) AS id_amendement,
split_part(replace(filename, '.json', ''), '/', -2) AS id_texte,
split_part(replace(filename, '.json', ''), '/', -3) AS id_dossier_legislatif,
id_texte[:4] AS nature_texte,
id_texte[5:6] AS source_texte,
regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 1) AS prefix_bibard,
regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 2) AS numero_bibard,
regexp_extract(id_amendement, '(SEA|PO\d*)', 1) AS code_organe,
regexp_extract(id_amendement, '(P)(\d*)(D)', 2) AS numero_partie,
regexp_extract(id_amendement, '(D)(\d*)(N)', 2) AS numero_deliberation,
regexp_extract(id_amendement, '(D)(\d*)(N)(\d*)', 4) AS numero_court,
date_T_insert
from __dbt__cte__stg_amendements
    );
  
  
  
[0m20:56:56.958313 [debug] [Thread-1 (]: SQL status: OK in 0.362 seconds
[0m20:56:56.960702 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:56:56.961001 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m20:56:56.961684 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:56.961901 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:56:56.962124 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements__10ff5f867d55'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:56:56.964370 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:56:56.966533 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:56:56.966784 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:56:56.968706 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:56:56.970908 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:56:56.971152 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:56:56.973053 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:56:56.974555 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements"
[0m20:56:56.975017 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:56:56.975241 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

        
            delete from "an_data_pipeline"."main"."int_amendements"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_amendements__10ff5f867d55"
            );

        
    

    insert into "an_data_pipeline"."main"."int_amendements" ("uid", "chronotag", "examenRef", "amendementParentRef", "typeAuteur", "refAuteur", "groupePolitiqueAuteur", "dateDepot", "datePublication", "soumisArticle40", "codeEtat", "libelleEtat", "codeSousEtat", "libelleSousEtat", "libelleSousEtat_1", "dateSort", "sort", "id_amendement", "id_texte", "id_dossier_legislatif", "nature_texte", "source_texte", "prefix_bibard", "numero_bibard", "code_organe", "numero_partie", "numero_deliberation", "numero_court")
    (
        select "uid", "chronotag", "examenRef", "amendementParentRef", "typeAuteur", "refAuteur", "groupePolitiqueAuteur", "dateDepot", "datePublication", "soumisArticle40", "codeEtat", "libelleEtat", "codeSousEtat", "libelleSousEtat", "libelleSousEtat_1", "dateSort", "sort", "id_amendement", "id_texte", "id_dossier_legislatif", "nature_texte", "source_texte", "prefix_bibard", "numero_bibard", "code_organe", "numero_partie", "numero_deliberation", "numero_court"
        from "an_data_pipeline"."dbt_temp"."int_amendements__10ff5f867d55"
    )
  
[0m20:56:57.232752 [debug] [Thread-1 (]: SQL status: OK in 0.257 seconds
[0m20:56:57.233637 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m20:56:57.233851 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:56:57.234020 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m20:56:57.351695 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m20:56:57.353643 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:56:57.353925 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__10ff5f867d55" cascade
    
[0m20:56:57.758183 [debug] [Thread-1 (]: SQL status: OK in 0.404 seconds
[0m20:56:57.761071 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:56:57.761261 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__10ff5f867d55" cascade
    
[0m20:56:57.871747 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m20:56:57.873114 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: Close
[0m20:56:57.873649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5363d1b-e774-47d8-95db-04ecd4a8bae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a507e90>]}
[0m20:56:57.874242 [info ] [Thread-1 (]: 4 of 10 OK created sql incremental model main.int_amendements .................. [[32mOK[0m in 1.70s]
[0m20:56:57.874741 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements
[0m20:56:57.875105 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements_cosignataires
[0m20:56:57.875581 [info ] [Thread-1 (]: 5 of 10 START sql incremental model main.int_amendements_cosignataires ......... [RUN]
[0m20:56:57.876021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements, now model.dbt_an_data.int_amendements_cosignataires)
[0m20:56:57.876360 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements_cosignataires
[0m20:56:57.884519 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements_cosignataires"
[0m20:56:57.885223 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements_cosignataires
[0m20:56:57.888235 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:56:57.888541 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__1f4120d299d7" cascade
    
[0m20:56:57.888786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:58.000043 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m20:56:58.005744 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:56:58.006606 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:56:58.009080 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:56:58.011761 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:56:58.012409 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m20:56:58.013935 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:58.014371 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:56:58.014799 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:56:58.289950 [debug] [Thread-1 (]: SQL status: OK in 0.274 seconds
[0m20:56:58.294012 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:56:58.295011 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    

  
[0m20:56:58.295891 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:58.298264 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m20:56:58.299011 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:56:58.299693 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m20:56:58.406189 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m20:56:58.406750 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:56:58.406932 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__1f4120d299d7"
  
    as (
      

WITH  __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
), cosignataires_arr AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef[*]') AS acteurRef,
    date_T_insert
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') == 'ARRAY' AND acteurRef IS NOT NULL
), cosignataires_str AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef') AS acteurRef,
    date_T_insert
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') <> 'ARRAY' AND acteurRef IS NOT NULL
)
SELECT 
  uid, 
  unnest(acteurRef) as acteurRef,
  date_T_insert
FROM cosignataires_arr
UNION ALL
SELECT 
  uid, 
  acteurRef,
  date_T_insert
FROM cosignataires_str
    );
  
  
  
[0m20:56:58.927509 [debug] [Thread-1 (]: SQL status: OK in 0.520 seconds
[0m20:56:58.929475 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:56:58.929713 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m20:56:58.930364 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:58.930563 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:56:58.930764 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires__1f4120d299d7'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:56:58.934797 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:56:58.939026 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:56:58.939528 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:56:58.942053 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:56:58.944018 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:56:58.944277 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:56:58.946243 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:56:58.947710 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements_cosignataires"
[0m20:56:58.948381 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:56:58.948639 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

        
            delete from "an_data_pipeline"."main"."int_amendements_cosignataires" as DBT_INCREMENTAL_TARGET
            using "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__1f4120d299d7"
            where (
                
                    "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__1f4120d299d7".uid = DBT_INCREMENTAL_TARGET.uid
                    and 
                
                    "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__1f4120d299d7".acteurRef = DBT_INCREMENTAL_TARGET.acteurRef
                    
                
                
            );
        
    

    insert into "an_data_pipeline"."main"."int_amendements_cosignataires" ("uid", "acteurRef")
    (
        select "uid", "acteurRef"
        from "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__1f4120d299d7"
    )
  
[0m20:56:59.208098 [debug] [Thread-1 (]: SQL status: OK in 0.259 seconds
[0m20:56:59.209936 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m20:56:59.210381 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:56:59.210756 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m20:56:59.323186 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m20:56:59.331361 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:56:59.332493 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__1f4120d299d7" cascade
    
[0m20:56:59.561206 [debug] [Thread-1 (]: SQL status: OK in 0.228 seconds
[0m20:56:59.562769 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:56:59.562942 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__1f4120d299d7" cascade
    
[0m20:56:59.670051 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m20:56:59.671625 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: Close
[0m20:56:59.672206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5363d1b-e774-47d8-95db-04ecd4a8bae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e45fa0>]}
[0m20:56:59.672831 [info ] [Thread-1 (]: 5 of 10 OK created sql incremental model main.int_amendements_cosignataires .... [[32mOK[0m in 1.80s]
[0m20:56:59.673332 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements_cosignataires
[0m20:56:59.673677 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_organes
[0m20:56:59.674152 [info ] [Thread-1 (]: 6 of 10 START sql incremental model main.int_organes ........................... [RUN]
[0m20:56:59.674571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements_cosignataires, now model.dbt_an_data.int_organes)
[0m20:56:59.674871 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_organes
[0m20:56:59.684523 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_organes"
[0m20:56:59.685188 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_organes
[0m20:56:59.687769 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:56:59.688032 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__d15cbc8e5a67" cascade
    
[0m20:56:59.688267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:59.796706 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m20:56:59.801761 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:56:59.802402 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:56:59.804672 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:56:59.807291 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:56:59.807806 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m20:56:59.808920 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:59.809360 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:56:59.809788 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:56:59.917778 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m20:56:59.920512 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:56:59.921319 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    

  
[0m20:56:59.922134 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:59.924300 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m20:56:59.925121 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:56:59.925957 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m20:57:00.041270 [debug] [Thread-1 (]: SQL status: OK in 0.115 seconds
[0m20:57:00.042701 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:57:00.043245 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_organes__d15cbc8e5a67"
  
    as (
      

with __dbt__cte__stg_organes as (
SELECT * 
FROM "database"."stg"."raw_organes"
) SELECT 
json_extract_string(json, '$.organe.uid') as uid,
json_extract_string(json, '$.organe.codeType') as codeType,
json_extract_string(json, '$.organe.libelle') as libelle,
json_extract_string(json, '$.organe.libelleEdition') as libelleEdition,
json_extract_string(json, '$.organe.libelleAbrege') as libelleAbrege,
json_extract_string(json, '$.organe.libelleAbrev') as libelleAbrev,
json_extract_string(json, '$.organe.viMoDe.dateDebut') as dateDebut,
json_extract_string(json, '$.organe.viMoDe.dateAgrement') as dateAgrement,
json_extract_string(json, '$.organe.viMoDe.dateFin') as dateFin,
json_extract_string(json, '$.organe.organeParent') as organeParent,
json_extract_string(json, '$.organe.chambre') as chambre,
json_extract_string(json, '$.organe.regime') as regime,
json_extract_string(json, '$.organe.legislature') as legislature,
date_T_insert
FROM __dbt__cte__stg_organes
    );
  
  
  
[0m20:57:01.143711 [debug] [Thread-1 (]: SQL status: OK in 1.100 seconds
[0m20:57:01.147189 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:57:01.147367 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m20:57:01.147875 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:57:01.148031 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:57:01.148181 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes__d15cbc8e5a67'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:57:01.149821 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:57:01.151275 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:57:01.151447 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:57:01.152776 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:57:01.154382 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:57:01.154549 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:57:01.155852 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:57:01.156919 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_organes"
[0m20:57:01.157480 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:57:01.157652 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

        
            delete from "an_data_pipeline"."main"."int_organes"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_organes__d15cbc8e5a67"
            );

        
    

    insert into "an_data_pipeline"."main"."int_organes" ("uid", "codeType", "libelle", "libelleEdition", "libelleAbrege", "libelleAbrev", "dateDebut", "dateAgrement", "dateFin", "organeParent", "chambre", "regime", "legislature")
    (
        select "uid", "codeType", "libelle", "libelleEdition", "libelleAbrege", "libelleAbrev", "dateDebut", "dateAgrement", "dateFin", "organeParent", "chambre", "regime", "legislature"
        from "an_data_pipeline"."dbt_temp"."int_organes__d15cbc8e5a67"
    )
  
[0m20:57:01.406834 [debug] [Thread-1 (]: SQL status: OK in 0.249 seconds
[0m20:57:01.411407 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m20:57:01.412245 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:57:01.412943 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m20:57:01.591504 [debug] [Thread-1 (]: SQL status: OK in 0.178 seconds
[0m20:57:01.592835 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:57:01.593013 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__d15cbc8e5a67" cascade
    
[0m20:57:01.830941 [debug] [Thread-1 (]: SQL status: OK in 0.238 seconds
[0m20:57:01.832502 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:57:01.832669 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__d15cbc8e5a67" cascade
    
[0m20:57:01.944379 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m20:57:01.945735 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: Close
[0m20:57:01.946370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5363d1b-e774-47d8-95db-04ecd4a8bae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055859d0>]}
[0m20:57:01.946972 [info ] [Thread-1 (]: 6 of 10 OK created sql incremental model main.int_organes ...................... [[32mOK[0m in 2.27s]
[0m20:57:01.947482 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_organes
[0m20:57:01.947834 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_pays
[0m20:57:01.948308 [info ] [Thread-1 (]: 7 of 10 START sql incremental model main.int_pays .............................. [RUN]
[0m20:57:01.948741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_organes, now model.dbt_an_data.int_pays)
[0m20:57:01.949070 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_pays
[0m20:57:01.956275 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_pays"
[0m20:57:01.956984 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_pays
[0m20:57:01.959936 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:57:01.960202 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__502487a6a5e3" cascade
    
[0m20:57:01.960458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:02.065215 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m20:57:02.070569 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:57:02.071010 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:57:02.072485 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:57:02.073805 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:57:02.074136 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m20:57:02.074910 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:57:02.075214 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:57:02.075515 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:57:02.183357 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m20:57:02.186222 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:57:02.187126 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    

  
[0m20:57:02.187902 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:57:02.189612 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m20:57:02.190107 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:57:02.190524 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m20:57:02.297438 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m20:57:02.300443 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:57:02.301700 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_pays__502487a6a5e3"
  
    as (
      

with __dbt__cte__stg_pays as (
SELECT * 
FROM "database"."stg"."raw_pays"
) SELECT
json_extract_string(json, '$.pays.uid') as uid,
json_extract_string(json, '$.pays.code_insee') as code_insee,
json_extract_string(json, '$.pays.libelleInsee') as libelleInsee,
json_extract_string(json, '$.pays.nomCourant') as nomCourant,
json_extract_string(json, '$.pays.code_iso2A') as code_iso2A,
json_extract_string(json, '$.pays.code_iso3A') as code_iso3A,
json_extract_string(json, '$.pays.code_iso3N') as code_iso3N,
json_extract_string(json, '$.pays.libelleIso') as libelleIso,
json_extract_string(json, '$.pays.libelleANCourt') as libelleANCourt,
json_extract_string(json, '$.pays.libelleANLong') as libelleANLong,
json_extract_string(json, '$.pays.sourceJuridique') as sourceJuridique,
json_extract_string(json, '$.pays.activ') as activ,
date_T_insert
FROM __dbt__cte__stg_pays
    );
  
  
  
[0m20:57:02.681108 [debug] [Thread-1 (]: SQL status: OK in 0.378 seconds
[0m20:57:02.690571 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:57:02.691427 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m20:57:02.693148 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:57:02.693857 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:57:02.694379 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays__502487a6a5e3'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:57:02.698622 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:57:02.701325 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:57:02.701673 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:57:02.704158 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:57:02.706613 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:57:02.706898 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:57:02.710157 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:57:02.712003 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_pays"
[0m20:57:02.712528 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:57:02.712755 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

        
            delete from "an_data_pipeline"."main"."int_pays"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_pays__502487a6a5e3"
            );

        
    

    insert into "an_data_pipeline"."main"."int_pays" ("uid", "code_insee", "libelleInsee", "nomCourant", "code_iso2A", "code_iso3A", "code_iso3N", "libelleIso", "libelleANCourt", "libelleANLong", "sourceJuridique", "activ")
    (
        select "uid", "code_insee", "libelleInsee", "nomCourant", "code_iso2A", "code_iso3A", "code_iso3N", "libelleIso", "libelleANCourt", "libelleANLong", "sourceJuridique", "activ"
        from "an_data_pipeline"."dbt_temp"."int_pays__502487a6a5e3"
    )
  
[0m20:57:02.942013 [debug] [Thread-1 (]: SQL status: OK in 0.229 seconds
[0m20:57:02.945106 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m20:57:02.945931 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:57:02.946623 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m20:57:03.070306 [debug] [Thread-1 (]: SQL status: OK in 0.123 seconds
[0m20:57:03.074389 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:57:03.074696 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__502487a6a5e3" cascade
    
[0m20:57:03.312191 [debug] [Thread-1 (]: SQL status: OK in 0.237 seconds
[0m20:57:03.314458 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m20:57:03.314660 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__502487a6a5e3" cascade
    
[0m20:57:03.443666 [debug] [Thread-1 (]: SQL status: OK in 0.129 seconds
[0m20:57:03.444629 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: Close
[0m20:57:03.445193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5363d1b-e774-47d8-95db-04ecd4a8bae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a4ebdd0>]}
[0m20:57:03.445660 [info ] [Thread-1 (]: 7 of 10 OK created sql incremental model main.int_pays ......................... [[32mOK[0m in 1.50s]
[0m20:57:03.445980 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_pays
[0m20:57:03.446195 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_reunions
[0m20:57:03.446601 [info ] [Thread-1 (]: 8 of 10 START sql incremental model main.int_reunions .......................... [RUN]
[0m20:57:03.446905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_pays, now model.dbt_an_data.int_reunions)
[0m20:57:03.447093 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_reunions
[0m20:57:03.453650 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_reunions"
[0m20:57:03.454683 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_reunions
[0m20:57:03.456886 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:57:03.457076 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__e35bc63f62f5" cascade
    
[0m20:57:03.457239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:03.572061 [debug] [Thread-1 (]: SQL status: OK in 0.115 seconds
[0m20:57:03.579562 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:57:03.580585 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:57:03.583019 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:57:03.585524 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:57:03.586343 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m20:57:03.588265 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:57:03.588952 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:57:03.589542 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:57:03.702348 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m20:57:03.705431 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:57:03.706273 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    

  
[0m20:57:03.707117 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:57:03.709252 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m20:57:03.709964 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:57:03.710578 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m20:57:03.852299 [debug] [Thread-1 (]: SQL status: OK in 0.141 seconds
[0m20:57:03.853762 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:57:03.854400 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_reunions__e35bc63f62f5"
  
    as (
      

with __dbt__cte__stg_reunions as (
SELECT * 
FROM "database"."stg"."raw_reunions"
) SELECT
json_extract_string(json, '$.reunion.uid') AS uid,
json_extract_string(json, '$.reunion.timeStampDebut') AS timeStampDebut,
json_extract_string(json, '$.reunion.lieu.lieuRef') AS lieuRef,
json_extract_string(json, '$.reunion.lieu.libelleLong') AS lieuLibelle,
json_extract_string(json, '$.reunion.cycleDeVie.etat') AS cycleDeVieEtat,
json_extract_string(json, '$.reunion.demandeur') AS demandeur,
json_extract_string(json, '$.reunion.organeReuniRef') AS organeReuniRef,
json_extract_string(json, '$.reunion.visioConference') AS visioConference,
json_extract_string(json, '$.reunion.sessionRef') AS sessionRef,
json_extract_string(json, '$.reunion.ouverturePresse') AS ouverturePresse,
json_extract_string(json, '$.reunion.captationVideo') AS captationVideo,
json_extract_string(json, '$.reunion.ODJ.convocationODJ.item') AS convocationODJ,
json_extract_string(json, '$.reunion.ODJ.resumeODJ.item') AS resumeODJ,
json_extract_string(json, '$.reunion.compteRenduRef') AS compteRenduRef,
json_extract_string(json, '$.reunion.identifiants.numSeanceJO') AS numSeanceJO,
json_extract_string(json, '$.reunion.identifiants.idJO') AS idJO,
json_extract_string(json, '$.reunion.identifiants.quantieme') AS quantieme,
json_extract_string(json, '$.reunion.identifiants.DataSeance') AS DataSeance,
date_T_insert
FROM __dbt__cte__stg_reunions
    );
  
  
  
[0m20:57:05.294649 [debug] [Thread-1 (]: SQL status: OK in 1.439 seconds
[0m20:57:05.300574 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:57:05.300779 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m20:57:05.301399 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:57:05.301552 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:57:05.301711 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions__e35bc63f62f5'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:57:05.303620 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:57:05.306505 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:57:05.306691 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:57:05.308133 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:57:05.309630 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:57:05.309800 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:57:05.311167 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:57:05.312542 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_reunions"
[0m20:57:05.313030 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:57:05.313202 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

        
            delete from "an_data_pipeline"."main"."int_reunions"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_reunions__e35bc63f62f5"
            );

        
    

    insert into "an_data_pipeline"."main"."int_reunions" ("uid", "timeStampDebut", "lieuRef", "lieuLibelle", "cycleDeVieEtat", "demandeur", "organeReuniRef", "visioConference", "sessionRef", "ouverturePresse", "captationVideo", "convocationODJ", "resumeODJ", "compteRenduRef", "numSeanceJO", "idJO", "quantieme", "DataSeance")
    (
        select "uid", "timeStampDebut", "lieuRef", "lieuLibelle", "cycleDeVieEtat", "demandeur", "organeReuniRef", "visioConference", "sessionRef", "ouverturePresse", "captationVideo", "convocationODJ", "resumeODJ", "compteRenduRef", "numSeanceJO", "idJO", "quantieme", "DataSeance"
        from "an_data_pipeline"."dbt_temp"."int_reunions__e35bc63f62f5"
    )
  
[0m20:57:05.622685 [debug] [Thread-1 (]: SQL status: OK in 0.309 seconds
[0m20:57:05.625199 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m20:57:05.625850 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:57:05.626333 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m20:57:05.827747 [debug] [Thread-1 (]: SQL status: OK in 0.200 seconds
[0m20:57:05.836359 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:57:05.837297 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__e35bc63f62f5" cascade
    
[0m20:57:06.077724 [debug] [Thread-1 (]: SQL status: OK in 0.240 seconds
[0m20:57:06.084117 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m20:57:06.085034 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__e35bc63f62f5" cascade
    
[0m20:57:06.194549 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m20:57:06.198750 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: Close
[0m20:57:06.199953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5363d1b-e774-47d8-95db-04ecd4a8bae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a514770>]}
[0m20:57:06.201283 [info ] [Thread-1 (]: 8 of 10 OK created sql incremental model main.int_reunions ..................... [[32mOK[0m in 2.75s]
[0m20:57:06.202300 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_reunions
[0m20:57:06.203080 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins
[0m20:57:06.204883 [info ] [Thread-1 (]: 9 of 10 START sql incremental model main.int_scrutins .......................... [RUN]
[0m20:57:06.205812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_reunions, now model.dbt_an_data.int_scrutins)
[0m20:57:06.206386 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins
[0m20:57:06.222557 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins"
[0m20:57:06.223809 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins
[0m20:57:06.228939 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:57:06.229373 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__db3fe52e7d5f" cascade
    
[0m20:57:06.229753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:06.346231 [debug] [Thread-1 (]: SQL status: OK in 0.116 seconds
[0m20:57:06.353447 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:57:06.354359 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:57:06.358160 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:57:06.360677 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:57:06.361262 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m20:57:06.363059 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:57:06.363759 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:57:06.364339 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:57:06.473618 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m20:57:06.475475 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:57:06.475960 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    

  
[0m20:57:06.476503 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:57:06.478105 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m20:57:06.479286 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:57:06.480215 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m20:57:06.586700 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m20:57:06.587287 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:57:06.587483 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_scrutins__db3fe52e7d5f"
  
    as (
      

with __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
) SELECT
date_T_insert,
json_extract_string(json, '$.scrutin.uid') AS uid,
json_extract_string(json, '$.scrutin.numero') AS numero,
json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
json_extract_string(json, '$.scrutin.legislature') AS legislature,
json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
json_extract_string(json, '$.scrutin.titre') AS titre,
json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote,
date_T_insert
FROM __dbt__cte__stg_scrutins
    );
  
  
  
[0m20:57:08.252474 [debug] [Thread-1 (]: SQL status: OK in 1.664 seconds
[0m20:57:08.258142 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:57:08.258355 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m20:57:08.259108 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:57:08.259276 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:57:08.259425 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins__db3fe52e7d5f'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:57:08.261512 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:57:08.263113 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:57:08.263301 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:57:08.264759 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:57:08.266346 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:57:08.266555 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:57:08.268082 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:57:08.270842 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins"
[0m20:57:08.271405 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:57:08.271599 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

        
            delete from "an_data_pipeline"."main"."int_scrutins"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_scrutins__db3fe52e7d5f"
            );

        
    

    insert into "an_data_pipeline"."main"."int_scrutins" ("date_T_insert", "uid", "numero", "organeRef", "legislature", "date_scrutin", "titre", "resultat_code", "resultat_libelle", "nb_votants", "suffrages_exprimes", "seuil", "lieu_vote")
    (
        select "date_T_insert", "uid", "numero", "organeRef", "legislature", "date_scrutin", "titre", "resultat_code", "resultat_libelle", "nb_votants", "suffrages_exprimes", "seuil", "lieu_vote"
        from "an_data_pipeline"."dbt_temp"."int_scrutins__db3fe52e7d5f"
    )
  
[0m20:57:08.524233 [debug] [Thread-1 (]: SQL status: OK in 0.252 seconds
[0m20:57:08.528255 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m20:57:08.529191 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:57:08.529905 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m20:57:08.688664 [debug] [Thread-1 (]: SQL status: OK in 0.158 seconds
[0m20:57:08.693677 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:57:08.694368 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__db3fe52e7d5f" cascade
    
[0m20:57:09.489303 [debug] [Thread-1 (]: SQL status: OK in 0.794 seconds
[0m20:57:09.491151 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m20:57:09.491341 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__db3fe52e7d5f" cascade
    
[0m20:57:09.602311 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m20:57:09.603945 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: Close
[0m20:57:09.604967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5363d1b-e774-47d8-95db-04ecd4a8bae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a55fcb0>]}
[0m20:57:09.605853 [info ] [Thread-1 (]: 9 of 10 OK created sql incremental model main.int_scrutins ..................... [[32mOK[0m in 3.40s]
[0m20:57:09.606474 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins
[0m20:57:09.606892 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins_votes
[0m20:57:09.607628 [info ] [Thread-1 (]: 10 of 10 START sql incremental model main.int_scrutins_votes ................... [RUN]
[0m20:57:09.608195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_scrutins, now model.dbt_an_data.int_scrutins_votes)
[0m20:57:09.608570 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins_votes
[0m20:57:09.638745 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins_votes"
[0m20:57:09.639542 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins_votes
[0m20:57:09.641716 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:57:09.641911 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__cb10ca15d2f9" cascade
    
[0m20:57:09.642092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:09.765376 [debug] [Thread-1 (]: SQL status: OK in 0.123 seconds
[0m20:57:09.769921 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:57:09.770604 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:57:09.772269 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:57:09.774184 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:57:09.774672 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m20:57:09.775850 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:57:09.776303 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:57:09.776747 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:57:09.898479 [debug] [Thread-1 (]: SQL status: OK in 0.121 seconds
[0m20:57:09.901356 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:57:09.902206 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    

  
[0m20:57:09.902946 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:57:09.906721 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m20:57:09.907805 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:57:09.908635 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m20:57:10.016982 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m20:57:10.018799 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:57:10.019827 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_scrutins_votes__cb10ca15d2f9"
  
    as (
      

WITH  __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
), grp AS (
      -- explode les groupes (1 par groupe)
    SELECT
        json_extract_string(j.json, '$.scrutin.uid') AS uid,
        json_extract_string(g.value, '$.organeRef') AS groupe_organe,
        g.value AS groupe_json,
        j.date_T_insert
    FROM __dbt__cte__stg_scrutins j,
    json_each(json->'scrutin'->'ventilationVotes'->'organe'->'groupes'->'groupe') g
  ),

  positions_array AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          date_T_insert,
          groupe_organe,
          'pour' AS type_vote,
          p.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'pours'->'votant') p
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          date_T_insert,
          groupe_organe,
          'contre' AS type_vote,
          c.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'contres'->'votant') c
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          date_T_insert,
          groupe_organe,
          'abstention' AS type_vote,
          a.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'abstentions'->'votant') a
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          date_T_insert,
          groupe_organe,
          'nonVotant' AS type_vote,
          n.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'nonVotants'->'votant') n
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[ARRAY]'
  ),
  positions_object AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[OBJECT]'
  ),

  clean AS (
      -- sécurise les champs (souvent string ou null)
      SELECT
          uid,
          groupe_organe,
          type_vote,
          json_extract_string(vote_json, '$.acteurRef') AS acteurRef,
          json_extract_string(vote_json, '$.mandatRef') AS mandatRef,
          json_extract_string(vote_json, '$.parDelegation') AS parDelegation,
          json_extract_string(vote_json, '$.numPlace') AS numPlace,
          json_extract_string(vote_json, '$.causePositionVote') AS cause,
          date_T_insert
      FROM positions_array
      UNION ALL
      SELECT * 
      FROM positions_object
  )

  SELECT * FROM clean
    );
  
  
  
[0m20:57:23.265124 [debug] [Thread-1 (]: SQL status: OK in 13.244 seconds
[0m20:57:23.272954 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:57:23.273248 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m20:57:23.273988 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:57:23.274155 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:57:23.274322 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins_votes__cb10ca15d2f9'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:57:23.276469 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:57:23.279314 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:57:23.279561 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins_votes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:57:23.281262 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:57:23.285563 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:57:23.285810 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins_votes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m20:57:23.287543 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:57:23.289579 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins_votes"
[0m20:57:23.291192 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:57:23.291396 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

        
            delete from "an_data_pipeline"."main"."int_scrutins_votes" as DBT_INCREMENTAL_TARGET
            using "an_data_pipeline"."dbt_temp"."int_scrutins_votes__cb10ca15d2f9"
            where (
                
                    "an_data_pipeline"."dbt_temp"."int_scrutins_votes__cb10ca15d2f9".uid = DBT_INCREMENTAL_TARGET.uid
                    and 
                
                    "an_data_pipeline"."dbt_temp"."int_scrutins_votes__cb10ca15d2f9".acteurRef = DBT_INCREMENTAL_TARGET.acteurRef
                    
                
                
            );
        
    

    insert into "an_data_pipeline"."main"."int_scrutins_votes" ("uid", "groupe_organe", "type_vote", "acteurRef", "mandatRef", "parDelegation", "numPlace", "cause")
    (
        select "uid", "groupe_organe", "type_vote", "acteurRef", "mandatRef", "parDelegation", "numPlace", "cause"
        from "an_data_pipeline"."dbt_temp"."int_scrutins_votes__cb10ca15d2f9"
    )
  
[0m20:57:24.189323 [debug] [Thread-1 (]: SQL status: OK in 0.898 seconds
[0m20:57:24.190723 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m20:57:24.191013 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:57:24.191193 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m20:57:24.819568 [debug] [Thread-1 (]: SQL status: OK in 0.628 seconds
[0m20:57:24.821578 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:57:24.821838 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__cb10ca15d2f9" cascade
    
[0m20:57:25.066237 [debug] [Thread-1 (]: SQL status: OK in 0.244 seconds
[0m20:57:25.068079 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m20:57:25.068278 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__cb10ca15d2f9" cascade
    
[0m20:57:25.176821 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m20:57:25.178060 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: Close
[0m20:57:25.178884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5363d1b-e774-47d8-95db-04ecd4a8bae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a4e2d80>]}
[0m20:57:25.179330 [info ] [Thread-1 (]: 10 of 10 OK created sql incremental model main.int_scrutins_votes .............. [[32mOK[0m in 15.57s]
[0m20:57:25.179634 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins_votes
[0m20:57:25.191667 [debug] [MainThread]: Using duckdb connection "master"
[0m20:57:25.192090 [debug] [MainThread]: On master: BEGIN
[0m20:57:25.192239 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:57:25.192862 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:57:25.192999 [debug] [MainThread]: On master: COMMIT
[0m20:57:25.193125 [debug] [MainThread]: Using duckdb connection "master"
[0m20:57:25.193243 [debug] [MainThread]: On master: COMMIT
[0m20:57:25.193461 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:57:25.193590 [debug] [MainThread]: On master: Close
[0m20:57:25.193770 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:57:25.193896 [debug] [MainThread]: Connection 'model.dbt_an_data.int_scrutins_votes' was properly closed.
[0m20:57:25.194671 [info ] [MainThread]: 
[0m20:57:25.194998 [info ] [MainThread]: Finished running 10 incremental models, 1 project hook in 0 hours 0 minutes and 38.09 seconds (38.09s).
[0m20:57:25.196558 [debug] [MainThread]: Command end result
[0m20:57:25.224509 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m20:57:25.234095 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m20:57:25.244717 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m20:57:25.244950 [info ] [MainThread]: 
[0m20:57:25.245326 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:57:25.245474 [info ] [MainThread]: 
[0m20:57:25.246016 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m20:57:25.248962 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 38.66453, "process_in_blocks": "0", "process_kernel_time": 6.987811, "process_mem_max_rss": "2900803584", "process_out_blocks": "0", "process_user_time": 18.282658}
[0m20:57:25.249936 [debug] [MainThread]: Command `dbt build` succeeded at 20:57:25.249891 after 38.67 seconds
[0m20:57:25.250618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043ae240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10535b6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10535b680>]}
[0m20:57:25.250785 [debug] [MainThread]: Flushing usage events
[0m20:57:25.862226 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:59:46.399964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073542c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a07710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a07440>]}


============================== 20:59:46.403220 | d49cb4e3-cfbc-4284-a953-58bbc38bc46c ==============================
[0m20:59:46.403220 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:59:46.403542 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'log_format': 'default', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'introspect': 'True', 'version_check': 'True', 'static_parser': 'True', 'write_json': 'True', 'quiet': 'False', 'empty': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'debug': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'invocation_command': 'dbt build -f', 'target_path': 'None'}
[0m20:59:46.585311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd49cb4e3-cfbc-4284-a953-58bbc38bc46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107212870>]}
[0m20:59:46.612808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd49cb4e3-cfbc-4284-a953-58bbc38bc46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b46780>]}
[0m20:59:46.614153 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:59:46.672219 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:59:46.743785 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:59:46.744011 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:59:46.747123 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_an_data.mart
[0m20:59:46.764286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd49cb4e3-cfbc-4284-a953-58bbc38bc46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079e7f80>]}
[0m20:59:46.803301 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m20:59:46.804793 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m20:59:46.826007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd49cb4e3-cfbc-4284-a953-58bbc38bc46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108014c50>]}
[0m20:59:46.826281 [info ] [MainThread]: Found 17 models, 1 operation, 9 sources, 469 macros
[0m20:59:46.827584 [info ] [MainThread]: 
[0m20:59:46.827768 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m20:59:46.827898 [info ] [MainThread]: 
[0m20:59:46.828131 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:59:46.830462 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_an_data_pipeline'
[0m20:59:46.916885 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline"
[0m20:59:46.917119 [debug] [ThreadPool]: On list_an_data_pipeline: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"an_data_pipeline"'
    
  
  
[0m20:59:46.917262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:49.048248 [debug] [ThreadPool]: SQL status: OK in 2.131 seconds
[0m20:59:49.051445 [debug] [ThreadPool]: On list_an_data_pipeline: Close
[0m20:59:49.052651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_an_data_pipeline, now create_an_data_pipeline_main)
[0m20:59:49.053436 [debug] [ThreadPool]: Creating schema "database: "an_data_pipeline"
schema: "main"
"
[0m20:59:49.064528 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m20:59:49.065150 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:59:49.065555 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:59:49.067956 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:59:49.069957 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m20:59:49.070401 [debug] [ThreadPool]: On create_an_data_pipeline_main: BEGIN
[0m20:59:49.071360 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:59:49.071677 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m20:59:49.071972 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
    
        create schema if not exists "an_data_pipeline"."main"
    
[0m20:59:49.181676 [debug] [ThreadPool]: SQL status: OK in 0.109 seconds
[0m20:59:49.184758 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m20:59:49.185734 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m20:59:49.186525 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m20:59:49.291506 [debug] [ThreadPool]: SQL status: OK in 0.104 seconds
[0m20:59:49.291759 [debug] [ThreadPool]: On create_an_data_pipeline_main: Close
[0m20:59:49.292651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_an_data_pipeline_main, now list_an_data_pipeline_main)
[0m20:59:49.295324 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m20:59:49.295488 [debug] [ThreadPool]: On list_an_data_pipeline_main: BEGIN
[0m20:59:49.295616 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:59:49.296064 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:59:49.296189 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m20:59:49.296324 [debug] [ThreadPool]: On list_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline_main"} */
select
      'an_data_pipeline' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'an_data_pipeline'
  
[0m20:59:49.306368 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m20:59:49.307162 [debug] [ThreadPool]: On list_an_data_pipeline_main: ROLLBACK
[0m20:59:49.309046 [debug] [ThreadPool]: Failed to rollback 'list_an_data_pipeline_main'
[0m20:59:49.309209 [debug] [ThreadPool]: On list_an_data_pipeline_main: Close
[0m20:59:49.310109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd49cb4e3-cfbc-4284-a953-58bbc38bc46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107384980>]}
[0m20:59:49.310347 [debug] [MainThread]: Using duckdb connection "master"
[0m20:59:49.310477 [debug] [MainThread]: On master: BEGIN
[0m20:59:49.310594 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:59:49.311033 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:59:49.311161 [debug] [MainThread]: On master: COMMIT
[0m20:59:49.311282 [debug] [MainThread]: Using duckdb connection "master"
[0m20:59:49.311395 [debug] [MainThread]: On master: COMMIT
[0m20:59:49.311596 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:59:49.314902 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_an_data.dbt_an_data-on-run-start-0"
[0m20:59:49.317328 [info ] [MainThread]: 1 of 1 START hook: dbt_an_data.on-run-start.0 .................................. [RUN]
[0m20:59:49.317553 [debug] [MainThread]: Using duckdb connection "master"
[0m20:59:49.317707 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "master"} */
ATTACH '../data/database/database.duckdb' AS database (READ_ONLY)
[0m20:59:49.324242 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m20:59:49.324761 [info ] [MainThread]: 1 of 1 OK hook: dbt_an_data.on-run-start.0 ..................................... [[32mOK[0m in 0.01s]
[0m20:59:49.324908 [info ] [MainThread]: 
[0m20:59:49.325042 [debug] [MainThread]: On master: Close
[0m20:59:49.326475 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_acteurs
[0m20:59:49.326673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_an_data_pipeline_main, now model.dbt_an_data.stg_acteurs)
[0m20:59:49.326940 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_acteurs
[0m20:59:49.328243 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_acteurs"
[0m20:59:49.328879 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_acteurs
[0m20:59:49.329078 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_agenda
[0m20:59:49.329274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_acteurs, now model.dbt_an_data.stg_agenda)
[0m20:59:49.329448 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_agenda
[0m20:59:49.330568 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_agenda"
[0m20:59:49.331049 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_agenda
[0m20:59:49.331220 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_amendements
[0m20:59:49.331404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_agenda, now model.dbt_an_data.stg_amendements)
[0m20:59:49.331574 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_amendements
[0m20:59:49.332667 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_amendements"
[0m20:59:49.333379 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_amendements
[0m20:59:49.333573 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_organes
[0m20:59:49.333763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_amendements, now model.dbt_an_data.stg_organes)
[0m20:59:49.333941 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_organes
[0m20:59:49.335127 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_organes"
[0m20:59:49.335690 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_organes
[0m20:59:49.335872 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_pays
[0m20:59:49.336108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_organes, now model.dbt_an_data.stg_pays)
[0m20:59:49.336362 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_pays
[0m20:59:49.337619 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_pays"
[0m20:59:49.338147 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_pays
[0m20:59:49.338324 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_reunions
[0m20:59:49.338499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_pays, now model.dbt_an_data.stg_reunions)
[0m20:59:49.338661 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_reunions
[0m20:59:49.339715 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_reunions"
[0m20:59:49.340189 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_reunions
[0m20:59:49.340359 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_scrutins
[0m20:59:49.340524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_reunions, now model.dbt_an_data.stg_scrutins)
[0m20:59:49.340682 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_scrutins
[0m20:59:49.341810 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_scrutins"
[0m20:59:49.342353 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_scrutins
[0m20:59:49.342534 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_acteurs
[0m20:59:49.342793 [info ] [Thread-1 (]: 1 of 10 START sql incremental model main.int_acteurs ........................... [RUN]
[0m20:59:49.343025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_scrutins, now model.dbt_an_data.int_acteurs)
[0m20:59:49.343186 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_acteurs
[0m20:59:49.347369 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_acteurs"
[0m20:59:49.347670 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_acteurs
[0m20:59:49.351332 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:59:49.351510 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__aa815b78f225" cascade
    
[0m20:59:49.351658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:49.458360 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m20:59:49.489953 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:59:49.490227 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:59:49.491097 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:49.491863 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:59:49.492051 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m20:59:49.492471 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:59:49.492641 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:59:49.492811 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:59:49.600975 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m20:59:49.602535 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:59:49.603026 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    

  
[0m20:59:49.603536 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:59:49.604798 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m20:59:49.605179 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:59:49.605504 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m20:59:49.711045 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m20:59:49.738303 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_acteurs"
[0m20:59:49.740590 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:59:49.741041 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m20:59:49.742210 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:49.742641 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:59:49.743139 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

  
    
    

    create  table
      "an_data_pipeline"."main"."int_acteurs__dbt_tmp"
  
    as (
      

with __dbt__cte__stg_acteurs as (
SELECT * 
FROM "database"."stg"."raw_acteurs"
) SELECT 
json_extract_string(json, '$.acteur.uid.#text') as uid,
json_extract_string(json, '$.acteur.etatCivil.ident.civ') as civ,
json_extract_string(json, '$.acteur.etatCivil.ident.prenom') as prenom,
json_extract_string(json, '$.acteur.etatCivil.ident.nom') as nom,
json_extract_string(json, '$.acteur.etatCivil.ident.trigramme') as trigramme,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.dateNais') as dateNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.villeNais') as villeNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.depNais') as depNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.paysNais') as paysNais,
json_extract_string(json, '$.acteur.etatCivil.dateDeces') as dateDeces,
json_extract_string(json, '$.acteur.profession.libelleCourant') as libelleCourant,
json_extract_string(json, '$.acteur.profession.socProcINSEE.catSocPro') as catSocPro,
json_extract_string(json, '$.acteur.profession.socProcINSEE.famSocPro') as famSocPro,
json_extract_string(json, '$.acteur.uri_hatvp') as uri_hatvp,
date_T_insert
FROM __dbt__cte__stg_acteurs
    );
  
  
  
[0m20:59:50.339059 [debug] [Thread-1 (]: SQL status: OK in 0.595 seconds
[0m20:59:50.350545 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:59:50.351238 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_acteurs'
  
[0m20:59:50.352981 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:50.354864 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:59:50.355299 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_acteurs'
  
[0m20:59:50.357366 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:59:50.364636 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:59:50.365064 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */
alter table "an_data_pipeline"."main"."int_acteurs" rename to "int_acteurs__dbt_backup"
[0m20:59:50.484140 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m20:59:50.491640 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:59:50.492478 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */
alter table "an_data_pipeline"."main"."int_acteurs__dbt_tmp" rename to "int_acteurs"
[0m20:59:50.607132 [debug] [Thread-1 (]: SQL status: OK in 0.114 seconds
[0m20:59:50.635389 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m20:59:50.635969 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:59:50.636363 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m20:59:50.898145 [debug] [Thread-1 (]: SQL status: OK in 0.261 seconds
[0m20:59:50.904283 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:59:50.905062 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__aa815b78f225" cascade
    
[0m20:59:51.014827 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m20:59:51.021397 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:59:51.022056 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."main"."int_acteurs__dbt_backup" cascade
    
[0m20:59:51.359532 [debug] [Thread-1 (]: SQL status: OK in 0.337 seconds
[0m20:59:51.366229 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m20:59:51.366898 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__aa815b78f225" cascade
    
[0m20:59:51.476538 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m20:59:51.481375 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: Close
[0m20:59:51.484928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd49cb4e3-cfbc-4284-a953-58bbc38bc46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104245580>]}
[0m20:59:51.486177 [info ] [Thread-1 (]: 1 of 10 OK created sql incremental model main.int_acteurs ...................... [[32mOK[0m in 2.14s]
[0m20:59:51.487111 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_acteurs
[0m20:59:51.487712 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_mandats
[0m20:59:51.488363 [info ] [Thread-1 (]: 2 of 10 START sql incremental model main.int_mandats ........................... [RUN]
[0m20:59:51.489048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_acteurs, now model.dbt_an_data.int_mandats)
[0m20:59:51.489731 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_mandats
[0m20:59:51.500320 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_mandats"
[0m20:59:51.501135 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_mandats
[0m20:59:51.549945 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:59:51.550292 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__50fd7157b949" cascade
    
[0m20:59:51.550506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:51.656913 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m20:59:51.660754 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:59:51.661331 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:59:51.663127 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:51.664639 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:59:51.665046 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m20:59:51.665936 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:51.666286 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:59:51.666628 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:59:51.775569 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m20:59:51.778756 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:59:51.779741 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    

  
[0m20:59:51.780846 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:59:51.783521 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m20:59:51.784272 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:59:51.784969 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m20:59:51.929785 [debug] [Thread-1 (]: SQL status: OK in 0.144 seconds
[0m20:59:51.932771 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_mandats"
[0m20:59:51.935282 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:59:51.936290 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m20:59:51.938516 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:51.939280 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:59:51.940060 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

  
    
    

    create  table
      "an_data_pipeline"."main"."int_mandats__dbt_tmp"
  
    as (
      

with __dbt__cte__stg_acteurs as (
SELECT * 
FROM "database"."stg"."raw_acteurs"
) SELECT 
json_extract_string(mandat.value, '$.uid') as uid,
json_extract_string(mandat.value, '$.acteurRef') as acteurRef,
json_extract_string(mandat.value, '$.legislature') as legislature,
json_extract_string(mandat.value, '$.typeOrgane') as typeOrgane,
json_extract_string(mandat.value, '$.dateDebut') as dateDebut,
json_extract_string(mandat.value, '$.dateFin') as dateFin,
json_extract_string(mandat.value, '$.preseance') as preseance,
json_extract_string(mandat.value, '$.nominPrincipale') as nominPrincipale,
json_extract_string(mandat.value, '$.infosQualite.codeQualite') as codeQualite,
json_extract_string(mandat.value, '$.organes.organeRef') as organeRef,
date_T_insert
FROM __dbt__cte__stg_acteurs act, json_each(json->'acteur'->'mandats'->'mandat') mandat
    );
  
  
  
[0m20:59:52.762761 [debug] [Thread-1 (]: SQL status: OK in 0.821 seconds
[0m20:59:52.767959 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:59:52.768800 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_mandats'
  
[0m20:59:52.770785 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:52.772679 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:59:52.773174 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_mandats'
  
[0m20:59:52.774330 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:52.779356 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:59:52.779787 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */
alter table "an_data_pipeline"."main"."int_mandats" rename to "int_mandats__dbt_backup"
[0m20:59:52.904470 [debug] [Thread-1 (]: SQL status: OK in 0.124 seconds
[0m20:59:52.911779 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:59:52.912602 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */
alter table "an_data_pipeline"."main"."int_mandats__dbt_tmp" rename to "int_mandats"
[0m20:59:53.028783 [debug] [Thread-1 (]: SQL status: OK in 0.115 seconds
[0m20:59:53.033215 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m20:59:53.034140 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:59:53.034856 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m20:59:53.313557 [debug] [Thread-1 (]: SQL status: OK in 0.278 seconds
[0m20:59:53.320179 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:59:53.321121 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__50fd7157b949" cascade
    
[0m20:59:53.431317 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m20:59:53.436394 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:59:53.437033 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."main"."int_mandats__dbt_backup" cascade
    
[0m20:59:53.656233 [debug] [Thread-1 (]: SQL status: OK in 0.219 seconds
[0m20:59:53.658008 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m20:59:53.658179 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__50fd7157b949" cascade
    
[0m20:59:53.763354 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m20:59:53.764416 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: Close
[0m20:59:53.764940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd49cb4e3-cfbc-4284-a953-58bbc38bc46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085850d0>]}
[0m20:59:53.765408 [info ] [Thread-1 (]: 2 of 10 OK created sql incremental model main.int_mandats ...................... [[32mOK[0m in 2.28s]
[0m20:59:53.765748 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_mandats
[0m20:59:53.765983 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_agenda
[0m20:59:53.766354 [info ] [Thread-1 (]: 3 of 10 START sql incremental model main.int_agenda ............................ [RUN]
[0m20:59:53.766681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_mandats, now model.dbt_an_data.int_agenda)
[0m20:59:53.766912 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_agenda
[0m20:59:53.769236 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_agenda"
[0m20:59:53.770022 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_agenda
[0m20:59:53.772280 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:59:53.772503 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__f69ad8201458" cascade
    
[0m20:59:53.772700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:53.880421 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m20:59:53.886344 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:59:53.886974 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:59:53.889167 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:59:53.891336 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:59:53.891873 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m20:59:53.893011 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:53.893453 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:59:53.893918 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:59:54.003771 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m20:59:54.007850 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:59:54.008764 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    

  
[0m20:59:54.009694 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:59:54.012091 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m20:59:54.012938 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:59:54.013735 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m20:59:54.121862 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m20:59:54.124408 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_agenda"
[0m20:59:54.126981 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:59:54.128026 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m20:59:54.130948 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:59:54.131860 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:59:54.132658 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

  
    
    

    create  table
      "an_data_pipeline"."main"."int_agenda__dbt_tmp"
  
    as (
      

with __dbt__cte__stg_agenda as (
SELECT * 
FROM "database"."stg"."raw_agenda"
) SELECT * 
FROM __dbt__cte__stg_agenda
    );
  
  
  
[0m20:59:54.452160 [debug] [Thread-1 (]: SQL status: OK in 0.318 seconds
[0m20:59:54.454714 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:59:54.455481 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_agenda'
  
[0m20:59:54.457878 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:59:54.460580 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:59:54.461284 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_agenda'
  
[0m20:59:54.463142 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:54.471230 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:59:54.472200 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */
alter table "an_data_pipeline"."main"."int_agenda" rename to "int_agenda__dbt_backup"
[0m20:59:54.590214 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m20:59:54.597261 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:59:54.598297 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */
alter table "an_data_pipeline"."main"."int_agenda__dbt_tmp" rename to "int_agenda"
[0m20:59:54.715309 [debug] [Thread-1 (]: SQL status: OK in 0.116 seconds
[0m20:59:54.719484 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m20:59:54.720297 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:59:54.721004 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m20:59:54.941983 [debug] [Thread-1 (]: SQL status: OK in 0.220 seconds
[0m20:59:54.943616 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:59:54.943804 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__f69ad8201458" cascade
    
[0m20:59:55.048055 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m20:59:55.050513 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:59:55.050803 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."main"."int_agenda__dbt_backup" cascade
    
[0m20:59:55.277641 [debug] [Thread-1 (]: SQL status: OK in 0.226 seconds
[0m20:59:55.284539 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m20:59:55.285367 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__f69ad8201458" cascade
    
[0m20:59:55.395493 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m20:59:55.398311 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: Close
[0m20:59:55.399197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd49cb4e3-cfbc-4284-a953-58bbc38bc46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10857dbb0>]}
[0m20:59:55.400401 [info ] [Thread-1 (]: 3 of 10 OK created sql incremental model main.int_agenda ....................... [[32mOK[0m in 1.63s]
[0m20:59:55.401515 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_agenda
[0m20:59:55.402285 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements
[0m20:59:55.403208 [info ] [Thread-1 (]: 4 of 10 START sql incremental model main.int_amendements ....................... [RUN]
[0m20:59:55.404294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_agenda, now model.dbt_an_data.int_amendements)
[0m20:59:55.405047 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements
[0m20:59:55.425580 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements"
[0m20:59:55.426561 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements
[0m20:59:55.430520 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:59:55.430984 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__9c9e36d59c0e" cascade
    
[0m20:59:55.431505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:55.542055 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m20:59:55.548521 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:59:55.549445 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:59:55.552463 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:59:55.554716 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:59:55.555264 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m20:59:55.556833 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:55.557444 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:59:55.557911 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:59:55.669503 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m20:59:55.672952 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:59:55.673761 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    

  
[0m20:59:55.674707 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:59:55.677000 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m20:59:55.677715 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:59:55.678789 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m20:59:55.787188 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m20:59:55.790175 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements"
[0m20:59:55.792585 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:59:55.793308 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m20:59:55.796079 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:59:55.797086 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:59:55.798070 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

  
    
    

    create  table
      "an_data_pipeline"."main"."int_amendements__dbt_tmp"
  
    as (
      

with __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
) SELECT
json_extract_string(json, '$.amendement.uid') AS uid,
json_extract_string(json, '$.amendement.chronotag') AS chronotag,
json_extract_string(json, '$.amendement.examenRef') AS examenRef,
json_extract_string(json, '$.amendement.amendementParentRef') AS amendementParentRef,
json_extract_string(json, '$.amendement.signataires.auteur.typeAuteur') AS typeAuteur,
json_extract_string(json, '$.amendement.signataires.auteur.acteurRef') AS refAuteur,
json_extract_string(json, '$.amendement.signataires.auteur.groupePolitique') AS groupePolitiqueAuteur,
json_extract_string(json, '$.amendement.cycleDeVie.dateDepot') AS dateDepot,
json_extract_string(json, '$.amendement.cycleDeVie.datePublication') AS datePublication,
json_extract_string(json, '$.amendement.cycleDeVie.soumisArticle40') AS soumisArticle40,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.code') AS codeEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.libelle') AS libelleEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.code') AS codeSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.dateSort') AS dateSort,
json_extract_string(json, '$.amendement.cycleDeVie.sort') AS sort,
split_part(replace(filename, '.json', ''), '/', -1) AS id_amendement,
split_part(replace(filename, '.json', ''), '/', -2) AS id_texte,
split_part(replace(filename, '.json', ''), '/', -3) AS id_dossier_legislatif,
id_texte[:4] AS nature_texte,
id_texte[5:6] AS source_texte,
regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 1) AS prefix_bibard,
regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 2) AS numero_bibard,
regexp_extract(id_amendement, '(SEA|PO\d*)', 1) AS code_organe,
regexp_extract(id_amendement, '(P)(\d*)(D)', 2) AS numero_partie,
regexp_extract(id_amendement, '(D)(\d*)(N)', 2) AS numero_deliberation,
regexp_extract(id_amendement, '(D)(\d*)(N)(\d*)', 4) AS numero_court,
date_T_insert
from __dbt__cte__stg_amendements
    );
  
  
  
[0m20:59:56.170228 [debug] [Thread-1 (]: SQL status: OK in 0.371 seconds
[0m20:59:56.172250 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:59:56.172794 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_amendements'
  
[0m20:59:56.174416 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:56.176384 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:59:56.176931 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_amendements'
  
[0m20:59:56.178148 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:56.182099 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:59:56.182656 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */
alter table "an_data_pipeline"."main"."int_amendements" rename to "int_amendements__dbt_backup"
[0m20:59:56.301034 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m20:59:56.312192 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:59:56.312984 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */
alter table "an_data_pipeline"."main"."int_amendements__dbt_tmp" rename to "int_amendements"
[0m20:59:56.432246 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m20:59:56.436809 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m20:59:56.437620 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:59:56.438353 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m20:59:56.667456 [debug] [Thread-1 (]: SQL status: OK in 0.229 seconds
[0m20:59:56.668763 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:59:56.668950 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__9c9e36d59c0e" cascade
    
[0m20:59:56.777047 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m20:59:56.779850 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:59:56.780187 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."main"."int_amendements__dbt_backup" cascade
    
[0m20:59:57.009815 [debug] [Thread-1 (]: SQL status: OK in 0.229 seconds
[0m20:59:57.011446 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m20:59:57.011628 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__9c9e36d59c0e" cascade
    
[0m20:59:57.119008 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m20:59:57.120200 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: Close
[0m20:59:57.120647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd49cb4e3-cfbc-4284-a953-58bbc38bc46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10859ba70>]}
[0m20:59:57.121088 [info ] [Thread-1 (]: 4 of 10 OK created sql incremental model main.int_amendements .................. [[32mOK[0m in 1.72s]
[0m20:59:57.121470 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements
[0m20:59:57.121738 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements_cosignataires
[0m20:59:57.122131 [info ] [Thread-1 (]: 5 of 10 START sql incremental model main.int_amendements_cosignataires ......... [RUN]
[0m20:59:57.122516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements, now model.dbt_an_data.int_amendements_cosignataires)
[0m20:59:57.122801 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements_cosignataires
[0m20:59:57.130241 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements_cosignataires"
[0m20:59:57.131042 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements_cosignataires
[0m20:59:57.134104 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:59:57.134408 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__9c245028804e" cascade
    
[0m20:59:57.134652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:57.241876 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m20:59:57.245499 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:59:57.245986 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:59:57.248049 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:57.250146 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:59:57.250823 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m20:59:57.251682 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:57.251924 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:59:57.252143 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:59:57.360873 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m20:59:57.364669 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:59:57.365726 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    

  
[0m20:59:57.366774 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:59:57.369037 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m20:59:57.369759 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:59:57.370427 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m20:59:57.478196 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m20:59:57.478716 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements_cosignataires"
[0m20:59:57.479203 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:59:57.479351 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m20:59:57.479884 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:59:57.480030 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:59:57.480206 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

  
    
    

    create  table
      "an_data_pipeline"."main"."int_amendements_cosignataires__dbt_tmp"
  
    as (
      

WITH  __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
), cosignataires_arr AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef[*]') AS acteurRef,
    date_T_insert
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') == 'ARRAY' AND acteurRef IS NOT NULL
), cosignataires_str AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef') AS acteurRef,
    date_T_insert
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') <> 'ARRAY' AND acteurRef IS NOT NULL
)
SELECT 
  uid, 
  unnest(acteurRef) as acteurRef,
  date_T_insert
FROM cosignataires_arr
UNION ALL
SELECT 
  uid, 
  acteurRef,
  date_T_insert
FROM cosignataires_str
    );
  
  
  
[0m20:59:57.814904 [debug] [Thread-1 (]: SQL status: OK in 0.334 seconds
[0m20:59:57.817478 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:59:57.818024 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_amendements_cosignataires'
  
[0m20:59:57.820016 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:57.822706 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:59:57.823314 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_amendements_cosignataires'
  
[0m20:59:57.824538 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:57.828988 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:59:57.829480 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */
alter table "an_data_pipeline"."main"."int_amendements_cosignataires" rename to "int_amendements_cosignataires__dbt_backup"
[0m20:59:57.945430 [debug] [Thread-1 (]: SQL status: OK in 0.115 seconds
[0m20:59:57.952486 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:59:57.953848 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */
alter table "an_data_pipeline"."main"."int_amendements_cosignataires__dbt_tmp" rename to "int_amendements_cosignataires"
[0m20:59:58.075004 [debug] [Thread-1 (]: SQL status: OK in 0.120 seconds
[0m20:59:58.079205 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m20:59:58.080079 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:59:58.080823 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m20:59:58.312601 [debug] [Thread-1 (]: SQL status: OK in 0.231 seconds
[0m20:59:58.319185 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:59:58.319934 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__9c245028804e" cascade
    
[0m20:59:58.428917 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m20:59:58.434873 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:59:58.435782 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."main"."int_amendements_cosignataires__dbt_backup" cascade
    
[0m20:59:58.668410 [debug] [Thread-1 (]: SQL status: OK in 0.232 seconds
[0m20:59:58.678726 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m20:59:58.679612 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__9c245028804e" cascade
    
[0m20:59:58.791832 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m20:59:58.793772 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: Close
[0m20:59:58.794471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd49cb4e3-cfbc-4284-a953-58bbc38bc46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108828d40>]}
[0m20:59:58.795588 [info ] [Thread-1 (]: 5 of 10 OK created sql incremental model main.int_amendements_cosignataires .... [[32mOK[0m in 1.67s]
[0m20:59:58.796658 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements_cosignataires
[0m20:59:58.797369 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_organes
[0m20:59:58.798091 [info ] [Thread-1 (]: 6 of 10 START sql incremental model main.int_organes ........................... [RUN]
[0m20:59:58.798758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements_cosignataires, now model.dbt_an_data.int_organes)
[0m20:59:58.799273 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_organes
[0m20:59:58.811713 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_organes"
[0m20:59:58.812457 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_organes
[0m20:59:58.816027 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:59:58.816334 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__cc59ad810f2f" cascade
    
[0m20:59:58.816552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:58.924303 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m20:59:58.931448 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:59:58.932463 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m20:59:58.935332 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:59:58.939044 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:59:58.939947 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m20:59:58.942110 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:58.942736 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:59:58.943241 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m20:59:59.055068 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m20:59:59.057092 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:59:59.057674 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    

  
[0m20:59:59.058294 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:59:59.059910 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m20:59:59.060466 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:59:59.060943 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m20:59:59.166697 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m20:59:59.167251 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_organes"
[0m20:59:59.167871 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:59:59.168032 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m20:59:59.168567 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:59:59.168718 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:59:59.168881 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

  
    
    

    create  table
      "an_data_pipeline"."main"."int_organes__dbt_tmp"
  
    as (
      

with __dbt__cte__stg_organes as (
SELECT * 
FROM "database"."stg"."raw_organes"
) SELECT 
json_extract_string(json, '$.organe.uid') as uid,
json_extract_string(json, '$.organe.codeType') as codeType,
json_extract_string(json, '$.organe.libelle') as libelle,
json_extract_string(json, '$.organe.libelleEdition') as libelleEdition,
json_extract_string(json, '$.organe.libelleAbrege') as libelleAbrege,
json_extract_string(json, '$.organe.libelleAbrev') as libelleAbrev,
json_extract_string(json, '$.organe.viMoDe.dateDebut') as dateDebut,
json_extract_string(json, '$.organe.viMoDe.dateAgrement') as dateAgrement,
json_extract_string(json, '$.organe.viMoDe.dateFin') as dateFin,
json_extract_string(json, '$.organe.organeParent') as organeParent,
json_extract_string(json, '$.organe.chambre') as chambre,
json_extract_string(json, '$.organe.regime') as regime,
json_extract_string(json, '$.organe.legislature') as legislature,
date_T_insert
FROM __dbt__cte__stg_organes
    );
  
  
  
[0m20:59:59.617832 [debug] [Thread-1 (]: SQL status: OK in 0.448 seconds
[0m20:59:59.621265 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:59:59.622212 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_organes'
  
[0m20:59:59.624276 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:59.626171 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:59:59.626728 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_organes'
  
[0m20:59:59.627978 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:59:59.632867 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:59:59.633421 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */
alter table "an_data_pipeline"."main"."int_organes" rename to "int_organes__dbt_backup"
[0m20:59:59.750250 [debug] [Thread-1 (]: SQL status: OK in 0.116 seconds
[0m20:59:59.757992 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:59:59.758908 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */
alter table "an_data_pipeline"."main"."int_organes__dbt_tmp" rename to "int_organes"
[0m20:59:59.876465 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m20:59:59.880078 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m20:59:59.880971 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m20:59:59.881652 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m21:00:00.152390 [debug] [Thread-1 (]: SQL status: OK in 0.270 seconds
[0m21:00:00.159369 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m21:00:00.160481 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__cc59ad810f2f" cascade
    
[0m21:00:00.269149 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m21:00:00.274029 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m21:00:00.275149 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."main"."int_organes__dbt_backup" cascade
    
[0m21:00:00.506028 [debug] [Thread-1 (]: SQL status: OK in 0.230 seconds
[0m21:00:00.512160 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m21:00:00.512947 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__cc59ad810f2f" cascade
    
[0m21:00:00.622224 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m21:00:00.624986 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: Close
[0m21:00:00.626188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd49cb4e3-cfbc-4284-a953-58bbc38bc46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108459760>]}
[0m21:00:00.627644 [info ] [Thread-1 (]: 6 of 10 OK created sql incremental model main.int_organes ...................... [[32mOK[0m in 1.83s]
[0m21:00:00.628770 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_organes
[0m21:00:00.629567 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_pays
[0m21:00:00.630474 [info ] [Thread-1 (]: 7 of 10 START sql incremental model main.int_pays .............................. [RUN]
[0m21:00:00.631328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_organes, now model.dbt_an_data.int_pays)
[0m21:00:00.632032 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_pays
[0m21:00:00.644521 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_pays"
[0m21:00:00.645361 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_pays
[0m21:00:00.650984 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:00:00.651389 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__f3e3b257b7a7" cascade
    
[0m21:00:00.651686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:00.757492 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m21:00:00.763967 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:00:00.764733 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m21:00:00.767618 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:00:00.769888 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:00:00.770412 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m21:00:00.771676 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:00:00.772156 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:00:00.772601 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m21:00:00.882135 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m21:00:00.886685 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:00:00.887838 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    

  
[0m21:00:00.889101 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:00.892382 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m21:00:00.893172 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:00:00.893861 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m21:00:01.001139 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m21:00:01.001702 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_pays"
[0m21:00:01.002208 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:00:01.002369 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m21:00:01.002926 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:01.003078 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:00:01.003243 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

  
    
    

    create  table
      "an_data_pipeline"."main"."int_pays__dbt_tmp"
  
    as (
      

with __dbt__cte__stg_pays as (
SELECT * 
FROM "database"."stg"."raw_pays"
) SELECT
json_extract_string(json, '$.pays.uid') as uid,
json_extract_string(json, '$.pays.code_insee') as code_insee,
json_extract_string(json, '$.pays.libelleInsee') as libelleInsee,
json_extract_string(json, '$.pays.nomCourant') as nomCourant,
json_extract_string(json, '$.pays.code_iso2A') as code_iso2A,
json_extract_string(json, '$.pays.code_iso3A') as code_iso3A,
json_extract_string(json, '$.pays.code_iso3N') as code_iso3N,
json_extract_string(json, '$.pays.libelleIso') as libelleIso,
json_extract_string(json, '$.pays.libelleANCourt') as libelleANCourt,
json_extract_string(json, '$.pays.libelleANLong') as libelleANLong,
json_extract_string(json, '$.pays.sourceJuridique') as sourceJuridique,
json_extract_string(json, '$.pays.activ') as activ,
date_T_insert
FROM __dbt__cte__stg_pays
    );
  
  
  
[0m21:00:01.337808 [debug] [Thread-1 (]: SQL status: OK in 0.334 seconds
[0m21:00:01.340393 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:00:01.341136 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_pays'
  
[0m21:00:01.343100 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:00:01.345076 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:00:01.345637 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_pays'
  
[0m21:00:01.346879 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:00:01.351373 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:00:01.351920 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */
alter table "an_data_pipeline"."main"."int_pays" rename to "int_pays__dbt_backup"
[0m21:00:01.468926 [debug] [Thread-1 (]: SQL status: OK in 0.116 seconds
[0m21:00:01.476075 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:00:01.476931 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */
alter table "an_data_pipeline"."main"."int_pays__dbt_tmp" rename to "int_pays"
[0m21:00:01.594598 [debug] [Thread-1 (]: SQL status: OK in 0.116 seconds
[0m21:00:01.600050 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m21:00:01.600904 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:00:01.601636 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m21:00:01.837061 [debug] [Thread-1 (]: SQL status: OK in 0.234 seconds
[0m21:00:01.843595 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:00:01.844375 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__f3e3b257b7a7" cascade
    
[0m21:00:01.953583 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m21:00:01.957886 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:00:01.958495 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."main"."int_pays__dbt_backup" cascade
    
[0m21:00:02.195225 [debug] [Thread-1 (]: SQL status: OK in 0.236 seconds
[0m21:00:02.202141 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:00:02.203156 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__f3e3b257b7a7" cascade
    
[0m21:00:02.311635 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m21:00:02.313769 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: Close
[0m21:00:02.314763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd49cb4e3-cfbc-4284-a953-58bbc38bc46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108832330>]}
[0m21:00:02.315719 [info ] [Thread-1 (]: 7 of 10 OK created sql incremental model main.int_pays ......................... [[32mOK[0m in 1.68s]
[0m21:00:02.316483 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_pays
[0m21:00:02.317062 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_reunions
[0m21:00:02.317705 [info ] [Thread-1 (]: 8 of 10 START sql incremental model main.int_reunions .......................... [RUN]
[0m21:00:02.318310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_pays, now model.dbt_an_data.int_reunions)
[0m21:00:02.318782 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_reunions
[0m21:00:02.333924 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_reunions"
[0m21:00:02.334698 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_reunions
[0m21:00:02.339181 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:00:02.339688 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__75b04631f612" cascade
    
[0m21:00:02.340121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:02.451330 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m21:00:02.459796 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:00:02.460780 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m21:00:02.464166 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:00:02.466821 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:00:02.467573 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m21:00:02.469521 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:00:02.470077 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:00:02.471067 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m21:00:02.578651 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m21:00:02.581514 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:00:02.582223 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    

  
[0m21:00:02.582856 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:02.584905 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m21:00:02.585612 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:00:02.586045 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m21:00:02.693117 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m21:00:02.696020 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_reunions"
[0m21:00:02.698688 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:00:02.699971 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m21:00:02.702677 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:00:02.703449 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:00:02.704245 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

  
    
    

    create  table
      "an_data_pipeline"."main"."int_reunions__dbt_tmp"
  
    as (
      

with __dbt__cte__stg_reunions as (
SELECT * 
FROM "database"."stg"."raw_reunions"
) SELECT
json_extract_string(json, '$.reunion.uid') AS uid,
json_extract_string(json, '$.reunion.timeStampDebut') AS timeStampDebut,
json_extract_string(json, '$.reunion.lieu.lieuRef') AS lieuRef,
json_extract_string(json, '$.reunion.lieu.libelleLong') AS lieuLibelle,
json_extract_string(json, '$.reunion.cycleDeVie.etat') AS cycleDeVieEtat,
json_extract_string(json, '$.reunion.demandeur') AS demandeur,
json_extract_string(json, '$.reunion.organeReuniRef') AS organeReuniRef,
json_extract_string(json, '$.reunion.visioConference') AS visioConference,
json_extract_string(json, '$.reunion.sessionRef') AS sessionRef,
json_extract_string(json, '$.reunion.ouverturePresse') AS ouverturePresse,
json_extract_string(json, '$.reunion.captationVideo') AS captationVideo,
json_extract_string(json, '$.reunion.ODJ.convocationODJ.item') AS convocationODJ,
json_extract_string(json, '$.reunion.ODJ.resumeODJ.item') AS resumeODJ,
json_extract_string(json, '$.reunion.compteRenduRef') AS compteRenduRef,
json_extract_string(json, '$.reunion.identifiants.numSeanceJO') AS numSeanceJO,
json_extract_string(json, '$.reunion.identifiants.idJO') AS idJO,
json_extract_string(json, '$.reunion.identifiants.quantieme') AS quantieme,
json_extract_string(json, '$.reunion.identifiants.DataSeance') AS DataSeance,
date_T_insert
FROM __dbt__cte__stg_reunions
    );
  
  
  
[0m21:00:03.601476 [debug] [Thread-1 (]: SQL status: OK in 0.896 seconds
[0m21:00:03.604905 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:00:03.606472 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_reunions'
  
[0m21:00:03.608218 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:00:03.610180 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:00:03.610596 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_reunions'
  
[0m21:00:03.611617 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:00:03.615223 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:00:03.615606 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */
alter table "an_data_pipeline"."main"."int_reunions" rename to "int_reunions__dbt_backup"
[0m21:00:03.734095 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m21:00:03.741466 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:00:03.742379 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */
alter table "an_data_pipeline"."main"."int_reunions__dbt_tmp" rename to "int_reunions"
[0m21:00:03.857604 [debug] [Thread-1 (]: SQL status: OK in 0.114 seconds
[0m21:00:03.860574 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m21:00:03.862081 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:00:03.864318 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m21:00:04.160998 [debug] [Thread-1 (]: SQL status: OK in 0.295 seconds
[0m21:00:04.166219 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:00:04.167061 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__75b04631f612" cascade
    
[0m21:00:04.277106 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m21:00:04.285177 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:00:04.286037 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."main"."int_reunions__dbt_backup" cascade
    
[0m21:00:04.509459 [debug] [Thread-1 (]: SQL status: OK in 0.223 seconds
[0m21:00:04.511377 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:00:04.511561 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__75b04631f612" cascade
    
[0m21:00:04.615050 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m21:00:04.616130 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: Close
[0m21:00:04.616612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd49cb4e3-cfbc-4284-a953-58bbc38bc46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108844770>]}
[0m21:00:04.617114 [info ] [Thread-1 (]: 8 of 10 OK created sql incremental model main.int_reunions ..................... [[32mOK[0m in 2.30s]
[0m21:00:04.617515 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_reunions
[0m21:00:04.617793 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins
[0m21:00:04.618238 [info ] [Thread-1 (]: 9 of 10 START sql incremental model main.int_scrutins .......................... [RUN]
[0m21:00:04.618651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_reunions, now model.dbt_an_data.int_scrutins)
[0m21:00:04.618938 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins
[0m21:00:04.625731 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins"
[0m21:00:04.626524 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins
[0m21:00:04.629701 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:00:04.630657 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__42dc8a69ce74" cascade
    
[0m21:00:04.631229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:04.738598 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m21:00:04.743014 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:00:04.743973 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m21:00:04.746406 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:00:04.748590 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:00:04.749157 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m21:00:04.750445 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:00:04.750924 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:00:04.751373 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m21:00:04.861331 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m21:00:04.864743 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:00:04.865792 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    

  
[0m21:00:04.867725 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:04.870538 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m21:00:04.871327 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:00:04.872025 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m21:00:04.979903 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m21:00:04.981932 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins"
[0m21:00:04.983452 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:00:04.983938 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m21:00:04.985739 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:00:04.986260 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:00:04.986760 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

  
    
    

    create  table
      "an_data_pipeline"."main"."int_scrutins__dbt_tmp"
  
    as (
      

with __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
) SELECT
date_T_insert,
json_extract_string(json, '$.scrutin.uid') AS uid,
json_extract_string(json, '$.scrutin.numero') AS numero,
json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
json_extract_string(json, '$.scrutin.legislature') AS legislature,
json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
json_extract_string(json, '$.scrutin.titre') AS titre,
json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote,
date_T_insert
FROM __dbt__cte__stg_scrutins
    );
  
  
  
[0m21:00:06.565201 [debug] [Thread-1 (]: SQL status: OK in 1.576 seconds
[0m21:00:06.573116 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:00:06.573861 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_scrutins'
  
[0m21:00:06.575835 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:00:06.577839 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:00:06.578408 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_scrutins'
  
[0m21:00:06.579595 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:00:06.586522 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:00:06.586971 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */
alter table "an_data_pipeline"."main"."int_scrutins" rename to "int_scrutins__dbt_backup"
[0m21:00:06.706082 [debug] [Thread-1 (]: SQL status: OK in 0.119 seconds
[0m21:00:06.715337 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:00:06.716262 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */
alter table "an_data_pipeline"."main"."int_scrutins__dbt_tmp" rename to "int_scrutins"
[0m21:00:06.836747 [debug] [Thread-1 (]: SQL status: OK in 0.120 seconds
[0m21:00:06.841431 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m21:00:06.842277 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:00:06.842846 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m21:00:07.106239 [debug] [Thread-1 (]: SQL status: OK in 0.263 seconds
[0m21:00:07.113272 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:00:07.114413 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__42dc8a69ce74" cascade
    
[0m21:00:07.226424 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m21:00:07.231377 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:00:07.232080 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."main"."int_scrutins__dbt_backup" cascade
    
[0m21:00:07.471094 [debug] [Thread-1 (]: SQL status: OK in 0.238 seconds
[0m21:00:07.476223 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:00:07.476864 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__42dc8a69ce74" cascade
    
[0m21:00:07.590103 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m21:00:07.592466 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: Close
[0m21:00:07.593803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd49cb4e3-cfbc-4284-a953-58bbc38bc46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108851a30>]}
[0m21:00:07.594988 [info ] [Thread-1 (]: 9 of 10 OK created sql incremental model main.int_scrutins ..................... [[32mOK[0m in 2.97s]
[0m21:00:07.595812 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins
[0m21:00:07.596630 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins_votes
[0m21:00:07.597996 [info ] [Thread-1 (]: 10 of 10 START sql incremental model main.int_scrutins_votes ................... [RUN]
[0m21:00:07.598949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_scrutins, now model.dbt_an_data.int_scrutins_votes)
[0m21:00:07.599845 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins_votes
[0m21:00:07.649172 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins_votes"
[0m21:00:07.653007 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins_votes
[0m21:00:07.656114 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:00:07.656734 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__713cf2f449f8" cascade
    
[0m21:00:07.656987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:07.767524 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m21:00:07.771750 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:00:07.772442 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m21:00:07.774902 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:00:07.777608 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:00:07.778413 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m21:00:07.780212 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:00:07.780807 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:00:07.781340 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m21:00:07.893390 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m21:00:07.897475 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:00:07.898473 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    

  
[0m21:00:07.899621 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:07.901972 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m21:00:07.902666 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:00:07.903190 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m21:00:08.010627 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m21:00:08.011292 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins_votes"
[0m21:00:08.011835 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:00:08.011995 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m21:00:08.012566 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:08.012711 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:00:08.013023 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

  
    
    

    create  table
      "an_data_pipeline"."main"."int_scrutins_votes__dbt_tmp"
  
    as (
      

WITH  __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
), grp AS (
      -- explode les groupes (1 par groupe)
    SELECT
        json_extract_string(j.json, '$.scrutin.uid') AS uid,
        json_extract_string(g.value, '$.organeRef') AS groupe_organe,
        g.value AS groupe_json,
        j.date_T_insert
    FROM __dbt__cte__stg_scrutins j,
    json_each(json->'scrutin'->'ventilationVotes'->'organe'->'groupes'->'groupe') g
  ),

  positions_array AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          date_T_insert,
          groupe_organe,
          'pour' AS type_vote,
          p.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'pours'->'votant') p
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          date_T_insert,
          groupe_organe,
          'contre' AS type_vote,
          c.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'contres'->'votant') c
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          date_T_insert,
          groupe_organe,
          'abstention' AS type_vote,
          a.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'abstentions'->'votant') a
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          date_T_insert,
          groupe_organe,
          'nonVotant' AS type_vote,
          n.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'nonVotants'->'votant') n
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[ARRAY]'
  ),
  positions_object AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[OBJECT]'
  ),

  clean AS (
      -- sécurise les champs (souvent string ou null)
      SELECT
          uid,
          groupe_organe,
          type_vote,
          json_extract_string(vote_json, '$.acteurRef') AS acteurRef,
          json_extract_string(vote_json, '$.mandatRef') AS mandatRef,
          json_extract_string(vote_json, '$.parDelegation') AS parDelegation,
          json_extract_string(vote_json, '$.numPlace') AS numPlace,
          json_extract_string(vote_json, '$.causePositionVote') AS cause,
          date_T_insert
      FROM positions_array
      UNION ALL
      SELECT * 
      FROM positions_object
  )

  SELECT * FROM clean
    );
  
  
  
[0m21:00:20.430369 [debug] [Thread-1 (]: SQL status: OK in 12.417 seconds
[0m21:00:20.433553 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:00:20.433795 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_scrutins_votes'
  
[0m21:00:20.434658 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:00:20.435434 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:00:20.435638 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'int_scrutins_votes'
  
[0m21:00:20.436173 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:00:20.440972 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:00:20.441176 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */
alter table "an_data_pipeline"."main"."int_scrutins_votes" rename to "int_scrutins_votes__dbt_backup"
[0m21:00:20.647797 [debug] [Thread-1 (]: SQL status: OK in 0.206 seconds
[0m21:00:20.654304 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:00:20.655019 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */
alter table "an_data_pipeline"."main"."int_scrutins_votes__dbt_tmp" rename to "int_scrutins_votes"
[0m21:00:20.770703 [debug] [Thread-1 (]: SQL status: OK in 0.115 seconds
[0m21:00:20.774054 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m21:00:20.774839 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:00:20.775517 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m21:00:22.761646 [debug] [Thread-1 (]: SQL status: OK in 1.986 seconds
[0m21:00:22.763108 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:00:22.763442 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__713cf2f449f8" cascade
    
[0m21:00:22.872200 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m21:00:22.875479 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:00:22.875898 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."main"."int_scrutins_votes__dbt_backup" cascade
    
[0m21:00:23.103773 [debug] [Thread-1 (]: SQL status: OK in 0.227 seconds
[0m21:00:23.108257 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:00:23.108739 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__713cf2f449f8" cascade
    
[0m21:00:23.216792 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m21:00:23.219204 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: Close
[0m21:00:23.221114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd49cb4e3-cfbc-4284-a953-58bbc38bc46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b46ea0>]}
[0m21:00:23.222466 [info ] [Thread-1 (]: 10 of 10 OK created sql incremental model main.int_scrutins_votes .............. [[32mOK[0m in 15.62s]
[0m21:00:23.223601 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins_votes
[0m21:00:23.238704 [debug] [MainThread]: Using duckdb connection "master"
[0m21:00:23.239099 [debug] [MainThread]: On master: BEGIN
[0m21:00:23.239362 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:00:23.240458 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:00:23.240718 [debug] [MainThread]: On master: COMMIT
[0m21:00:23.240946 [debug] [MainThread]: Using duckdb connection "master"
[0m21:00:23.241200 [debug] [MainThread]: On master: COMMIT
[0m21:00:23.241658 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:00:23.241982 [debug] [MainThread]: On master: Close
[0m21:00:23.242343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:00:23.242578 [debug] [MainThread]: Connection 'model.dbt_an_data.int_scrutins_votes' was properly closed.
[0m21:00:23.243390 [info ] [MainThread]: 
[0m21:00:23.243878 [info ] [MainThread]: Finished running 10 incremental models, 1 project hook in 0 hours 0 minutes and 36.41 seconds (36.41s).
[0m21:00:23.246058 [debug] [MainThread]: Command end result
[0m21:00:23.286973 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m21:00:23.300219 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m21:00:23.309999 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m21:00:23.310180 [info ] [MainThread]: 
[0m21:00:23.310374 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:00:23.310515 [info ] [MainThread]: 
[0m21:00:23.311665 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m21:00:23.314165 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 36.9548, "process_in_blocks": "0", "process_kernel_time": 7.02221, "process_mem_max_rss": "2919333888", "process_out_blocks": "0", "process_user_time": 19.67421}
[0m21:00:23.314526 [debug] [MainThread]: Command `dbt build` succeeded at 21:00:23.314475 after 36.96 seconds
[0m21:00:23.315109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dd7c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e3c950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108126ea0>]}
[0m21:00:23.315290 [debug] [MainThread]: Flushing usage events
[0m21:00:23.981162 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:37:41.353803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10709c2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114536b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111453350>]}


============================== 21:37:41.357076 | f1575fc1-0eee-4fd0-91e5-dc09b0d20926 ==============================
[0m21:37:41.357076 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:37:41.357405 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'target_path': 'None', 'fail_fast': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'printer_width': '80', 'warn_error': 'None', 'quiet': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'debug': 'False', 'invocation_command': 'dbt build', 'no_print': 'None', 'log_format': 'default', 'write_json': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m21:37:41.561218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1575fc1-0eee-4fd0-91e5-dc09b0d20926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114c5be0>]}
[0m21:37:41.590602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1575fc1-0eee-4fd0-91e5-dc09b0d20926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106797140>]}
[0m21:37:41.592167 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:37:41.663591 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:37:41.743805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:37:41.744120 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:37:41.747553 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_an_data.mart
[0m21:37:41.774684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1575fc1-0eee-4fd0-91e5-dc09b0d20926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117fce00>]}
[0m21:37:41.815887 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m21:37:41.818380 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m21:37:41.841819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1575fc1-0eee-4fd0-91e5-dc09b0d20926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11266f560>]}
[0m21:37:41.842149 [info ] [MainThread]: Found 17 models, 1 operation, 9 sources, 469 macros
[0m21:37:41.843596 [info ] [MainThread]: 
[0m21:37:41.843809 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:37:41.843948 [info ] [MainThread]: 
[0m21:37:41.844211 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:37:41.846751 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_an_data_pipeline'
[0m21:37:41.945925 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline"
[0m21:37:41.946249 [debug] [ThreadPool]: On list_an_data_pipeline: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"an_data_pipeline"'
    
  
  
[0m21:37:41.946407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:37:54.241969 [debug] [ThreadPool]: SQL status: OK in 12.294 seconds
[0m21:37:54.249930 [debug] [ThreadPool]: On list_an_data_pipeline: Close
[0m21:37:54.252232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_an_data_pipeline, now create_an_data_pipeline_main)
[0m21:37:54.253176 [debug] [ThreadPool]: Creating schema "database: "an_data_pipeline"
schema: "main"
"
[0m21:37:54.265215 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m21:37:54.265674 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m21:37:54.265980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:37:54.267971 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:37:54.269339 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m21:37:54.269611 [debug] [ThreadPool]: On create_an_data_pipeline_main: BEGIN
[0m21:37:54.270320 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:37:54.270570 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m21:37:54.270806 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
    
        create schema if not exists "an_data_pipeline"."main"
    
[0m21:37:54.378255 [debug] [ThreadPool]: SQL status: OK in 0.107 seconds
[0m21:37:54.381575 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m21:37:54.382706 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m21:37:54.383604 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m21:37:54.496727 [debug] [ThreadPool]: SQL status: OK in 0.106 seconds
[0m21:37:54.498145 [debug] [ThreadPool]: On create_an_data_pipeline_main: Close
[0m21:37:54.512852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_an_data_pipeline_main, now list_an_data_pipeline_main)
[0m21:37:54.521432 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m21:37:54.522058 [debug] [ThreadPool]: On list_an_data_pipeline_main: BEGIN
[0m21:37:54.522461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:37:54.523950 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:37:54.524488 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m21:37:54.524991 [debug] [ThreadPool]: On list_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline_main"} */
select
      'an_data_pipeline' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'an_data_pipeline'
  
[0m21:37:54.544096 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m21:37:54.545536 [debug] [ThreadPool]: On list_an_data_pipeline_main: ROLLBACK
[0m21:37:54.550354 [debug] [ThreadPool]: Failed to rollback 'list_an_data_pipeline_main'
[0m21:37:54.550680 [debug] [ThreadPool]: On list_an_data_pipeline_main: Close
[0m21:37:54.552612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1575fc1-0eee-4fd0-91e5-dc09b0d20926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107148b90>]}
[0m21:37:54.553233 [debug] [MainThread]: Using duckdb connection "master"
[0m21:37:54.553469 [debug] [MainThread]: On master: BEGIN
[0m21:37:54.553681 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:37:54.554636 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:37:54.554883 [debug] [MainThread]: On master: COMMIT
[0m21:37:54.555085 [debug] [MainThread]: Using duckdb connection "master"
[0m21:37:54.555261 [debug] [MainThread]: On master: COMMIT
[0m21:37:54.555598 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:37:54.561673 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_an_data.dbt_an_data-on-run-start-0"
[0m21:37:54.566903 [info ] [MainThread]: 1 of 1 START hook: dbt_an_data.on-run-start.0 .................................. [RUN]
[0m21:37:54.567301 [debug] [MainThread]: Using duckdb connection "master"
[0m21:37:54.567535 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "master"} */
ATTACH '../data/database/database.duckdb' AS database (READ_ONLY)
[0m21:37:54.577322 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m21:37:54.578164 [info ] [MainThread]: 1 of 1 OK hook: dbt_an_data.on-run-start.0 ..................................... [[32mOK[0m in 0.02s]
[0m21:37:54.578401 [info ] [MainThread]: 
[0m21:37:54.578612 [debug] [MainThread]: On master: Close
[0m21:37:54.581323 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_acteurs
[0m21:37:54.581705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_an_data_pipeline_main, now model.dbt_an_data.stg_acteurs)
[0m21:37:54.582832 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_acteurs
[0m21:37:54.584974 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_acteurs"
[0m21:37:54.586059 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_acteurs
[0m21:37:54.586330 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_agenda
[0m21:37:54.586704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_acteurs, now model.dbt_an_data.stg_agenda)
[0m21:37:54.587115 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_agenda
[0m21:37:54.588957 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_agenda"
[0m21:37:54.590028 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_agenda
[0m21:37:54.590265 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_amendements
[0m21:37:54.590556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_agenda, now model.dbt_an_data.stg_amendements)
[0m21:37:54.590804 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_amendements
[0m21:37:54.592473 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_amendements"
[0m21:37:54.593878 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_amendements
[0m21:37:54.594083 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_organes
[0m21:37:54.594296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_amendements, now model.dbt_an_data.stg_organes)
[0m21:37:54.594499 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_organes
[0m21:37:54.595812 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_organes"
[0m21:37:54.596470 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_organes
[0m21:37:54.596654 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_pays
[0m21:37:54.596842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_organes, now model.dbt_an_data.stg_pays)
[0m21:37:54.597020 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_pays
[0m21:37:54.598338 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_pays"
[0m21:37:54.599023 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_pays
[0m21:37:54.599237 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_reunions
[0m21:37:54.599449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_pays, now model.dbt_an_data.stg_reunions)
[0m21:37:54.599638 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_reunions
[0m21:37:54.600938 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_reunions"
[0m21:37:54.601463 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_reunions
[0m21:37:54.601642 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_scrutins
[0m21:37:54.601822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_reunions, now model.dbt_an_data.stg_scrutins)
[0m21:37:54.601992 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_scrutins
[0m21:37:54.603190 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_scrutins"
[0m21:37:54.604397 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_scrutins
[0m21:37:54.604583 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_acteurs
[0m21:37:54.604870 [info ] [Thread-1 (]: 1 of 10 START sql incremental model main.int_acteurs ........................... [RUN]
[0m21:37:54.605177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_scrutins, now model.dbt_an_data.int_acteurs)
[0m21:37:54.605356 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_acteurs
[0m21:37:54.619152 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_acteurs"
[0m21:37:54.620298 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_acteurs
[0m21:37:54.625711 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m21:37:54.625940 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__0b458da3d385" cascade
    
[0m21:37:54.626094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:54.731016 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m21:37:54.761228 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m21:37:54.761513 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m21:37:54.762431 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:37:54.763226 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m21:37:54.763423 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m21:37:54.763850 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:37:54.764022 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m21:37:54.764190 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m21:37:54.934378 [debug] [Thread-1 (]: SQL status: OK in 0.169 seconds
[0m21:37:54.938112 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m21:37:54.939074 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    

  
[0m21:37:54.940217 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:37:54.943096 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m21:37:54.944120 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m21:37:54.944950 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m21:37:55.049463 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m21:37:55.054934 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m21:37:55.055159 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_acteurs__0b458da3d385"
  
    as (
      

with __dbt__cte__stg_acteurs as (
SELECT * 
FROM "database"."stg"."raw_acteurs"
) SELECT 
json_extract_string(json, '$.acteur.uid.#text') as uid,
json_extract_string(json, '$.acteur.etatCivil.ident.civ') as civ,
json_extract_string(json, '$.acteur.etatCivil.ident.prenom') as prenom,
json_extract_string(json, '$.acteur.etatCivil.ident.nom') as nom,
json_extract_string(json, '$.acteur.etatCivil.ident.trigramme') as trigramme,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.dateNais') as dateNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.villeNais') as villeNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.depNais') as depNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.paysNais') as paysNais,
json_extract_string(json, '$.acteur.etatCivil.dateDeces') as dateDeces,
json_extract_string(json, '$.acteur.profession.libelleCourant') as libelleCourant,
json_extract_string(json, '$.acteur.profession.socProcINSEE.catSocPro') as catSocPro,
json_extract_string(json, '$.acteur.profession.socProcINSEE.famSocPro') as famSocPro,
json_extract_string(json, '$.acteur.uri_hatvp') as uri_hatvp,
date_T_insert
FROM __dbt__cte__stg_acteurs
    );
  
  
  
[0m21:37:55.645517 [debug] [Thread-1 (]: SQL status: OK in 0.590 seconds
[0m21:37:55.652952 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m21:37:55.653315 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m21:37:55.654201 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:37:55.654476 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m21:37:55.654757 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs__0b458da3d385'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m21:37:55.661902 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m21:37:55.666178 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m21:37:55.666486 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m21:37:55.668730 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:37:55.674857 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m21:37:55.675134 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m21:37:55.677114 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:37:55.678571 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m21:37:55.678778 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */
SELECT version()
[0m21:37:55.679170 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:37:55.687558 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_acteurs"
[0m21:37:55.688528 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m21:37:55.688732 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

        
            delete from "an_data_pipeline"."main"."int_acteurs"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_acteurs__0b458da3d385"
            );

        
    

    insert into "an_data_pipeline"."main"."int_acteurs" ("uid", "civ", "prenom", "nom", "trigramme", "dateNais", "villeNais", "depNais", "paysNais", "dateDeces", "libelleCourant", "catSocPro", "famSocPro", "uri_hatvp", "date_T_insert")
    (
        select "uid", "civ", "prenom", "nom", "trigramme", "dateNais", "villeNais", "depNais", "paysNais", "dateDeces", "libelleCourant", "catSocPro", "famSocPro", "uri_hatvp", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_acteurs__0b458da3d385"
    )
  
[0m21:37:55.920275 [debug] [Thread-1 (]: SQL status: OK in 0.231 seconds
[0m21:37:55.942005 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m21:37:55.942761 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m21:37:55.943288 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m21:37:56.066681 [debug] [Thread-1 (]: SQL status: OK in 0.123 seconds
[0m21:37:56.073108 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m21:37:56.075337 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__0b458da3d385" cascade
    
[0m21:37:56.480308 [debug] [Thread-1 (]: SQL status: OK in 0.404 seconds
[0m21:37:56.481994 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m21:37:56.482161 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__0b458da3d385" cascade
    
[0m21:37:56.605311 [debug] [Thread-1 (]: SQL status: OK in 0.123 seconds
[0m21:37:56.608098 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: Close
[0m21:37:56.611440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1575fc1-0eee-4fd0-91e5-dc09b0d20926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11313ae70>]}
[0m21:37:56.612074 [info ] [Thread-1 (]: 1 of 10 OK created sql incremental model main.int_acteurs ...................... [[32mOK[0m in 2.00s]
[0m21:37:56.612583 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_acteurs
[0m21:37:56.612934 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_mandats
[0m21:37:56.613392 [info ] [Thread-1 (]: 2 of 10 START sql incremental model main.int_mandats ........................... [RUN]
[0m21:37:56.613778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_acteurs, now model.dbt_an_data.int_mandats)
[0m21:37:56.614082 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_mandats
[0m21:37:56.622959 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_mandats"
[0m21:37:56.623699 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_mandats
[0m21:37:56.672344 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m21:37:56.672567 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__2b1853b3307d" cascade
    
[0m21:37:56.672724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:56.776526 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m21:37:56.779030 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m21:37:56.779352 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m21:37:56.780414 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:37:56.781507 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m21:37:56.781786 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m21:37:56.782488 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:37:56.782742 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m21:37:56.782993 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m21:37:56.888272 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m21:37:56.891026 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m21:37:56.891757 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    

  
[0m21:37:56.892472 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:37:56.894404 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m21:37:56.895056 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m21:37:56.895599 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m21:37:56.998196 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m21:37:56.998658 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m21:37:56.998849 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_mandats__2b1853b3307d"
  
    as (
      

with __dbt__cte__stg_acteurs as (
SELECT * 
FROM "database"."stg"."raw_acteurs"
) SELECT 
json_extract_string(mandat.value, '$.uid') as uid,
json_extract_string(mandat.value, '$.acteurRef') as acteurRef,
json_extract_string(mandat.value, '$.legislature') as legislature,
json_extract_string(mandat.value, '$.typeOrgane') as typeOrgane,
json_extract_string(mandat.value, '$.dateDebut') as dateDebut,
json_extract_string(mandat.value, '$.dateFin') as dateFin,
json_extract_string(mandat.value, '$.preseance') as preseance,
json_extract_string(mandat.value, '$.nominPrincipale') as nominPrincipale,
json_extract_string(mandat.value, '$.infosQualite.codeQualite') as codeQualite,
json_extract_string(mandat.value, '$.organes.organeRef') as organeRef,
date_T_insert
FROM __dbt__cte__stg_acteurs act, json_each(json->'acteur'->'mandats'->'mandat') mandat
    );
  
  
  
[0m21:37:58.995099 [debug] [Thread-1 (]: SQL status: OK in 1.995 seconds
[0m21:37:59.001351 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m21:37:59.001802 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m21:37:59.003109 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:37:59.003485 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m21:37:59.003862 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats__2b1853b3307d'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m21:37:59.007936 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:37:59.011079 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m21:37:59.011476 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m21:37:59.014420 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:37:59.017866 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m21:37:59.018190 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m21:37:59.020628 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:37:59.022890 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_mandats"
[0m21:37:59.023650 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m21:37:59.023928 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

        
            delete from "an_data_pipeline"."main"."int_mandats"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_mandats__2b1853b3307d"
            );

        
    

    insert into "an_data_pipeline"."main"."int_mandats" ("uid", "acteurRef", "legislature", "typeOrgane", "dateDebut", "dateFin", "preseance", "nominPrincipale", "codeQualite", "organeRef", "date_T_insert")
    (
        select "uid", "acteurRef", "legislature", "typeOrgane", "dateDebut", "dateFin", "preseance", "nominPrincipale", "codeQualite", "organeRef", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_mandats__2b1853b3307d"
    )
  
[0m21:37:59.290405 [debug] [Thread-1 (]: SQL status: OK in 0.266 seconds
[0m21:37:59.294001 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m21:37:59.294968 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m21:37:59.295706 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m21:37:59.486473 [debug] [Thread-1 (]: SQL status: OK in 0.190 seconds
[0m21:37:59.494180 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m21:37:59.495417 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__2b1853b3307d" cascade
    
[0m21:37:59.724682 [debug] [Thread-1 (]: SQL status: OK in 0.228 seconds
[0m21:37:59.732492 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m21:37:59.733451 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__2b1853b3307d" cascade
    
[0m21:37:59.843764 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m21:37:59.848197 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: Close
[0m21:37:59.850126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1575fc1-0eee-4fd0-91e5-dc09b0d20926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131bc9e0>]}
[0m21:37:59.851931 [info ] [Thread-1 (]: 2 of 10 OK created sql incremental model main.int_mandats ...................... [[32mOK[0m in 3.24s]
[0m21:37:59.853297 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_mandats
[0m21:37:59.854270 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_agenda
[0m21:37:59.855503 [info ] [Thread-1 (]: 3 of 10 START sql incremental model main.int_agenda ............................ [RUN]
[0m21:37:59.856588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_mandats, now model.dbt_an_data.int_agenda)
[0m21:37:59.857359 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_agenda
[0m21:37:59.864320 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_agenda"
[0m21:37:59.866001 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_agenda
[0m21:37:59.871375 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m21:37:59.871892 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__fb8ba2cb649e" cascade
    
[0m21:37:59.872367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:00.695728 [debug] [Thread-1 (]: SQL status: OK in 0.823 seconds
[0m21:38:00.708007 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m21:38:00.708820 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m21:38:00.711610 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:38:00.714468 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m21:38:00.715467 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m21:38:00.717418 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:00.718000 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m21:38:00.718498 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m21:38:00.823039 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m21:38:00.825150 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m21:38:00.825803 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    

  
[0m21:38:00.826484 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:38:00.829247 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m21:38:00.830118 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m21:38:00.830701 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m21:38:00.934243 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m21:38:00.934698 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m21:38:00.934868 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_agenda__fb8ba2cb649e"
  
    as (
      

with __dbt__cte__stg_agenda as (
SELECT * 
FROM "database"."stg"."raw_agenda"
) SELECT * 
FROM __dbt__cte__stg_agenda
    );
  
  
  
[0m21:38:01.341417 [debug] [Thread-1 (]: SQL status: OK in 0.406 seconds
[0m21:38:01.343180 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m21:38:01.343363 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m21:38:01.343884 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:38:01.344042 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m21:38:01.344200 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda__fb8ba2cb649e'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m21:38:01.345931 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:38:01.347283 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m21:38:01.347454 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m21:38:01.348797 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:01.350110 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m21:38:01.350272 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m21:38:01.351567 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:01.352424 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_agenda"
[0m21:38:01.352805 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m21:38:01.352968 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

        
            delete from "an_data_pipeline"."main"."int_agenda" as DBT_INCREMENTAL_TARGET
            using "an_data_pipeline"."dbt_temp"."int_agenda__fb8ba2cb649e"
            where (
                
                    "an_data_pipeline"."dbt_temp"."int_agenda__fb8ba2cb649e".Date = DBT_INCREMENTAL_TARGET.Date
                    and 
                
                    "an_data_pipeline"."dbt_temp"."int_agenda__fb8ba2cb649e".Heure = DBT_INCREMENTAL_TARGET.Heure
                    
                
                
            );
        
    

    insert into "an_data_pipeline"."main"."int_agenda" ("Date", "Heure", "Ordre(s) du jour", "filename", "date_T_insert")
    (
        select "Date", "Heure", "Ordre(s) du jour", "filename", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_agenda__fb8ba2cb649e"
    )
  
[0m21:38:01.577148 [debug] [Thread-1 (]: SQL status: OK in 0.223 seconds
[0m21:38:01.580822 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m21:38:01.581686 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m21:38:01.582405 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m21:38:01.697818 [debug] [Thread-1 (]: SQL status: OK in 0.115 seconds
[0m21:38:01.699221 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m21:38:01.699399 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__fb8ba2cb649e" cascade
    
[0m21:38:01.920471 [debug] [Thread-1 (]: SQL status: OK in 0.221 seconds
[0m21:38:01.922021 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m21:38:01.922194 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__fb8ba2cb649e" cascade
    
[0m21:38:02.027309 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m21:38:02.028696 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: Close
[0m21:38:02.029322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1575fc1-0eee-4fd0-91e5-dc09b0d20926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132ff4d0>]}
[0m21:38:02.029933 [info ] [Thread-1 (]: 3 of 10 OK created sql incremental model main.int_agenda ....................... [[32mOK[0m in 2.17s]
[0m21:38:02.030432 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_agenda
[0m21:38:02.030799 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements
[0m21:38:02.031317 [info ] [Thread-1 (]: 4 of 10 START sql incremental model main.int_amendements ....................... [RUN]
[0m21:38:02.031742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_agenda, now model.dbt_an_data.int_amendements)
[0m21:38:02.032065 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements
[0m21:38:02.046667 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements"
[0m21:38:02.047272 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements
[0m21:38:02.050007 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m21:38:02.050235 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__0ce2b4ef73bb" cascade
    
[0m21:38:02.050439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:02.157341 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m21:38:02.162363 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m21:38:02.163219 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m21:38:02.165545 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:38:02.167510 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m21:38:02.167985 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m21:38:02.169074 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:02.169502 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m21:38:02.169925 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m21:38:02.276755 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m21:38:02.280554 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m21:38:02.281736 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    

  
[0m21:38:02.282749 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:38:02.285690 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m21:38:02.286622 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m21:38:02.287438 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m21:38:02.393877 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m21:38:02.397143 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m21:38:02.399048 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_amendements__0ce2b4ef73bb"
  
    as (
      

with __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
) SELECT
json_extract_string(json, '$.amendement.uid') AS uid,
json_extract_string(json, '$.amendement.chronotag') AS chronotag,
json_extract_string(json, '$.amendement.examenRef') AS examenRef,
json_extract_string(json, '$.amendement.amendementParentRef') AS amendementParentRef,
json_extract_string(json, '$.amendement.signataires.auteur.typeAuteur') AS typeAuteur,
json_extract_string(json, '$.amendement.signataires.auteur.acteurRef') AS refAuteur,
json_extract_string(json, '$.amendement.signataires.auteur.groupePolitique') AS groupePolitiqueAuteur,
json_extract_string(json, '$.amendement.cycleDeVie.dateDepot') AS dateDepot,
json_extract_string(json, '$.amendement.cycleDeVie.datePublication') AS datePublication,
json_extract_string(json, '$.amendement.cycleDeVie.soumisArticle40') AS soumisArticle40,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.code') AS codeEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.libelle') AS libelleEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.code') AS codeSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.dateSort') AS dateSort,
json_extract_string(json, '$.amendement.cycleDeVie.sort') AS sort,
split_part(replace(filename, '.json', ''), '/', -1) AS id_amendement,
split_part(replace(filename, '.json', ''), '/', -2) AS id_texte,
split_part(replace(filename, '.json', ''), '/', -3) AS id_dossier_legislatif,
id_texte[:4] AS nature_texte,
id_texte[5:6] AS source_texte,
regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 1) AS prefix_bibard,
regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 2) AS numero_bibard,
regexp_extract(id_amendement, '(SEA|PO\d*)', 1) AS code_organe,
regexp_extract(id_amendement, '(P)(\d*)(D)', 2) AS numero_partie,
regexp_extract(id_amendement, '(D)(\d*)(N)', 2) AS numero_deliberation,
regexp_extract(id_amendement, '(D)(\d*)(N)(\d*)', 4) AS numero_court,
date_T_insert
from __dbt__cte__stg_amendements
    );
  
  
  
[0m21:38:22.742335 [debug] [Thread-1 (]: SQL status: OK in 20.341 seconds
[0m21:38:22.754838 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m21:38:22.755259 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m21:38:22.756697 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:22.757017 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m21:38:22.757346 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements__0ce2b4ef73bb'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m21:38:22.764516 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m21:38:22.770544 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m21:38:22.770887 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m21:38:22.773596 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:38:22.776420 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m21:38:22.776741 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m21:38:22.779447 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:38:22.781686 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements"
[0m21:38:22.782672 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m21:38:22.782973 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

        
            delete from "an_data_pipeline"."main"."int_amendements"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_amendements__0ce2b4ef73bb"
            );

        
    

    insert into "an_data_pipeline"."main"."int_amendements" ("uid", "chronotag", "examenRef", "amendementParentRef", "typeAuteur", "refAuteur", "groupePolitiqueAuteur", "dateDepot", "datePublication", "soumisArticle40", "codeEtat", "libelleEtat", "codeSousEtat", "libelleSousEtat", "libelleSousEtat_1", "dateSort", "sort", "id_amendement", "id_texte", "id_dossier_legislatif", "nature_texte", "source_texte", "prefix_bibard", "numero_bibard", "code_organe", "numero_partie", "numero_deliberation", "numero_court", "date_T_insert")
    (
        select "uid", "chronotag", "examenRef", "amendementParentRef", "typeAuteur", "refAuteur", "groupePolitiqueAuteur", "dateDepot", "datePublication", "soumisArticle40", "codeEtat", "libelleEtat", "codeSousEtat", "libelleSousEtat", "libelleSousEtat_1", "dateSort", "sort", "id_amendement", "id_texte", "id_dossier_legislatif", "nature_texte", "source_texte", "prefix_bibard", "numero_bibard", "code_organe", "numero_partie", "numero_deliberation", "numero_court", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_amendements__0ce2b4ef73bb"
    )
  
[0m21:38:23.336446 [debug] [Thread-1 (]: SQL status: OK in 0.553 seconds
[0m21:38:23.340038 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m21:38:23.340822 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m21:38:23.341542 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m21:38:24.233133 [debug] [Thread-1 (]: SQL status: OK in 0.890 seconds
[0m21:38:24.242053 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m21:38:24.243004 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__0ce2b4ef73bb" cascade
    
[0m21:38:24.544820 [debug] [Thread-1 (]: SQL status: OK in 0.301 seconds
[0m21:38:24.553250 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m21:38:24.554216 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__0ce2b4ef73bb" cascade
    
[0m21:38:24.665396 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m21:38:24.669305 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: Close
[0m21:38:24.671130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1575fc1-0eee-4fd0-91e5-dc09b0d20926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113505940>]}
[0m21:38:24.672769 [info ] [Thread-1 (]: 4 of 10 OK created sql incremental model main.int_amendements .................. [[32mOK[0m in 22.64s]
[0m21:38:24.673999 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements
[0m21:38:24.674905 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements_cosignataires
[0m21:38:24.676336 [info ] [Thread-1 (]: 5 of 10 START sql incremental model main.int_amendements_cosignataires ......... [RUN]
[0m21:38:24.677188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements, now model.dbt_an_data.int_amendements_cosignataires)
[0m21:38:24.677823 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements_cosignataires
[0m21:38:24.688171 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements_cosignataires"
[0m21:38:24.689281 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements_cosignataires
[0m21:38:24.692143 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m21:38:24.692386 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__e91705d754da" cascade
    
[0m21:38:24.692600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:24.926472 [debug] [Thread-1 (]: SQL status: OK in 0.234 seconds
[0m21:38:24.932712 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m21:38:24.933717 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m21:38:24.936801 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:38:24.940279 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m21:38:24.941028 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m21:38:24.942909 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:24.943620 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m21:38:24.944247 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m21:38:25.051752 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m21:38:25.055205 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m21:38:25.056083 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    

  
[0m21:38:25.057061 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:38:25.059109 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m21:38:25.059796 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m21:38:25.060401 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m21:38:25.165896 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m21:38:25.168899 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m21:38:25.170212 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__e91705d754da"
  
    as (
      

WITH  __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
), cosignataires_arr AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef[*]') AS acteurRef,
    date_T_insert
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') == 'ARRAY' AND acteurRef IS NOT NULL
), cosignataires_str AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef') AS acteurRef,
    date_T_insert
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') <> 'ARRAY' AND acteurRef IS NOT NULL
)
SELECT 
  uid, 
  unnest(acteurRef) as acteurRef,
  date_T_insert
FROM cosignataires_arr
UNION ALL
SELECT 
  uid, 
  acteurRef,
  date_T_insert
FROM cosignataires_str
    );
  
  
  
[0m21:39:02.917676 [debug] [Thread-1 (]: SQL status: OK in 37.747 seconds
[0m21:39:02.923640 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m21:39:02.923872 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m21:39:02.924634 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:39:02.924857 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m21:39:02.925031 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires__e91705d754da'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m21:39:02.927158 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:39:02.928586 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m21:39:02.928777 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m21:39:02.930183 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:39:02.932780 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m21:39:02.932963 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m21:39:02.934321 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:39:02.935446 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements_cosignataires"
[0m21:39:02.936360 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m21:39:02.936540 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

        
            delete from "an_data_pipeline"."main"."int_amendements_cosignataires" as DBT_INCREMENTAL_TARGET
            using "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__e91705d754da"
            where (
                
                    "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__e91705d754da".uid = DBT_INCREMENTAL_TARGET.uid
                    and 
                
                    "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__e91705d754da".acteurRef = DBT_INCREMENTAL_TARGET.acteurRef
                    
                
                
            );
        
    

    insert into "an_data_pipeline"."main"."int_amendements_cosignataires" ("uid", "acteurRef", "date_T_insert")
    (
        select "uid", "acteurRef", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__e91705d754da"
    )
  
[0m21:39:03.435267 [debug] [Thread-1 (]: SQL status: OK in 0.498 seconds
[0m21:39:03.439959 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m21:39:03.440887 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m21:39:03.441623 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m21:39:03.921599 [debug] [Thread-1 (]: SQL status: OK in 0.479 seconds
[0m21:39:03.925954 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m21:39:03.926552 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__e91705d754da" cascade
    
[0m21:39:04.172540 [debug] [Thread-1 (]: SQL status: OK in 0.245 seconds
[0m21:39:04.181032 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m21:39:04.182126 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__e91705d754da" cascade
    
[0m21:39:04.292147 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m21:39:04.295336 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: Close
[0m21:39:04.297163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1575fc1-0eee-4fd0-91e5-dc09b0d20926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132f7ec0>]}
[0m21:39:04.299225 [info ] [Thread-1 (]: 5 of 10 OK created sql incremental model main.int_amendements_cosignataires .... [[32mOK[0m in 39.62s]
[0m21:39:04.300722 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements_cosignataires
[0m21:39:04.301847 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_organes
[0m21:39:04.303635 [info ] [Thread-1 (]: 6 of 10 START sql incremental model main.int_organes ........................... [RUN]
[0m21:39:04.304962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements_cosignataires, now model.dbt_an_data.int_organes)
[0m21:39:04.305788 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_organes
[0m21:39:04.320946 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_organes"
[0m21:39:04.322101 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_organes
[0m21:39:04.327095 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m21:39:04.327523 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__35efc3016dc5" cascade
    
[0m21:39:04.327907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:39:04.438121 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m21:39:04.445944 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m21:39:04.446853 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m21:39:04.450224 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:39:04.452828 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m21:39:04.453509 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m21:39:04.454994 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:39:04.455639 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m21:39:04.456177 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m21:39:04.565177 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m21:39:04.569290 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m21:39:04.570450 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    

  
[0m21:39:04.571673 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:39:04.574388 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m21:39:04.575271 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m21:39:04.575941 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m21:39:04.682591 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m21:39:04.686070 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m21:39:04.687276 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_organes__35efc3016dc5"
  
    as (
      

with __dbt__cte__stg_organes as (
SELECT * 
FROM "database"."stg"."raw_organes"
) SELECT 
json_extract_string(json, '$.organe.uid') as uid,
json_extract_string(json, '$.organe.codeType') as codeType,
json_extract_string(json, '$.organe.libelle') as libelle,
json_extract_string(json, '$.organe.libelleEdition') as libelleEdition,
json_extract_string(json, '$.organe.libelleAbrege') as libelleAbrege,
json_extract_string(json, '$.organe.libelleAbrev') as libelleAbrev,
json_extract_string(json, '$.organe.viMoDe.dateDebut') as dateDebut,
json_extract_string(json, '$.organe.viMoDe.dateAgrement') as dateAgrement,
json_extract_string(json, '$.organe.viMoDe.dateFin') as dateFin,
json_extract_string(json, '$.organe.organeParent') as organeParent,
json_extract_string(json, '$.organe.chambre') as chambre,
json_extract_string(json, '$.organe.regime') as regime,
json_extract_string(json, '$.organe.legislature') as legislature,
date_T_insert
FROM __dbt__cte__stg_organes
    );
  
  
  
[0m21:39:06.384056 [debug] [Thread-1 (]: SQL status: OK in 1.696 seconds
[0m21:39:06.385876 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m21:39:06.386053 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m21:39:06.386542 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:39:06.386691 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m21:39:06.386842 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes__35efc3016dc5'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m21:39:06.388494 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:39:06.390001 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m21:39:06.390190 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m21:39:06.391782 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:39:06.393220 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m21:39:06.393393 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m21:39:06.394738 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:39:06.395769 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_organes"
[0m21:39:06.397839 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m21:39:06.398018 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

        
            delete from "an_data_pipeline"."main"."int_organes"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_organes__35efc3016dc5"
            );

        
    

    insert into "an_data_pipeline"."main"."int_organes" ("uid", "codeType", "libelle", "libelleEdition", "libelleAbrege", "libelleAbrev", "dateDebut", "dateAgrement", "dateFin", "organeParent", "chambre", "regime", "legislature", "date_T_insert")
    (
        select "uid", "codeType", "libelle", "libelleEdition", "libelleAbrege", "libelleAbrev", "dateDebut", "dateAgrement", "dateFin", "organeParent", "chambre", "regime", "legislature", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_organes__35efc3016dc5"
    )
  
[0m21:39:06.742629 [debug] [Thread-1 (]: SQL status: OK in 0.344 seconds
[0m21:39:06.746521 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m21:39:06.747753 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m21:39:06.748667 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m21:39:06.913765 [debug] [Thread-1 (]: SQL status: OK in 0.164 seconds
[0m21:39:06.920953 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m21:39:06.922063 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__35efc3016dc5" cascade
    
[0m21:39:07.143704 [debug] [Thread-1 (]: SQL status: OK in 0.221 seconds
[0m21:39:07.146207 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m21:39:07.146387 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__35efc3016dc5" cascade
    
[0m21:39:07.249560 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m21:39:07.250641 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: Close
[0m21:39:07.251123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1575fc1-0eee-4fd0-91e5-dc09b0d20926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135419a0>]}
[0m21:39:07.251691 [info ] [Thread-1 (]: 6 of 10 OK created sql incremental model main.int_organes ...................... [[32mOK[0m in 2.95s]
[0m21:39:07.252167 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_organes
[0m21:39:07.252501 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_pays
[0m21:39:07.252949 [info ] [Thread-1 (]: 7 of 10 START sql incremental model main.int_pays .............................. [RUN]
[0m21:39:07.253350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_organes, now model.dbt_an_data.int_pays)
[0m21:39:07.253667 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_pays
[0m21:39:07.260840 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_pays"
[0m21:39:07.261893 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_pays
[0m21:39:07.264787 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:39:07.265051 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__55d97dd2eede" cascade
    
[0m21:39:07.265293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:39:07.374040 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m21:39:07.379924 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:39:07.380780 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m21:39:07.383079 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:39:07.385043 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:39:07.385543 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m21:39:07.386606 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:39:07.387031 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:39:07.387451 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m21:39:07.494996 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m21:39:07.498511 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:39:07.499390 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    

  
[0m21:39:07.500407 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:39:07.503121 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m21:39:07.504115 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:39:07.504921 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m21:39:07.609684 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m21:39:07.610121 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:39:07.610306 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_pays__55d97dd2eede"
  
    as (
      

with __dbt__cte__stg_pays as (
SELECT * 
FROM "database"."stg"."raw_pays"
) SELECT
json_extract_string(json, '$.pays.uid') as uid,
json_extract_string(json, '$.pays.code_insee') as code_insee,
json_extract_string(json, '$.pays.libelleInsee') as libelleInsee,
json_extract_string(json, '$.pays.nomCourant') as nomCourant,
json_extract_string(json, '$.pays.code_iso2A') as code_iso2A,
json_extract_string(json, '$.pays.code_iso3A') as code_iso3A,
json_extract_string(json, '$.pays.code_iso3N') as code_iso3N,
json_extract_string(json, '$.pays.libelleIso') as libelleIso,
json_extract_string(json, '$.pays.libelleANCourt') as libelleANCourt,
json_extract_string(json, '$.pays.libelleANLong') as libelleANLong,
json_extract_string(json, '$.pays.sourceJuridique') as sourceJuridique,
json_extract_string(json, '$.pays.activ') as activ,
date_T_insert
FROM __dbt__cte__stg_pays
    );
  
  
  
[0m21:39:07.950034 [debug] [Thread-1 (]: SQL status: OK in 0.339 seconds
[0m21:39:07.955858 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:39:07.956578 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m21:39:07.957872 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:39:07.958301 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:39:07.958740 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays__55d97dd2eede'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m21:39:07.963301 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:39:07.967153 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:39:07.967566 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m21:39:07.970831 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:39:07.974141 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:39:07.974503 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m21:39:07.977254 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:39:07.979297 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_pays"
[0m21:39:07.980895 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:39:07.981233 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

        
            delete from "an_data_pipeline"."main"."int_pays"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_pays__55d97dd2eede"
            );

        
    

    insert into "an_data_pipeline"."main"."int_pays" ("uid", "code_insee", "libelleInsee", "nomCourant", "code_iso2A", "code_iso3A", "code_iso3N", "libelleIso", "libelleANCourt", "libelleANLong", "sourceJuridique", "activ", "date_T_insert")
    (
        select "uid", "code_insee", "libelleInsee", "nomCourant", "code_iso2A", "code_iso3A", "code_iso3N", "libelleIso", "libelleANCourt", "libelleANLong", "sourceJuridique", "activ", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_pays__55d97dd2eede"
    )
  
[0m21:39:08.214507 [debug] [Thread-1 (]: SQL status: OK in 0.232 seconds
[0m21:39:08.218325 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m21:39:08.219486 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:39:08.219948 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m21:39:08.340196 [debug] [Thread-1 (]: SQL status: OK in 0.119 seconds
[0m21:39:08.347100 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:39:08.348657 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__55d97dd2eede" cascade
    
[0m21:39:08.570021 [debug] [Thread-1 (]: SQL status: OK in 0.221 seconds
[0m21:39:08.571709 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m21:39:08.571879 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__55d97dd2eede" cascade
    
[0m21:39:08.776501 [debug] [Thread-1 (]: SQL status: OK in 0.203 seconds
[0m21:39:08.779730 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: Close
[0m21:39:08.781169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1575fc1-0eee-4fd0-91e5-dc09b0d20926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11329ac30>]}
[0m21:39:08.782562 [info ] [Thread-1 (]: 7 of 10 OK created sql incremental model main.int_pays ......................... [[32mOK[0m in 1.53s]
[0m21:39:08.783506 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_pays
[0m21:39:08.784201 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_reunions
[0m21:39:08.785064 [info ] [Thread-1 (]: 8 of 10 START sql incremental model main.int_reunions .......................... [RUN]
[0m21:39:08.785937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_pays, now model.dbt_an_data.int_reunions)
[0m21:39:08.786604 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_reunions
[0m21:39:08.803791 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_reunions"
[0m21:39:08.805093 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_reunions
[0m21:39:08.811854 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:39:08.812275 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__57faac1f0047" cascade
    
[0m21:39:08.812642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:39:08.919631 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m21:39:08.926733 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:39:08.927773 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m21:39:08.931128 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:39:08.934652 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:39:08.935366 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m21:39:08.937193 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:39:08.937892 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:39:08.938430 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m21:39:09.044918 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m21:39:09.047752 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:39:09.048463 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    

  
[0m21:39:09.049323 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:39:09.051678 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m21:39:09.052521 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:39:09.053342 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m21:39:09.160553 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m21:39:09.162183 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:39:09.162922 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_reunions__57faac1f0047"
  
    as (
      

with __dbt__cte__stg_reunions as (
SELECT * 
FROM "database"."stg"."raw_reunions"
) SELECT
json_extract_string(json, '$.reunion.uid') AS uid,
json_extract_string(json, '$.reunion.timeStampDebut') AS timeStampDebut,
json_extract_string(json, '$.reunion.lieu.lieuRef') AS lieuRef,
json_extract_string(json, '$.reunion.lieu.libelleLong') AS lieuLibelle,
json_extract_string(json, '$.reunion.cycleDeVie.etat') AS cycleDeVieEtat,
json_extract_string(json, '$.reunion.demandeur') AS demandeur,
json_extract_string(json, '$.reunion.organeReuniRef') AS organeReuniRef,
json_extract_string(json, '$.reunion.visioConference') AS visioConference,
json_extract_string(json, '$.reunion.sessionRef') AS sessionRef,
json_extract_string(json, '$.reunion.ouverturePresse') AS ouverturePresse,
json_extract_string(json, '$.reunion.captationVideo') AS captationVideo,
json_extract_string(json, '$.reunion.ODJ.convocationODJ.item') AS convocationODJ,
json_extract_string(json, '$.reunion.ODJ.resumeODJ.item') AS resumeODJ,
json_extract_string(json, '$.reunion.compteRenduRef') AS compteRenduRef,
json_extract_string(json, '$.reunion.identifiants.numSeanceJO') AS numSeanceJO,
json_extract_string(json, '$.reunion.identifiants.idJO') AS idJO,
json_extract_string(json, '$.reunion.identifiants.quantieme') AS quantieme,
json_extract_string(json, '$.reunion.identifiants.DataSeance') AS DataSeance,
date_T_insert
FROM __dbt__cte__stg_reunions
    );
  
  
  
[0m21:39:15.499999 [debug] [Thread-1 (]: SQL status: OK in 6.337 seconds
[0m21:39:15.501875 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:39:15.502062 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m21:39:15.502612 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:39:15.502765 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:39:15.502919 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions__57faac1f0047'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m21:39:15.504538 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:39:15.506068 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:39:15.506241 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m21:39:15.507636 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:39:15.509222 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:39:15.509418 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m21:39:15.511033 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:39:15.512158 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_reunions"
[0m21:39:15.512739 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:39:15.512917 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

        
            delete from "an_data_pipeline"."main"."int_reunions"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_reunions__57faac1f0047"
            );

        
    

    insert into "an_data_pipeline"."main"."int_reunions" ("uid", "timeStampDebut", "lieuRef", "lieuLibelle", "cycleDeVieEtat", "demandeur", "organeReuniRef", "visioConference", "sessionRef", "ouverturePresse", "captationVideo", "convocationODJ", "resumeODJ", "compteRenduRef", "numSeanceJO", "idJO", "quantieme", "DataSeance", "date_T_insert")
    (
        select "uid", "timeStampDebut", "lieuRef", "lieuLibelle", "cycleDeVieEtat", "demandeur", "organeReuniRef", "visioConference", "sessionRef", "ouverturePresse", "captationVideo", "convocationODJ", "resumeODJ", "compteRenduRef", "numSeanceJO", "idJO", "quantieme", "DataSeance", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_reunions__57faac1f0047"
    )
  
[0m21:39:15.759156 [debug] [Thread-1 (]: SQL status: OK in 0.246 seconds
[0m21:39:15.762953 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m21:39:15.763978 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:39:15.764735 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m21:39:15.943008 [debug] [Thread-1 (]: SQL status: OK in 0.178 seconds
[0m21:39:15.944264 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:39:15.944426 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__57faac1f0047" cascade
    
[0m21:39:16.173322 [debug] [Thread-1 (]: SQL status: OK in 0.228 seconds
[0m21:39:16.181036 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m21:39:16.181876 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__57faac1f0047" cascade
    
[0m21:39:16.290884 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m21:39:16.294255 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: Close
[0m21:39:16.295337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1575fc1-0eee-4fd0-91e5-dc09b0d20926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11350ea80>]}
[0m21:39:16.296501 [info ] [Thread-1 (]: 8 of 10 OK created sql incremental model main.int_reunions ..................... [[32mOK[0m in 7.51s]
[0m21:39:16.297337 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_reunions
[0m21:39:16.297901 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins
[0m21:39:16.298585 [info ] [Thread-1 (]: 9 of 10 START sql incremental model main.int_scrutins .......................... [RUN]
[0m21:39:16.299235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_reunions, now model.dbt_an_data.int_scrutins)
[0m21:39:16.299725 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins
[0m21:39:16.311330 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins"
[0m21:39:16.312688 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins
[0m21:39:16.316028 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:39:16.316364 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__3ba5b0773824" cascade
    
[0m21:39:16.316636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:39:16.424659 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m21:39:16.435643 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:39:16.436633 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m21:39:16.439230 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:39:16.441576 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:39:16.442122 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m21:39:16.443193 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:39:16.443654 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:39:16.444092 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m21:39:16.821078 [debug] [Thread-1 (]: SQL status: OK in 0.376 seconds
[0m21:39:16.824250 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:39:16.825505 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    

  
[0m21:39:16.826646 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:39:16.829509 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m21:39:16.830501 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:39:16.831268 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m21:39:16.936880 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m21:39:16.939737 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:39:16.941014 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_scrutins__3ba5b0773824"
  
    as (
      

with __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
) SELECT
date_T_insert,
json_extract_string(json, '$.scrutin.uid') AS uid,
json_extract_string(json, '$.scrutin.numero') AS numero,
json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
json_extract_string(json, '$.scrutin.legislature') AS legislature,
json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
json_extract_string(json, '$.scrutin.titre') AS titre,
json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote,
date_T_insert
FROM __dbt__cte__stg_scrutins
    );
  
  
  
[0m21:39:19.517371 [debug] [Thread-1 (]: SQL status: OK in 2.574 seconds
[0m21:39:19.523295 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:39:19.523509 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m21:39:19.524143 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:39:19.524298 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:39:19.524452 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins__3ba5b0773824'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m21:39:19.526483 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:39:19.528126 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:39:19.528302 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m21:39:19.529733 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:39:19.531403 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:39:19.531591 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m21:39:19.533192 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:39:19.534549 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins"
[0m21:39:19.535263 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:39:19.535433 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

        
            delete from "an_data_pipeline"."main"."int_scrutins"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_scrutins__3ba5b0773824"
            );

        
    

    insert into "an_data_pipeline"."main"."int_scrutins" ("date_T_insert", "uid", "numero", "organeRef", "legislature", "date_scrutin", "titre", "resultat_code", "resultat_libelle", "nb_votants", "suffrages_exprimes", "seuil", "lieu_vote", "date_T_insert_1")
    (
        select "date_T_insert", "uid", "numero", "organeRef", "legislature", "date_scrutin", "titre", "resultat_code", "resultat_libelle", "nb_votants", "suffrages_exprimes", "seuil", "lieu_vote", "date_T_insert_1"
        from "an_data_pipeline"."dbt_temp"."int_scrutins__3ba5b0773824"
    )
  
[0m21:39:19.771502 [debug] [Thread-1 (]: SQL status: OK in 0.235 seconds
[0m21:39:19.776047 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m21:39:19.777129 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:39:19.777958 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m21:39:19.932171 [debug] [Thread-1 (]: SQL status: OK in 0.154 seconds
[0m21:39:19.933681 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:39:19.933857 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__3ba5b0773824" cascade
    
[0m21:39:20.152363 [debug] [Thread-1 (]: SQL status: OK in 0.218 seconds
[0m21:39:20.154052 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m21:39:20.154228 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__3ba5b0773824" cascade
    
[0m21:39:20.259272 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m21:39:20.260824 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: Close
[0m21:39:20.261835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1575fc1-0eee-4fd0-91e5-dc09b0d20926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113566330>]}
[0m21:39:20.262689 [info ] [Thread-1 (]: 9 of 10 OK created sql incremental model main.int_scrutins ..................... [[32mOK[0m in 3.96s]
[0m21:39:20.263207 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins
[0m21:39:20.263607 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins_votes
[0m21:39:20.264342 [info ] [Thread-1 (]: 10 of 10 START sql incremental model main.int_scrutins_votes ................... [RUN]
[0m21:39:20.264778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_scrutins, now model.dbt_an_data.int_scrutins_votes)
[0m21:39:20.265100 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins_votes
[0m21:39:20.293489 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins_votes"
[0m21:39:20.294501 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins_votes
[0m21:39:20.297865 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:39:20.298132 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__972cb8d85b8f" cascade
    
[0m21:39:20.298319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:39:20.404874 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m21:39:20.407928 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:39:20.408310 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m21:39:20.409693 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:39:20.411126 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:39:20.411493 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m21:39:20.412299 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:39:20.412632 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:39:20.412944 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m21:39:20.520384 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m21:39:20.523571 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:39:20.524664 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    

  
[0m21:39:20.525918 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:39:20.528578 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m21:39:20.529403 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:39:20.530140 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m21:39:20.635663 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m21:39:20.637936 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:39:20.639811 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_scrutins_votes__972cb8d85b8f"
  
    as (
      

WITH  __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
), grp AS (
      -- explode les groupes (1 par groupe)
    SELECT
        json_extract_string(j.json, '$.scrutin.uid') AS uid,
        json_extract_string(g.value, '$.organeRef') AS groupe_organe,
        g.value AS groupe_json,
        j.date_T_insert
    FROM __dbt__cte__stg_scrutins j,
    json_each(json->'scrutin'->'ventilationVotes'->'organe'->'groupes'->'groupe') g
  ),

  positions_array AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          date_T_insert,
          groupe_organe,
          'pour' AS type_vote,
          p.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'pours'->'votant') p
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          date_T_insert,
          groupe_organe,
          'contre' AS type_vote,
          c.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'contres'->'votant') c
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          date_T_insert,
          groupe_organe,
          'abstention' AS type_vote,
          a.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'abstentions'->'votant') a
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          date_T_insert,
          groupe_organe,
          'nonVotant' AS type_vote,
          n.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'nonVotants'->'votant') n
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[ARRAY]'
  ),
  positions_object AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[OBJECT]'
  ),

  clean AS (
      -- sécurise les champs (souvent string ou null)
      SELECT
          uid,
          groupe_organe,
          type_vote,
          json_extract_string(vote_json, '$.acteurRef') AS acteurRef,
          json_extract_string(vote_json, '$.mandatRef') AS mandatRef,
          json_extract_string(vote_json, '$.parDelegation') AS parDelegation,
          json_extract_string(vote_json, '$.numPlace') AS numPlace,
          json_extract_string(vote_json, '$.causePositionVote') AS cause,
          date_T_insert
      FROM positions_array
      UNION ALL
      SELECT * 
      FROM positions_object
  )

  SELECT * FROM clean
    );
  
  
  
[0m21:40:05.763155 [debug] [Thread-1 (]: SQL status: OK in 45.122 seconds
[0m21:40:05.768580 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:40:05.768816 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m21:40:05.769582 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:40:05.769754 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:40:05.769921 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins_votes__972cb8d85b8f'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m21:40:05.774907 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:40:05.776813 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:40:05.776993 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins_votes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m21:40:05.778526 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:40:05.780230 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:40:05.780428 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins_votes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m21:40:05.781988 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:40:05.783986 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins_votes"
[0m21:40:05.784886 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:40:05.785080 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

        
            delete from "an_data_pipeline"."main"."int_scrutins_votes" as DBT_INCREMENTAL_TARGET
            using "an_data_pipeline"."dbt_temp"."int_scrutins_votes__972cb8d85b8f"
            where (
                
                    "an_data_pipeline"."dbt_temp"."int_scrutins_votes__972cb8d85b8f".uid = DBT_INCREMENTAL_TARGET.uid
                    and 
                
                    "an_data_pipeline"."dbt_temp"."int_scrutins_votes__972cb8d85b8f".acteurRef = DBT_INCREMENTAL_TARGET.acteurRef
                    
                
                
            );
        
    

    insert into "an_data_pipeline"."main"."int_scrutins_votes" ("uid", "groupe_organe", "type_vote", "acteurRef", "mandatRef", "parDelegation", "numPlace", "cause", "date_T_insert")
    (
        select "uid", "groupe_organe", "type_vote", "acteurRef", "mandatRef", "parDelegation", "numPlace", "cause", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_scrutins_votes__972cb8d85b8f"
    )
  
[0m21:40:06.469712 [debug] [Thread-1 (]: SQL status: OK in 0.684 seconds
[0m21:40:06.473387 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m21:40:06.474368 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:40:06.475136 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m21:40:06.948269 [debug] [Thread-1 (]: SQL status: OK in 0.472 seconds
[0m21:40:06.956082 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:40:06.957096 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__972cb8d85b8f" cascade
    
[0m21:40:07.173765 [debug] [Thread-1 (]: SQL status: OK in 0.216 seconds
[0m21:40:07.175586 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m21:40:07.175765 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__972cb8d85b8f" cascade
    
[0m21:40:07.279597 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m21:40:07.281303 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: Close
[0m21:40:07.282603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1575fc1-0eee-4fd0-91e5-dc09b0d20926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11162f5f0>]}
[0m21:40:07.283563 [info ] [Thread-1 (]: 10 of 10 OK created sql incremental model main.int_scrutins_votes .............. [[32mOK[0m in 47.02s]
[0m21:40:07.284188 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins_votes
[0m21:40:07.294643 [debug] [MainThread]: Using duckdb connection "master"
[0m21:40:07.294935 [debug] [MainThread]: On master: BEGIN
[0m21:40:07.295149 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:40:07.296379 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:40:07.296620 [debug] [MainThread]: On master: COMMIT
[0m21:40:07.296830 [debug] [MainThread]: Using duckdb connection "master"
[0m21:40:07.297016 [debug] [MainThread]: On master: COMMIT
[0m21:40:07.297376 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:40:07.297568 [debug] [MainThread]: On master: Close
[0m21:40:07.297840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:40:07.298019 [debug] [MainThread]: Connection 'model.dbt_an_data.int_scrutins_votes' was properly closed.
[0m21:40:07.299001 [info ] [MainThread]: 
[0m21:40:07.299287 [info ] [MainThread]: Finished running 10 incremental models, 1 project hook in 0 hours 2 minutes and 25.45 seconds (145.45s).
[0m21:40:07.301021 [debug] [MainThread]: Command end result
[0m21:40:07.325048 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m21:40:07.335074 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m21:40:07.342334 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m21:40:07.342551 [info ] [MainThread]: 
[0m21:40:07.342743 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:40:07.342883 [info ] [MainThread]: 
[0m21:40:07.343766 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m21:40:07.346396 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 146.03705, "process_in_blocks": "0", "process_kernel_time": 10.482419, "process_mem_max_rss": "3088433152", "process_out_blocks": "0", "process_user_time": 33.65483}
[0m21:40:07.346914 [debug] [MainThread]: Command `dbt build` succeeded at 21:40:07.346870 after 146.04 seconds
[0m21:40:07.347319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aba1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125707d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11266fec0>]}
[0m21:40:07.347487 [debug] [MainThread]: Flushing usage events
[0m21:40:08.496646 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:12:16.119429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087f9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109753bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109753770>]}


============================== 17:12:16.124214 | 1d425064-5bbc-434f-ab38-427e24a9c630 ==============================
[0m17:12:16.124214 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:12:16.124614 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'log_format': 'default', 'static_parser': 'True', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'version_check': 'True', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'printer_width': '80', 'debug': 'False', 'empty': 'False', 'target_path': 'None', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'partial_parse': 'True'}
[0m17:12:16.351255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d425064-5bbc-434f-ab38-427e24a9c630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109af6ed0>]}
[0m17:12:16.387578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d425064-5bbc-434f-ab38-427e24a9c630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095be6c0>]}
[0m17:12:16.391086 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:12:16.539493 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m17:12:16.666744 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:12:16.667140 [debug] [MainThread]: Partial parsing: added file: dbt_an_data://models/mart/mart_check_insert_dates.sql
[0m17:12:16.796761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d425064-5bbc-434f-ab38-427e24a9c630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2eb740>]}
[0m17:12:16.937486 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m17:12:16.952806 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m17:12:17.025831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d425064-5bbc-434f-ab38-427e24a9c630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a288110>]}
[0m17:12:17.028534 [info ] [MainThread]: Found 18 models, 1 operation, 9 sources, 469 macros
[0m17:12:17.028932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d425064-5bbc-434f-ab38-427e24a9c630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2930b0>]}
[0m17:12:17.031530 [info ] [MainThread]: 
[0m17:12:17.032130 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m17:12:17.032453 [info ] [MainThread]: 
[0m17:12:17.034811 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:12:17.053818 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_an_data_pipeline'
[0m17:12:17.199742 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline"
[0m17:12:17.200990 [debug] [ThreadPool]: On list_an_data_pipeline: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"an_data_pipeline"'
    
  
  
[0m17:12:17.201240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:23.539110 [debug] [ThreadPool]: SQL status: OK in 6.337 seconds
[0m17:12:23.542952 [debug] [ThreadPool]: On list_an_data_pipeline: Close
[0m17:12:23.545095 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_an_data_pipeline, now create_an_data_pipeline_main)
[0m17:12:23.546427 [debug] [ThreadPool]: Creating schema "database: "an_data_pipeline"
schema: "main"
"
[0m17:12:23.555612 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m17:12:23.555931 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m17:12:23.556125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:23.557214 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:12:23.558099 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m17:12:23.558283 [debug] [ThreadPool]: On create_an_data_pipeline_main: BEGIN
[0m17:12:23.558858 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:23.559012 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m17:12:23.559159 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
    
        create schema if not exists "an_data_pipeline"."main"
    
[0m17:12:23.656423 [debug] [ThreadPool]: SQL status: OK in 0.097 seconds
[0m17:12:23.657048 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m17:12:23.657232 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m17:12:23.657381 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m17:12:23.752010 [debug] [ThreadPool]: SQL status: OK in 0.094 seconds
[0m17:12:23.752301 [debug] [ThreadPool]: On create_an_data_pipeline_main: Close
[0m17:12:23.753655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_an_data_pipeline_main, now list_an_data_pipeline_main)
[0m17:12:23.756583 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m17:12:23.756787 [debug] [ThreadPool]: On list_an_data_pipeline_main: BEGIN
[0m17:12:23.756943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:23.757626 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:12:23.757784 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m17:12:23.758015 [debug] [ThreadPool]: On list_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline_main"} */
select
      'an_data_pipeline' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'an_data_pipeline'
  
[0m17:12:23.772723 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m17:12:23.773725 [debug] [ThreadPool]: On list_an_data_pipeline_main: ROLLBACK
[0m17:12:23.775238 [debug] [ThreadPool]: Failed to rollback 'list_an_data_pipeline_main'
[0m17:12:23.775440 [debug] [ThreadPool]: On list_an_data_pipeline_main: Close
[0m17:12:23.776598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d425064-5bbc-434f-ab38-427e24a9c630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2ebcb0>]}
[0m17:12:23.777030 [debug] [MainThread]: Using duckdb connection "master"
[0m17:12:23.777189 [debug] [MainThread]: On master: BEGIN
[0m17:12:23.777330 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:12:23.777983 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:12:23.778167 [debug] [MainThread]: On master: COMMIT
[0m17:12:23.778323 [debug] [MainThread]: Using duckdb connection "master"
[0m17:12:23.778466 [debug] [MainThread]: On master: COMMIT
[0m17:12:23.778771 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:12:23.783029 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_an_data.dbt_an_data-on-run-start-0"
[0m17:12:23.786830 [info ] [MainThread]: 1 of 1 START hook: dbt_an_data.on-run-start.0 .................................. [RUN]
[0m17:12:23.787175 [debug] [MainThread]: Using duckdb connection "master"
[0m17:12:23.787373 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "master"} */
ATTACH '../data/database/database.duckdb' AS database (READ_ONLY)
[0m17:12:23.795895 [debug] [MainThread]: SQL status: OK in 0.008 seconds
[0m17:12:23.797375 [info ] [MainThread]: 1 of 1 OK hook: dbt_an_data.on-run-start.0 ..................................... [[32mOK[0m in 0.02s]
[0m17:12:23.797914 [info ] [MainThread]: 
[0m17:12:23.798133 [debug] [MainThread]: On master: Close
[0m17:12:23.801107 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_acteurs
[0m17:12:23.801458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_an_data_pipeline_main, now model.dbt_an_data.stg_acteurs)
[0m17:12:23.801659 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_acteurs
[0m17:12:23.803537 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_acteurs"
[0m17:12:23.804639 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_acteurs
[0m17:12:23.804866 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_agenda
[0m17:12:23.805210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_acteurs, now model.dbt_an_data.stg_agenda)
[0m17:12:23.805518 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_agenda
[0m17:12:23.807209 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_agenda"
[0m17:12:23.807886 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_agenda
[0m17:12:23.808146 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_amendements
[0m17:12:23.808492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_agenda, now model.dbt_an_data.stg_amendements)
[0m17:12:23.808733 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_amendements
[0m17:12:23.810287 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_amendements"
[0m17:12:23.810967 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_amendements
[0m17:12:23.811162 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_organes
[0m17:12:23.811377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_amendements, now model.dbt_an_data.stg_organes)
[0m17:12:23.811707 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_organes
[0m17:12:23.812936 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_organes"
[0m17:12:23.813366 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_organes
[0m17:12:23.813552 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_pays
[0m17:12:23.813849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_organes, now model.dbt_an_data.stg_pays)
[0m17:12:23.814038 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_pays
[0m17:12:23.815191 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_pays"
[0m17:12:23.815665 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_pays
[0m17:12:23.815872 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_reunions
[0m17:12:23.816081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_pays, now model.dbt_an_data.stg_reunions)
[0m17:12:23.816402 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_reunions
[0m17:12:23.817846 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_reunions"
[0m17:12:23.818377 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_reunions
[0m17:12:23.818635 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_scrutins
[0m17:12:23.818931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_reunions, now model.dbt_an_data.stg_scrutins)
[0m17:12:23.820049 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_scrutins
[0m17:12:23.821579 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_scrutins"
[0m17:12:23.822180 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_scrutins
[0m17:12:23.822414 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_acteurs
[0m17:12:23.822769 [info ] [Thread-1 (]: 1 of 11 START sql incremental model main.int_acteurs ........................... [RUN]
[0m17:12:23.879733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_scrutins, now model.dbt_an_data.int_acteurs)
[0m17:12:23.880091 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_acteurs
[0m17:12:23.885010 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_acteurs"
[0m17:12:23.885539 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_acteurs
[0m17:12:23.889315 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m17:12:23.889531 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__e1675c0a7e23" cascade
    
[0m17:12:23.889709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:23.988463 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m17:12:24.010455 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m17:12:24.010789 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m17:12:24.011892 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:24.012745 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m17:12:24.012955 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m17:12:24.013534 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:24.013713 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m17:12:24.013887 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m17:12:24.110265 [debug] [Thread-1 (]: SQL status: OK in 0.096 seconds
[0m17:12:24.110984 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m17:12:24.111186 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    

  
[0m17:12:24.111415 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:24.111981 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m17:12:24.112165 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m17:12:24.112326 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m17:12:24.205654 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m17:12:24.212165 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m17:12:24.212499 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_acteurs__e1675c0a7e23"
  
    as (
      

with __dbt__cte__stg_acteurs as (
SELECT * 
FROM "database"."stg"."raw_acteurs"
) SELECT 
json_extract_string(json, '$.acteur.uid.#text') as uid,
json_extract_string(json, '$.acteur.etatCivil.ident.civ') as civ,
json_extract_string(json, '$.acteur.etatCivil.ident.prenom') as prenom,
json_extract_string(json, '$.acteur.etatCivil.ident.nom') as nom,
json_extract_string(json, '$.acteur.etatCivil.ident.trigramme') as trigramme,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.dateNais') as dateNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.villeNais') as villeNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.depNais') as depNais,
json_extract_string(json, '$.acteur.etatCivil.infoNaissance.paysNais') as paysNais,
json_extract_string(json, '$.acteur.etatCivil.dateDeces') as dateDeces,
json_extract_string(json, '$.acteur.profession.libelleCourant') as libelleCourant,
json_extract_string(json, '$.acteur.profession.socProcINSEE.catSocPro') as catSocPro,
json_extract_string(json, '$.acteur.profession.socProcINSEE.famSocPro') as famSocPro,
json_extract_string(json, '$.acteur.uri_hatvp') as uri_hatvp,
date_T_insert
FROM __dbt__cte__stg_acteurs
    );
  
  
  
[0m17:12:25.145109 [debug] [Thread-1 (]: SQL status: OK in 0.932 seconds
[0m17:12:25.149099 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m17:12:25.149325 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m17:12:25.149949 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:25.150129 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m17:12:25.150307 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs__e1675c0a7e23'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m17:12:25.155309 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:12:25.159134 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m17:12:25.159356 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m17:12:25.161164 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:25.164612 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m17:12:25.164822 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m17:12:25.166528 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:25.167408 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m17:12:25.167598 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */
SELECT version()
[0m17:12:25.167924 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:25.174671 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_acteurs"
[0m17:12:25.175384 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m17:12:25.175593 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

        
            delete from "an_data_pipeline"."main"."int_acteurs"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_acteurs__e1675c0a7e23"
            );

        
    

    insert into "an_data_pipeline"."main"."int_acteurs" ("uid", "civ", "prenom", "nom", "trigramme", "dateNais", "villeNais", "depNais", "paysNais", "dateDeces", "libelleCourant", "catSocPro", "famSocPro", "uri_hatvp", "date_T_insert")
    (
        select "uid", "civ", "prenom", "nom", "trigramme", "dateNais", "villeNais", "depNais", "paysNais", "dateDeces", "libelleCourant", "catSocPro", "famSocPro", "uri_hatvp", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_acteurs__e1675c0a7e23"
    )
  
[0m17:12:25.603575 [debug] [Thread-1 (]: SQL status: OK in 0.427 seconds
[0m17:12:25.619091 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m17:12:25.619656 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m17:12:25.620084 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m17:12:25.738719 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m17:12:25.741725 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m17:12:25.742065 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__e1675c0a7e23" cascade
    
[0m17:12:25.947377 [debug] [Thread-1 (]: SQL status: OK in 0.205 seconds
[0m17:12:25.949085 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m17:12:25.949293 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__e1675c0a7e23" cascade
    
[0m17:12:26.046206 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m17:12:26.047720 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: Close
[0m17:12:26.048956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d425064-5bbc-434f-ab38-427e24a9c630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108719400>]}
[0m17:12:26.049380 [info ] [Thread-1 (]: 1 of 11 OK created sql incremental model main.int_acteurs ...................... [[32mOK[0m in 2.22s]
[0m17:12:26.049714 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_acteurs
[0m17:12:26.049947 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_mandats
[0m17:12:26.050231 [info ] [Thread-1 (]: 2 of 11 START sql incremental model main.int_mandats ........................... [RUN]
[0m17:12:26.050482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_acteurs, now model.dbt_an_data.int_mandats)
[0m17:12:26.050677 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_mandats
[0m17:12:26.055094 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_mandats"
[0m17:12:26.055715 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_mandats
[0m17:12:26.058184 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m17:12:26.058430 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__4f183fee98f6" cascade
    
[0m17:12:26.058612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:26.157657 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m17:12:26.159883 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m17:12:26.160222 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m17:12:26.161515 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:26.162588 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m17:12:26.162886 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m17:12:26.163606 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:26.163865 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m17:12:26.164124 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m17:12:26.263348 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m17:12:26.264943 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m17:12:26.265472 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    

  
[0m17:12:26.266038 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:26.267569 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m17:12:26.268012 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m17:12:26.268402 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m17:12:26.365258 [debug] [Thread-1 (]: SQL status: OK in 0.096 seconds
[0m17:12:26.367214 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m17:12:26.367904 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_mandats__4f183fee98f6"
  
    as (
      

with __dbt__cte__stg_acteurs as (
SELECT * 
FROM "database"."stg"."raw_acteurs"
) SELECT 
json_extract_string(mandat.value, '$.uid') as uid,
json_extract_string(mandat.value, '$.acteurRef') as acteurRef,
json_extract_string(mandat.value, '$.legislature') as legislature,
json_extract_string(mandat.value, '$.typeOrgane') as typeOrgane,
json_extract_string(mandat.value, '$.dateDebut') as dateDebut,
json_extract_string(mandat.value, '$.dateFin') as dateFin,
json_extract_string(mandat.value, '$.preseance') as preseance,
json_extract_string(mandat.value, '$.nominPrincipale') as nominPrincipale,
json_extract_string(mandat.value, '$.infosQualite.codeQualite') as codeQualite,
json_extract_string(mandat.value, '$.organes.organeRef') as organeRef,
date_T_insert
FROM __dbt__cte__stg_acteurs act, json_each(json->'acteur'->'mandats'->'mandat') mandat
    );
  
  
  
[0m17:12:27.330123 [debug] [Thread-1 (]: SQL status: OK in 0.959 seconds
[0m17:12:27.336682 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m17:12:27.337068 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m17:12:27.338395 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:27.338676 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m17:12:27.339006 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats__4f183fee98f6'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m17:12:27.342821 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:27.344943 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m17:12:27.345200 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m17:12:27.347337 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:27.349438 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m17:12:27.349652 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m17:12:27.351677 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:27.355831 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_mandats"
[0m17:12:27.356496 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m17:12:27.356703 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

        
            delete from "an_data_pipeline"."main"."int_mandats"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_mandats__4f183fee98f6"
            );

        
    

    insert into "an_data_pipeline"."main"."int_mandats" ("uid", "acteurRef", "legislature", "typeOrgane", "dateDebut", "dateFin", "preseance", "nominPrincipale", "codeQualite", "organeRef", "date_T_insert")
    (
        select "uid", "acteurRef", "legislature", "typeOrgane", "dateDebut", "dateFin", "preseance", "nominPrincipale", "codeQualite", "organeRef", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_mandats__4f183fee98f6"
    )
  
[0m17:12:27.626813 [debug] [Thread-1 (]: SQL status: OK in 0.270 seconds
[0m17:12:27.628239 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m17:12:27.628495 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m17:12:27.628687 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m17:12:27.908174 [debug] [Thread-1 (]: SQL status: OK in 0.279 seconds
[0m17:12:27.912779 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m17:12:27.913544 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__4f183fee98f6" cascade
    
[0m17:12:28.127844 [debug] [Thread-1 (]: SQL status: OK in 0.214 seconds
[0m17:12:28.135599 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m17:12:28.135975 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__4f183fee98f6" cascade
    
[0m17:12:28.243739 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m17:12:28.245222 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: Close
[0m17:12:28.247065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d425064-5bbc-434f-ab38-427e24a9c630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10473cad0>]}
[0m17:12:28.247900 [info ] [Thread-1 (]: 2 of 11 OK created sql incremental model main.int_mandats ...................... [[32mOK[0m in 2.20s]
[0m17:12:28.248639 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_mandats
[0m17:12:28.248928 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_agenda
[0m17:12:28.249505 [info ] [Thread-1 (]: 3 of 11 START sql incremental model main.int_agenda ............................ [RUN]
[0m17:12:28.250958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_mandats, now model.dbt_an_data.int_agenda)
[0m17:12:28.252098 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_agenda
[0m17:12:28.256861 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_agenda"
[0m17:12:28.258406 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_agenda
[0m17:12:28.264270 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m17:12:28.265239 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__b875cce6989b" cascade
    
[0m17:12:28.265818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:28.364350 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m17:12:28.366073 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m17:12:28.366323 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m17:12:28.367673 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:28.368497 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m17:12:28.368713 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m17:12:28.369295 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:28.369530 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m17:12:28.369728 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m17:12:28.466216 [debug] [Thread-1 (]: SQL status: OK in 0.096 seconds
[0m17:12:28.467090 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m17:12:28.467446 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    

  
[0m17:12:28.467808 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:28.468614 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m17:12:28.468874 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m17:12:28.469094 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m17:12:28.562068 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m17:12:28.563640 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m17:12:28.564893 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_agenda__b875cce6989b"
  
    as (
      

with __dbt__cte__stg_agenda as (
SELECT * 
FROM "database"."stg"."raw_agenda"
) SELECT * 
FROM __dbt__cte__stg_agenda
    );
  
  
  
[0m17:12:28.885783 [debug] [Thread-1 (]: SQL status: OK in 0.320 seconds
[0m17:12:28.889963 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m17:12:28.890772 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m17:12:28.892415 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:28.892937 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m17:12:28.893470 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda__b875cce6989b'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m17:12:28.898586 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:12:28.903174 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m17:12:28.903670 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m17:12:28.907742 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:12:28.910652 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m17:12:28.911069 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m17:12:28.914466 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:28.917041 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_agenda"
[0m17:12:28.917810 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m17:12:28.918156 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

        
            delete from "an_data_pipeline"."main"."int_agenda" as DBT_INCREMENTAL_TARGET
            using "an_data_pipeline"."dbt_temp"."int_agenda__b875cce6989b"
            where (
                
                    "an_data_pipeline"."dbt_temp"."int_agenda__b875cce6989b".Date = DBT_INCREMENTAL_TARGET.Date
                    and 
                
                    "an_data_pipeline"."dbt_temp"."int_agenda__b875cce6989b".Heure = DBT_INCREMENTAL_TARGET.Heure
                    
                
                
            );
        
    

    insert into "an_data_pipeline"."main"."int_agenda" ("Date", "Heure", "Ordre(s) du jour", "filename", "date_T_insert")
    (
        select "Date", "Heure", "Ordre(s) du jour", "filename", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_agenda__b875cce6989b"
    )
  
[0m17:12:29.167003 [debug] [Thread-1 (]: SQL status: OK in 0.248 seconds
[0m17:12:29.169348 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m17:12:29.169937 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m17:12:29.170418 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m17:12:29.277290 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m17:12:29.278662 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m17:12:29.278877 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__b875cce6989b" cascade
    
[0m17:12:29.496355 [debug] [Thread-1 (]: SQL status: OK in 0.217 seconds
[0m17:12:29.498789 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m17:12:29.498990 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__b875cce6989b" cascade
    
[0m17:12:29.596035 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m17:12:29.597324 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: Close
[0m17:12:29.597810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d425064-5bbc-434f-ab38-427e24a9c630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10873e330>]}
[0m17:12:29.598294 [info ] [Thread-1 (]: 3 of 11 OK created sql incremental model main.int_agenda ....................... [[32mOK[0m in 1.35s]
[0m17:12:29.598701 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_agenda
[0m17:12:29.599213 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements
[0m17:12:29.599665 [info ] [Thread-1 (]: 4 of 11 START sql incremental model main.int_amendements ....................... [RUN]
[0m17:12:29.600067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_agenda, now model.dbt_an_data.int_amendements)
[0m17:12:29.600353 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements
[0m17:12:29.618773 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements"
[0m17:12:29.619491 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements
[0m17:12:29.623597 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m17:12:29.623897 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__17df06b89432" cascade
    
[0m17:12:29.624290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:29.722249 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m17:12:29.723915 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m17:12:29.724167 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m17:12:29.725191 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:29.726029 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m17:12:29.726254 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m17:12:29.726818 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:29.727017 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m17:12:29.727216 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m17:12:29.844391 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m17:12:29.847152 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m17:12:29.847935 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    

  
[0m17:12:29.848472 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:29.850276 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m17:12:29.850841 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m17:12:29.851541 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m17:12:29.971324 [debug] [Thread-1 (]: SQL status: OK in 0.119 seconds
[0m17:12:29.971914 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m17:12:29.972189 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_amendements__17df06b89432"
  
    as (
      

with __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
) SELECT
json_extract_string(json, '$.amendement.uid') AS uid,
json_extract_string(json, '$.amendement.chronotag') AS chronotag,
json_extract_string(json, '$.amendement.examenRef') AS examenRef,
json_extract_string(json, '$.amendement.amendementParentRef') AS amendementParentRef,
json_extract_string(json, '$.amendement.signataires.auteur.typeAuteur') AS typeAuteur,
json_extract_string(json, '$.amendement.signataires.auteur.acteurRef') AS refAuteur,
json_extract_string(json, '$.amendement.signataires.auteur.groupePolitique') AS groupePolitiqueAuteur,
json_extract_string(json, '$.amendement.cycleDeVie.dateDepot') AS dateDepot,
json_extract_string(json, '$.amendement.cycleDeVie.datePublication') AS datePublication,
json_extract_string(json, '$.amendement.cycleDeVie.soumisArticle40') AS soumisArticle40,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.code') AS codeEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.libelle') AS libelleEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.code') AS codeSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
json_extract_string(json, '$.amendement.cycleDeVie.dateSort') AS dateSort,
json_extract_string(json, '$.amendement.cycleDeVie.sort') AS sort,
split_part(replace(filename, '.json', ''), '/', -1) AS id_amendement,
split_part(replace(filename, '.json', ''), '/', -2) AS id_texte,
split_part(replace(filename, '.json', ''), '/', -3) AS id_dossier_legislatif,
id_texte[:4] AS nature_texte,
id_texte[5:6] AS source_texte,
regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 1) AS prefix_bibard,
regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 2) AS numero_bibard,
regexp_extract(id_amendement, '(SEA|PO\d*)', 1) AS code_organe,
regexp_extract(id_amendement, '(P)(\d*)(D)', 2) AS numero_partie,
regexp_extract(id_amendement, '(D)(\d*)(N)', 2) AS numero_deliberation,
regexp_extract(id_amendement, '(D)(\d*)(N)(\d*)', 4) AS numero_court,
date_T_insert
from __dbt__cte__stg_amendements
    );
  
  
  
[0m17:12:43.028699 [debug] [Thread-1 (]: SQL status: OK in 13.050 seconds
[0m17:12:43.040709 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m17:12:43.040977 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m17:12:43.054347 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:12:43.054559 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m17:12:43.054736 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements__17df06b89432'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m17:12:43.070627 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m17:12:43.073882 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m17:12:43.074121 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m17:12:43.076121 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:43.078043 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m17:12:43.078264 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m17:12:43.080353 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:43.082874 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements"
[0m17:12:43.083499 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m17:12:43.083715 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

        
            delete from "an_data_pipeline"."main"."int_amendements"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_amendements__17df06b89432"
            );

        
    

    insert into "an_data_pipeline"."main"."int_amendements" ("uid", "chronotag", "examenRef", "amendementParentRef", "typeAuteur", "refAuteur", "groupePolitiqueAuteur", "dateDepot", "datePublication", "soumisArticle40", "codeEtat", "libelleEtat", "codeSousEtat", "libelleSousEtat", "libelleSousEtat_1", "dateSort", "sort", "id_amendement", "id_texte", "id_dossier_legislatif", "nature_texte", "source_texte", "prefix_bibard", "numero_bibard", "code_organe", "numero_partie", "numero_deliberation", "numero_court", "date_T_insert")
    (
        select "uid", "chronotag", "examenRef", "amendementParentRef", "typeAuteur", "refAuteur", "groupePolitiqueAuteur", "dateDepot", "datePublication", "soumisArticle40", "codeEtat", "libelleEtat", "codeSousEtat", "libelleSousEtat", "libelleSousEtat_1", "dateSort", "sort", "id_amendement", "id_texte", "id_dossier_legislatif", "nature_texte", "source_texte", "prefix_bibard", "numero_bibard", "code_organe", "numero_partie", "numero_deliberation", "numero_court", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_amendements__17df06b89432"
    )
  
[0m17:12:44.143850 [debug] [Thread-1 (]: SQL status: OK in 1.060 seconds
[0m17:12:44.146933 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m17:12:44.147352 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m17:12:44.147682 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m17:12:45.156160 [debug] [Thread-1 (]: SQL status: OK in 1.008 seconds
[0m17:12:45.162307 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m17:12:45.163011 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__17df06b89432" cascade
    
[0m17:12:45.448018 [debug] [Thread-1 (]: SQL status: OK in 0.284 seconds
[0m17:12:45.450754 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m17:12:45.450971 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__17df06b89432" cascade
    
[0m17:12:45.550196 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m17:12:45.551760 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: Close
[0m17:12:45.557708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d425064-5bbc-434f-ab38-427e24a9c630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109de7b90>]}
[0m17:12:45.558619 [info ] [Thread-1 (]: 4 of 11 OK created sql incremental model main.int_amendements .................. [[32mOK[0m in 15.95s]
[0m17:12:45.559205 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements
[0m17:12:45.559637 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements_cosignataires
[0m17:12:45.560306 [info ] [Thread-1 (]: 5 of 11 START sql incremental model main.int_amendements_cosignataires ......... [RUN]
[0m17:12:45.560715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements, now model.dbt_an_data.int_amendements_cosignataires)
[0m17:12:45.561025 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements_cosignataires
[0m17:12:45.570223 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements_cosignataires"
[0m17:12:45.571021 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements_cosignataires
[0m17:12:45.573929 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m17:12:45.574290 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__c9a751eed445" cascade
    
[0m17:12:45.574587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:45.672890 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m17:12:45.676233 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m17:12:45.676515 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m17:12:45.677582 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:45.678427 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m17:12:45.678650 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m17:12:45.679167 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:45.679355 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m17:12:45.679541 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m17:12:45.776238 [debug] [Thread-1 (]: SQL status: OK in 0.096 seconds
[0m17:12:45.777185 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m17:12:45.777473 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    

  
[0m17:12:45.777784 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:45.778541 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m17:12:45.778793 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m17:12:45.779019 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m17:12:45.872939 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m17:12:45.873999 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m17:12:45.874565 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__c9a751eed445"
  
    as (
      

WITH  __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
), cosignataires_arr AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef[*]') AS acteurRef,
    date_T_insert
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') == 'ARRAY' AND acteurRef IS NOT NULL
), cosignataires_str AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef') AS acteurRef,
    date_T_insert
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') <> 'ARRAY' AND acteurRef IS NOT NULL
)
SELECT 
  uid, 
  unnest(acteurRef) as acteurRef,
  date_T_insert
FROM cosignataires_arr
UNION ALL
SELECT 
  uid, 
  acteurRef,
  date_T_insert
FROM cosignataires_str
    );
  
  
  
[0m17:12:49.992129 [debug] [Thread-1 (]: SQL status: OK in 4.117 seconds
[0m17:12:49.997447 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m17:12:49.997668 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m17:12:49.998518 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:49.998760 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m17:12:49.998971 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires__c9a751eed445'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m17:12:50.001446 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:50.003014 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m17:12:50.003228 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m17:12:50.005033 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:50.006580 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m17:12:50.006789 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m17:12:50.008442 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:50.009705 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements_cosignataires"
[0m17:12:50.010291 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m17:12:50.010488 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

        
            delete from "an_data_pipeline"."main"."int_amendements_cosignataires" as DBT_INCREMENTAL_TARGET
            using "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__c9a751eed445"
            where (
                
                    "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__c9a751eed445".uid = DBT_INCREMENTAL_TARGET.uid
                    and 
                
                    "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__c9a751eed445".acteurRef = DBT_INCREMENTAL_TARGET.acteurRef
                    
                
                
            );
        
    

    insert into "an_data_pipeline"."main"."int_amendements_cosignataires" ("uid", "acteurRef", "date_T_insert")
    (
        select "uid", "acteurRef", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__c9a751eed445"
    )
  
[0m17:12:50.895659 [debug] [Thread-1 (]: SQL status: OK in 0.885 seconds
[0m17:12:50.898400 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m17:12:50.899168 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m17:12:50.899710 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m17:12:51.445014 [debug] [Thread-1 (]: SQL status: OK in 0.545 seconds
[0m17:12:51.449728 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m17:12:51.450799 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__c9a751eed445" cascade
    
[0m17:12:51.655679 [debug] [Thread-1 (]: SQL status: OK in 0.204 seconds
[0m17:12:51.658135 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m17:12:51.658440 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__c9a751eed445" cascade
    
[0m17:12:51.757357 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m17:12:51.759321 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: Close
[0m17:12:51.764959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d425064-5bbc-434f-ab38-427e24a9c630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d22ed50>]}
[0m17:12:51.766489 [info ] [Thread-1 (]: 5 of 11 OK created sql incremental model main.int_amendements_cosignataires .... [[32mOK[0m in 6.20s]
[0m17:12:51.767342 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements_cosignataires
[0m17:12:51.767882 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_organes
[0m17:12:51.768716 [info ] [Thread-1 (]: 6 of 11 START sql incremental model main.int_organes ........................... [RUN]
[0m17:12:51.769874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements_cosignataires, now model.dbt_an_data.int_organes)
[0m17:12:51.770420 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_organes
[0m17:12:51.803103 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_organes"
[0m17:12:51.804346 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_organes
[0m17:12:51.822897 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m17:12:51.823595 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__5062bba30bea" cascade
    
[0m17:12:51.823963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:51.928038 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m17:12:51.932543 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m17:12:51.933120 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m17:12:51.934838 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:51.936163 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m17:12:51.936546 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m17:12:51.937396 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:51.937639 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m17:12:51.937835 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m17:12:52.035834 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m17:12:52.036871 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m17:12:52.037189 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    

  
[0m17:12:52.037526 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:52.038343 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m17:12:52.038620 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m17:12:52.038872 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m17:12:52.133136 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m17:12:52.134657 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m17:12:52.135342 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_organes__5062bba30bea"
  
    as (
      

with __dbt__cte__stg_organes as (
SELECT * 
FROM "database"."stg"."raw_organes"
) SELECT 
json_extract_string(json, '$.organe.uid') as uid,
json_extract_string(json, '$.organe.codeType') as codeType,
json_extract_string(json, '$.organe.libelle') as libelle,
json_extract_string(json, '$.organe.libelleEdition') as libelleEdition,
json_extract_string(json, '$.organe.libelleAbrege') as libelleAbrege,
json_extract_string(json, '$.organe.libelleAbrev') as libelleAbrev,
json_extract_string(json, '$.organe.viMoDe.dateDebut') as dateDebut,
json_extract_string(json, '$.organe.viMoDe.dateAgrement') as dateAgrement,
json_extract_string(json, '$.organe.viMoDe.dateFin') as dateFin,
json_extract_string(json, '$.organe.organeParent') as organeParent,
json_extract_string(json, '$.organe.chambre') as chambre,
json_extract_string(json, '$.organe.regime') as regime,
json_extract_string(json, '$.organe.legislature') as legislature,
date_T_insert
FROM __dbt__cte__stg_organes
    );
  
  
  
[0m17:12:52.654163 [debug] [Thread-1 (]: SQL status: OK in 0.518 seconds
[0m17:12:52.658600 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m17:12:52.659068 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m17:12:52.661655 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:52.662219 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m17:12:52.662654 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes__5062bba30bea'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m17:12:52.669797 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:12:52.677546 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m17:12:52.678302 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m17:12:52.681305 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:52.684484 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m17:12:52.684801 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m17:12:52.688232 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:52.690018 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_organes"
[0m17:12:52.691032 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m17:12:52.692108 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

        
            delete from "an_data_pipeline"."main"."int_organes"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_organes__5062bba30bea"
            );

        
    

    insert into "an_data_pipeline"."main"."int_organes" ("uid", "codeType", "libelle", "libelleEdition", "libelleAbrege", "libelleAbrev", "dateDebut", "dateAgrement", "dateFin", "organeParent", "chambre", "regime", "legislature", "date_T_insert")
    (
        select "uid", "codeType", "libelle", "libelleEdition", "libelleAbrege", "libelleAbrev", "dateDebut", "dateAgrement", "dateFin", "organeParent", "chambre", "regime", "legislature", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_organes__5062bba30bea"
    )
  
[0m17:12:53.071123 [debug] [Thread-1 (]: SQL status: OK in 0.378 seconds
[0m17:12:53.072668 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m17:12:53.073064 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m17:12:53.073378 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m17:12:53.240734 [debug] [Thread-1 (]: SQL status: OK in 0.167 seconds
[0m17:12:53.245659 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m17:12:53.246364 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__5062bba30bea" cascade
    
[0m17:12:53.451606 [debug] [Thread-1 (]: SQL status: OK in 0.205 seconds
[0m17:12:53.453350 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m17:12:53.453567 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__5062bba30bea" cascade
    
[0m17:12:53.554045 [debug] [Thread-1 (]: SQL status: OK in 0.100 seconds
[0m17:12:53.555581 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: Close
[0m17:12:53.556185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d425064-5bbc-434f-ab38-427e24a9c630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d24d970>]}
[0m17:12:53.556811 [info ] [Thread-1 (]: 6 of 11 OK created sql incremental model main.int_organes ...................... [[32mOK[0m in 1.79s]
[0m17:12:53.557348 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_organes
[0m17:12:53.557758 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_pays
[0m17:12:53.558318 [info ] [Thread-1 (]: 7 of 11 START sql incremental model main.int_pays .............................. [RUN]
[0m17:12:53.558877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_organes, now model.dbt_an_data.int_pays)
[0m17:12:53.559317 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_pays
[0m17:12:53.566977 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_pays"
[0m17:12:53.567790 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_pays
[0m17:12:53.571378 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m17:12:53.571797 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__b777d76be611" cascade
    
[0m17:12:53.572073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:53.671518 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m17:12:53.674919 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m17:12:53.675477 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m17:12:53.677540 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:53.679082 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m17:12:53.679496 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m17:12:53.680506 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:53.680864 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m17:12:53.681219 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m17:12:53.781065 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m17:12:53.783441 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m17:12:53.784333 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    

  
[0m17:12:53.785475 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:53.787421 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m17:12:53.787972 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m17:12:53.788471 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m17:12:53.883735 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m17:12:53.885740 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m17:12:53.886981 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_pays__b777d76be611"
  
    as (
      

with __dbt__cte__stg_pays as (
SELECT * 
FROM "database"."stg"."raw_pays"
) SELECT
json_extract_string(json, '$.pays.uid') as uid,
json_extract_string(json, '$.pays.code_insee') as code_insee,
json_extract_string(json, '$.pays.libelleInsee') as libelleInsee,
json_extract_string(json, '$.pays.nomCourant') as nomCourant,
json_extract_string(json, '$.pays.code_iso2A') as code_iso2A,
json_extract_string(json, '$.pays.code_iso3A') as code_iso3A,
json_extract_string(json, '$.pays.code_iso3N') as code_iso3N,
json_extract_string(json, '$.pays.libelleIso') as libelleIso,
json_extract_string(json, '$.pays.libelleANCourt') as libelleANCourt,
json_extract_string(json, '$.pays.libelleANLong') as libelleANLong,
json_extract_string(json, '$.pays.sourceJuridique') as sourceJuridique,
json_extract_string(json, '$.pays.activ') as activ,
date_T_insert
FROM __dbt__cte__stg_pays
    );
  
  
  
[0m17:12:54.231602 [debug] [Thread-1 (]: SQL status: OK in 0.344 seconds
[0m17:12:54.235460 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m17:12:54.235957 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m17:12:54.237288 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:54.237715 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m17:12:54.238145 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays__b777d76be611'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m17:12:54.242788 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:12:54.246213 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m17:12:54.246631 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m17:12:54.250109 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:54.253177 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m17:12:54.253583 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m17:12:54.256641 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:54.258484 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_pays"
[0m17:12:54.259248 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m17:12:54.259596 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

        
            delete from "an_data_pipeline"."main"."int_pays"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_pays__b777d76be611"
            );

        
    

    insert into "an_data_pipeline"."main"."int_pays" ("uid", "code_insee", "libelleInsee", "nomCourant", "code_iso2A", "code_iso3A", "code_iso3N", "libelleIso", "libelleANCourt", "libelleANLong", "sourceJuridique", "activ", "date_T_insert")
    (
        select "uid", "code_insee", "libelleInsee", "nomCourant", "code_iso2A", "code_iso3A", "code_iso3N", "libelleIso", "libelleANCourt", "libelleANLong", "sourceJuridique", "activ", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_pays__b777d76be611"
    )
  
[0m17:12:54.525465 [debug] [Thread-1 (]: SQL status: OK in 0.265 seconds
[0m17:12:54.531261 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m17:12:54.531927 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m17:12:54.532439 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m17:12:54.643331 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m17:12:54.647401 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m17:12:54.648332 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__b777d76be611" cascade
    
[0m17:12:54.855418 [debug] [Thread-1 (]: SQL status: OK in 0.207 seconds
[0m17:12:54.857182 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m17:12:54.857391 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__b777d76be611" cascade
    
[0m17:12:54.962694 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m17:12:54.964255 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: Close
[0m17:12:54.964923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d425064-5bbc-434f-ab38-427e24a9c630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d28a1e0>]}
[0m17:12:54.965533 [info ] [Thread-1 (]: 7 of 11 OK created sql incremental model main.int_pays ......................... [[32mOK[0m in 1.41s]
[0m17:12:54.966028 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_pays
[0m17:12:54.966367 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_reunions
[0m17:12:54.966878 [info ] [Thread-1 (]: 8 of 11 START sql incremental model main.int_reunions .......................... [RUN]
[0m17:12:54.967362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_pays, now model.dbt_an_data.int_reunions)
[0m17:12:54.967713 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_reunions
[0m17:12:54.977297 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_reunions"
[0m17:12:54.977996 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_reunions
[0m17:12:54.981233 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m17:12:54.981602 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__40f0f86f8e56" cascade
    
[0m17:12:54.981897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:55.082412 [debug] [Thread-1 (]: SQL status: OK in 0.100 seconds
[0m17:12:55.085732 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m17:12:55.086243 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m17:12:55.088166 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:55.089784 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m17:12:55.090174 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m17:12:55.091172 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:55.091586 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m17:12:55.091958 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m17:12:55.192431 [debug] [Thread-1 (]: SQL status: OK in 0.100 seconds
[0m17:12:55.194794 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m17:12:55.195427 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    

  
[0m17:12:55.196182 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:55.198477 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m17:12:55.199031 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m17:12:55.199513 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m17:12:55.295392 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m17:12:55.296821 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m17:12:55.297596 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_reunions__40f0f86f8e56"
  
    as (
      

with __dbt__cte__stg_reunions as (
SELECT * 
FROM "database"."stg"."raw_reunions"
) SELECT
json_extract_string(json, '$.reunion.uid') AS uid,
json_extract_string(json, '$.reunion.timeStampDebut') AS timeStampDebut,
json_extract_string(json, '$.reunion.lieu.lieuRef') AS lieuRef,
json_extract_string(json, '$.reunion.lieu.libelleLong') AS lieuLibelle,
json_extract_string(json, '$.reunion.cycleDeVie.etat') AS cycleDeVieEtat,
json_extract_string(json, '$.reunion.demandeur') AS demandeur,
json_extract_string(json, '$.reunion.organeReuniRef') AS organeReuniRef,
json_extract_string(json, '$.reunion.visioConference') AS visioConference,
json_extract_string(json, '$.reunion.sessionRef') AS sessionRef,
json_extract_string(json, '$.reunion.ouverturePresse') AS ouverturePresse,
json_extract_string(json, '$.reunion.captationVideo') AS captationVideo,
json_extract_string(json, '$.reunion.ODJ.convocationODJ.item') AS convocationODJ,
json_extract_string(json, '$.reunion.ODJ.resumeODJ.item') AS resumeODJ,
json_extract_string(json, '$.reunion.compteRenduRef') AS compteRenduRef,
json_extract_string(json, '$.reunion.identifiants.numSeanceJO') AS numSeanceJO,
json_extract_string(json, '$.reunion.identifiants.idJO') AS idJO,
json_extract_string(json, '$.reunion.identifiants.quantieme') AS quantieme,
json_extract_string(json, '$.reunion.identifiants.DataSeance') AS DataSeance,
date_T_insert
FROM __dbt__cte__stg_reunions
    );
  
  
  
[0m17:12:56.218832 [debug] [Thread-1 (]: SQL status: OK in 0.921 seconds
[0m17:12:56.220486 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m17:12:56.220691 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m17:12:56.221252 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:56.221428 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m17:12:56.221610 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions__40f0f86f8e56'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m17:12:56.223476 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:56.225012 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m17:12:56.225211 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m17:12:56.226843 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:56.228341 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m17:12:56.228530 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m17:12:56.230116 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:56.231273 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_reunions"
[0m17:12:56.231692 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m17:12:56.231889 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

        
            delete from "an_data_pipeline"."main"."int_reunions"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_reunions__40f0f86f8e56"
            );

        
    

    insert into "an_data_pipeline"."main"."int_reunions" ("uid", "timeStampDebut", "lieuRef", "lieuLibelle", "cycleDeVieEtat", "demandeur", "organeReuniRef", "visioConference", "sessionRef", "ouverturePresse", "captationVideo", "convocationODJ", "resumeODJ", "compteRenduRef", "numSeanceJO", "idJO", "quantieme", "DataSeance", "date_T_insert")
    (
        select "uid", "timeStampDebut", "lieuRef", "lieuLibelle", "cycleDeVieEtat", "demandeur", "organeReuniRef", "visioConference", "sessionRef", "ouverturePresse", "captationVideo", "convocationODJ", "resumeODJ", "compteRenduRef", "numSeanceJO", "idJO", "quantieme", "DataSeance", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_reunions__40f0f86f8e56"
    )
  
[0m17:12:56.489514 [debug] [Thread-1 (]: SQL status: OK in 0.257 seconds
[0m17:12:56.491578 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m17:12:56.492171 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m17:12:56.492667 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m17:12:56.678448 [debug] [Thread-1 (]: SQL status: OK in 0.185 seconds
[0m17:12:56.681437 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m17:12:56.681803 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__40f0f86f8e56" cascade
    
[0m17:12:56.898564 [debug] [Thread-1 (]: SQL status: OK in 0.216 seconds
[0m17:12:56.901609 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m17:12:56.901825 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__40f0f86f8e56" cascade
    
[0m17:12:57.002374 [debug] [Thread-1 (]: SQL status: OK in 0.100 seconds
[0m17:12:57.003909 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: Close
[0m17:12:57.004565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d425064-5bbc-434f-ab38-427e24a9c630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d283d70>]}
[0m17:12:57.005213 [info ] [Thread-1 (]: 8 of 11 OK created sql incremental model main.int_reunions ..................... [[32mOK[0m in 2.04s]
[0m17:12:57.005763 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_reunions
[0m17:12:57.006169 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins
[0m17:12:57.006643 [info ] [Thread-1 (]: 9 of 11 START sql incremental model main.int_scrutins .......................... [RUN]
[0m17:12:57.007051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_reunions, now model.dbt_an_data.int_scrutins)
[0m17:12:57.007375 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins
[0m17:12:57.015186 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins"
[0m17:12:57.016074 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins
[0m17:12:57.019221 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m17:12:57.019557 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__4920a893f66b" cascade
    
[0m17:12:57.019849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:57.120069 [debug] [Thread-1 (]: SQL status: OK in 0.100 seconds
[0m17:12:57.122923 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m17:12:57.123348 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m17:12:57.125024 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:57.126548 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m17:12:57.126967 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m17:12:57.127810 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:57.128123 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m17:12:57.128425 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m17:12:57.236106 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m17:12:57.238416 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m17:12:57.239259 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    

  
[0m17:12:57.239942 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:57.241555 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m17:12:57.242078 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m17:12:57.242549 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m17:12:57.337488 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m17:12:57.338681 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m17:12:57.339271 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_scrutins__4920a893f66b"
  
    as (
      

with __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
) SELECT
date_T_insert,
json_extract_string(json, '$.scrutin.uid') AS uid,
json_extract_string(json, '$.scrutin.numero') AS numero,
json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
json_extract_string(json, '$.scrutin.legislature') AS legislature,
json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
json_extract_string(json, '$.scrutin.titre') AS titre,
json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote,
date_T_insert
FROM __dbt__cte__stg_scrutins
    );
  
  
  
[0m17:12:59.161012 [debug] [Thread-1 (]: SQL status: OK in 1.820 seconds
[0m17:12:59.167547 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m17:12:59.167834 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m17:12:59.168647 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:59.168863 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m17:12:59.169063 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins__4920a893f66b'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m17:12:59.171476 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:59.173267 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m17:12:59.173473 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m17:12:59.175545 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:59.177596 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m17:12:59.177847 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m17:12:59.180615 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:59.182239 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins"
[0m17:12:59.182850 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m17:12:59.183050 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

        
            delete from "an_data_pipeline"."main"."int_scrutins"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_scrutins__4920a893f66b"
            );

        
    

    insert into "an_data_pipeline"."main"."int_scrutins" ("date_T_insert", "uid", "numero", "organeRef", "legislature", "date_scrutin", "titre", "resultat_code", "resultat_libelle", "nb_votants", "suffrages_exprimes", "seuil", "lieu_vote", "date_T_insert_1")
    (
        select "date_T_insert", "uid", "numero", "organeRef", "legislature", "date_scrutin", "titre", "resultat_code", "resultat_libelle", "nb_votants", "suffrages_exprimes", "seuil", "lieu_vote", "date_T_insert_1"
        from "an_data_pipeline"."dbt_temp"."int_scrutins__4920a893f66b"
    )
  
[0m17:12:59.519371 [debug] [Thread-1 (]: SQL status: OK in 0.336 seconds
[0m17:12:59.520886 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m17:12:59.521264 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m17:12:59.521569 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m17:12:59.672133 [debug] [Thread-1 (]: SQL status: OK in 0.150 seconds
[0m17:12:59.677261 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m17:12:59.678357 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__4920a893f66b" cascade
    
[0m17:12:59.884743 [debug] [Thread-1 (]: SQL status: OK in 0.206 seconds
[0m17:12:59.886742 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m17:12:59.886987 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__4920a893f66b" cascade
    
[0m17:12:59.992453 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m17:12:59.995136 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: Close
[0m17:12:59.997225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d425064-5bbc-434f-ab38-427e24a9c630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b3fd70>]}
[0m17:12:59.998769 [info ] [Thread-1 (]: 9 of 11 OK created sql incremental model main.int_scrutins ..................... [[32mOK[0m in 2.99s]
[0m17:13:00.001167 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins
[0m17:13:00.002732 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins_votes
[0m17:13:00.003512 [info ] [Thread-1 (]: 10 of 11 START sql incremental model main.int_scrutins_votes ................... [RUN]
[0m17:13:00.004775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_scrutins, now model.dbt_an_data.int_scrutins_votes)
[0m17:13:00.005669 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins_votes
[0m17:13:00.106838 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins_votes"
[0m17:13:00.107967 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins_votes
[0m17:13:00.111050 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m17:13:00.111418 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__0294327f166f" cascade
    
[0m17:13:00.111671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:13:00.209783 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m17:13:00.212746 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m17:13:00.213068 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m17:13:00.215254 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:13:00.217342 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m17:13:00.218149 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m17:13:00.219629 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:13:00.221191 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m17:13:00.221645 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m17:13:00.318176 [debug] [Thread-1 (]: SQL status: OK in 0.096 seconds
[0m17:13:00.319066 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m17:13:00.319329 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    

  
[0m17:13:00.319611 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:13:00.320303 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m17:13:00.320533 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m17:13:00.320741 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m17:13:00.414730 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m17:13:00.415778 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m17:13:00.416555 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_scrutins_votes__0294327f166f"
  
    as (
      

WITH  __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
), grp AS (
      -- explode les groupes (1 par groupe)
    SELECT
        json_extract_string(j.json, '$.scrutin.uid') AS uid,
        json_extract_string(g.value, '$.organeRef') AS groupe_organe,
        g.value AS groupe_json,
        j.date_T_insert
    FROM __dbt__cte__stg_scrutins j,
    json_each(json->'scrutin'->'ventilationVotes'->'organe'->'groupes'->'groupe') g
  ),

  positions_array AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          date_T_insert,
          groupe_organe,
          'pour' AS type_vote,
          p.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'pours'->'votant') p
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          date_T_insert,
          groupe_organe,
          'contre' AS type_vote,
          c.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'contres'->'votant') c
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          date_T_insert,
          groupe_organe,
          'abstention' AS type_vote,
          a.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'abstentions'->'votant') a
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[ARRAY]'

      UNION ALL
      SELECT
          uid,
          date_T_insert,
          groupe_organe,
          'nonVotant' AS type_vote,
          n.value AS vote_json
      FROM grp,
           json_each(groupe_json->'vote'->'decompteNominatif'->'nonVotants'->'votant') n
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[ARRAY]'
  ),
  positions_object AS (
      -- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
      SELECT
          uid,
          groupe_organe,
          'pour' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'contre' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'abstention' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[OBJECT]'

      UNION ALL
      SELECT
          uid,
          groupe_organe,
          'nonVotant' AS type_vote,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.acteurRef') AS acteurRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.mandatRef') AS mandatRef,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.parDelegation') AS parDelegation,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.numPlace') AS numPlace,
          json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.causePositionVote') AS cause,
          date_T_insert
      FROM grp
      WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[OBJECT]'
  ),

  clean AS (
      -- sécurise les champs (souvent string ou null)
      SELECT
          uid,
          groupe_organe,
          type_vote,
          json_extract_string(vote_json, '$.acteurRef') AS acteurRef,
          json_extract_string(vote_json, '$.mandatRef') AS mandatRef,
          json_extract_string(vote_json, '$.parDelegation') AS parDelegation,
          json_extract_string(vote_json, '$.numPlace') AS numPlace,
          json_extract_string(vote_json, '$.causePositionVote') AS cause,
          date_T_insert
      FROM positions_array
      UNION ALL
      SELECT * 
      FROM positions_object
  )

  SELECT * FROM clean
    );
  
  
  
[0m17:13:15.015807 [debug] [Thread-1 (]: SQL status: OK in 14.591 seconds
[0m17:13:15.049544 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m17:13:15.050042 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m17:13:15.051507 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:13:15.051740 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m17:13:15.051931 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins_votes__0294327f166f'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m17:13:15.056323 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:13:15.059969 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m17:13:15.060211 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins_votes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m17:13:15.062172 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:13:15.065569 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m17:13:15.065776 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins_votes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m17:13:15.067524 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:13:15.071201 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins_votes"
[0m17:13:15.072149 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m17:13:15.072349 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

        
            delete from "an_data_pipeline"."main"."int_scrutins_votes" as DBT_INCREMENTAL_TARGET
            using "an_data_pipeline"."dbt_temp"."int_scrutins_votes__0294327f166f"
            where (
                
                    "an_data_pipeline"."dbt_temp"."int_scrutins_votes__0294327f166f".uid = DBT_INCREMENTAL_TARGET.uid
                    and 
                
                    "an_data_pipeline"."dbt_temp"."int_scrutins_votes__0294327f166f".acteurRef = DBT_INCREMENTAL_TARGET.acteurRef
                    
                
                
            );
        
    

    insert into "an_data_pipeline"."main"."int_scrutins_votes" ("uid", "groupe_organe", "type_vote", "acteurRef", "mandatRef", "parDelegation", "numPlace", "cause", "date_T_insert")
    (
        select "uid", "groupe_organe", "type_vote", "acteurRef", "mandatRef", "parDelegation", "numPlace", "cause", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_scrutins_votes__0294327f166f"
    )
  
[0m17:13:16.074755 [debug] [Thread-1 (]: SQL status: OK in 1.002 seconds
[0m17:13:16.077563 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m17:13:16.078203 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m17:13:16.078705 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m17:13:16.693129 [debug] [Thread-1 (]: SQL status: OK in 0.614 seconds
[0m17:13:16.695445 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m17:13:16.695642 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__0294327f166f" cascade
    
[0m17:13:16.894872 [debug] [Thread-1 (]: SQL status: OK in 0.199 seconds
[0m17:13:16.897389 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m17:13:16.897608 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__0294327f166f" cascade
    
[0m17:13:16.997152 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m17:13:17.001582 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: Close
[0m17:13:17.006184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d425064-5bbc-434f-ab38-427e24a9c630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bf99d0>]}
[0m17:13:17.007987 [info ] [Thread-1 (]: 10 of 11 OK created sql incremental model main.int_scrutins_votes .............. [[32mOK[0m in 17.00s]
[0m17:13:17.009268 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins_votes
[0m17:13:17.010525 [debug] [Thread-1 (]: Began running node model.dbt_an_data.mart_check_insert_dates
[0m17:13:17.013178 [info ] [Thread-1 (]: 11 of 11 START sql view model main.mart_check_insert_dates ..................... [RUN]
[0m17:13:17.013776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_scrutins_votes, now model.dbt_an_data.mart_check_insert_dates)
[0m17:13:17.014061 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.mart_check_insert_dates
[0m17:13:17.027346 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.mart_check_insert_dates"
[0m17:13:17.028210 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.mart_check_insert_dates
[0m17:13:17.046007 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.mart_check_insert_dates"
[0m17:13:17.046628 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.mart_check_insert_dates"
[0m17:13:17.046838 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: BEGIN
[0m17:13:17.047034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:13:17.047796 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:13:17.047982 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.mart_check_insert_dates"
[0m17:13:17.048180 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.mart_check_insert_dates"} */

  
  create view "an_data_pipeline"."main"."mart_check_insert_dates__dbt_tmp" as (
    SELECT
"acteurs" as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_acteurs"

UNION ALL 

SELECT
"agenda" as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_agenda"

UNION ALL 

SELECT
"amendements" as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_amendements"

UNION ALL 

SELECT
"organes" as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_organes"

UNION ALL 

SELECT
"pays" as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_pays"

UNION ALL 

SELECT
"reunions" as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_reunions"

UNION ALL 

SELECT
"scrutins" as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_scrutins"
  );

[0m17:13:17.158152 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.mart_check_insert_dates"} */

  
  create view "an_data_pipeline"."main"."mart_check_insert_dates__dbt_tmp" as (
    SELECT
"acteurs" as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_acteurs"

UNION ALL 

SELECT
"agenda" as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_agenda"

UNION ALL 

SELECT
"amendements" as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_amendements"

UNION ALL 

SELECT
"organes" as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_organes"

UNION ALL 

SELECT
"pays" as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_pays"

UNION ALL 

SELECT
"reunions" as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_reunions"

UNION ALL 

SELECT
"scrutins" as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_scrutins"
  );

[0m17:13:17.158492 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:13:17.159001 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: ROLLBACK
[0m17:13:17.176422 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_an_data.mart_check_insert_dates'
[0m17:13:17.176700 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: Close
[0m17:13:17.178948 [debug] [Thread-1 (]: Runtime Error in model mart_check_insert_dates (models/mart/mart_check_insert_dates.sql)
  Binder Error: Referenced column "acteurs" not found in FROM clause!
  Candidate bindings: "dateNais", "dateDeces", "date_T_insert", "catSocPro", "libelleCourant"
  
  LINE 6: "acteurs" as source,
          ^
[0m17:13:17.179237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d425064-5bbc-434f-ab38-427e24a9c630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d20caa0>]}
[0m17:13:17.179578 [error] [Thread-1 (]: 11 of 11 ERROR creating sql view model main.mart_check_insert_dates ............ [[31mERROR[0m in 0.17s]
[0m17:13:17.180361 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.mart_check_insert_dates
[0m17:13:17.180838 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.mart_check_insert_dates' to be skipped because of status 'error'.  Reason: Runtime Error in model mart_check_insert_dates (models/mart/mart_check_insert_dates.sql)
  Binder Error: Referenced column "acteurs" not found in FROM clause!
  Candidate bindings: "dateNais", "dateDeces", "date_T_insert", "catSocPro", "libelleCourant"
  
  LINE 6: "acteurs" as source,
          ^.
[0m17:13:17.192399 [debug] [MainThread]: Using duckdb connection "master"
[0m17:13:17.192659 [debug] [MainThread]: On master: BEGIN
[0m17:13:17.192810 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:13:17.193597 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:13:17.193808 [debug] [MainThread]: On master: COMMIT
[0m17:13:17.193977 [debug] [MainThread]: Using duckdb connection "master"
[0m17:13:17.194125 [debug] [MainThread]: On master: COMMIT
[0m17:13:17.194420 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:13:17.194577 [debug] [MainThread]: On master: Close
[0m17:13:17.194916 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:13:17.195070 [debug] [MainThread]: Connection 'model.dbt_an_data.mart_check_insert_dates' was properly closed.
[0m17:13:17.195722 [info ] [MainThread]: 
[0m17:13:17.195905 [info ] [MainThread]: Finished running 10 incremental models, 1 project hook, 1 view model in 0 hours 1 minutes and 0.16 seconds (60.16s).
[0m17:13:17.197195 [debug] [MainThread]: Command end result
[0m17:13:17.225237 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m17:13:17.246078 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m17:13:17.255049 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m17:13:17.255273 [info ] [MainThread]: 
[0m17:13:17.255469 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:13:17.255630 [info ] [MainThread]: 
[0m17:13:17.255826 [error] [MainThread]: [31mFailure in model mart_check_insert_dates (models/mart/mart_check_insert_dates.sql)[0m
[0m17:13:17.256018 [error] [MainThread]:   Runtime Error in model mart_check_insert_dates (models/mart/mart_check_insert_dates.sql)
  Binder Error: Referenced column "acteurs" not found in FROM clause!
  Candidate bindings: "dateNais", "dateDeces", "date_T_insert", "catSocPro", "libelleCourant"
  
  LINE 6: "acteurs" as source,
          ^
[0m17:13:17.256237 [info ] [MainThread]: 
[0m17:13:17.256471 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/mart/mart_check_insert_dates.sql
[0m17:13:17.256647 [info ] [MainThread]: 
[0m17:13:17.257212 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=12
[0m17:13:17.260154 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 61.211838, "process_in_blocks": "0", "process_kernel_time": 13.188052, "process_mem_max_rss": "2914516992", "process_out_blocks": "0", "process_user_time": 44.45855}
[0m17:13:17.261323 [debug] [MainThread]: Command `dbt run` failed at 17:13:17.261273 after 61.21 seconds
[0m17:13:17.262075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095ffc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10906e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109711880>]}
[0m17:13:17.262327 [debug] [MainThread]: Flushing usage events
[0m17:13:17.836129 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:16:13.186590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054b4bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062f9460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062f9370>]}


============================== 17:16:13.189810 | c2ccbe5f-d473-4850-862f-106db342b449 ==============================
[0m17:16:13.189810 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:16:13.190173 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'target_path': 'None', 'no_print': 'None', 'quiet': 'False', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'introspect': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt run --select mart+', 'static_parser': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'debug': 'False'}
[0m17:16:13.193591 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'MOTHERDUCK_TOKEN'
[0m17:16:13.193964 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.0518345, "process_in_blocks": "0", "process_kernel_time": 0.124539, "process_mem_max_rss": "100352000", "process_out_blocks": "0", "process_user_time": 0.631715}
[0m17:16:13.194234 [debug] [MainThread]: Command `dbt run` failed at 17:16:13.194188 after 0.05 seconds
[0m17:16:13.194407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054b4bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aa0200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c8140>]}
[0m17:16:13.194589 [debug] [MainThread]: Flushing usage events
[0m17:16:13.687918 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:16:38.001737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109080680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a596a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a595b0>]}


============================== 17:16:38.004787 | 810371c4-3ffb-4946-b5d9-d6a511496192 ==============================
[0m17:16:38.004787 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:16:38.005138 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'empty': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'introspect': 'True', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'log_format': 'default', 'use_colors': 'True', 'quiet': 'False', 'write_json': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'target_path': 'None', 'version_check': 'True', 'debug': 'False', 'static_parser': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select mart+', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80'}
[0m17:16:38.182820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '810371c4-3ffb-4946-b5d9-d6a511496192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10980f9e0>]}
[0m17:16:38.210661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '810371c4-3ffb-4946-b5d9-d6a511496192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096f5e50>]}
[0m17:16:38.212114 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:16:38.271596 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m17:16:38.342807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:16:38.343179 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/mart/mart_check_insert_dates.sql
[0m17:16:38.468359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '810371c4-3ffb-4946-b5d9-d6a511496192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d22db0>]}
[0m17:16:38.505548 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m17:16:38.507102 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m17:16:38.520104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '810371c4-3ffb-4946-b5d9-d6a511496192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b2e4e0>]}
[0m17:16:38.520397 [info ] [MainThread]: Found 18 models, 1 operation, 9 sources, 469 macros
[0m17:16:38.520592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '810371c4-3ffb-4946-b5d9-d6a511496192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eab7d0>]}
[0m17:16:38.521408 [info ] [MainThread]: 
[0m17:16:38.521600 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m17:16:38.521748 [info ] [MainThread]: 
[0m17:16:38.521994 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:16:38.522418 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_an_data_pipeline'
[0m17:16:38.604644 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline"
[0m17:16:38.604899 [debug] [ThreadPool]: On list_an_data_pipeline: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"an_data_pipeline"'
    
  
  
[0m17:16:38.605060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:40.612427 [debug] [ThreadPool]: SQL status: OK in 2.007 seconds
[0m17:16:40.614237 [debug] [ThreadPool]: On list_an_data_pipeline: Close
[0m17:16:40.615061 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_an_data_pipeline, now create_an_data_pipeline_main)
[0m17:16:40.615581 [debug] [ThreadPool]: Creating schema "database: "an_data_pipeline"
schema: "main"
"
[0m17:16:40.621487 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m17:16:40.621838 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m17:16:40.622111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:16:40.623732 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:16:40.624891 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m17:16:40.625174 [debug] [ThreadPool]: On create_an_data_pipeline_main: BEGIN
[0m17:16:40.625931 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:16:40.626184 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m17:16:40.626406 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
    
        create schema if not exists "an_data_pipeline"."main"
    
[0m17:16:40.724426 [debug] [ThreadPool]: SQL status: OK in 0.098 seconds
[0m17:16:40.725590 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m17:16:40.725963 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m17:16:40.726267 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m17:16:40.823057 [debug] [ThreadPool]: SQL status: OK in 0.096 seconds
[0m17:16:40.824055 [debug] [ThreadPool]: On create_an_data_pipeline_main: Close
[0m17:16:40.831847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_an_data_pipeline_main, now list_an_data_pipeline_main)
[0m17:16:40.838808 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m17:16:40.839285 [debug] [ThreadPool]: On list_an_data_pipeline_main: BEGIN
[0m17:16:40.839751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:16:40.841215 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:16:40.841812 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m17:16:40.842205 [debug] [ThreadPool]: On list_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline_main"} */
select
      'an_data_pipeline' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'an_data_pipeline'
  
[0m17:16:40.864915 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m17:16:40.866420 [debug] [ThreadPool]: On list_an_data_pipeline_main: ROLLBACK
[0m17:16:40.867784 [debug] [ThreadPool]: Failed to rollback 'list_an_data_pipeline_main'
[0m17:16:40.868047 [debug] [ThreadPool]: On list_an_data_pipeline_main: Close
[0m17:16:40.869516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '810371c4-3ffb-4946-b5d9-d6a511496192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d93050>]}
[0m17:16:40.869944 [debug] [MainThread]: Using duckdb connection "master"
[0m17:16:40.870195 [debug] [MainThread]: On master: BEGIN
[0m17:16:40.870410 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:16:40.871332 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:16:40.871562 [debug] [MainThread]: On master: COMMIT
[0m17:16:40.871777 [debug] [MainThread]: Using duckdb connection "master"
[0m17:16:40.871981 [debug] [MainThread]: On master: COMMIT
[0m17:16:40.872393 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:16:40.877881 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_an_data.dbt_an_data-on-run-start-0"
[0m17:16:40.881217 [info ] [MainThread]: 1 of 1 START hook: dbt_an_data.on-run-start.0 .................................. [RUN]
[0m17:16:40.881591 [debug] [MainThread]: Using duckdb connection "master"
[0m17:16:40.881869 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "master"} */
ATTACH '../data/database/database.duckdb' AS database (READ_ONLY)
[0m17:16:40.890266 [debug] [MainThread]: SQL status: OK in 0.008 seconds
[0m17:16:40.891173 [info ] [MainThread]: 1 of 1 OK hook: dbt_an_data.on-run-start.0 ..................................... [[32mOK[0m in 0.02s]
[0m17:16:40.891582 [info ] [MainThread]: 
[0m17:16:40.891890 [debug] [MainThread]: On master: Close
[0m17:16:40.894712 [debug] [Thread-1 (]: Began running node model.dbt_an_data.mart_check_insert_dates
[0m17:16:40.895168 [info ] [Thread-1 (]: 1 of 1 START sql view model main.mart_check_insert_dates ....................... [RUN]
[0m17:16:40.895478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_an_data_pipeline_main, now model.dbt_an_data.mart_check_insert_dates)
[0m17:16:40.895696 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.mart_check_insert_dates
[0m17:16:40.898261 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.mart_check_insert_dates"
[0m17:16:40.898794 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.mart_check_insert_dates
[0m17:16:40.914992 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.mart_check_insert_dates"
[0m17:16:40.915549 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.mart_check_insert_dates"
[0m17:16:40.915753 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: BEGIN
[0m17:16:40.915970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:40.916949 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:16:40.917186 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.mart_check_insert_dates"
[0m17:16:40.917391 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.mart_check_insert_dates"} */

  
  create view "an_data_pipeline"."main"."mart_check_insert_dates__dbt_tmp" as (
    SELECT
'acteurs' as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_acteurs"

UNION ALL 

SELECT
'agenda' as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_agenda"

UNION ALL 

SELECT
'amendements' as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_amendements"

UNION ALL 

SELECT
'organes' as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_organes"

UNION ALL 

SELECT
'pays' as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_pays"

UNION ALL 

SELECT
'reunions' as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_reunions"

UNION ALL 

SELECT
'scrutins' as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_scrutins"
  );

[0m17:16:41.027374 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m17:16:41.031730 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.mart_check_insert_dates"
[0m17:16:41.032031 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.mart_check_insert_dates"} */
alter view "an_data_pipeline"."main"."mart_check_insert_dates__dbt_tmp" rename to "mart_check_insert_dates"
[0m17:16:41.136464 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m17:16:41.147131 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: COMMIT
[0m17:16:41.147587 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.mart_check_insert_dates"
[0m17:16:41.147951 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: COMMIT
[0m17:16:41.355322 [debug] [Thread-1 (]: SQL status: OK in 0.207 seconds
[0m17:16:41.362366 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.mart_check_insert_dates"
[0m17:16:41.362885 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.mart_check_insert_dates"} */

      drop view if exists "an_data_pipeline"."main"."mart_check_insert_dates__dbt_backup" cascade
    
[0m17:16:41.466783 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m17:16:41.471566 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: Close
[0m17:16:41.474417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '810371c4-3ffb-4946-b5d9-d6a511496192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1d3a0>]}
[0m17:16:41.475422 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.mart_check_insert_dates .................. [[32mOK[0m in 0.58s]
[0m17:16:41.476265 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.mart_check_insert_dates
[0m17:16:41.477882 [debug] [MainThread]: Using duckdb connection "master"
[0m17:16:41.478407 [debug] [MainThread]: On master: BEGIN
[0m17:16:41.478831 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:16:41.480382 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m17:16:41.480826 [debug] [MainThread]: On master: COMMIT
[0m17:16:41.481179 [debug] [MainThread]: Using duckdb connection "master"
[0m17:16:41.481496 [debug] [MainThread]: On master: COMMIT
[0m17:16:41.482115 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:16:41.482587 [debug] [MainThread]: On master: Close
[0m17:16:41.483256 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:41.483628 [debug] [MainThread]: Connection 'model.dbt_an_data.mart_check_insert_dates' was properly closed.
[0m17:16:41.484010 [info ] [MainThread]: 
[0m17:16:41.484402 [info ] [MainThread]: Finished running 1 project hook, 1 view model in 0 hours 0 minutes and 2.96 seconds (2.96s).
[0m17:16:41.485244 [debug] [MainThread]: Command end result
[0m17:16:41.545283 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m17:16:41.546366 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m17:16:41.549647 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m17:16:41.549845 [info ] [MainThread]: 
[0m17:16:41.550070 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:16:41.550236 [info ] [MainThread]: 
[0m17:16:41.550425 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m17:16:41.550770 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.5846944, "process_in_blocks": "0", "process_kernel_time": 0.31435, "process_mem_max_rss": "162971648", "process_out_blocks": "0", "process_user_time": 1.583853}
[0m17:16:41.551000 [debug] [MainThread]: Command `dbt run` succeeded at 17:16:41.550961 after 3.58 seconds
[0m17:16:41.551196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109205bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089c5ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d1d460>]}
[0m17:16:41.551385 [debug] [MainThread]: Flushing usage events
[0m17:16:41.959367 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:18:02.976886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c016a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e25a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10401d580>]}


============================== 17:18:02.980085 | f9bc6169-e5ee-475e-bc93-f9b0ce8af908 ==============================
[0m17:18:02.980085 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:18:02.980446 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'warn_error': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'log_format': 'default', 'debug': 'False', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'invocation_command': 'dbt run --select mart+', 'quiet': 'False', 'introspect': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m17:18:03.184692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9bc6169-e5ee-475e-bc93-f9b0ce8af908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d3bfe0>]}
[0m17:18:03.212015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9bc6169-e5ee-475e-bc93-f9b0ce8af908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1012f9f40>]}
[0m17:18:03.213379 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:18:03.277158 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m17:18:03.351926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:18:03.352311 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/mart/mart_check_insert_dates.sql
[0m17:18:03.468966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9bc6169-e5ee-475e-bc93-f9b0ce8af908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe1df0>]}
[0m17:18:03.507150 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m17:18:03.509052 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m17:18:03.521887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9bc6169-e5ee-475e-bc93-f9b0ce8af908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10518ef60>]}
[0m17:18:03.522188 [info ] [MainThread]: Found 18 models, 1 operation, 9 sources, 469 macros
[0m17:18:03.522406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9bc6169-e5ee-475e-bc93-f9b0ce8af908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104672660>]}
[0m17:18:03.523275 [info ] [MainThread]: 
[0m17:18:03.523484 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m17:18:03.523638 [info ] [MainThread]: 
[0m17:18:03.523891 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:18:03.524321 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_an_data_pipeline'
[0m17:18:03.618424 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline"
[0m17:18:03.619104 [debug] [ThreadPool]: On list_an_data_pipeline: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"an_data_pipeline"'
    
  
  
[0m17:18:03.619352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:05.363654 [debug] [ThreadPool]: SQL status: OK in 1.744 seconds
[0m17:18:05.364940 [debug] [ThreadPool]: On list_an_data_pipeline: Close
[0m17:18:05.365478 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_an_data_pipeline, now create_an_data_pipeline_main)
[0m17:18:05.365804 [debug] [ThreadPool]: Creating schema "database: "an_data_pipeline"
schema: "main"
"
[0m17:18:05.373871 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m17:18:05.374332 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m17:18:05.374702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:18:05.376962 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:18:05.378479 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m17:18:05.378831 [debug] [ThreadPool]: On create_an_data_pipeline_main: BEGIN
[0m17:18:05.379837 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:18:05.380171 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m17:18:05.380492 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
    
        create schema if not exists "an_data_pipeline"."main"
    
[0m17:18:05.482597 [debug] [ThreadPool]: SQL status: OK in 0.102 seconds
[0m17:18:05.484663 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m17:18:05.485493 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m17:18:05.486093 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m17:18:05.582482 [debug] [ThreadPool]: SQL status: OK in 0.096 seconds
[0m17:18:05.583599 [debug] [ThreadPool]: On create_an_data_pipeline_main: Close
[0m17:18:05.592982 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_an_data_pipeline_main, now list_an_data_pipeline_main)
[0m17:18:05.600512 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m17:18:05.600952 [debug] [ThreadPool]: On list_an_data_pipeline_main: BEGIN
[0m17:18:05.601300 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:18:05.602497 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:18:05.602979 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m17:18:05.603333 [debug] [ThreadPool]: On list_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline_main"} */
select
      'an_data_pipeline' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'an_data_pipeline'
  
[0m17:18:05.626990 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m17:18:05.628704 [debug] [ThreadPool]: On list_an_data_pipeline_main: ROLLBACK
[0m17:18:05.630253 [debug] [ThreadPool]: Failed to rollback 'list_an_data_pipeline_main'
[0m17:18:05.630593 [debug] [ThreadPool]: On list_an_data_pipeline_main: Close
[0m17:18:05.632252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9bc6169-e5ee-475e-bc93-f9b0ce8af908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105358b00>]}
[0m17:18:05.632649 [debug] [MainThread]: Using duckdb connection "master"
[0m17:18:05.632889 [debug] [MainThread]: On master: BEGIN
[0m17:18:05.633111 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:18:05.634102 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:18:05.634368 [debug] [MainThread]: On master: COMMIT
[0m17:18:05.634600 [debug] [MainThread]: Using duckdb connection "master"
[0m17:18:05.634820 [debug] [MainThread]: On master: COMMIT
[0m17:18:05.635288 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:18:05.641162 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_an_data.dbt_an_data-on-run-start-0"
[0m17:18:05.644712 [info ] [MainThread]: 1 of 1 START hook: dbt_an_data.on-run-start.0 .................................. [RUN]
[0m17:18:05.645161 [debug] [MainThread]: Using duckdb connection "master"
[0m17:18:05.645421 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "master"} */
ATTACH '../data/database/database.duckdb' AS database (READ_ONLY)
[0m17:18:05.656001 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m17:18:05.659474 [info ] [MainThread]: 1 of 1 OK hook: dbt_an_data.on-run-start.0 ..................................... [[32mOK[0m in 0.02s]
[0m17:18:05.661024 [info ] [MainThread]: 
[0m17:18:05.661546 [debug] [MainThread]: On master: Close
[0m17:18:05.664757 [debug] [Thread-1 (]: Began running node model.dbt_an_data.mart_check_insert_dates
[0m17:18:05.665269 [info ] [Thread-1 (]: 1 of 1 START sql view model main.mart_check_insert_dates ....................... [RUN]
[0m17:18:05.665677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_an_data_pipeline_main, now model.dbt_an_data.mart_check_insert_dates)
[0m17:18:05.666105 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.mart_check_insert_dates
[0m17:18:05.668717 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.mart_check_insert_dates"
[0m17:18:05.669404 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.mart_check_insert_dates
[0m17:18:05.688311 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.mart_check_insert_dates"
[0m17:18:05.688879 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.mart_check_insert_dates"
[0m17:18:05.689094 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: BEGIN
[0m17:18:05.689326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:05.690400 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:18:05.690609 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.mart_check_insert_dates"
[0m17:18:05.690817 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.mart_check_insert_dates"} */

  
  create view "an_data_pipeline"."main"."mart_check_insert_dates__dbt_tmp" as (
    SELECT DISTINCT
'acteurs' as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_acteurs"

UNION ALL 

SELECT DISTINCT
'agenda' as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_agenda"

UNION ALL 

SELECT DISTINCT
'amendements' as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_amendements"

UNION ALL 

SELECT DISTINCT
'organes' as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_organes"

UNION ALL 

SELECT DISTINCT
'pays' as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_pays"

UNION ALL 

SELECT DISTINCT
'reunions' as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_reunions"

UNION ALL 

SELECT DISTINCT
'scrutins' as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_scrutins"
  );

[0m17:18:05.802441 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m17:18:05.807758 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.mart_check_insert_dates"
[0m17:18:05.808103 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.mart_check_insert_dates"} */
alter view "an_data_pipeline"."main"."mart_check_insert_dates" rename to "mart_check_insert_dates__dbt_backup"
[0m17:18:05.913621 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m17:18:05.917482 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.mart_check_insert_dates"
[0m17:18:05.917979 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.mart_check_insert_dates"} */
alter view "an_data_pipeline"."main"."mart_check_insert_dates__dbt_tmp" rename to "mart_check_insert_dates"
[0m17:18:06.026661 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m17:18:06.042452 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: COMMIT
[0m17:18:06.043018 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.mart_check_insert_dates"
[0m17:18:06.043441 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: COMMIT
[0m17:18:06.255502 [debug] [Thread-1 (]: SQL status: OK in 0.211 seconds
[0m17:18:06.267476 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.mart_check_insert_dates"
[0m17:18:06.268225 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.mart_check_insert_dates"} */

      drop view if exists "an_data_pipeline"."main"."mart_check_insert_dates__dbt_backup" cascade
    
[0m17:18:06.474229 [debug] [Thread-1 (]: SQL status: OK in 0.205 seconds
[0m17:18:06.478234 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: Close
[0m17:18:06.481007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9bc6169-e5ee-475e-bc93-f9b0ce8af908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104670d10>]}
[0m17:18:06.481958 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.mart_check_insert_dates .................. [[32mOK[0m in 0.81s]
[0m17:18:06.482791 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.mart_check_insert_dates
[0m17:18:06.484381 [debug] [MainThread]: Using duckdb connection "master"
[0m17:18:06.484938 [debug] [MainThread]: On master: BEGIN
[0m17:18:06.485305 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:18:06.486690 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:18:06.487045 [debug] [MainThread]: On master: COMMIT
[0m17:18:06.487365 [debug] [MainThread]: Using duckdb connection "master"
[0m17:18:06.487679 [debug] [MainThread]: On master: COMMIT
[0m17:18:06.488283 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:18:06.488615 [debug] [MainThread]: On master: Close
[0m17:18:06.489147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:06.489548 [debug] [MainThread]: Connection 'model.dbt_an_data.mart_check_insert_dates' was properly closed.
[0m17:18:06.489984 [info ] [MainThread]: 
[0m17:18:06.490376 [info ] [MainThread]: Finished running 1 project hook, 1 view model in 0 hours 0 minutes and 2.97 seconds (2.97s).
[0m17:18:06.491223 [debug] [MainThread]: Command end result
[0m17:18:06.552711 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m17:18:06.553739 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m17:18:06.556766 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m17:18:06.556962 [info ] [MainThread]: 
[0m17:18:06.557193 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:18:06.557364 [info ] [MainThread]: 
[0m17:18:06.557561 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m17:18:06.557910 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.625341, "process_in_blocks": "0", "process_kernel_time": 0.320735, "process_mem_max_rss": "167608320", "process_out_blocks": "0", "process_user_time": 1.575027}
[0m17:18:06.558146 [debug] [MainThread]: Command `dbt run` succeeded at 17:18:06.558105 after 3.63 seconds
[0m17:18:06.558343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052e4620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052e7e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052e75c0>]}
[0m17:18:06.558537 [debug] [MainThread]: Flushing usage events
[0m17:18:07.056521 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:16:44.823932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f508c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ed550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ec5f0>]}


============================== 16:16:44.827212 | 71121d8b-e7f2-4a8e-9517-b9df34cb0994 ==============================
[0m16:16:44.827212 [info ] [MainThread]: Running with dbt=1.10.15
[0m16:16:44.827549 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'quiet': 'False', 'debug': 'False', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'target_path': 'None', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'printer_width': '80', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'no_print': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False'}
[0m16:16:44.950179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71121d8b-e7f2-4a8e-9517-b9df34cb0994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073abb90>]}
[0m16:16:44.979561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71121d8b-e7f2-4a8e-9517-b9df34cb0994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107179dc0>]}
[0m16:16:44.981014 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:16:45.039980 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m16:16:45.117384 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 10 files changed.
[0m16:16:45.136023 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_organes.sql
[0m16:16:45.136488 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_scrutins.sql
[0m16:16:45.136731 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_acteurs.sql
[0m16:16:45.149411 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_reunions.sql
[0m16:16:45.158734 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_scrutins_votes.sql
[0m16:16:45.163295 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_agenda.sql
[0m16:16:45.163573 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_mandats.sql
[0m16:16:45.163817 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_pays.sql
[0m16:16:45.164045 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_amendements.sql
[0m16:16:45.164267 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_amendements_cosignataires.sql
[0m16:16:45.319603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71121d8b-e7f2-4a8e-9517-b9df34cb0994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b118b0>]}
[0m16:16:45.359259 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m16:16:45.361259 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m16:16:45.375356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71121d8b-e7f2-4a8e-9517-b9df34cb0994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b25880>]}
[0m16:16:45.375644 [info ] [MainThread]: Found 18 models, 1 operation, 9 sources, 469 macros
[0m16:16:45.375819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71121d8b-e7f2-4a8e-9517-b9df34cb0994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a336b0>]}
[0m16:16:45.376906 [info ] [MainThread]: 
[0m16:16:45.377089 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m16:16:45.377230 [info ] [MainThread]: 
[0m16:16:45.377473 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:16:45.379869 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_an_data_pipeline'
[0m16:16:45.504777 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline"
[0m16:16:45.505027 [debug] [ThreadPool]: On list_an_data_pipeline: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"an_data_pipeline"'
    
  
  
[0m16:16:45.505169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:49.035444 [debug] [ThreadPool]: SQL status: OK in 3.530 seconds
[0m16:16:49.038098 [debug] [ThreadPool]: On list_an_data_pipeline: Close
[0m16:16:49.039044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_an_data_pipeline, now create_an_data_pipeline_main)
[0m16:16:49.039586 [debug] [ThreadPool]: Creating schema "database: "an_data_pipeline"
schema: "main"
"
[0m16:16:49.047984 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m16:16:49.049524 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:16:49.050607 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:16:49.055498 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:16:49.058860 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m16:16:49.059158 [debug] [ThreadPool]: On create_an_data_pipeline_main: BEGIN
[0m16:16:49.060094 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:16:49.060576 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m16:16:49.060832 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
    
        create schema if not exists "an_data_pipeline"."main"
    
[0m16:16:49.162176 [debug] [ThreadPool]: SQL status: OK in 0.101 seconds
[0m16:16:49.164779 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m16:16:49.165450 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m16:16:49.165931 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m16:16:49.260745 [debug] [ThreadPool]: SQL status: OK in 0.094 seconds
[0m16:16:49.261417 [debug] [ThreadPool]: On create_an_data_pipeline_main: Close
[0m16:16:49.263983 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_an_data_pipeline_main, now list_an_data_pipeline_main)
[0m16:16:49.276683 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m16:16:49.285917 [debug] [ThreadPool]: On list_an_data_pipeline_main: BEGIN
[0m16:16:49.286148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:16:49.287018 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:16:49.287234 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m16:16:49.287414 [debug] [ThreadPool]: On list_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline_main"} */
select
      'an_data_pipeline' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'an_data_pipeline'
  
[0m16:16:49.301070 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m16:16:49.302141 [debug] [ThreadPool]: On list_an_data_pipeline_main: ROLLBACK
[0m16:16:49.303282 [debug] [ThreadPool]: Failed to rollback 'list_an_data_pipeline_main'
[0m16:16:49.303537 [debug] [ThreadPool]: On list_an_data_pipeline_main: Close
[0m16:16:49.305165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71121d8b-e7f2-4a8e-9517-b9df34cb0994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b0abd0>]}
[0m16:16:49.305512 [debug] [MainThread]: Using duckdb connection "master"
[0m16:16:49.305682 [debug] [MainThread]: On master: BEGIN
[0m16:16:49.305827 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:16:49.306441 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:16:49.306594 [debug] [MainThread]: On master: COMMIT
[0m16:16:49.306737 [debug] [MainThread]: Using duckdb connection "master"
[0m16:16:49.306871 [debug] [MainThread]: On master: COMMIT
[0m16:16:49.307130 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:16:49.311296 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_an_data.dbt_an_data-on-run-start-0"
[0m16:16:49.315687 [info ] [MainThread]: 1 of 1 START hook: dbt_an_data.on-run-start.0 .................................. [RUN]
[0m16:16:49.316316 [debug] [MainThread]: Using duckdb connection "master"
[0m16:16:49.316726 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "master"} */
ATTACH '../data/database/database.duckdb' AS database (READ_ONLY)
[0m16:16:49.323633 [debug] [MainThread]: SQL status: OK in 0.007 seconds
[0m16:16:49.324386 [info ] [MainThread]: 1 of 1 OK hook: dbt_an_data.on-run-start.0 ..................................... [[32mOK[0m in 0.02s]
[0m16:16:49.324601 [info ] [MainThread]: 
[0m16:16:49.324805 [debug] [MainThread]: On master: Close
[0m16:16:49.326488 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_acteurs
[0m16:16:49.326742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_an_data_pipeline_main, now model.dbt_an_data.stg_acteurs)
[0m16:16:49.326943 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_acteurs
[0m16:16:49.328715 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_acteurs"
[0m16:16:49.329930 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_acteurs
[0m16:16:49.330191 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_agenda
[0m16:16:49.330471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_acteurs, now model.dbt_an_data.stg_agenda)
[0m16:16:49.330727 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_agenda
[0m16:16:49.332932 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_agenda"
[0m16:16:49.333707 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_agenda
[0m16:16:49.333960 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_amendements
[0m16:16:49.334241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_agenda, now model.dbt_an_data.stg_amendements)
[0m16:16:49.334485 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_amendements
[0m16:16:49.336265 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_amendements"
[0m16:16:49.336838 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_amendements
[0m16:16:49.337080 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_organes
[0m16:16:49.337372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_amendements, now model.dbt_an_data.stg_organes)
[0m16:16:49.337689 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_organes
[0m16:16:49.339343 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_organes"
[0m16:16:49.339882 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_organes
[0m16:16:49.340121 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_pays
[0m16:16:49.340372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_organes, now model.dbt_an_data.stg_pays)
[0m16:16:49.340597 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_pays
[0m16:16:49.342148 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_pays"
[0m16:16:49.342739 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_pays
[0m16:16:49.342971 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_reunions
[0m16:16:49.343216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_pays, now model.dbt_an_data.stg_reunions)
[0m16:16:49.343455 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_reunions
[0m16:16:49.345383 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_reunions"
[0m16:16:49.346005 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_reunions
[0m16:16:49.346245 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_scrutins
[0m16:16:49.346545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_reunions, now model.dbt_an_data.stg_scrutins)
[0m16:16:49.346804 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_scrutins
[0m16:16:49.349776 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_scrutins"
[0m16:16:49.350354 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_scrutins
[0m16:16:49.350568 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_acteurs
[0m16:16:49.350855 [info ] [Thread-1 (]: 1 of 11 START sql incremental model main.int_acteurs ........................... [RUN]
[0m16:16:49.351127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_scrutins, now model.dbt_an_data.int_acteurs)
[0m16:16:49.351320 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_acteurs
[0m16:16:49.358408 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_acteurs"
[0m16:16:49.358840 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_acteurs
[0m16:16:49.362848 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:16:49.363064 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__b8f842aaad2f" cascade
    
[0m16:16:49.363243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:16:49.461329 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m16:16:49.487971 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:16:49.488299 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:16:49.489263 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:16:49.490125 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:16:49.490345 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m16:16:49.490827 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:16:49.491019 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:16:49.491210 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m16:16:49.588993 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m16:16:49.590250 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:16:49.590624 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    

  
[0m16:16:49.591028 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:16:49.592088 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m16:16:49.592427 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:16:49.592727 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m16:16:49.686456 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m16:16:49.724782 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:16:49.725099 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_acteurs__b8f842aaad2f"
  
    as (
      

with __dbt__cte__stg_acteurs as (
SELECT * 
FROM "database"."stg"."raw_acteurs"
) SELECT 
	json_extract_string(json, '$.acteur.uid.#text') as uid,
	json_extract_string(json, '$.acteur.etatCivil.ident.civ') as civ,
	json_extract_string(json, '$.acteur.etatCivil.ident.prenom') as prenom,
	json_extract_string(json, '$.acteur.etatCivil.ident.nom') as nom,
	json_extract_string(json, '$.acteur.etatCivil.ident.trigramme') as trigramme,
	json_extract_string(json, '$.acteur.etatCivil.infoNaissance.dateNais') as dateNais,
	json_extract_string(json, '$.acteur.etatCivil.infoNaissance.villeNais') as villeNais,
	json_extract_string(json, '$.acteur.etatCivil.infoNaissance.depNais') as depNais,
	json_extract_string(json, '$.acteur.etatCivil.infoNaissance.paysNais') as paysNais,
	json_extract_string(json, '$.acteur.etatCivil.dateDeces') as dateDeces,
	json_extract_string(json, '$.acteur.profession.libelleCourant') as libelleCourant,
	json_extract_string(json, '$.acteur.profession.socProcINSEE.catSocPro') as catSocPro,
	json_extract_string(json, '$.acteur.profession.socProcINSEE.famSocPro') as famSocPro,
	json_extract_string(json, '$.acteur.uri_hatvp') as uri_hatvp,
	date_T_insert
FROM __dbt__cte__stg_acteurs


	LEFT JOIN "an_data_pipeline"."main"."int_acteurs" AS target ON source.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:16:49.934275 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_acteurs__b8f842aaad2f"
  
    as (
      

with __dbt__cte__stg_acteurs as (
SELECT * 
FROM "database"."stg"."raw_acteurs"
) SELECT 
	json_extract_string(json, '$.acteur.uid.#text') as uid,
	json_extract_string(json, '$.acteur.etatCivil.ident.civ') as civ,
	json_extract_string(json, '$.acteur.etatCivil.ident.prenom') as prenom,
	json_extract_string(json, '$.acteur.etatCivil.ident.nom') as nom,
	json_extract_string(json, '$.acteur.etatCivil.ident.trigramme') as trigramme,
	json_extract_string(json, '$.acteur.etatCivil.infoNaissance.dateNais') as dateNais,
	json_extract_string(json, '$.acteur.etatCivil.infoNaissance.villeNais') as villeNais,
	json_extract_string(json, '$.acteur.etatCivil.infoNaissance.depNais') as depNais,
	json_extract_string(json, '$.acteur.etatCivil.infoNaissance.paysNais') as paysNais,
	json_extract_string(json, '$.acteur.etatCivil.dateDeces') as dateDeces,
	json_extract_string(json, '$.acteur.profession.libelleCourant') as libelleCourant,
	json_extract_string(json, '$.acteur.profession.socProcINSEE.catSocPro') as catSocPro,
	json_extract_string(json, '$.acteur.profession.socProcINSEE.famSocPro') as famSocPro,
	json_extract_string(json, '$.acteur.uri_hatvp') as uri_hatvp,
	date_T_insert
FROM __dbt__cte__stg_acteurs


	LEFT JOIN "an_data_pipeline"."main"."int_acteurs" AS target ON source.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:16:49.935043 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:16:49.938174 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:16:49.938602 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__b8f842aaad2f" cascade
    
[0m16:16:50.041318 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m16:16:50.043303 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: Close
[0m16:16:50.055183 [debug] [Thread-1 (]: Runtime Error in model int_acteurs (models/int/int_acteurs.sql)
  Binder Error: Referenced table "source" not found!
  Candidate tables: "target"
  
  LINE 36: ... JOIN "an_data_pipeline"."main"."int_acteurs" AS target ON source.uid = target.uid
                                                                         ^
[0m16:16:50.057588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71121d8b-e7f2-4a8e-9517-b9df34cb0994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107835430>]}
[0m16:16:50.058378 [error] [Thread-1 (]: 1 of 11 ERROR creating sql incremental model main.int_acteurs .................. [[31mERROR[0m in 0.70s]
[0m16:16:50.059206 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_acteurs
[0m16:16:50.059713 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_mandats
[0m16:16:50.060240 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.int_acteurs' to be skipped because of status 'error'.  Reason: Runtime Error in model int_acteurs (models/int/int_acteurs.sql)
  Binder Error: Referenced table "source" not found!
  Candidate tables: "target"
  
  LINE 36: ... JOIN "an_data_pipeline"."main"."int_acteurs" AS target ON source.uid = target.uid
                                                                         ^.
[0m16:16:50.060762 [info ] [Thread-1 (]: 2 of 11 START sql incremental model main.int_mandats ........................... [RUN]
[0m16:16:50.061856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_acteurs, now model.dbt_an_data.int_mandats)
[0m16:16:50.062196 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_mandats
[0m16:16:50.073418 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_mandats"
[0m16:16:50.076911 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_mandats
[0m16:16:50.117504 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:16:50.117840 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__caca5bbded5c" cascade
    
[0m16:16:50.118032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:16:50.218853 [debug] [Thread-1 (]: SQL status: OK in 0.101 seconds
[0m16:16:50.223361 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:16:50.223932 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:16:50.225887 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:16:50.227898 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:16:50.228426 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m16:16:50.229569 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:16:50.230020 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:16:50.230470 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m16:16:50.328597 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m16:16:50.330530 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:16:50.331053 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    

  
[0m16:16:50.331339 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:16:50.332015 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m16:16:50.332216 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:16:50.332421 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m16:16:50.424984 [debug] [Thread-1 (]: SQL status: OK in 0.092 seconds
[0m16:16:50.425520 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:16:50.425741 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_mandats__caca5bbded5c"
  
    as (
      

with __dbt__cte__stg_acteurs as (
SELECT * 
FROM "database"."stg"."raw_acteurs"
) SELECT 
	json_extract_string(mandat.value, '$.uid') as uid,
	json_extract_string(mandat.value, '$.acteurRef') as acteurRef,
	json_extract_string(mandat.value, '$.legislature') as legislature,
	json_extract_string(mandat.value, '$.typeOrgane') as typeOrgane,
	json_extract_string(mandat.value, '$.dateDebut') as dateDebut,
	json_extract_string(mandat.value, '$.dateFin') as dateFin,
	json_extract_string(mandat.value, '$.preseance') as preseance,
	json_extract_string(mandat.value, '$.nominPrincipale') as nominPrincipale,
	json_extract_string(mandat.value, '$.infosQualite.codeQualite') as codeQualite,
	json_extract_string(mandat.value, '$.organes.organeRef') as organeRef,
	date_T_insert
FROM __dbt__cte__stg_acteurs act, json_each(json->'acteur'->'mandats'->'mandat') mandat


	LEFT JOIN "an_data_pipeline"."main"."int_mandats" AS target ON source.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:16:50.721172 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_mandats__caca5bbded5c"
  
    as (
      

with __dbt__cte__stg_acteurs as (
SELECT * 
FROM "database"."stg"."raw_acteurs"
) SELECT 
	json_extract_string(mandat.value, '$.uid') as uid,
	json_extract_string(mandat.value, '$.acteurRef') as acteurRef,
	json_extract_string(mandat.value, '$.legislature') as legislature,
	json_extract_string(mandat.value, '$.typeOrgane') as typeOrgane,
	json_extract_string(mandat.value, '$.dateDebut') as dateDebut,
	json_extract_string(mandat.value, '$.dateFin') as dateFin,
	json_extract_string(mandat.value, '$.preseance') as preseance,
	json_extract_string(mandat.value, '$.nominPrincipale') as nominPrincipale,
	json_extract_string(mandat.value, '$.infosQualite.codeQualite') as codeQualite,
	json_extract_string(mandat.value, '$.organes.organeRef') as organeRef,
	date_T_insert
FROM __dbt__cte__stg_acteurs act, json_each(json->'acteur'->'mandats'->'mandat') mandat


	LEFT JOIN "an_data_pipeline"."main"."int_mandats" AS target ON source.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:16:50.723764 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:16:50.728367 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:16:50.728698 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__caca5bbded5c" cascade
    
[0m16:16:50.829697 [debug] [Thread-1 (]: SQL status: OK in 0.100 seconds
[0m16:16:50.831928 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: Close
[0m16:16:50.837282 [debug] [Thread-1 (]: Runtime Error in model int_mandats (models/int/int_mandats.sql)
  Binder Error: Referenced table "source" not found!
  Candidate tables: "act"
  
  LINE 32: ... JOIN "an_data_pipeline"."main"."int_mandats" AS target ON source.uid = target.uid
                                                                         ^
[0m16:16:50.838091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71121d8b-e7f2-4a8e-9517-b9df34cb0994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079b3bc0>]}
[0m16:16:50.839004 [error] [Thread-1 (]: 2 of 11 ERROR creating sql incremental model main.int_mandats .................. [[31mERROR[0m in 0.78s]
[0m16:16:50.839777 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_mandats
[0m16:16:50.840296 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_agenda
[0m16:16:50.841001 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.int_mandats' to be skipped because of status 'error'.  Reason: Runtime Error in model int_mandats (models/int/int_mandats.sql)
  Binder Error: Referenced table "source" not found!
  Candidate tables: "act"
  
  LINE 32: ... JOIN "an_data_pipeline"."main"."int_mandats" AS target ON source.uid = target.uid
                                                                         ^.
[0m16:16:50.841770 [info ] [Thread-1 (]: 3 of 11 START sql incremental model main.int_agenda ............................ [RUN]
[0m16:16:50.842619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_mandats, now model.dbt_an_data.int_agenda)
[0m16:16:50.843142 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_agenda
[0m16:16:50.847508 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_agenda"
[0m16:16:50.852939 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_agenda
[0m16:16:50.857397 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:16:50.857934 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__0ca22fc4c44d" cascade
    
[0m16:16:50.858405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:16:50.958220 [debug] [Thread-1 (]: SQL status: OK in 0.100 seconds
[0m16:16:50.962640 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:16:50.963302 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:16:50.965147 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:16:50.967046 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:16:50.967530 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m16:16:50.968607 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:16:50.969044 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:16:50.969476 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m16:16:51.068165 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m16:16:51.070057 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:16:51.070665 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    

  
[0m16:16:51.071350 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:16:51.073249 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m16:16:51.073881 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:16:51.074439 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m16:16:51.176675 [debug] [Thread-1 (]: SQL status: OK in 0.101 seconds
[0m16:16:51.177910 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:16:51.178150 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_agenda__0ca22fc4c44d"
  
    as (
      

with __dbt__cte__stg_agenda as (
SELECT * 
FROM "database"."stg"."raw_agenda"
) SELECT * 
FROM __dbt__cte__stg_agenda
    );
  
  
  
[0m16:16:51.518233 [debug] [Thread-1 (]: SQL status: OK in 0.340 seconds
[0m16:16:51.522045 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:16:51.522260 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m16:16:51.522796 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:16:51.522961 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:16:51.523131 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda__0ca22fc4c44d'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:16:51.526478 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:16:51.529209 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:16:51.529423 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:16:51.531138 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:16:51.534869 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:16:51.535104 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:16:51.536719 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:16:51.537504 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:16:51.537683 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */
SELECT version()
[0m16:16:51.537994 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:16:51.546560 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_agenda"
[0m16:16:51.547106 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:16:51.547324 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

        
            delete from "an_data_pipeline"."main"."int_agenda" as DBT_INCREMENTAL_TARGET
            using "an_data_pipeline"."dbt_temp"."int_agenda__0ca22fc4c44d"
            where (
                
                    "an_data_pipeline"."dbt_temp"."int_agenda__0ca22fc4c44d".Date = DBT_INCREMENTAL_TARGET.Date
                    and 
                
                    "an_data_pipeline"."dbt_temp"."int_agenda__0ca22fc4c44d".Heure = DBT_INCREMENTAL_TARGET.Heure
                    
                
                
            );
        
    

    insert into "an_data_pipeline"."main"."int_agenda" ("Date", "Heure", "Ordre(s) du jour", "filename", "date_T_insert")
    (
        select "Date", "Heure", "Ordre(s) du jour", "filename", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_agenda__0ca22fc4c44d"
    )
  
[0m16:16:51.968815 [debug] [Thread-1 (]: SQL status: OK in 0.421 seconds
[0m16:16:51.983731 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m16:16:51.984429 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:16:51.984869 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m16:16:52.095007 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m16:16:52.102433 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:16:52.103064 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__0ca22fc4c44d" cascade
    
[0m16:16:52.300795 [debug] [Thread-1 (]: SQL status: OK in 0.197 seconds
[0m16:16:52.302948 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:16:52.303488 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__0ca22fc4c44d" cascade
    
[0m16:16:52.441035 [debug] [Thread-1 (]: SQL status: OK in 0.137 seconds
[0m16:16:52.443862 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: Close
[0m16:16:52.444424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71121d8b-e7f2-4a8e-9517-b9df34cb0994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10811ef30>]}
[0m16:16:52.445026 [info ] [Thread-1 (]: 3 of 11 OK created sql incremental model main.int_agenda ....................... [[32mOK[0m in 1.60s]
[0m16:16:52.445550 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_agenda
[0m16:16:52.445911 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements
[0m16:16:52.446423 [info ] [Thread-1 (]: 4 of 11 START sql incremental model main.int_amendements ....................... [RUN]
[0m16:16:52.446934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_agenda, now model.dbt_an_data.int_amendements)
[0m16:16:52.447312 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements
[0m16:16:52.464304 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements"
[0m16:16:52.465173 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements
[0m16:16:52.468040 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:16:52.468325 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__3ecc8c1a28c4" cascade
    
[0m16:16:52.468571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:16:52.578293 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m16:16:52.582064 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:16:52.582632 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:16:52.584252 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:16:52.585167 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:16:52.585404 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m16:16:52.586007 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:16:52.586301 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:16:52.586549 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m16:16:52.686433 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m16:16:52.689303 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:16:52.689876 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    

  
[0m16:16:52.690686 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:16:52.692656 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m16:16:52.693163 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:16:52.693602 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m16:16:52.786395 [debug] [Thread-1 (]: SQL status: OK in 0.092 seconds
[0m16:16:52.786891 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:16:52.787133 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_amendements__3ecc8c1a28c4"
  
    as (
      

with __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
) SELECT
	json_extract_string(json, '$.amendement.uid') AS uid,
	json_extract_string(json, '$.amendement.chronotag') AS chronotag,
	json_extract_string(json, '$.amendement.examenRef') AS examenRef,
	json_extract_string(json, '$.amendement.amendementParentRef') AS amendementParentRef,
	json_extract_string(json, '$.amendement.signataires.auteur.typeAuteur') AS typeAuteur,
	json_extract_string(json, '$.amendement.signataires.auteur.acteurRef') AS refAuteur,
	json_extract_string(json, '$.amendement.signataires.auteur.groupePolitique') AS groupePolitiqueAuteur,
	json_extract_string(json, '$.amendement.cycleDeVie.dateDepot') AS dateDepot,
	json_extract_string(json, '$.amendement.cycleDeVie.datePublication') AS datePublication,
	json_extract_string(json, '$.amendement.cycleDeVie.soumisArticle40') AS soumisArticle40,
	json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.code') AS codeEtat,
	json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.libelle') AS libelleEtat,
	json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.code') AS codeSousEtat,
	json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
	json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
	json_extract_string(json, '$.amendement.cycleDeVie.dateSort') AS dateSort,
	json_extract_string(json, '$.amendement.cycleDeVie.sort') AS sort,
	split_part(replace(filename, '.json', ''), '/', -1) AS id_amendement,
	split_part(replace(filename, '.json', ''), '/', -2) AS id_texte,
	split_part(replace(filename, '.json', ''), '/', -3) AS id_dossier_legislatif,
	id_texte[:4] AS nature_texte,
	id_texte[5:6] AS source_texte,
	regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 1) AS prefix_bibard,
	regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 2) AS numero_bibard,
	regexp_extract(id_amendement, '(SEA|PO\d*)', 1) AS code_organe,
	regexp_extract(id_amendement, '(P)(\d*)(D)', 2) AS numero_partie,
	regexp_extract(id_amendement, '(D)(\d*)(N)', 2) AS numero_deliberation,
	regexp_extract(id_amendement, '(D)(\d*)(N)(\d*)', 4) AS numero_court,
	date_T_insert
from __dbt__cte__stg_amendements


	LEFT JOIN "an_data_pipeline"."main"."int_amendements" AS target ON source.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:16:52.999019 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_amendements__3ecc8c1a28c4"
  
    as (
      

with __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
) SELECT
	json_extract_string(json, '$.amendement.uid') AS uid,
	json_extract_string(json, '$.amendement.chronotag') AS chronotag,
	json_extract_string(json, '$.amendement.examenRef') AS examenRef,
	json_extract_string(json, '$.amendement.amendementParentRef') AS amendementParentRef,
	json_extract_string(json, '$.amendement.signataires.auteur.typeAuteur') AS typeAuteur,
	json_extract_string(json, '$.amendement.signataires.auteur.acteurRef') AS refAuteur,
	json_extract_string(json, '$.amendement.signataires.auteur.groupePolitique') AS groupePolitiqueAuteur,
	json_extract_string(json, '$.amendement.cycleDeVie.dateDepot') AS dateDepot,
	json_extract_string(json, '$.amendement.cycleDeVie.datePublication') AS datePublication,
	json_extract_string(json, '$.amendement.cycleDeVie.soumisArticle40') AS soumisArticle40,
	json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.code') AS codeEtat,
	json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.libelle') AS libelleEtat,
	json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.code') AS codeSousEtat,
	json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
	json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
	json_extract_string(json, '$.amendement.cycleDeVie.dateSort') AS dateSort,
	json_extract_string(json, '$.amendement.cycleDeVie.sort') AS sort,
	split_part(replace(filename, '.json', ''), '/', -1) AS id_amendement,
	split_part(replace(filename, '.json', ''), '/', -2) AS id_texte,
	split_part(replace(filename, '.json', ''), '/', -3) AS id_dossier_legislatif,
	id_texte[:4] AS nature_texte,
	id_texte[5:6] AS source_texte,
	regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 1) AS prefix_bibard,
	regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 2) AS numero_bibard,
	regexp_extract(id_amendement, '(SEA|PO\d*)', 1) AS code_organe,
	regexp_extract(id_amendement, '(P)(\d*)(D)', 2) AS numero_partie,
	regexp_extract(id_amendement, '(D)(\d*)(N)', 2) AS numero_deliberation,
	regexp_extract(id_amendement, '(D)(\d*)(N)(\d*)', 4) AS numero_court,
	date_T_insert
from __dbt__cte__stg_amendements


	LEFT JOIN "an_data_pipeline"."main"."int_amendements" AS target ON source.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:16:52.999943 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:16:53.001558 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:16:53.001814 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__3ecc8c1a28c4" cascade
    
[0m16:16:53.101312 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m16:16:53.103218 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: Close
[0m16:16:53.108644 [debug] [Thread-1 (]: Runtime Error in model int_amendements (models/int/int_amendements.sql)
  Binder Error: Referenced table "source" not found!
  Candidate tables: "target"
  
  LINE 50: ... JOIN "an_data_pipeline"."main"."int_amendements" AS target ON source.uid = target.uid
                                                                             ^
[0m16:16:53.109480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71121d8b-e7f2-4a8e-9517-b9df34cb0994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10814ba40>]}
[0m16:16:53.110406 [error] [Thread-1 (]: 4 of 11 ERROR creating sql incremental model main.int_amendements .............. [[31mERROR[0m in 0.66s]
[0m16:16:53.111299 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements
[0m16:16:53.112113 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements_cosignataires
[0m16:16:53.112860 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.int_amendements' to be skipped because of status 'error'.  Reason: Runtime Error in model int_amendements (models/int/int_amendements.sql)
  Binder Error: Referenced table "source" not found!
  Candidate tables: "target"
  
  LINE 50: ... JOIN "an_data_pipeline"."main"."int_amendements" AS target ON source.uid = target.uid
                                                                             ^.
[0m16:16:53.113675 [info ] [Thread-1 (]: 5 of 11 START sql incremental model main.int_amendements_cosignataires ......... [RUN]
[0m16:16:53.114602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements, now model.dbt_an_data.int_amendements_cosignataires)
[0m16:16:53.115228 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements_cosignataires
[0m16:16:53.128218 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements_cosignataires"
[0m16:16:53.130662 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements_cosignataires
[0m16:16:53.134441 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:16:53.134829 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__89713e022d51" cascade
    
[0m16:16:53.135159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:16:53.234608 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m16:16:53.241836 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:16:53.242513 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:16:53.244502 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:16:53.246519 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:16:53.247052 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m16:16:53.247995 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:16:53.248397 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:16:53.248781 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m16:16:53.347325 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m16:16:53.349126 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:16:53.349763 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    

  
[0m16:16:53.350508 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:16:53.352381 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m16:16:53.353147 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:16:53.353612 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m16:16:53.446915 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m16:16:53.448202 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:16:53.448824 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__89713e022d51"
  
    as (
      

WITH  __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
), cosignataires_arr AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef[*]') AS acteurRef,
    date_T_insert
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') == 'ARRAY' AND acteurRef IS NOT NULL
), cosignataires_str AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef') AS acteurRef,
    date_T_insert
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') <> 'ARRAY' AND acteurRef IS NOT NULL
), result AS (
	SELECT 
		uid, 
		unnest(acteurRef) as acteurRef,
		date_T_insert
	FROM cosignataires_arr
	UNION ALL
	SELECT 
		uid, 
		acteurRef,
		date_T_insert
	FROM cosignataires_str
)
SELECT * 
FROM result


	LEFT JOIN "an_data_pipeline"."main"."int_amendements_cosignataires" AS target ON source.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:16:53.654144 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__89713e022d51"
  
    as (
      

WITH  __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
), cosignataires_arr AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef[*]') AS acteurRef,
    date_T_insert
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') == 'ARRAY' AND acteurRef IS NOT NULL
), cosignataires_str AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef') AS acteurRef,
    date_T_insert
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') <> 'ARRAY' AND acteurRef IS NOT NULL
), result AS (
	SELECT 
		uid, 
		unnest(acteurRef) as acteurRef,
		date_T_insert
	FROM cosignataires_arr
	UNION ALL
	SELECT 
		uid, 
		acteurRef,
		date_T_insert
	FROM cosignataires_str
)
SELECT * 
FROM result


	LEFT JOIN "an_data_pipeline"."main"."int_amendements_cosignataires" AS target ON source.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:16:53.654953 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:16:53.658249 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:16:53.658694 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__89713e022d51" cascade
    
[0m16:16:53.759624 [debug] [Thread-1 (]: SQL status: OK in 0.100 seconds
[0m16:16:53.761593 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: Close
[0m16:16:53.766220 [debug] [Thread-1 (]: Runtime Error in model int_amendements_cosignataires (models/int/int_amendements_cosignataires.sql)
  Binder Error: Referenced table "source" not found!
  Candidate tables: "result", "target"
  
  LINE 48: ...eline"."main"."int_amendements_cosignataires" AS target ON source.uid = target.uid
                                                                         ^
[0m16:16:53.767026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71121d8b-e7f2-4a8e-9517-b9df34cb0994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107862ae0>]}
[0m16:16:53.767793 [error] [Thread-1 (]: 5 of 11 ERROR creating sql incremental model main.int_amendements_cosignataires  [[31mERROR[0m in 0.65s]
[0m16:16:53.768564 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements_cosignataires
[0m16:16:53.769045 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_organes
[0m16:16:53.769485 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.int_amendements_cosignataires' to be skipped because of status 'error'.  Reason: Runtime Error in model int_amendements_cosignataires (models/int/int_amendements_cosignataires.sql)
  Binder Error: Referenced table "source" not found!
  Candidate tables: "result", "target"
  
  LINE 48: ...eline"."main"."int_amendements_cosignataires" AS target ON source.uid = target.uid
                                                                         ^.
[0m16:16:53.769922 [info ] [Thread-1 (]: 6 of 11 START sql incremental model main.int_organes ........................... [RUN]
[0m16:16:53.770440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements_cosignataires, now model.dbt_an_data.int_organes)
[0m16:16:53.770772 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_organes
[0m16:16:53.781466 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_organes"
[0m16:16:53.783668 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_organes
[0m16:16:53.793241 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:16:53.793912 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__60f7f3291791" cascade
    
[0m16:16:53.794311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:16:53.894562 [debug] [Thread-1 (]: SQL status: OK in 0.100 seconds
[0m16:16:53.898742 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:16:53.899319 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:16:53.901157 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:16:53.903027 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:16:53.903528 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m16:16:53.904620 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:16:53.905075 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:16:53.905517 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m16:16:54.010929 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m16:16:54.012970 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:16:54.013549 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    

  
[0m16:16:54.014197 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:16:54.016524 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m16:16:54.017220 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:16:54.017736 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m16:16:54.110987 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m16:16:54.111533 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:16:54.111751 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_organes__60f7f3291791"
  
    as (
      

with __dbt__cte__stg_organes as (
SELECT * 
FROM "database"."stg"."raw_organes"
) SELECT 
	json_extract_string(json, '$.organe.uid') as uid,
	json_extract_string(json, '$.organe.codeType') as codeType,
	json_extract_string(json, '$.organe.libelle') as libelle,
	json_extract_string(json, '$.organe.libelleEdition') as libelleEdition,
	json_extract_string(json, '$.organe.libelleAbrege') as libelleAbrege,
	json_extract_string(json, '$.organe.libelleAbrev') as libelleAbrev,
	json_extract_string(json, '$.organe.viMoDe.dateDebut') as dateDebut,
	json_extract_string(json, '$.organe.viMoDe.dateAgrement') as dateAgrement,
	json_extract_string(json, '$.organe.viMoDe.dateFin') as dateFin,
	json_extract_string(json, '$.organe.organeParent') as organeParent,
	json_extract_string(json, '$.organe.chambre') as chambre,
	json_extract_string(json, '$.organe.regime') as regime,
	json_extract_string(json, '$.organe.legislature') as legislature,
	date_T_insert
FROM __dbt__cte__stg_organes


	LEFT JOIN "an_data_pipeline"."main"."int_organes" AS target ON source.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:16:54.308566 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_organes__60f7f3291791"
  
    as (
      

with __dbt__cte__stg_organes as (
SELECT * 
FROM "database"."stg"."raw_organes"
) SELECT 
	json_extract_string(json, '$.organe.uid') as uid,
	json_extract_string(json, '$.organe.codeType') as codeType,
	json_extract_string(json, '$.organe.libelle') as libelle,
	json_extract_string(json, '$.organe.libelleEdition') as libelleEdition,
	json_extract_string(json, '$.organe.libelleAbrege') as libelleAbrege,
	json_extract_string(json, '$.organe.libelleAbrev') as libelleAbrev,
	json_extract_string(json, '$.organe.viMoDe.dateDebut') as dateDebut,
	json_extract_string(json, '$.organe.viMoDe.dateAgrement') as dateAgrement,
	json_extract_string(json, '$.organe.viMoDe.dateFin') as dateFin,
	json_extract_string(json, '$.organe.organeParent') as organeParent,
	json_extract_string(json, '$.organe.chambre') as chambre,
	json_extract_string(json, '$.organe.regime') as regime,
	json_extract_string(json, '$.organe.legislature') as legislature,
	date_T_insert
FROM __dbt__cte__stg_organes


	LEFT JOIN "an_data_pipeline"."main"."int_organes" AS target ON source.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:16:54.309230 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:16:54.311995 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:16:54.312427 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__60f7f3291791" cascade
    
[0m16:16:54.413111 [debug] [Thread-1 (]: SQL status: OK in 0.100 seconds
[0m16:16:54.414962 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: Close
[0m16:16:54.418295 [debug] [Thread-1 (]: Runtime Error in model int_organes (models/int/int_organes.sql)
  Binder Error: Referenced table "source" not found!
  Candidate tables: "target"
  
  LINE 35: ... JOIN "an_data_pipeline"."main"."int_organes" AS target ON source.uid = target.uid
                                                                         ^
[0m16:16:54.418670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71121d8b-e7f2-4a8e-9517-b9df34cb0994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b09ac0>]}
[0m16:16:54.419026 [error] [Thread-1 (]: 6 of 11 ERROR creating sql incremental model main.int_organes .................. [[31mERROR[0m in 0.65s]
[0m16:16:54.419332 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_organes
[0m16:16:54.419527 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_pays
[0m16:16:54.419735 [info ] [Thread-1 (]: 7 of 11 START sql incremental model main.int_pays .............................. [RUN]
[0m16:16:54.419972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_organes, now model.dbt_an_data.int_pays)
[0m16:16:54.420139 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_pays
[0m16:16:54.425306 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_pays"
[0m16:16:54.425638 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.int_organes' to be skipped because of status 'error'.  Reason: Runtime Error in model int_organes (models/int/int_organes.sql)
  Binder Error: Referenced table "source" not found!
  Candidate tables: "target"
  
  LINE 35: ... JOIN "an_data_pipeline"."main"."int_organes" AS target ON source.uid = target.uid
                                                                         ^.
[0m16:16:54.426180 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_pays
[0m16:16:54.428058 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:16:54.428245 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__146a0f9d3db6" cascade
    
[0m16:16:54.428405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:16:54.528022 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m16:16:54.532951 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:16:54.533727 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:16:54.535793 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:16:54.538012 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:16:54.538555 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m16:16:54.539718 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:16:54.540186 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:16:54.540633 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m16:16:54.648327 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m16:16:54.653102 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:16:54.653471 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    

  
[0m16:16:54.653732 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:16:54.654452 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m16:16:54.654644 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:16:54.654794 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m16:16:54.748714 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m16:16:54.750374 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:16:54.751102 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_pays__146a0f9d3db6"
  
    as (
      

with __dbt__cte__stg_pays as (
SELECT * 
FROM "database"."stg"."raw_pays"
) SELECT
	json_extract_string(json, '$.pays.uid') as uid,
	json_extract_string(json, '$.pays.code_insee') as code_insee,
	json_extract_string(json, '$.pays.libelleInsee') as libelleInsee,
	json_extract_string(json, '$.pays.nomCourant') as nomCourant,
	json_extract_string(json, '$.pays.code_iso2A') as code_iso2A,
	json_extract_string(json, '$.pays.code_iso3A') as code_iso3A,
	json_extract_string(json, '$.pays.code_iso3N') as code_iso3N,
	json_extract_string(json, '$.pays.libelleIso') as libelleIso,
	json_extract_string(json, '$.pays.libelleANCourt') as libelleANCourt,
	json_extract_string(json, '$.pays.libelleANLong') as libelleANLong,
	json_extract_string(json, '$.pays.sourceJuridique') as sourceJuridique,
	json_extract_string(json, '$.pays.activ') as activ,
	date_T_insert
FROM __dbt__cte__stg_pays


	LEFT JOIN "an_data_pipeline"."main"."int_pays" AS target ON source.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:16:54.954648 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_pays__146a0f9d3db6"
  
    as (
      

with __dbt__cte__stg_pays as (
SELECT * 
FROM "database"."stg"."raw_pays"
) SELECT
	json_extract_string(json, '$.pays.uid') as uid,
	json_extract_string(json, '$.pays.code_insee') as code_insee,
	json_extract_string(json, '$.pays.libelleInsee') as libelleInsee,
	json_extract_string(json, '$.pays.nomCourant') as nomCourant,
	json_extract_string(json, '$.pays.code_iso2A') as code_iso2A,
	json_extract_string(json, '$.pays.code_iso3A') as code_iso3A,
	json_extract_string(json, '$.pays.code_iso3N') as code_iso3N,
	json_extract_string(json, '$.pays.libelleIso') as libelleIso,
	json_extract_string(json, '$.pays.libelleANCourt') as libelleANCourt,
	json_extract_string(json, '$.pays.libelleANLong') as libelleANLong,
	json_extract_string(json, '$.pays.sourceJuridique') as sourceJuridique,
	json_extract_string(json, '$.pays.activ') as activ,
	date_T_insert
FROM __dbt__cte__stg_pays


	LEFT JOIN "an_data_pipeline"."main"."int_pays" AS target ON source.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:16:54.955439 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:16:54.961197 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:16:54.961631 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__146a0f9d3db6" cascade
    
[0m16:16:55.075195 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m16:16:55.075900 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: Close
[0m16:16:55.077694 [debug] [Thread-1 (]: Runtime Error in model int_pays (models/int/int_pays.sql)
  Binder Error: Referenced table "source" not found!
  Candidate tables: "target"
  
  LINE 34: ...	LEFT JOIN "an_data_pipeline"."main"."int_pays" AS target ON source.uid = target.uid
                                                                          ^
[0m16:16:55.078307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71121d8b-e7f2-4a8e-9517-b9df34cb0994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108138fe0>]}
[0m16:16:55.078726 [error] [Thread-1 (]: 7 of 11 ERROR creating sql incremental model main.int_pays ..................... [[31mERROR[0m in 0.66s]
[0m16:16:55.079129 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_pays
[0m16:16:55.079379 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_reunions
[0m16:16:55.079637 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.int_pays' to be skipped because of status 'error'.  Reason: Runtime Error in model int_pays (models/int/int_pays.sql)
  Binder Error: Referenced table "source" not found!
  Candidate tables: "target"
  
  LINE 34: ...	LEFT JOIN "an_data_pipeline"."main"."int_pays" AS target ON source.uid = target.uid
                                                                          ^.
[0m16:16:55.079911 [info ] [Thread-1 (]: 8 of 11 START sql incremental model main.int_reunions .......................... [RUN]
[0m16:16:55.080564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_pays, now model.dbt_an_data.int_reunions)
[0m16:16:55.080771 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_reunions
[0m16:16:55.091131 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_reunions"
[0m16:16:55.092378 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_reunions
[0m16:16:55.095364 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:16:55.095647 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__e4ebfa1bb496" cascade
    
[0m16:16:55.095819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:16:55.195940 [debug] [Thread-1 (]: SQL status: OK in 0.100 seconds
[0m16:16:55.198782 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:16:55.199150 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:16:55.200294 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:16:55.201359 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:16:55.201641 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m16:16:55.202246 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:16:55.202485 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:16:55.202718 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m16:16:55.301908 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m16:16:55.303887 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:16:55.304419 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    

  
[0m16:16:55.304950 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:16:55.306405 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m16:16:55.306836 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:16:55.307088 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m16:16:55.402261 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m16:16:55.405077 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:16:55.406091 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_reunions__e4ebfa1bb496"
  
    as (
      

with __dbt__cte__stg_reunions as (
SELECT * 
FROM "database"."stg"."raw_reunions"
) SELECT
	json_extract_string(json, '$.reunion.uid') AS uid,
	json_extract_string(json, '$.reunion.timeStampDebut') AS timeStampDebut,
	json_extract_string(json, '$.reunion.lieu.lieuRef') AS lieuRef,
	json_extract_string(json, '$.reunion.lieu.libelleLong') AS lieuLibelle,
	json_extract_string(json, '$.reunion.cycleDeVie.etat') AS cycleDeVieEtat,
	json_extract_string(json, '$.reunion.demandeur') AS demandeur,
	json_extract_string(json, '$.reunion.organeReuniRef') AS organeReuniRef,
	json_extract_string(json, '$.reunion.visioConference') AS visioConference,
	json_extract_string(json, '$.reunion.sessionRef') AS sessionRef,
	json_extract_string(json, '$.reunion.ouverturePresse') AS ouverturePresse,
	json_extract_string(json, '$.reunion.captationVideo') AS captationVideo,
	json_extract_string(json, '$.reunion.ODJ.convocationODJ.item') AS convocationODJ,
	json_extract_string(json, '$.reunion.ODJ.resumeODJ.item') AS resumeODJ,
	json_extract_string(json, '$.reunion.compteRenduRef') AS compteRenduRef,
	json_extract_string(json, '$.reunion.identifiants.numSeanceJO') AS numSeanceJO,
	json_extract_string(json, '$.reunion.identifiants.idJO') AS idJO,
	json_extract_string(json, '$.reunion.identifiants.quantieme') AS quantieme,
	json_extract_string(json, '$.reunion.identifiants.DataSeance') AS DataSeance,
	date_T_insert
FROM __dbt__cte__stg_reunions


	LEFT JOIN "an_data_pipeline"."main"."int_reunions" AS target ON source.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:16:55.604771 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_reunions__e4ebfa1bb496"
  
    as (
      

with __dbt__cte__stg_reunions as (
SELECT * 
FROM "database"."stg"."raw_reunions"
) SELECT
	json_extract_string(json, '$.reunion.uid') AS uid,
	json_extract_string(json, '$.reunion.timeStampDebut') AS timeStampDebut,
	json_extract_string(json, '$.reunion.lieu.lieuRef') AS lieuRef,
	json_extract_string(json, '$.reunion.lieu.libelleLong') AS lieuLibelle,
	json_extract_string(json, '$.reunion.cycleDeVie.etat') AS cycleDeVieEtat,
	json_extract_string(json, '$.reunion.demandeur') AS demandeur,
	json_extract_string(json, '$.reunion.organeReuniRef') AS organeReuniRef,
	json_extract_string(json, '$.reunion.visioConference') AS visioConference,
	json_extract_string(json, '$.reunion.sessionRef') AS sessionRef,
	json_extract_string(json, '$.reunion.ouverturePresse') AS ouverturePresse,
	json_extract_string(json, '$.reunion.captationVideo') AS captationVideo,
	json_extract_string(json, '$.reunion.ODJ.convocationODJ.item') AS convocationODJ,
	json_extract_string(json, '$.reunion.ODJ.resumeODJ.item') AS resumeODJ,
	json_extract_string(json, '$.reunion.compteRenduRef') AS compteRenduRef,
	json_extract_string(json, '$.reunion.identifiants.numSeanceJO') AS numSeanceJO,
	json_extract_string(json, '$.reunion.identifiants.idJO') AS idJO,
	json_extract_string(json, '$.reunion.identifiants.quantieme') AS quantieme,
	json_extract_string(json, '$.reunion.identifiants.DataSeance') AS DataSeance,
	date_T_insert
FROM __dbt__cte__stg_reunions


	LEFT JOIN "an_data_pipeline"."main"."int_reunions" AS target ON source.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:16:55.605391 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:16:55.607144 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:16:55.607409 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__e4ebfa1bb496" cascade
    
[0m16:16:55.706283 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m16:16:55.708140 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: Close
[0m16:16:55.712791 [debug] [Thread-1 (]: Runtime Error in model int_reunions (models/int/int_reunions.sql)
  Binder Error: Referenced table "source" not found!
  Candidate tables: "target"
  
  LINE 40: ... JOIN "an_data_pipeline"."main"."int_reunions" AS target ON source.uid = target.uid
                                                                          ^
[0m16:16:55.713266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71121d8b-e7f2-4a8e-9517-b9df34cb0994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a10350>]}
[0m16:16:55.713650 [error] [Thread-1 (]: 8 of 11 ERROR creating sql incremental model main.int_reunions ................. [[31mERROR[0m in 0.63s]
[0m16:16:55.713939 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_reunions
[0m16:16:55.714159 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins
[0m16:16:55.714372 [info ] [Thread-1 (]: 9 of 11 START sql incremental model main.int_scrutins .......................... [RUN]
[0m16:16:55.714611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_reunions, now model.dbt_an_data.int_scrutins)
[0m16:16:55.714785 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins
[0m16:16:55.721696 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.int_reunions' to be skipped because of status 'error'.  Reason: Runtime Error in model int_reunions (models/int/int_reunions.sql)
  Binder Error: Referenced table "source" not found!
  Candidate tables: "target"
  
  LINE 40: ... JOIN "an_data_pipeline"."main"."int_reunions" AS target ON source.uid = target.uid
                                                                          ^.
[0m16:16:55.728255 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins"
[0m16:16:55.729182 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins
[0m16:16:55.731643 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:16:55.731901 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__5266a66fe8be" cascade
    
[0m16:16:55.732119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:16:55.833461 [debug] [Thread-1 (]: SQL status: OK in 0.101 seconds
[0m16:16:55.837460 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:16:55.837873 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:16:55.838703 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:16:55.839433 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:16:55.839609 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m16:16:55.839996 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:16:55.840146 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:16:55.840292 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m16:16:55.941961 [debug] [Thread-1 (]: SQL status: OK in 0.101 seconds
[0m16:16:55.943928 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:16:55.944434 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    

  
[0m16:16:55.944986 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:16:55.946342 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m16:16:55.946637 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:16:55.946823 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m16:16:56.041607 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m16:16:56.043499 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:16:56.044329 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_scrutins__5266a66fe8be"
  
    as (
      

with __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
) SELECT
	date_T_insert,
	json_extract_string(json, '$.scrutin.uid') AS uid,
	json_extract_string(json, '$.scrutin.numero') AS numero,
	json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
	json_extract_string(json, '$.scrutin.legislature') AS legislature,
	json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
	json_extract_string(json, '$.scrutin.titre') AS titre,
	json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
	json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
	json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
	json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
	json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
	json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote,
	date_T_insert
FROM __dbt__cte__stg_scrutins source


	LEFT JOIN "an_data_pipeline"."main"."int_scrutins" AS target ON source.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:16:56.245952 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_scrutins__5266a66fe8be"
  
    as (
      

with __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
) SELECT
	date_T_insert,
	json_extract_string(json, '$.scrutin.uid') AS uid,
	json_extract_string(json, '$.scrutin.numero') AS numero,
	json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
	json_extract_string(json, '$.scrutin.legislature') AS legislature,
	json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
	json_extract_string(json, '$.scrutin.titre') AS titre,
	json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
	json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
	json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
	json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
	json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
	json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote,
	date_T_insert
FROM __dbt__cte__stg_scrutins source


	LEFT JOIN "an_data_pipeline"."main"."int_scrutins" AS target ON source.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:16:56.246374 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:16:56.247661 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:16:56.247851 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__5266a66fe8be" cascade
    
[0m16:16:56.346556 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m16:16:56.348170 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: Close
[0m16:16:56.352529 [debug] [Thread-1 (]: Runtime Error in model int_scrutins (models/int/int_scrutins.sql)
  Binder Error: Values list "source" does not have a column named "uid"
  
  LINE 35: ... JOIN "an_data_pipeline"."main"."int_scrutins" AS target ON source.uid = target.uid
                                                                          ^
[0m16:16:56.352886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71121d8b-e7f2-4a8e-9517-b9df34cb0994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10813e660>]}
[0m16:16:56.353229 [error] [Thread-1 (]: 9 of 11 ERROR creating sql incremental model main.int_scrutins ................. [[31mERROR[0m in 0.64s]
[0m16:16:56.353506 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins
[0m16:16:56.353696 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins_votes
[0m16:16:56.353894 [info ] [Thread-1 (]: 10 of 11 START sql incremental model main.int_scrutins_votes ................... [RUN]
[0m16:16:56.354155 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.int_scrutins' to be skipped because of status 'error'.  Reason: Runtime Error in model int_scrutins (models/int/int_scrutins.sql)
  Binder Error: Values list "source" does not have a column named "uid"
  
  LINE 35: ... JOIN "an_data_pipeline"."main"."int_scrutins" AS target ON source.uid = target.uid
                                                                          ^.
[0m16:16:56.354393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_scrutins, now model.dbt_an_data.int_scrutins_votes)
[0m16:16:56.354691 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins_votes
[0m16:16:56.372100 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins_votes"
[0m16:16:56.373175 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins_votes
[0m16:16:56.375131 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:16:56.375324 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__dbaef595fdd2" cascade
    
[0m16:16:56.375487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:16:56.474290 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m16:16:56.477948 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:16:56.478688 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:16:56.480700 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:16:56.481648 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:16:56.481862 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m16:16:56.482482 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:16:56.482702 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:16:56.482883 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m16:16:56.579940 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m16:16:56.581594 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:16:56.582103 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    

  
[0m16:16:56.582672 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:16:56.584215 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m16:16:56.584823 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:16:56.585122 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m16:16:56.678757 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m16:16:56.680624 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:16:56.681774 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_scrutins_votes__dbaef595fdd2"
  
    as (
      

WITH  __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
), grp AS (
	-- explode les groupes (1 par groupe)
SELECT
	json_extract_string(j.json, '$.scrutin.uid') AS uid,
	json_extract_string(g.value, '$.organeRef') AS groupe_organe,
	g.value AS groupe_json,
	j.date_T_insert
FROM __dbt__cte__stg_scrutins j,
json_each(json->'scrutin'->'ventilationVotes'->'organe'->'groupes'->'groupe') g
),

positions_array AS (
	-- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
	SELECT
		uid,
		date_T_insert,
		groupe_organe,
		'pour' AS type_vote,
		p.value AS vote_json
	FROM grp,
		json_each(groupe_json->'vote'->'decompteNominatif'->'pours'->'votant') p
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[ARRAY]'

	UNION ALL
	SELECT
		uid,
		date_T_insert,
		groupe_organe,
		'contre' AS type_vote,
		c.value AS vote_json
	FROM grp,
		json_each(groupe_json->'vote'->'decompteNominatif'->'contres'->'votant') c
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[ARRAY]'

	UNION ALL
	SELECT
		uid,
		date_T_insert,
		groupe_organe,
		'abstention' AS type_vote,
		a.value AS vote_json
	FROM grp,
		json_each(groupe_json->'vote'->'decompteNominatif'->'abstentions'->'votant') a
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[ARRAY]'

	UNION ALL
	SELECT
		uid,
		date_T_insert,
		groupe_organe,
		'nonVotant' AS type_vote,
		n.value AS vote_json
	FROM grp,
			json_each(groupe_json->'vote'->'decompteNominatif'->'nonVotants'->'votant') n
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[ARRAY]'
),
positions_object AS (
	-- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
	SELECT
		uid,
		groupe_organe,
		'pour' AS type_vote,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.acteurRef') AS acteurRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.mandatRef') AS mandatRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.parDelegation') AS parDelegation,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.numPlace') AS numPlace,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.causePositionVote') AS cause,
		date_T_insert
	FROM grp
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[OBJECT]'

	UNION ALL
	SELECT
		uid,
		groupe_organe,
		'contre' AS type_vote,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.acteurRef') AS acteurRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.mandatRef') AS mandatRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.parDelegation') AS parDelegation,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.numPlace') AS numPlace,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.causePositionVote') AS cause,
		date_T_insert
	FROM grp
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[OBJECT]'

	UNION ALL
	SELECT
		uid,
		groupe_organe,
		'abstention' AS type_vote,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.acteurRef') AS acteurRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.mandatRef') AS mandatRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.parDelegation') AS parDelegation,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.numPlace') AS numPlace,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.causePositionVote') AS cause,
		date_T_insert
	FROM grp
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[OBJECT]'

	UNION ALL
	SELECT
		uid,
		groupe_organe,
		'nonVotant' AS type_vote,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.acteurRef') AS acteurRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.mandatRef') AS mandatRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.parDelegation') AS parDelegation,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.numPlace') AS numPlace,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.causePositionVote') AS cause,
		date_T_insert
	FROM grp
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[OBJECT]'
),

clean AS (
	-- sécurise les champs (souvent string ou null)
	SELECT
		uid,
		groupe_organe,
		type_vote,
		json_extract_string(vote_json, '$.acteurRef') AS acteurRef,
		json_extract_string(vote_json, '$.mandatRef') AS mandatRef,
		json_extract_string(vote_json, '$.parDelegation') AS parDelegation,
		json_extract_string(vote_json, '$.numPlace') AS numPlace,
		json_extract_string(vote_json, '$.causePositionVote') AS cause,
		date_T_insert
	FROM positions_array
	UNION ALL
	SELECT * 
	FROM positions_object
)

SELECT * FROM clean


	LEFT JOIN "an_data_pipeline"."main"."int_scrutins_votes" AS target ON source.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:16:56.892513 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_scrutins_votes__dbaef595fdd2"
  
    as (
      

WITH  __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
), grp AS (
	-- explode les groupes (1 par groupe)
SELECT
	json_extract_string(j.json, '$.scrutin.uid') AS uid,
	json_extract_string(g.value, '$.organeRef') AS groupe_organe,
	g.value AS groupe_json,
	j.date_T_insert
FROM __dbt__cte__stg_scrutins j,
json_each(json->'scrutin'->'ventilationVotes'->'organe'->'groupes'->'groupe') g
),

positions_array AS (
	-- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
	SELECT
		uid,
		date_T_insert,
		groupe_organe,
		'pour' AS type_vote,
		p.value AS vote_json
	FROM grp,
		json_each(groupe_json->'vote'->'decompteNominatif'->'pours'->'votant') p
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[ARRAY]'

	UNION ALL
	SELECT
		uid,
		date_T_insert,
		groupe_organe,
		'contre' AS type_vote,
		c.value AS vote_json
	FROM grp,
		json_each(groupe_json->'vote'->'decompteNominatif'->'contres'->'votant') c
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[ARRAY]'

	UNION ALL
	SELECT
		uid,
		date_T_insert,
		groupe_organe,
		'abstention' AS type_vote,
		a.value AS vote_json
	FROM grp,
		json_each(groupe_json->'vote'->'decompteNominatif'->'abstentions'->'votant') a
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[ARRAY]'

	UNION ALL
	SELECT
		uid,
		date_T_insert,
		groupe_organe,
		'nonVotant' AS type_vote,
		n.value AS vote_json
	FROM grp,
			json_each(groupe_json->'vote'->'decompteNominatif'->'nonVotants'->'votant') n
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[ARRAY]'
),
positions_object AS (
	-- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
	SELECT
		uid,
		groupe_organe,
		'pour' AS type_vote,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.acteurRef') AS acteurRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.mandatRef') AS mandatRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.parDelegation') AS parDelegation,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.numPlace') AS numPlace,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.causePositionVote') AS cause,
		date_T_insert
	FROM grp
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[OBJECT]'

	UNION ALL
	SELECT
		uid,
		groupe_organe,
		'contre' AS type_vote,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.acteurRef') AS acteurRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.mandatRef') AS mandatRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.parDelegation') AS parDelegation,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.numPlace') AS numPlace,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.causePositionVote') AS cause,
		date_T_insert
	FROM grp
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[OBJECT]'

	UNION ALL
	SELECT
		uid,
		groupe_organe,
		'abstention' AS type_vote,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.acteurRef') AS acteurRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.mandatRef') AS mandatRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.parDelegation') AS parDelegation,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.numPlace') AS numPlace,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.causePositionVote') AS cause,
		date_T_insert
	FROM grp
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[OBJECT]'

	UNION ALL
	SELECT
		uid,
		groupe_organe,
		'nonVotant' AS type_vote,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.acteurRef') AS acteurRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.mandatRef') AS mandatRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.parDelegation') AS parDelegation,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.numPlace') AS numPlace,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.causePositionVote') AS cause,
		date_T_insert
	FROM grp
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[OBJECT]'
),

clean AS (
	-- sécurise les champs (souvent string ou null)
	SELECT
		uid,
		groupe_organe,
		type_vote,
		json_extract_string(vote_json, '$.acteurRef') AS acteurRef,
		json_extract_string(vote_json, '$.mandatRef') AS mandatRef,
		json_extract_string(vote_json, '$.parDelegation') AS parDelegation,
		json_extract_string(vote_json, '$.numPlace') AS numPlace,
		json_extract_string(vote_json, '$.causePositionVote') AS cause,
		date_T_insert
	FROM positions_array
	UNION ALL
	SELECT * 
	FROM positions_object
)

SELECT * FROM clean


	LEFT JOIN "an_data_pipeline"."main"."int_scrutins_votes" AS target ON source.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:16:56.892958 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:16:56.894211 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:16:56.894397 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__dbaef595fdd2" cascade
    
[0m16:16:57.002799 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m16:16:57.004571 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: Close
[0m16:16:57.008046 [debug] [Thread-1 (]: Runtime Error in model int_scrutins_votes (models/int/int_scrutins_votes.sql)
  Binder Error: Referenced table "source" not found!
  Candidate tables: "target"
  
  LINE 152: ... "an_data_pipeline"."main"."int_scrutins_votes" AS target ON source.uid = target.uid
                                                                            ^
[0m16:16:57.008385 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71121d8b-e7f2-4a8e-9517-b9df34cb0994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075bc830>]}
[0m16:16:57.008710 [error] [Thread-1 (]: 10 of 11 ERROR creating sql incremental model main.int_scrutins_votes .......... [[31mERROR[0m in 0.65s]
[0m16:16:57.008980 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins_votes
[0m16:16:57.009163 [debug] [Thread-1 (]: Began running node model.dbt_an_data.mart_check_insert_dates
[0m16:16:57.009343 [info ] [Thread-1 (]: 11 of 11 SKIP relation main.mart_check_insert_dates ............................ [[33mSKIP[0m]
[0m16:16:57.009524 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.mart_check_insert_dates
[0m16:16:57.009726 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.int_scrutins_votes' to be skipped because of status 'error'.  Reason: Runtime Error in model int_scrutins_votes (models/int/int_scrutins_votes.sql)
  Binder Error: Referenced table "source" not found!
  Candidate tables: "target"
  
  LINE 152: ... "an_data_pipeline"."main"."int_scrutins_votes" AS target ON source.uid = target.uid
                                                                            ^.
[0m16:16:57.010396 [debug] [MainThread]: Using duckdb connection "master"
[0m16:16:57.010550 [debug] [MainThread]: On master: BEGIN
[0m16:16:57.010685 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:16:57.011853 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:16:57.012825 [debug] [MainThread]: On master: COMMIT
[0m16:16:57.013073 [debug] [MainThread]: Using duckdb connection "master"
[0m16:16:57.013219 [debug] [MainThread]: On master: COMMIT
[0m16:16:57.013592 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:16:57.013734 [debug] [MainThread]: On master: Close
[0m16:16:57.013940 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:16:57.014069 [debug] [MainThread]: Connection 'model.dbt_an_data.int_scrutins_votes' was properly closed.
[0m16:16:57.014266 [info ] [MainThread]: 
[0m16:16:57.014424 [info ] [MainThread]: Finished running 10 incremental models, 1 project hook, 1 view model in 0 hours 0 minutes and 11.64 seconds (11.64s).
[0m16:16:57.015296 [debug] [MainThread]: Command end result
[0m16:16:57.029492 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m16:16:57.031176 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m16:16:57.034218 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m16:16:57.034394 [info ] [MainThread]: 
[0m16:16:57.034578 [info ] [MainThread]: [31mCompleted with 9 errors, 0 partial successes, and 0 warnings:[0m
[0m16:16:57.034729 [info ] [MainThread]: 
[0m16:16:57.034913 [error] [MainThread]: [31mFailure in model int_acteurs (models/int/int_acteurs.sql)[0m
[0m16:16:57.035088 [error] [MainThread]:   Runtime Error in model int_acteurs (models/int/int_acteurs.sql)
  Binder Error: Referenced table "source" not found!
  Candidate tables: "target"
  
  LINE 36: ... JOIN "an_data_pipeline"."main"."int_acteurs" AS target ON source.uid = target.uid
                                                                         ^
[0m16:16:57.035218 [info ] [MainThread]: 
[0m16:16:57.035367 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/int/int_acteurs.sql
[0m16:16:57.035495 [info ] [MainThread]: 
[0m16:16:57.035648 [error] [MainThread]: [31mFailure in model int_mandats (models/int/int_mandats.sql)[0m
[0m16:16:57.035801 [error] [MainThread]:   Runtime Error in model int_mandats (models/int/int_mandats.sql)
  Binder Error: Referenced table "source" not found!
  Candidate tables: "act"
  
  LINE 32: ... JOIN "an_data_pipeline"."main"."int_mandats" AS target ON source.uid = target.uid
                                                                         ^
[0m16:16:57.035922 [info ] [MainThread]: 
[0m16:16:57.036063 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/int/int_mandats.sql
[0m16:16:57.036184 [info ] [MainThread]: 
[0m16:16:57.036330 [error] [MainThread]: [31mFailure in model int_amendements (models/int/int_amendements.sql)[0m
[0m16:16:57.036480 [error] [MainThread]:   Runtime Error in model int_amendements (models/int/int_amendements.sql)
  Binder Error: Referenced table "source" not found!
  Candidate tables: "target"
  
  LINE 50: ... JOIN "an_data_pipeline"."main"."int_amendements" AS target ON source.uid = target.uid
                                                                             ^
[0m16:16:57.036601 [info ] [MainThread]: 
[0m16:16:57.036792 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/int/int_amendements.sql
[0m16:16:57.036974 [info ] [MainThread]: 
[0m16:16:57.037153 [error] [MainThread]: [31mFailure in model int_amendements_cosignataires (models/int/int_amendements_cosignataires.sql)[0m
[0m16:16:57.037327 [error] [MainThread]:   Runtime Error in model int_amendements_cosignataires (models/int/int_amendements_cosignataires.sql)
  Binder Error: Referenced table "source" not found!
  Candidate tables: "result", "target"
  
  LINE 48: ...eline"."main"."int_amendements_cosignataires" AS target ON source.uid = target.uid
                                                                         ^
[0m16:16:57.037473 [info ] [MainThread]: 
[0m16:16:57.037628 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/int/int_amendements_cosignataires.sql
[0m16:16:57.037759 [info ] [MainThread]: 
[0m16:16:57.037914 [error] [MainThread]: [31mFailure in model int_organes (models/int/int_organes.sql)[0m
[0m16:16:57.038072 [error] [MainThread]:   Runtime Error in model int_organes (models/int/int_organes.sql)
  Binder Error: Referenced table "source" not found!
  Candidate tables: "target"
  
  LINE 35: ... JOIN "an_data_pipeline"."main"."int_organes" AS target ON source.uid = target.uid
                                                                         ^
[0m16:16:57.038196 [info ] [MainThread]: 
[0m16:16:57.038341 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/int/int_organes.sql
[0m16:16:57.038465 [info ] [MainThread]: 
[0m16:16:57.038613 [error] [MainThread]: [31mFailure in model int_pays (models/int/int_pays.sql)[0m
[0m16:16:57.038767 [error] [MainThread]:   Runtime Error in model int_pays (models/int/int_pays.sql)
  Binder Error: Referenced table "source" not found!
  Candidate tables: "target"
  
  LINE 34: ...	LEFT JOIN "an_data_pipeline"."main"."int_pays" AS target ON source.uid = target.uid
                                                                          ^
[0m16:16:57.038892 [info ] [MainThread]: 
[0m16:16:57.039033 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/int/int_pays.sql
[0m16:16:57.039184 [info ] [MainThread]: 
[0m16:16:57.039353 [error] [MainThread]: [31mFailure in model int_reunions (models/int/int_reunions.sql)[0m
[0m16:16:57.039513 [error] [MainThread]:   Runtime Error in model int_reunions (models/int/int_reunions.sql)
  Binder Error: Referenced table "source" not found!
  Candidate tables: "target"
  
  LINE 40: ... JOIN "an_data_pipeline"."main"."int_reunions" AS target ON source.uid = target.uid
                                                                          ^
[0m16:16:57.039643 [info ] [MainThread]: 
[0m16:16:57.039787 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/int/int_reunions.sql
[0m16:16:57.039911 [info ] [MainThread]: 
[0m16:16:57.040059 [error] [MainThread]: [31mFailure in model int_scrutins (models/int/int_scrutins.sql)[0m
[0m16:16:57.040212 [error] [MainThread]:   Runtime Error in model int_scrutins (models/int/int_scrutins.sql)
  Binder Error: Values list "source" does not have a column named "uid"
  
  LINE 35: ... JOIN "an_data_pipeline"."main"."int_scrutins" AS target ON source.uid = target.uid
                                                                          ^
[0m16:16:57.040348 [info ] [MainThread]: 
[0m16:16:57.040489 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/int/int_scrutins.sql
[0m16:16:57.040616 [info ] [MainThread]: 
[0m16:16:57.040765 [error] [MainThread]: [31mFailure in model int_scrutins_votes (models/int/int_scrutins_votes.sql)[0m
[0m16:16:57.040920 [error] [MainThread]:   Runtime Error in model int_scrutins_votes (models/int/int_scrutins_votes.sql)
  Binder Error: Referenced table "source" not found!
  Candidate tables: "target"
  
  LINE 152: ... "an_data_pipeline"."main"."int_scrutins_votes" AS target ON source.uid = target.uid
                                                                            ^
[0m16:16:57.041104 [info ] [MainThread]: 
[0m16:16:57.041271 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/int/int_scrutins_votes.sql
[0m16:16:57.041405 [info ] [MainThread]: 
[0m16:16:57.041581 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=9 SKIP=1 NO-OP=0 TOTAL=12
[0m16:16:57.042192 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.264139, "process_in_blocks": "0", "process_kernel_time": 0.490699, "process_mem_max_rss": "182304768", "process_out_blocks": "0", "process_user_time": 2.967894}
[0m16:16:57.042417 [debug] [MainThread]: Command `dbt run` failed at 16:16:57.042376 after 12.26 seconds
[0m16:16:57.042614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038756a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b0e3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee7170>]}
[0m16:16:57.042792 [debug] [MainThread]: Flushing usage events
[0m16:16:57.608773 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:26:19.687362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e8b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106697920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106695520>]}


============================== 16:26:19.690745 | 057ce264-c2a4-4eb4-8a5a-ebad9fe1493a ==============================
[0m16:26:19.690745 [info ] [MainThread]: Running with dbt=1.10.15
[0m16:26:19.691091 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'introspect': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'debug': 'False', 'version_check': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'no_print': 'None', 'quiet': 'False', 'target_path': 'None', 'invocation_command': 'dbt run', 'printer_width': '80', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'use_experimental_parser': 'False', 'fail_fast': 'False'}
[0m16:26:19.860063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '057ce264-c2a4-4eb4-8a5a-ebad9fe1493a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b264e0>]}
[0m16:26:19.887626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '057ce264-c2a4-4eb4-8a5a-ebad9fe1493a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071e5d30>]}
[0m16:26:19.888994 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:26:19.944747 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m16:26:20.015346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 9 files changed.
[0m16:26:20.015715 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_reunions.sql
[0m16:26:20.015908 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_mandats.sql
[0m16:26:20.016075 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_amendements_cosignataires.sql
[0m16:26:20.016250 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_scrutins.sql
[0m16:26:20.016417 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_acteurs.sql
[0m16:26:20.016580 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_organes.sql
[0m16:26:20.016733 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_scrutins_votes.sql
[0m16:26:20.016882 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_amendements.sql
[0m16:26:20.017028 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_pays.sql
[0m16:26:20.155399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '057ce264-c2a4-4eb4-8a5a-ebad9fe1493a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a91070>]}
[0m16:26:20.192773 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m16:26:20.194189 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m16:26:20.207003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '057ce264-c2a4-4eb4-8a5a-ebad9fe1493a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a86ea0>]}
[0m16:26:20.207263 [info ] [MainThread]: Found 18 models, 1 operation, 9 sources, 469 macros
[0m16:26:20.207431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '057ce264-c2a4-4eb4-8a5a-ebad9fe1493a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac4290>]}
[0m16:26:20.208507 [info ] [MainThread]: 
[0m16:26:20.208680 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m16:26:20.208814 [info ] [MainThread]: 
[0m16:26:20.209051 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:26:20.211445 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_an_data_pipeline'
[0m16:26:20.294913 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline"
[0m16:26:20.295150 [debug] [ThreadPool]: On list_an_data_pipeline: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"an_data_pipeline"'
    
  
  
[0m16:26:20.295300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:22.153301 [debug] [ThreadPool]: SQL status: OK in 1.858 seconds
[0m16:26:22.155934 [debug] [ThreadPool]: On list_an_data_pipeline: Close
[0m16:26:22.156960 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_an_data_pipeline, now create_an_data_pipeline_main)
[0m16:26:22.157575 [debug] [ThreadPool]: Creating schema "database: "an_data_pipeline"
schema: "main"
"
[0m16:26:22.211079 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m16:26:22.211409 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:26:22.211605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:22.213395 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:26:22.214223 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m16:26:22.214412 [debug] [ThreadPool]: On create_an_data_pipeline_main: BEGIN
[0m16:26:22.214968 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:26:22.215202 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m16:26:22.215396 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
    
        create schema if not exists "an_data_pipeline"."main"
    
[0m16:26:22.312644 [debug] [ThreadPool]: SQL status: OK in 0.097 seconds
[0m16:26:22.313666 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m16:26:22.313990 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m16:26:22.314285 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m16:26:22.409344 [debug] [ThreadPool]: SQL status: OK in 0.095 seconds
[0m16:26:22.410768 [debug] [ThreadPool]: On create_an_data_pipeline_main: Close
[0m16:26:22.414691 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_an_data_pipeline_main, now list_an_data_pipeline_main)
[0m16:26:22.423965 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m16:26:22.424540 [debug] [ThreadPool]: On list_an_data_pipeline_main: BEGIN
[0m16:26:22.424936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:22.426249 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:26:22.426659 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m16:26:22.427050 [debug] [ThreadPool]: On list_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline_main"} */
select
      'an_data_pipeline' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'an_data_pipeline'
  
[0m16:26:22.446947 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:26:22.448669 [debug] [ThreadPool]: On list_an_data_pipeline_main: ROLLBACK
[0m16:26:22.450344 [debug] [ThreadPool]: Failed to rollback 'list_an_data_pipeline_main'
[0m16:26:22.450633 [debug] [ThreadPool]: On list_an_data_pipeline_main: Close
[0m16:26:22.452349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '057ce264-c2a4-4eb4-8a5a-ebad9fe1493a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e94860>]}
[0m16:26:22.452772 [debug] [MainThread]: Using duckdb connection "master"
[0m16:26:22.453024 [debug] [MainThread]: On master: BEGIN
[0m16:26:22.453236 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:26:22.454032 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:26:22.454256 [debug] [MainThread]: On master: COMMIT
[0m16:26:22.454510 [debug] [MainThread]: Using duckdb connection "master"
[0m16:26:22.454724 [debug] [MainThread]: On master: COMMIT
[0m16:26:22.455094 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:26:22.461120 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_an_data.dbt_an_data-on-run-start-0"
[0m16:26:22.465104 [info ] [MainThread]: 1 of 1 START hook: dbt_an_data.on-run-start.0 .................................. [RUN]
[0m16:26:22.465481 [debug] [MainThread]: Using duckdb connection "master"
[0m16:26:22.465744 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "master"} */
ATTACH '../data/database/database.duckdb' AS database (READ_ONLY)
[0m16:26:22.473792 [debug] [MainThread]: SQL status: OK in 0.008 seconds
[0m16:26:22.474627 [info ] [MainThread]: 1 of 1 OK hook: dbt_an_data.on-run-start.0 ..................................... [[32mOK[0m in 0.02s]
[0m16:26:22.474871 [info ] [MainThread]: 
[0m16:26:22.475088 [debug] [MainThread]: On master: Close
[0m16:26:22.476897 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_acteurs
[0m16:26:22.477197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_an_data_pipeline_main, now model.dbt_an_data.stg_acteurs)
[0m16:26:22.477424 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_acteurs
[0m16:26:22.479211 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_acteurs"
[0m16:26:22.479920 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_acteurs
[0m16:26:22.480143 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_agenda
[0m16:26:22.480397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_acteurs, now model.dbt_an_data.stg_agenda)
[0m16:26:22.480618 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_agenda
[0m16:26:22.482119 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_agenda"
[0m16:26:22.482611 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_agenda
[0m16:26:22.482820 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_amendements
[0m16:26:22.483048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_agenda, now model.dbt_an_data.stg_amendements)
[0m16:26:22.483256 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_amendements
[0m16:26:22.484746 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_amendements"
[0m16:26:22.485215 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_amendements
[0m16:26:22.485419 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_organes
[0m16:26:22.485620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_amendements, now model.dbt_an_data.stg_organes)
[0m16:26:22.485814 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_organes
[0m16:26:22.487217 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_organes"
[0m16:26:22.487750 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_organes
[0m16:26:22.487982 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_pays
[0m16:26:22.488242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_organes, now model.dbt_an_data.stg_pays)
[0m16:26:22.488457 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_pays
[0m16:26:22.489963 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_pays"
[0m16:26:22.490448 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_pays
[0m16:26:22.490650 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_reunions
[0m16:26:22.490856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_pays, now model.dbt_an_data.stg_reunions)
[0m16:26:22.491044 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_reunions
[0m16:26:22.492407 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_reunions"
[0m16:26:22.492819 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_reunions
[0m16:26:22.493007 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_scrutins
[0m16:26:22.493202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_reunions, now model.dbt_an_data.stg_scrutins)
[0m16:26:22.493379 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_scrutins
[0m16:26:22.494645 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_scrutins"
[0m16:26:22.495152 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_scrutins
[0m16:26:22.495325 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_acteurs
[0m16:26:22.495558 [info ] [Thread-1 (]: 1 of 11 START sql incremental model main.int_acteurs ........................... [RUN]
[0m16:26:22.496977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_scrutins, now model.dbt_an_data.int_acteurs)
[0m16:26:22.497165 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_acteurs
[0m16:26:22.503989 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_acteurs"
[0m16:26:22.504448 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_acteurs
[0m16:26:22.508141 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:26:22.508338 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__71332217caf8" cascade
    
[0m16:26:22.508504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:22.606215 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m16:26:22.637251 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:26:22.637555 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:26:22.638458 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:26:22.639308 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:26:22.639531 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m16:26:22.640013 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:26:22.640207 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:26:22.640399 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m16:26:22.736091 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m16:26:22.737311 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:26:22.737698 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    

  
[0m16:26:22.738088 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:26:22.739114 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m16:26:22.739450 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:26:22.739750 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m16:26:22.836464 [debug] [Thread-1 (]: SQL status: OK in 0.096 seconds
[0m16:26:22.854926 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:26:22.855578 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_acteurs__71332217caf8"
  
    as (
      

WITH  __dbt__cte__stg_acteurs as (
SELECT * 
FROM "database"."stg"."raw_acteurs"
), acteurs AS (
	SELECT 
		json_extract_string(json, '$.acteur.uid.#text') as uid,
		json_extract_string(json, '$.acteur.etatCivil.ident.civ') as civ,
		json_extract_string(json, '$.acteur.etatCivil.ident.prenom') as prenom,
		json_extract_string(json, '$.acteur.etatCivil.ident.nom') as nom,
		json_extract_string(json, '$.acteur.etatCivil.ident.trigramme') as trigramme,
		json_extract_string(json, '$.acteur.etatCivil.infoNaissance.dateNais') as dateNais,
		json_extract_string(json, '$.acteur.etatCivil.infoNaissance.villeNais') as villeNais,
		json_extract_string(json, '$.acteur.etatCivil.infoNaissance.depNais') as depNais,
		json_extract_string(json, '$.acteur.etatCivil.infoNaissance.paysNais') as paysNais,
		json_extract_string(json, '$.acteur.etatCivil.dateDeces') as dateDeces,
		json_extract_string(json, '$.acteur.profession.libelleCourant') as libelleCourant,
		json_extract_string(json, '$.acteur.profession.socProcINSEE.catSocPro') as catSocPro,
		json_extract_string(json, '$.acteur.profession.socProcINSEE.famSocPro') as famSocPro,
		json_extract_string(json, '$.acteur.uri_hatvp') as uri_hatvp,
		date_T_insert
	FROM __dbt__cte__stg_acteurs
)
SELECT *
FROM acteurs


	LEFT JOIN "an_data_pipeline"."main"."int_acteurs" AS target ON acteurs.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:26:23.579964 [debug] [Thread-1 (]: SQL status: OK in 0.724 seconds
[0m16:26:23.586782 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:26:23.587138 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m16:26:23.587986 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:26:23.588271 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:26:23.588578 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs__71332217caf8'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:26:23.593845 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:26:23.598142 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:26:23.598462 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:26:23.600739 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:26:23.606005 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:26:23.606296 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:26:23.608408 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:26:23.610372 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:26:23.610629 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */
SELECT version()
[0m16:26:23.611038 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:26:23.619792 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_acteurs"
[0m16:26:23.620935 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:26:23.621180 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

        
            delete from "an_data_pipeline"."main"."int_acteurs"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_acteurs__71332217caf8"
            );

        
    

    insert into "an_data_pipeline"."main"."int_acteurs" ("uid", "civ", "prenom", "nom", "trigramme", "dateNais", "villeNais", "depNais", "paysNais", "dateDeces", "libelleCourant", "catSocPro", "famSocPro", "uri_hatvp", "date_T_insert")
    (
        select "uid", "civ", "prenom", "nom", "trigramme", "dateNais", "villeNais", "depNais", "paysNais", "dateDeces", "libelleCourant", "catSocPro", "famSocPro", "uri_hatvp", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_acteurs__71332217caf8"
    )
  
[0m16:26:23.829263 [debug] [Thread-1 (]: SQL status: OK in 0.208 seconds
[0m16:26:23.843531 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m16:26:23.844050 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:26:23.844447 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m16:26:24.029653 [debug] [Thread-1 (]: SQL status: OK in 0.184 seconds
[0m16:26:24.037839 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:26:24.038490 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__71332217caf8" cascade
    
[0m16:26:24.237023 [debug] [Thread-1 (]: SQL status: OK in 0.198 seconds
[0m16:26:24.238733 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:26:24.238927 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__71332217caf8" cascade
    
[0m16:26:24.340113 [debug] [Thread-1 (]: SQL status: OK in 0.101 seconds
[0m16:26:24.342634 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: Close
[0m16:26:24.344961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '057ce264-c2a4-4eb4-8a5a-ebad9fe1493a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a991f0>]}
[0m16:26:24.345625 [info ] [Thread-1 (]: 1 of 11 OK created sql incremental model main.int_acteurs ...................... [[32mOK[0m in 1.85s]
[0m16:26:24.346101 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_acteurs
[0m16:26:24.346418 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_mandats
[0m16:26:24.346868 [info ] [Thread-1 (]: 2 of 11 START sql incremental model main.int_mandats ........................... [RUN]
[0m16:26:24.347307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_acteurs, now model.dbt_an_data.int_mandats)
[0m16:26:24.347626 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_mandats
[0m16:26:24.356990 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_mandats"
[0m16:26:24.357577 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_mandats
[0m16:26:24.360261 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:26:24.360533 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__e5b2b5560057" cascade
    
[0m16:26:24.360770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:24.459980 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m16:26:24.463068 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:26:24.463510 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:26:24.464951 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:26:24.466447 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:26:24.466843 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m16:26:24.467688 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:26:24.468009 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:26:24.468316 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m16:26:24.567080 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m16:26:24.569444 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:26:24.570153 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    

  
[0m16:26:24.571089 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:26:24.573054 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m16:26:24.573571 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:26:24.574026 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m16:26:24.668617 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m16:26:24.671453 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:26:24.672719 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_mandats__e5b2b5560057"
  
    as (
      

WITH  __dbt__cte__stg_acteurs as (
SELECT * 
FROM "database"."stg"."raw_acteurs"
), mandats AS (
	SELECT 
		json_extract_string(mandat.value, '$.uid') as uid,
		json_extract_string(mandat.value, '$.acteurRef') as acteurRef,
		json_extract_string(mandat.value, '$.legislature') as legislature,
		json_extract_string(mandat.value, '$.typeOrgane') as typeOrgane,
		json_extract_string(mandat.value, '$.dateDebut') as dateDebut,
		json_extract_string(mandat.value, '$.dateFin') as dateFin,
		json_extract_string(mandat.value, '$.preseance') as preseance,
		json_extract_string(mandat.value, '$.nominPrincipale') as nominPrincipale,
		json_extract_string(mandat.value, '$.infosQualite.codeQualite') as codeQualite,
		json_extract_string(mandat.value, '$.organes.organeRef') as organeRef,
		date_T_insert
	FROM __dbt__cte__stg_acteurs act, json_each(json->'acteur'->'mandats'->'mandat') mandat
)
SELECT * 
FROM mandats


	LEFT JOIN "an_data_pipeline"."main"."int_mandats" AS target ON mandats.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:26:25.557003 [debug] [Thread-1 (]: SQL status: OK in 0.883 seconds
[0m16:26:25.559203 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:26:25.559400 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m16:26:25.559914 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:26:25.560084 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:26:25.560251 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats__e5b2b5560057'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:26:25.561891 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:26:25.563425 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:26:25.563601 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:26:25.564941 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:26:25.567245 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:26:25.567419 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:26:25.568798 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:26:25.569845 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_mandats"
[0m16:26:25.570268 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:26:25.570455 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

        
            delete from "an_data_pipeline"."main"."int_mandats"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_mandats__e5b2b5560057"
            );

        
    

    insert into "an_data_pipeline"."main"."int_mandats" ("uid", "acteurRef", "legislature", "typeOrgane", "dateDebut", "dateFin", "preseance", "nominPrincipale", "codeQualite", "organeRef", "date_T_insert")
    (
        select "uid", "acteurRef", "legislature", "typeOrgane", "dateDebut", "dateFin", "preseance", "nominPrincipale", "codeQualite", "organeRef", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_mandats__e5b2b5560057"
    )
  
[0m16:26:25.777496 [debug] [Thread-1 (]: SQL status: OK in 0.206 seconds
[0m16:26:25.780635 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m16:26:25.781371 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:26:25.781854 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m16:26:25.978904 [debug] [Thread-1 (]: SQL status: OK in 0.196 seconds
[0m16:26:25.984298 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:26:25.985088 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__e5b2b5560057" cascade
    
[0m16:26:26.198318 [debug] [Thread-1 (]: SQL status: OK in 0.212 seconds
[0m16:26:26.203422 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:26:26.203932 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__e5b2b5560057" cascade
    
[0m16:26:26.305276 [debug] [Thread-1 (]: SQL status: OK in 0.101 seconds
[0m16:26:26.308304 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: Close
[0m16:26:26.309258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '057ce264-c2a4-4eb4-8a5a-ebad9fe1493a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f57fb0>]}
[0m16:26:26.310165 [info ] [Thread-1 (]: 2 of 11 OK created sql incremental model main.int_mandats ...................... [[32mOK[0m in 1.96s]
[0m16:26:26.310908 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_mandats
[0m16:26:26.311428 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_agenda
[0m16:26:26.312150 [info ] [Thread-1 (]: 3 of 11 START sql incremental model main.int_agenda ............................ [RUN]
[0m16:26:26.312893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_mandats, now model.dbt_an_data.int_agenda)
[0m16:26:26.313426 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_agenda
[0m16:26:26.321155 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_agenda"
[0m16:26:26.322708 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_agenda
[0m16:26:26.326985 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:26:26.327413 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__702a6f76afc6" cascade
    
[0m16:26:26.327806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:26.429903 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m16:26:26.435381 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:26:26.436074 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:26:26.438134 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:26:26.440142 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:26:26.440634 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m16:26:26.441701 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:26:26.442139 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:26:26.442590 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m16:26:26.542666 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m16:26:26.544917 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:26:26.545566 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    

  
[0m16:26:26.546138 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:26:26.547654 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m16:26:26.548115 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:26:26.548554 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m16:26:26.644087 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m16:26:26.646823 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:26:26.647778 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_agenda__702a6f76afc6"
  
    as (
      

with __dbt__cte__stg_agenda as (
SELECT * 
FROM "database"."stg"."raw_agenda"
) SELECT * 
FROM __dbt__cte__stg_agenda
    );
  
  
  
[0m16:26:26.965091 [debug] [Thread-1 (]: SQL status: OK in 0.317 seconds
[0m16:26:26.968071 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:26:26.968431 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m16:26:26.969305 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:26:26.969608 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:26:26.969927 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda__702a6f76afc6'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:26:26.973120 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:26:26.977560 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:26:26.977907 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:26:26.980397 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:26:26.982890 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:26:26.983218 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:26:26.985645 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:26:26.988005 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_agenda"
[0m16:26:26.988747 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:26:26.989039 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

        
            delete from "an_data_pipeline"."main"."int_agenda" as DBT_INCREMENTAL_TARGET
            using "an_data_pipeline"."dbt_temp"."int_agenda__702a6f76afc6"
            where (
                
                    "an_data_pipeline"."dbt_temp"."int_agenda__702a6f76afc6".Date = DBT_INCREMENTAL_TARGET.Date
                    and 
                
                    "an_data_pipeline"."dbt_temp"."int_agenda__702a6f76afc6".Heure = DBT_INCREMENTAL_TARGET.Heure
                    
                
                
            );
        
    

    insert into "an_data_pipeline"."main"."int_agenda" ("Date", "Heure", "Ordre(s) du jour", "filename", "date_T_insert")
    (
        select "Date", "Heure", "Ordre(s) du jour", "filename", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_agenda__702a6f76afc6"
    )
  
[0m16:26:27.200123 [debug] [Thread-1 (]: SQL status: OK in 0.210 seconds
[0m16:26:27.202895 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m16:26:27.203605 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:26:27.204188 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m16:26:27.319128 [debug] [Thread-1 (]: SQL status: OK in 0.114 seconds
[0m16:26:27.325559 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:26:27.326343 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__702a6f76afc6" cascade
    
[0m16:26:27.529130 [debug] [Thread-1 (]: SQL status: OK in 0.202 seconds
[0m16:26:27.530784 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:26:27.530962 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__702a6f76afc6" cascade
    
[0m16:26:27.627779 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m16:26:27.628973 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: Close
[0m16:26:27.629470 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '057ce264-c2a4-4eb4-8a5a-ebad9fe1493a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f4da00>]}
[0m16:26:27.630002 [info ] [Thread-1 (]: 3 of 11 OK created sql incremental model main.int_agenda ....................... [[32mOK[0m in 1.32s]
[0m16:26:27.630448 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_agenda
[0m16:26:27.630760 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements
[0m16:26:27.631189 [info ] [Thread-1 (]: 4 of 11 START sql incremental model main.int_amendements ....................... [RUN]
[0m16:26:27.631598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_agenda, now model.dbt_an_data.int_amendements)
[0m16:26:27.631913 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements
[0m16:26:27.647952 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements"
[0m16:26:27.648613 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements
[0m16:26:27.652840 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:26:27.653160 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__358cadc062c6" cascade
    
[0m16:26:27.653458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:27.750951 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m16:26:27.754021 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:26:27.754493 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:26:27.756066 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:26:27.757583 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:26:27.757963 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m16:26:27.758774 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:26:27.759103 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:26:27.759431 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m16:26:27.856573 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m16:26:27.859074 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:26:27.859960 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    

  
[0m16:26:27.860940 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:26:27.862897 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m16:26:27.863444 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:26:27.863903 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m16:26:27.958908 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m16:26:27.961502 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:26:27.962527 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_amendements__358cadc062c6"
  
    as (
      

WITH  __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
), amendements AS (
	SELECT
		json_extract_string(json, '$.amendement.uid') AS uid,
		json_extract_string(json, '$.amendement.chronotag') AS chronotag,
		json_extract_string(json, '$.amendement.examenRef') AS examenRef,
		json_extract_string(json, '$.amendement.amendementParentRef') AS amendementParentRef,
		json_extract_string(json, '$.amendement.signataires.auteur.typeAuteur') AS typeAuteur,
		json_extract_string(json, '$.amendement.signataires.auteur.acteurRef') AS refAuteur,
		json_extract_string(json, '$.amendement.signataires.auteur.groupePolitique') AS groupePolitiqueAuteur,
		json_extract_string(json, '$.amendement.cycleDeVie.dateDepot') AS dateDepot,
		json_extract_string(json, '$.amendement.cycleDeVie.datePublication') AS datePublication,
		json_extract_string(json, '$.amendement.cycleDeVie.soumisArticle40') AS soumisArticle40,
		json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.code') AS codeEtat,
		json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.libelle') AS libelleEtat,
		json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.code') AS codeSousEtat,
		json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
		json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
		json_extract_string(json, '$.amendement.cycleDeVie.dateSort') AS dateSort,
		json_extract_string(json, '$.amendement.cycleDeVie.sort') AS sort,
		split_part(replace(filename, '.json', ''), '/', -1) AS id_amendement,
		split_part(replace(filename, '.json', ''), '/', -2) AS id_texte,
		split_part(replace(filename, '.json', ''), '/', -3) AS id_dossier_legislatif,
		id_texte[:4] AS nature_texte,
		id_texte[5:6] AS source_texte,
		regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 1) AS prefix_bibard,
		regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 2) AS numero_bibard,
		regexp_extract(id_amendement, '(SEA|PO\d*)', 1) AS code_organe,
		regexp_extract(id_amendement, '(P)(\d*)(D)', 2) AS numero_partie,
		regexp_extract(id_amendement, '(D)(\d*)(N)', 2) AS numero_deliberation,
		regexp_extract(id_amendement, '(D)(\d*)(N)(\d*)', 4) AS numero_court,
		date_T_insert
	FROM __dbt__cte__stg_amendements
)
SELECT * 
FROM amendements


	LEFT JOIN "an_data_pipeline"."main"."int_amendements" AS target ON amendements.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:26:35.715181 [debug] [Thread-1 (]: SQL status: OK in 7.750 seconds
[0m16:26:35.723552 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:26:35.723781 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m16:26:35.734653 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m16:26:35.734831 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:26:35.735013 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements__358cadc062c6'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:26:35.746279 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m16:26:35.748701 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:26:35.748922 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:26:35.750443 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:26:35.752119 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:26:35.752310 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:26:35.753703 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:26:35.755296 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements"
[0m16:26:35.756076 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:26:35.756277 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

        
            delete from "an_data_pipeline"."main"."int_amendements"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_amendements__358cadc062c6"
            );

        
    

    insert into "an_data_pipeline"."main"."int_amendements" ("uid", "chronotag", "examenRef", "amendementParentRef", "typeAuteur", "refAuteur", "groupePolitiqueAuteur", "dateDepot", "datePublication", "soumisArticle40", "codeEtat", "libelleEtat", "codeSousEtat", "libelleSousEtat", "libelleSousEtat_1", "dateSort", "sort", "id_amendement", "id_texte", "id_dossier_legislatif", "nature_texte", "source_texte", "prefix_bibard", "numero_bibard", "code_organe", "numero_partie", "numero_deliberation", "numero_court", "date_T_insert")
    (
        select "uid", "chronotag", "examenRef", "amendementParentRef", "typeAuteur", "refAuteur", "groupePolitiqueAuteur", "dateDepot", "datePublication", "soumisArticle40", "codeEtat", "libelleEtat", "codeSousEtat", "libelleSousEtat", "libelleSousEtat_1", "dateSort", "sort", "id_amendement", "id_texte", "id_dossier_legislatif", "nature_texte", "source_texte", "prefix_bibard", "numero_bibard", "code_organe", "numero_partie", "numero_deliberation", "numero_court", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_amendements__358cadc062c6"
    )
  
[0m16:26:35.989258 [debug] [Thread-1 (]: SQL status: OK in 0.233 seconds
[0m16:26:35.991436 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m16:26:35.991929 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:26:35.992276 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m16:26:36.120848 [debug] [Thread-1 (]: SQL status: OK in 0.128 seconds
[0m16:26:36.125138 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:26:36.125769 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__358cadc062c6" cascade
    
[0m16:26:36.336118 [debug] [Thread-1 (]: SQL status: OK in 0.210 seconds
[0m16:26:36.342159 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:26:36.342817 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__358cadc062c6" cascade
    
[0m16:26:36.444518 [debug] [Thread-1 (]: SQL status: OK in 0.101 seconds
[0m16:26:36.446816 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: Close
[0m16:26:36.448836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '057ce264-c2a4-4eb4-8a5a-ebad9fe1493a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f44710>]}
[0m16:26:36.450173 [info ] [Thread-1 (]: 4 of 11 OK created sql incremental model main.int_amendements .................. [[32mOK[0m in 8.82s]
[0m16:26:36.451062 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements
[0m16:26:36.451659 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements_cosignataires
[0m16:26:36.452760 [info ] [Thread-1 (]: 5 of 11 START sql incremental model main.int_amendements_cosignataires ......... [RUN]
[0m16:26:36.453415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements, now model.dbt_an_data.int_amendements_cosignataires)
[0m16:26:36.453888 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements_cosignataires
[0m16:26:36.468671 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements_cosignataires"
[0m16:26:36.469482 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements_cosignataires
[0m16:26:36.473311 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:26:36.473709 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__98e9bb9c1f6e" cascade
    
[0m16:26:36.474044 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:36.580097 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m16:26:36.583678 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:26:36.583982 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:26:36.584953 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:26:36.585866 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:26:36.586114 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m16:26:36.586641 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:26:36.586861 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:26:36.587080 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m16:26:36.681565 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m16:26:36.682753 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:26:36.683178 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    

  
[0m16:26:36.683612 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:26:36.686133 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m16:26:36.686614 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:26:36.687015 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m16:26:36.781257 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m16:26:36.784029 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:26:36.785215 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__98e9bb9c1f6e"
  
    as (
      

WITH  __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
), cosignataires_arr AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef[*]') AS acteurRef,
    date_T_insert
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') == 'ARRAY' AND acteurRef IS NOT NULL
), cosignataires_str AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef') AS acteurRef,
    date_T_insert
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') <> 'ARRAY' AND acteurRef IS NOT NULL
), cosignataires AS (
	SELECT 
		uid, 
		unnest(acteurRef) as acteurRef,
		date_T_insert
	FROM cosignataires_arr
	UNION ALL
	SELECT 
		uid, 
		acteurRef,
		date_T_insert
	FROM cosignataires_str
)
SELECT * 
FROM cosignataires


	LEFT JOIN "an_data_pipeline"."main"."int_amendements_cosignataires" AS target ON cosignataires.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:26:43.025229 [debug] [Thread-1 (]: SQL status: OK in 6.239 seconds
[0m16:26:43.027049 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:26:43.027246 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m16:26:43.027861 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:26:43.028068 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:26:43.028254 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires__98e9bb9c1f6e'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:26:43.029948 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:26:43.031493 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:26:43.031678 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:26:43.033060 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:26:43.034489 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:26:43.034692 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:26:43.036099 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:26:43.037060 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements_cosignataires"
[0m16:26:43.037491 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:26:43.037686 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

        
            delete from "an_data_pipeline"."main"."int_amendements_cosignataires" as DBT_INCREMENTAL_TARGET
            using "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__98e9bb9c1f6e"
            where (
                
                    "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__98e9bb9c1f6e".uid = DBT_INCREMENTAL_TARGET.uid
                    and 
                
                    "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__98e9bb9c1f6e".acteurRef = DBT_INCREMENTAL_TARGET.acteurRef
                    
                
                
            );
        
    

    insert into "an_data_pipeline"."main"."int_amendements_cosignataires" ("uid", "acteurRef", "date_T_insert")
    (
        select "uid", "acteurRef", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__98e9bb9c1f6e"
    )
  
[0m16:26:43.255217 [debug] [Thread-1 (]: SQL status: OK in 0.217 seconds
[0m16:26:43.258261 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m16:26:43.259047 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:26:43.259821 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m16:26:43.398265 [debug] [Thread-1 (]: SQL status: OK in 0.137 seconds
[0m16:26:43.404132 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:26:43.404817 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__98e9bb9c1f6e" cascade
    
[0m16:26:43.611650 [debug] [Thread-1 (]: SQL status: OK in 0.206 seconds
[0m16:26:43.613206 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:26:43.613390 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__98e9bb9c1f6e" cascade
    
[0m16:26:43.709913 [debug] [Thread-1 (]: SQL status: OK in 0.096 seconds
[0m16:26:43.711155 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: Close
[0m16:26:43.711700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '057ce264-c2a4-4eb4-8a5a-ebad9fe1493a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f85400>]}
[0m16:26:43.712342 [info ] [Thread-1 (]: 5 of 11 OK created sql incremental model main.int_amendements_cosignataires .... [[32mOK[0m in 7.26s]
[0m16:26:43.712887 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements_cosignataires
[0m16:26:43.713372 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_organes
[0m16:26:43.713844 [info ] [Thread-1 (]: 6 of 11 START sql incremental model main.int_organes ........................... [RUN]
[0m16:26:43.714210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements_cosignataires, now model.dbt_an_data.int_organes)
[0m16:26:43.714513 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_organes
[0m16:26:43.723682 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_organes"
[0m16:26:43.724327 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_organes
[0m16:26:43.727247 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:26:43.727522 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__3a19df8b9016" cascade
    
[0m16:26:43.727760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:43.825042 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m16:26:43.828150 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:26:43.828609 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:26:43.830119 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:26:43.831409 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:26:43.831753 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m16:26:43.832497 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:26:43.832794 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:26:43.833103 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m16:26:43.932122 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m16:26:43.934387 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:26:43.935044 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    

  
[0m16:26:43.936058 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:26:43.937954 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m16:26:43.938460 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:26:43.938916 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m16:26:44.033474 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m16:26:44.035917 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:26:44.036981 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_organes__3a19df8b9016"
  
    as (
      

WITH  __dbt__cte__stg_organes as (
SELECT * 
FROM "database"."stg"."raw_organes"
), organes AS (
	SELECT 
		json_extract_string(json, '$.organe.uid') as uid,
		json_extract_string(json, '$.organe.codeType') as codeType,
		json_extract_string(json, '$.organe.libelle') as libelle,
		json_extract_string(json, '$.organe.libelleEdition') as libelleEdition,
		json_extract_string(json, '$.organe.libelleAbrege') as libelleAbrege,
		json_extract_string(json, '$.organe.libelleAbrev') as libelleAbrev,
		json_extract_string(json, '$.organe.viMoDe.dateDebut') as dateDebut,
		json_extract_string(json, '$.organe.viMoDe.dateAgrement') as dateAgrement,
		json_extract_string(json, '$.organe.viMoDe.dateFin') as dateFin,
		json_extract_string(json, '$.organe.organeParent') as organeParent,
		json_extract_string(json, '$.organe.chambre') as chambre,
		json_extract_string(json, '$.organe.regime') as regime,
		json_extract_string(json, '$.organe.legislature') as legislature,
		date_T_insert
	FROM __dbt__cte__stg_organes
)


	LEFT JOIN "an_data_pipeline"."main"."int_organes" AS target ON organes.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:26:44.055862 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_organes__3a19df8b9016"
  
    as (
      

WITH  __dbt__cte__stg_organes as (
SELECT * 
FROM "database"."stg"."raw_organes"
), organes AS (
	SELECT 
		json_extract_string(json, '$.organe.uid') as uid,
		json_extract_string(json, '$.organe.codeType') as codeType,
		json_extract_string(json, '$.organe.libelle') as libelle,
		json_extract_string(json, '$.organe.libelleEdition') as libelleEdition,
		json_extract_string(json, '$.organe.libelleAbrege') as libelleAbrege,
		json_extract_string(json, '$.organe.libelleAbrev') as libelleAbrev,
		json_extract_string(json, '$.organe.viMoDe.dateDebut') as dateDebut,
		json_extract_string(json, '$.organe.viMoDe.dateAgrement') as dateAgrement,
		json_extract_string(json, '$.organe.viMoDe.dateFin') as dateFin,
		json_extract_string(json, '$.organe.organeParent') as organeParent,
		json_extract_string(json, '$.organe.chambre') as chambre,
		json_extract_string(json, '$.organe.regime') as regime,
		json_extract_string(json, '$.organe.legislature') as legislature,
		date_T_insert
	FROM __dbt__cte__stg_organes
)


	LEFT JOIN "an_data_pipeline"."main"."int_organes" AS target ON organes.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:26:44.056475 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:26:44.059315 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:26:44.059717 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__3a19df8b9016" cascade
    
[0m16:26:44.163450 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m16:26:44.165673 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: Close
[0m16:26:44.177248 [debug] [Thread-1 (]: Runtime Error in model int_organes (models/int/int_organes.sql)
  Parser Error: syntax error at or near "LEFT"
  
  LINE 37: 	LEFT JOIN "an_data_pipeline"."main"."int_organes" AS target...
           ^
[0m16:26:44.177762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '057ce264-c2a4-4eb4-8a5a-ebad9fe1493a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c5ecc0>]}
[0m16:26:44.178259 [error] [Thread-1 (]: 6 of 11 ERROR creating sql incremental model main.int_organes .................. [[31mERROR[0m in 0.46s]
[0m16:26:44.178691 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_organes
[0m16:26:44.178992 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_pays
[0m16:26:44.179406 [debug] [Thread-4 (]: Marking all children of 'model.dbt_an_data.int_organes' to be skipped because of status 'error'.  Reason: Runtime Error in model int_organes (models/int/int_organes.sql)
  Parser Error: syntax error at or near "LEFT"
  
  LINE 37: 	LEFT JOIN "an_data_pipeline"."main"."int_organes" AS target...
           ^.
[0m16:26:44.179794 [info ] [Thread-1 (]: 7 of 11 START sql incremental model main.int_pays .............................. [RUN]
[0m16:26:44.181213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_organes, now model.dbt_an_data.int_pays)
[0m16:26:44.181494 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_pays
[0m16:26:44.190634 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_pays"
[0m16:26:44.191324 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_pays
[0m16:26:44.193992 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:26:44.194258 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__2beb3bb96ea2" cascade
    
[0m16:26:44.194470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:44.295153 [debug] [Thread-1 (]: SQL status: OK in 0.100 seconds
[0m16:26:44.299918 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:26:44.300563 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:26:44.302390 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:26:44.304296 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:26:44.304785 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m16:26:44.305844 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:26:44.306275 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:26:44.306710 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m16:26:44.409823 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m16:26:44.412744 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:26:44.413530 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    

  
[0m16:26:44.414533 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:26:44.416724 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m16:26:44.417278 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:26:44.417742 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m16:26:44.512550 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m16:26:44.514722 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:26:44.515716 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_pays__2beb3bb96ea2"
  
    as (
      

WITH  __dbt__cte__stg_pays as (
SELECT * 
FROM "database"."stg"."raw_pays"
), pays AS (
	SELECT
		json_extract_string(json, '$.pays.uid') as uid,
		json_extract_string(json, '$.pays.code_insee') as code_insee,
		json_extract_string(json, '$.pays.libelleInsee') as libelleInsee,
		json_extract_string(json, '$.pays.nomCourant') as nomCourant,
		json_extract_string(json, '$.pays.code_iso2A') as code_iso2A,
		json_extract_string(json, '$.pays.code_iso3A') as code_iso3A,
		json_extract_string(json, '$.pays.code_iso3N') as code_iso3N,
		json_extract_string(json, '$.pays.libelleIso') as libelleIso,
		json_extract_string(json, '$.pays.libelleANCourt') as libelleANCourt,
		json_extract_string(json, '$.pays.libelleANLong') as libelleANLong,
		json_extract_string(json, '$.pays.sourceJuridique') as sourceJuridique,
		json_extract_string(json, '$.pays.activ') as activ,
		date_T_insert
	FROM __dbt__cte__stg_pays source
)
SELECT * 
FROM pays


	LEFT JOIN "an_data_pipeline"."main"."int_pays" AS target ON pays.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:26:44.948269 [debug] [Thread-1 (]: SQL status: OK in 0.432 seconds
[0m16:26:44.952517 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:26:44.953058 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m16:26:44.954298 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:26:44.954691 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:26:44.955068 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays__2beb3bb96ea2'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:26:44.958789 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:26:44.962617 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:26:44.963063 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:26:44.966373 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:26:44.969517 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:26:44.969938 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:26:44.972875 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:26:44.974981 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_pays"
[0m16:26:44.975853 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:26:44.976239 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

        
            delete from "an_data_pipeline"."main"."int_pays"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_pays__2beb3bb96ea2"
            );

        
    

    insert into "an_data_pipeline"."main"."int_pays" ("uid", "code_insee", "libelleInsee", "nomCourant", "code_iso2A", "code_iso3A", "code_iso3N", "libelleIso", "libelleANCourt", "libelleANLong", "sourceJuridique", "activ", "date_T_insert")
    (
        select "uid", "code_insee", "libelleInsee", "nomCourant", "code_iso2A", "code_iso3A", "code_iso3N", "libelleIso", "libelleANCourt", "libelleANLong", "sourceJuridique", "activ", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_pays__2beb3bb96ea2"
    )
  
[0m16:26:45.189936 [debug] [Thread-1 (]: SQL status: OK in 0.213 seconds
[0m16:26:45.192181 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m16:26:45.192732 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:26:45.193197 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m16:26:45.291407 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m16:26:45.297466 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:26:45.298357 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__2beb3bb96ea2" cascade
    
[0m16:26:45.509591 [debug] [Thread-1 (]: SQL status: OK in 0.210 seconds
[0m16:26:45.514747 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:26:45.515341 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__2beb3bb96ea2" cascade
    
[0m16:26:45.617324 [debug] [Thread-1 (]: SQL status: OK in 0.101 seconds
[0m16:26:45.622073 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: Close
[0m16:26:45.623499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '057ce264-c2a4-4eb4-8a5a-ebad9fe1493a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107566cf0>]}
[0m16:26:45.624650 [info ] [Thread-1 (]: 7 of 11 OK created sql incremental model main.int_pays ......................... [[32mOK[0m in 1.44s]
[0m16:26:45.625465 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_pays
[0m16:26:45.625988 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_reunions
[0m16:26:45.626709 [info ] [Thread-1 (]: 8 of 11 START sql incremental model main.int_reunions .......................... [RUN]
[0m16:26:45.627486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_pays, now model.dbt_an_data.int_reunions)
[0m16:26:45.628026 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_reunions
[0m16:26:45.644683 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_reunions"
[0m16:26:45.803445 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_reunions
[0m16:26:45.817242 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:26:45.820381 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__070d9a5e44a0" cascade
    
[0m16:26:45.820882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:45.922412 [debug] [Thread-1 (]: SQL status: OK in 0.101 seconds
[0m16:26:45.927546 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:26:45.927942 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:26:45.929037 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:26:45.930087 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:26:45.930348 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m16:26:45.930885 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:26:45.931099 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:26:45.931308 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m16:26:46.029138 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m16:26:46.031802 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:26:46.032588 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    

  
[0m16:26:46.033238 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:26:46.034868 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m16:26:46.035366 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:26:46.035809 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m16:26:46.132594 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m16:26:46.135294 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:26:46.136025 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_reunions__070d9a5e44a0"
  
    as (
      

WITH  __dbt__cte__stg_reunions as (
SELECT * 
FROM "database"."stg"."raw_reunions"
), reunions AS (
	SELECT
		json_extract_string(json, '$.reunion.uid') AS uid,
		json_extract_string(json, '$.reunion.timeStampDebut') AS timeStampDebut,
		json_extract_string(json, '$.reunion.lieu.lieuRef') AS lieuRef,
		json_extract_string(json, '$.reunion.lieu.libelleLong') AS lieuLibelle,
		json_extract_string(json, '$.reunion.cycleDeVie.etat') AS cycleDeVieEtat,
		json_extract_string(json, '$.reunion.demandeur') AS demandeur,
		json_extract_string(json, '$.reunion.organeReuniRef') AS organeReuniRef,
		json_extract_string(json, '$.reunion.visioConference') AS visioConference,
		json_extract_string(json, '$.reunion.sessionRef') AS sessionRef,
		json_extract_string(json, '$.reunion.ouverturePresse') AS ouverturePresse,
		json_extract_string(json, '$.reunion.captationVideo') AS captationVideo,
		json_extract_string(json, '$.reunion.ODJ.convocationODJ.item') AS convocationODJ,
		json_extract_string(json, '$.reunion.ODJ.resumeODJ.item') AS resumeODJ,
		json_extract_string(json, '$.reunion.compteRenduRef') AS compteRenduRef,
		json_extract_string(json, '$.reunion.identifiants.numSeanceJO') AS numSeanceJO,
		json_extract_string(json, '$.reunion.identifiants.idJO') AS idJO,
		json_extract_string(json, '$.reunion.identifiants.quantieme') AS quantieme,
		json_extract_string(json, '$.reunion.identifiants.DataSeance') AS DataSeance,
		date_T_insert
	FROM __dbt__cte__stg_reunions source
)
SELECT * 
FROM reunions


	LEFT JOIN "an_data_pipeline"."main"."int_reunions" AS target ON reunions.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:26:47.506954 [debug] [Thread-1 (]: SQL status: OK in 1.370 seconds
[0m16:26:47.509626 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:26:47.509928 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m16:26:47.510733 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:26:47.510984 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:26:47.511248 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions__070d9a5e44a0'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:26:47.513951 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:26:47.516478 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:26:47.516742 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:26:47.518719 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:26:47.520871 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:26:47.521133 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:26:47.523038 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:26:47.524414 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_reunions"
[0m16:26:47.524927 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:26:47.525164 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

        
            delete from "an_data_pipeline"."main"."int_reunions"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_reunions__070d9a5e44a0"
            );

        
    

    insert into "an_data_pipeline"."main"."int_reunions" ("uid", "timeStampDebut", "lieuRef", "lieuLibelle", "cycleDeVieEtat", "demandeur", "organeReuniRef", "visioConference", "sessionRef", "ouverturePresse", "captationVideo", "convocationODJ", "resumeODJ", "compteRenduRef", "numSeanceJO", "idJO", "quantieme", "DataSeance", "date_T_insert")
    (
        select "uid", "timeStampDebut", "lieuRef", "lieuLibelle", "cycleDeVieEtat", "demandeur", "organeReuniRef", "visioConference", "sessionRef", "ouverturePresse", "captationVideo", "convocationODJ", "resumeODJ", "compteRenduRef", "numSeanceJO", "idJO", "quantieme", "DataSeance", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_reunions__070d9a5e44a0"
    )
  
[0m16:26:47.733994 [debug] [Thread-1 (]: SQL status: OK in 0.208 seconds
[0m16:26:47.736336 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m16:26:47.736920 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:26:47.737393 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m16:26:47.850797 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m16:26:47.856012 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:26:47.856587 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__070d9a5e44a0" cascade
    
[0m16:26:48.063527 [debug] [Thread-1 (]: SQL status: OK in 0.206 seconds
[0m16:26:48.065289 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:26:48.065506 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__070d9a5e44a0" cascade
    
[0m16:26:48.163370 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m16:26:48.164556 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: Close
[0m16:26:48.165019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '057ce264-c2a4-4eb4-8a5a-ebad9fe1493a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc4b30>]}
[0m16:26:48.165497 [info ] [Thread-1 (]: 8 of 11 OK created sql incremental model main.int_reunions ..................... [[32mOK[0m in 2.54s]
[0m16:26:48.165892 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_reunions
[0m16:26:48.166181 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins
[0m16:26:48.166588 [info ] [Thread-1 (]: 9 of 11 START sql incremental model main.int_scrutins .......................... [RUN]
[0m16:26:48.166990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_reunions, now model.dbt_an_data.int_scrutins)
[0m16:26:48.167285 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins
[0m16:26:48.174491 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins"
[0m16:26:48.175020 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins
[0m16:26:48.177309 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:26:48.177564 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__190de11839ed" cascade
    
[0m16:26:48.177760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:48.280148 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m16:26:48.285156 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:26:48.285557 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:26:48.286873 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:26:48.288107 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:26:48.288427 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m16:26:48.289155 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:26:48.289430 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:26:48.289703 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m16:26:48.387667 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m16:26:48.389194 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:26:48.389631 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    

  
[0m16:26:48.390134 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:26:48.391370 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m16:26:48.391723 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:26:48.392033 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m16:26:48.489985 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m16:26:48.490893 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:26:48.491244 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_scrutins__190de11839ed"
  
    as (
      

WITH  __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
), scrutins AS (
	SELECT
		date_T_insert,
		json_extract_string(json, '$.scrutin.uid') AS uid,
		json_extract_string(json, '$.scrutin.numero') AS numero,
		json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
		json_extract_string(json, '$.scrutin.legislature') AS legislature,
		json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
		json_extract_string(json, '$.scrutin.titre') AS titre,
		json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
		json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
		json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
		json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
		json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
		json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote,
		date_T_insert
	FROM __dbt__cte__stg_scrutins
)
SELECT * 
FROM scrutins


	LEFT JOIN "an_data_pipeline"."main"."int_scrutins" AS target ON scrutins.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:26:50.829481 [debug] [Thread-1 (]: SQL status: OK in 2.341 seconds
[0m16:26:50.838932 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:26:50.839820 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m16:26:50.841776 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:26:50.842346 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:26:50.842865 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins__190de11839ed'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:26:50.848547 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:26:50.853316 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:26:50.853826 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:26:50.857649 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:26:50.861016 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:26:50.861411 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:26:50.864192 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:26:50.866989 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins"
[0m16:26:50.868317 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:26:50.868677 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

        
            delete from "an_data_pipeline"."main"."int_scrutins"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_scrutins__190de11839ed"
            );

        
    

    insert into "an_data_pipeline"."main"."int_scrutins" ("date_T_insert", "uid", "numero", "organeRef", "legislature", "date_scrutin", "titre", "resultat_code", "resultat_libelle", "nb_votants", "suffrages_exprimes", "seuil", "lieu_vote", "date_T_insert_1")
    (
        select "date_T_insert", "uid", "numero", "organeRef", "legislature", "date_scrutin", "titre", "resultat_code", "resultat_libelle", "nb_votants", "suffrages_exprimes", "seuil", "lieu_vote", "date_T_insert_1"
        from "an_data_pipeline"."dbt_temp"."int_scrutins__190de11839ed"
    )
  
[0m16:26:51.077272 [debug] [Thread-1 (]: SQL status: OK in 0.208 seconds
[0m16:26:51.079905 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m16:26:51.080618 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:26:51.081236 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m16:26:51.198482 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m16:26:51.203689 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:26:51.204412 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__190de11839ed" cascade
    
[0m16:26:51.414672 [debug] [Thread-1 (]: SQL status: OK in 0.210 seconds
[0m16:26:51.416650 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:26:51.416847 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__190de11839ed" cascade
    
[0m16:26:51.516842 [debug] [Thread-1 (]: SQL status: OK in 0.100 seconds
[0m16:26:51.518602 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: Close
[0m16:26:51.519599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '057ce264-c2a4-4eb4-8a5a-ebad9fe1493a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc9d90>]}
[0m16:26:51.520432 [info ] [Thread-1 (]: 9 of 11 OK created sql incremental model main.int_scrutins ..................... [[32mOK[0m in 3.35s]
[0m16:26:51.521015 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins
[0m16:26:51.521432 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins_votes
[0m16:26:51.522174 [info ] [Thread-1 (]: 10 of 11 START sql incremental model main.int_scrutins_votes ................... [RUN]
[0m16:26:51.522865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_scrutins, now model.dbt_an_data.int_scrutins_votes)
[0m16:26:51.523232 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins_votes
[0m16:26:51.546211 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins_votes"
[0m16:26:51.547078 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins_votes
[0m16:26:51.549500 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:26:51.549758 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__155c90fd9875" cascade
    
[0m16:26:51.549961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:51.648166 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m16:26:51.653055 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:26:51.653456 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:26:51.654873 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:26:51.656188 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:26:51.656540 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m16:26:51.657220 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:26:51.657495 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:26:51.657771 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m16:26:51.764460 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m16:26:51.769088 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:26:51.770010 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    

  
[0m16:26:51.770983 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:26:51.773718 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m16:26:51.774535 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:26:51.775185 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m16:26:51.869833 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m16:26:51.871825 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:26:51.872834 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_scrutins_votes__155c90fd9875"
  
    as (
      

WITH  __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
), grp AS (
	-- explode les groupes (1 par groupe)
SELECT
	json_extract_string(j.json, '$.scrutin.uid') AS uid,
	json_extract_string(g.value, '$.organeRef') AS groupe_organe,
	g.value AS groupe_json,
	j.date_T_insert
FROM __dbt__cte__stg_scrutins j,
json_each(json->'scrutin'->'ventilationVotes'->'organe'->'groupes'->'groupe') g
),

positions_array AS (
	-- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
	SELECT
		uid,
		date_T_insert,
		groupe_organe,
		'pour' AS type_vote,
		p.value AS vote_json
	FROM grp,
		json_each(groupe_json->'vote'->'decompteNominatif'->'pours'->'votant') p
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[ARRAY]'

	UNION ALL
	SELECT
		uid,
		date_T_insert,
		groupe_organe,
		'contre' AS type_vote,
		c.value AS vote_json
	FROM grp,
		json_each(groupe_json->'vote'->'decompteNominatif'->'contres'->'votant') c
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[ARRAY]'

	UNION ALL
	SELECT
		uid,
		date_T_insert,
		groupe_organe,
		'abstention' AS type_vote,
		a.value AS vote_json
	FROM grp,
		json_each(groupe_json->'vote'->'decompteNominatif'->'abstentions'->'votant') a
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[ARRAY]'

	UNION ALL
	SELECT
		uid,
		date_T_insert,
		groupe_organe,
		'nonVotant' AS type_vote,
		n.value AS vote_json
	FROM grp,
			json_each(groupe_json->'vote'->'decompteNominatif'->'nonVotants'->'votant') n
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[ARRAY]'
),
positions_object AS (
	-- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
	SELECT
		uid,
		groupe_organe,
		'pour' AS type_vote,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.acteurRef') AS acteurRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.mandatRef') AS mandatRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.parDelegation') AS parDelegation,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.numPlace') AS numPlace,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.causePositionVote') AS cause,
		date_T_insert
	FROM grp
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[OBJECT]'

	UNION ALL
	SELECT
		uid,
		groupe_organe,
		'contre' AS type_vote,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.acteurRef') AS acteurRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.mandatRef') AS mandatRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.parDelegation') AS parDelegation,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.numPlace') AS numPlace,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.causePositionVote') AS cause,
		date_T_insert
	FROM grp
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[OBJECT]'

	UNION ALL
	SELECT
		uid,
		groupe_organe,
		'abstention' AS type_vote,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.acteurRef') AS acteurRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.mandatRef') AS mandatRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.parDelegation') AS parDelegation,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.numPlace') AS numPlace,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.causePositionVote') AS cause,
		date_T_insert
	FROM grp
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[OBJECT]'

	UNION ALL
	SELECT
		uid,
		groupe_organe,
		'nonVotant' AS type_vote,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.acteurRef') AS acteurRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.mandatRef') AS mandatRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.parDelegation') AS parDelegation,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.numPlace') AS numPlace,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.causePositionVote') AS cause,
		date_T_insert
	FROM grp
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[OBJECT]'
),

clean AS (
	-- sécurise les champs (souvent string ou null)
	SELECT
		uid,
		groupe_organe,
		type_vote,
		json_extract_string(vote_json, '$.acteurRef') AS acteurRef,
		json_extract_string(vote_json, '$.mandatRef') AS mandatRef,
		json_extract_string(vote_json, '$.parDelegation') AS parDelegation,
		json_extract_string(vote_json, '$.numPlace') AS numPlace,
		json_extract_string(vote_json, '$.causePositionVote') AS cause,
		date_T_insert
	FROM positions_array
	UNION ALL
	SELECT * 
	FROM positions_object
)

SELECT * FROM clean


	LEFT JOIN "an_data_pipeline"."main"."int_scrutins_votes" AS target ON clean.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:27:01.286212 [debug] [Thread-1 (]: SQL status: OK in 9.420 seconds
[0m16:27:01.292032 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:27:01.292336 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m16:27:01.293140 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:27:01.293329 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:27:01.293502 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins_votes__155c90fd9875'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:27:01.295518 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:27:01.297604 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:27:01.297843 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins_votes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:27:01.299566 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:27:01.301264 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:27:01.301474 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins_votes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:27:01.303111 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:27:01.304690 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins_votes"
[0m16:27:01.305555 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:27:01.305770 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

        
            delete from "an_data_pipeline"."main"."int_scrutins_votes" as DBT_INCREMENTAL_TARGET
            using "an_data_pipeline"."dbt_temp"."int_scrutins_votes__155c90fd9875"
            where (
                
                    "an_data_pipeline"."dbt_temp"."int_scrutins_votes__155c90fd9875".uid = DBT_INCREMENTAL_TARGET.uid
                    and 
                
                    "an_data_pipeline"."dbt_temp"."int_scrutins_votes__155c90fd9875".acteurRef = DBT_INCREMENTAL_TARGET.acteurRef
                    
                
                
            );
        
    

    insert into "an_data_pipeline"."main"."int_scrutins_votes" ("uid", "groupe_organe", "type_vote", "acteurRef", "mandatRef", "parDelegation", "numPlace", "cause", "date_T_insert")
    (
        select "uid", "groupe_organe", "type_vote", "acteurRef", "mandatRef", "parDelegation", "numPlace", "cause", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_scrutins_votes__155c90fd9875"
    )
  
[0m16:27:01.530252 [debug] [Thread-1 (]: SQL status: OK in 0.224 seconds
[0m16:27:01.532372 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m16:27:01.532974 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:27:01.533482 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m16:27:01.704859 [debug] [Thread-1 (]: SQL status: OK in 0.171 seconds
[0m16:27:01.711722 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:27:01.713429 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__155c90fd9875" cascade
    
[0m16:27:01.917522 [debug] [Thread-1 (]: SQL status: OK in 0.204 seconds
[0m16:27:01.919506 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:27:01.919700 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__155c90fd9875" cascade
    
[0m16:27:02.016625 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m16:27:02.018305 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: Close
[0m16:27:02.019314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '057ce264-c2a4-4eb4-8a5a-ebad9fe1493a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c2a3f0>]}
[0m16:27:02.020162 [info ] [Thread-1 (]: 10 of 11 OK created sql incremental model main.int_scrutins_votes .............. [[32mOK[0m in 10.50s]
[0m16:27:02.020717 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins_votes
[0m16:27:02.021127 [debug] [Thread-1 (]: Began running node model.dbt_an_data.mart_check_insert_dates
[0m16:27:02.022145 [info ] [Thread-1 (]: 11 of 11 SKIP relation main.mart_check_insert_dates ............................ [[33mSKIP[0m]
[0m16:27:02.022621 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.mart_check_insert_dates
[0m16:27:02.027524 [debug] [MainThread]: Using duckdb connection "master"
[0m16:27:02.027794 [debug] [MainThread]: On master: BEGIN
[0m16:27:02.028014 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:27:02.028976 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:27:02.029304 [debug] [MainThread]: On master: COMMIT
[0m16:27:02.029599 [debug] [MainThread]: Using duckdb connection "master"
[0m16:27:02.029891 [debug] [MainThread]: On master: COMMIT
[0m16:27:02.030381 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:27:02.030620 [debug] [MainThread]: On master: Close
[0m16:27:02.030951 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:27:02.031158 [debug] [MainThread]: Connection 'model.dbt_an_data.int_scrutins_votes' was properly closed.
[0m16:27:02.032411 [info ] [MainThread]: 
[0m16:27:02.032861 [info ] [MainThread]: Finished running 10 incremental models, 1 project hook, 1 view model in 0 hours 0 minutes and 41.82 seconds (41.82s).
[0m16:27:02.034183 [debug] [MainThread]: Command end result
[0m16:27:02.053014 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m16:27:02.055681 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m16:27:02.059730 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m16:27:02.059927 [info ] [MainThread]: 
[0m16:27:02.060121 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:27:02.060273 [info ] [MainThread]: 
[0m16:27:02.060457 [error] [MainThread]: [31mFailure in model int_organes (models/int/int_organes.sql)[0m
[0m16:27:02.060626 [error] [MainThread]:   Runtime Error in model int_organes (models/int/int_organes.sql)
  Parser Error: syntax error at or near "LEFT"
  
  LINE 37: 	LEFT JOIN "an_data_pipeline"."main"."int_organes" AS target...
           ^
[0m16:27:02.060756 [info ] [MainThread]: 
[0m16:27:02.060904 [info ] [MainThread]:   compiled code at target/compiled/dbt_an_data/models/int/int_organes.sql
[0m16:27:02.061035 [info ] [MainThread]: 
[0m16:27:02.061962 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=12
[0m16:27:02.062976 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 42.43, "process_in_blocks": "0", "process_kernel_time": 10.507377, "process_mem_max_rss": "2906636288", "process_out_blocks": "0", "process_user_time": 40.07119}
[0m16:27:02.063301 [debug] [MainThread]: Command `dbt run` failed at 16:27:02.063255 after 42.43 seconds
[0m16:27:02.063593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e031d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10737b830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072742c0>]}
[0m16:27:02.063765 [debug] [MainThread]: Flushing usage events
[0m16:27:02.647663 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:27:21.814186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107121490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11195b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11195b590>]}


============================== 16:27:21.817330 | bf006df3-ec4e-4ee2-9966-eb7d5af6071d ==============================
[0m16:27:21.817330 [info ] [MainThread]: Running with dbt=1.10.15
[0m16:27:21.817673 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'warn_error': 'None', 'target_path': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt', 'log_format': 'default', 'write_json': 'True', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run', 'quiet': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'partial_parse': 'True', 'cache_selected_only': 'False', 'no_print': 'None'}
[0m16:27:21.939996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf006df3-ec4e-4ee2-9966-eb7d5af6071d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054d2930>]}
[0m16:27:21.966821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf006df3-ec4e-4ee2-9966-eb7d5af6071d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11198a9c0>]}
[0m16:27:21.968310 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:27:22.023941 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m16:27:22.088770 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:27:22.089121 [debug] [MainThread]: Partial parsing: updated file: dbt_an_data://models/int/int_organes.sql
[0m16:27:22.205029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf006df3-ec4e-4ee2-9966-eb7d5af6071d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129572f0>]}
[0m16:27:22.241520 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m16:27:22.242617 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m16:27:22.254475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf006df3-ec4e-4ee2-9966-eb7d5af6071d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112985610>]}
[0m16:27:22.254742 [info ] [MainThread]: Found 18 models, 1 operation, 9 sources, 469 macros
[0m16:27:22.254927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf006df3-ec4e-4ee2-9966-eb7d5af6071d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129b5400>]}
[0m16:27:22.255984 [info ] [MainThread]: 
[0m16:27:22.256156 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m16:27:22.256294 [info ] [MainThread]: 
[0m16:27:22.256521 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:27:22.258838 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_an_data_pipeline'
[0m16:27:22.289097 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline"
[0m16:27:22.289333 [debug] [ThreadPool]: On list_an_data_pipeline: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"an_data_pipeline"'
    
  
  
[0m16:27:22.289478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:27:23.953894 [debug] [ThreadPool]: SQL status: OK in 1.664 seconds
[0m16:27:23.956240 [debug] [ThreadPool]: On list_an_data_pipeline: Close
[0m16:27:23.957509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_an_data_pipeline, now create_an_data_pipeline_main)
[0m16:27:23.958412 [debug] [ThreadPool]: Creating schema "database: "an_data_pipeline"
schema: "main"
"
[0m16:27:23.967755 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m16:27:23.968284 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:27:23.968648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:27:23.970274 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:27:23.971852 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m16:27:23.972198 [debug] [ThreadPool]: On create_an_data_pipeline_main: BEGIN
[0m16:27:23.973196 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:27:23.973632 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m16:27:23.974002 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
    
        create schema if not exists "an_data_pipeline"."main"
    
[0m16:27:24.074483 [debug] [ThreadPool]: SQL status: OK in 0.100 seconds
[0m16:27:24.076813 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m16:27:24.077486 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m16:27:24.077966 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m16:27:24.173742 [debug] [ThreadPool]: SQL status: OK in 0.095 seconds
[0m16:27:24.175327 [debug] [ThreadPool]: On create_an_data_pipeline_main: Close
[0m16:27:24.179886 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_an_data_pipeline_main, now list_an_data_pipeline_main)
[0m16:27:24.189040 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m16:27:24.189609 [debug] [ThreadPool]: On list_an_data_pipeline_main: BEGIN
[0m16:27:24.189999 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:27:24.191245 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:27:24.191624 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m16:27:24.192019 [debug] [ThreadPool]: On list_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline_main"} */
select
      'an_data_pipeline' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'an_data_pipeline'
  
[0m16:27:24.211093 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:27:24.212900 [debug] [ThreadPool]: On list_an_data_pipeline_main: ROLLBACK
[0m16:27:24.214698 [debug] [ThreadPool]: Failed to rollback 'list_an_data_pipeline_main'
[0m16:27:24.215012 [debug] [ThreadPool]: On list_an_data_pipeline_main: Close
[0m16:27:24.216717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf006df3-ec4e-4ee2-9966-eb7d5af6071d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112883560>]}
[0m16:27:24.217157 [debug] [MainThread]: Using duckdb connection "master"
[0m16:27:24.217395 [debug] [MainThread]: On master: BEGIN
[0m16:27:24.217621 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:27:24.218452 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:27:24.218691 [debug] [MainThread]: On master: COMMIT
[0m16:27:24.218911 [debug] [MainThread]: Using duckdb connection "master"
[0m16:27:24.219121 [debug] [MainThread]: On master: COMMIT
[0m16:27:24.219501 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:27:24.225675 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_an_data.dbt_an_data-on-run-start-0"
[0m16:27:24.229290 [info ] [MainThread]: 1 of 1 START hook: dbt_an_data.on-run-start.0 .................................. [RUN]
[0m16:27:24.229671 [debug] [MainThread]: Using duckdb connection "master"
[0m16:27:24.229936 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "master"} */
ATTACH '../data/database/database.duckdb' AS database (READ_ONLY)
[0m16:27:24.237351 [debug] [MainThread]: SQL status: OK in 0.007 seconds
[0m16:27:24.238079 [info ] [MainThread]: 1 of 1 OK hook: dbt_an_data.on-run-start.0 ..................................... [[32mOK[0m in 0.02s]
[0m16:27:24.238305 [info ] [MainThread]: 
[0m16:27:24.238512 [debug] [MainThread]: On master: Close
[0m16:27:24.240067 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_acteurs
[0m16:27:24.240360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_an_data_pipeline_main, now model.dbt_an_data.stg_acteurs)
[0m16:27:24.240583 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_acteurs
[0m16:27:24.242542 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_acteurs"
[0m16:27:24.243194 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_acteurs
[0m16:27:24.243419 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_agenda
[0m16:27:24.243675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_acteurs, now model.dbt_an_data.stg_agenda)
[0m16:27:24.243899 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_agenda
[0m16:27:24.245535 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_agenda"
[0m16:27:24.246081 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_agenda
[0m16:27:24.246303 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_amendements
[0m16:27:24.246536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_agenda, now model.dbt_an_data.stg_amendements)
[0m16:27:24.246854 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_amendements
[0m16:27:24.248566 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_amendements"
[0m16:27:24.249169 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_amendements
[0m16:27:24.249387 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_organes
[0m16:27:24.249650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_amendements, now model.dbt_an_data.stg_organes)
[0m16:27:24.250063 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_organes
[0m16:27:24.251463 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_organes"
[0m16:27:24.251951 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_organes
[0m16:27:24.252149 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_pays
[0m16:27:24.252467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_organes, now model.dbt_an_data.stg_pays)
[0m16:27:24.252676 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_pays
[0m16:27:24.253920 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_pays"
[0m16:27:24.254344 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_pays
[0m16:27:24.254535 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_reunions
[0m16:27:24.255544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_pays, now model.dbt_an_data.stg_reunions)
[0m16:27:24.255759 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_reunions
[0m16:27:24.257044 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_reunions"
[0m16:27:24.257483 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_reunions
[0m16:27:24.257669 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_scrutins
[0m16:27:24.288933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_reunions, now model.dbt_an_data.stg_scrutins)
[0m16:27:24.289209 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_scrutins
[0m16:27:24.290498 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_scrutins"
[0m16:27:24.290989 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_scrutins
[0m16:27:24.291161 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_acteurs
[0m16:27:24.291356 [info ] [Thread-1 (]: 1 of 11 START sql incremental model main.int_acteurs ........................... [RUN]
[0m16:27:24.291542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_scrutins, now model.dbt_an_data.int_acteurs)
[0m16:27:24.291692 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_acteurs
[0m16:27:24.297743 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_acteurs"
[0m16:27:24.298102 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_acteurs
[0m16:27:24.301415 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:27:24.301596 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__e49fdc6c3bef" cascade
    
[0m16:27:24.301748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:27:24.399533 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m16:27:24.428768 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:27:24.429063 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:27:24.429967 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:27:24.430811 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:27:24.431022 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m16:27:24.431484 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:27:24.431676 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:27:24.431868 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m16:27:24.527904 [debug] [Thread-1 (]: SQL status: OK in 0.096 seconds
[0m16:27:24.529081 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:27:24.529455 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    

  
[0m16:27:24.529856 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:27:24.530921 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m16:27:24.531262 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:27:24.531580 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m16:27:24.626077 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m16:27:24.645535 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:27:24.646184 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_acteurs__e49fdc6c3bef"
  
    as (
      

WITH  __dbt__cte__stg_acteurs as (
SELECT * 
FROM "database"."stg"."raw_acteurs"
), acteurs AS (
	SELECT 
		json_extract_string(json, '$.acteur.uid.#text') as uid,
		json_extract_string(json, '$.acteur.etatCivil.ident.civ') as civ,
		json_extract_string(json, '$.acteur.etatCivil.ident.prenom') as prenom,
		json_extract_string(json, '$.acteur.etatCivil.ident.nom') as nom,
		json_extract_string(json, '$.acteur.etatCivil.ident.trigramme') as trigramme,
		json_extract_string(json, '$.acteur.etatCivil.infoNaissance.dateNais') as dateNais,
		json_extract_string(json, '$.acteur.etatCivil.infoNaissance.villeNais') as villeNais,
		json_extract_string(json, '$.acteur.etatCivil.infoNaissance.depNais') as depNais,
		json_extract_string(json, '$.acteur.etatCivil.infoNaissance.paysNais') as paysNais,
		json_extract_string(json, '$.acteur.etatCivil.dateDeces') as dateDeces,
		json_extract_string(json, '$.acteur.profession.libelleCourant') as libelleCourant,
		json_extract_string(json, '$.acteur.profession.socProcINSEE.catSocPro') as catSocPro,
		json_extract_string(json, '$.acteur.profession.socProcINSEE.famSocPro') as famSocPro,
		json_extract_string(json, '$.acteur.uri_hatvp') as uri_hatvp,
		date_T_insert
	FROM __dbt__cte__stg_acteurs
)
SELECT *
FROM acteurs


	LEFT JOIN "an_data_pipeline"."main"."int_acteurs" AS target ON acteurs.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:27:25.286321 [debug] [Thread-1 (]: SQL status: OK in 0.640 seconds
[0m16:27:25.293363 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:27:25.293740 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m16:27:25.294744 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:27:25.295035 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:27:25.295335 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs__e49fdc6c3bef'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:27:25.298396 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:27:25.304562 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:27:25.304909 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:27:25.307318 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:27:25.312358 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:27:25.312646 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:27:25.314634 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:27:25.315719 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:27:25.315955 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */
SELECT version()
[0m16:27:25.316347 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:27:25.326048 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_acteurs"
[0m16:27:25.326557 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:27:25.326781 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

        
            delete from "an_data_pipeline"."main"."int_acteurs"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_acteurs__e49fdc6c3bef"
            );

        
    

    insert into "an_data_pipeline"."main"."int_acteurs" ("uid", "civ", "prenom", "nom", "trigramme", "dateNais", "villeNais", "depNais", "paysNais", "dateDeces", "libelleCourant", "catSocPro", "famSocPro", "uri_hatvp", "date_T_insert")
    (
        select "uid", "civ", "prenom", "nom", "trigramme", "dateNais", "villeNais", "depNais", "paysNais", "dateDeces", "libelleCourant", "catSocPro", "famSocPro", "uri_hatvp", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_acteurs__e49fdc6c3bef"
    )
  
[0m16:27:25.532054 [debug] [Thread-1 (]: SQL status: OK in 0.205 seconds
[0m16:27:25.546445 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m16:27:25.546942 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:27:25.547336 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m16:27:25.726956 [debug] [Thread-1 (]: SQL status: OK in 0.179 seconds
[0m16:27:25.734878 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:27:25.735557 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__e49fdc6c3bef" cascade
    
[0m16:27:25.945202 [debug] [Thread-1 (]: SQL status: OK in 0.209 seconds
[0m16:27:25.949902 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m16:27:25.950292 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__e49fdc6c3bef" cascade
    
[0m16:27:26.050623 [debug] [Thread-1 (]: SQL status: OK in 0.100 seconds
[0m16:27:26.055314 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: Close
[0m16:27:26.058345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf006df3-ec4e-4ee2-9966-eb7d5af6071d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076190d0>]}
[0m16:27:26.059305 [info ] [Thread-1 (]: 1 of 11 OK created sql incremental model main.int_acteurs ...................... [[32mOK[0m in 1.76s]
[0m16:27:26.060066 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_acteurs
[0m16:27:26.060610 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_mandats
[0m16:27:26.061248 [info ] [Thread-1 (]: 2 of 11 START sql incremental model main.int_mandats ........................... [RUN]
[0m16:27:26.061993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_acteurs, now model.dbt_an_data.int_mandats)
[0m16:27:26.062523 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_mandats
[0m16:27:26.076161 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_mandats"
[0m16:27:26.077057 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_mandats
[0m16:27:26.080760 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:27:26.081124 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__b1c6613e09c7" cascade
    
[0m16:27:26.081434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:27:26.183012 [debug] [Thread-1 (]: SQL status: OK in 0.101 seconds
[0m16:27:26.188180 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:27:26.188793 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:27:26.190597 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:27:26.192502 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:27:26.192983 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m16:27:26.194067 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:27:26.194495 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:27:26.194930 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m16:27:26.292953 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m16:27:26.295539 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:27:26.296297 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    

  
[0m16:27:26.296990 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:27:26.299080 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m16:27:26.299569 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:27:26.300026 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m16:27:26.395395 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m16:27:26.398146 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:27:26.399320 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_mandats__b1c6613e09c7"
  
    as (
      

WITH  __dbt__cte__stg_acteurs as (
SELECT * 
FROM "database"."stg"."raw_acteurs"
), mandats AS (
	SELECT 
		json_extract_string(mandat.value, '$.uid') as uid,
		json_extract_string(mandat.value, '$.acteurRef') as acteurRef,
		json_extract_string(mandat.value, '$.legislature') as legislature,
		json_extract_string(mandat.value, '$.typeOrgane') as typeOrgane,
		json_extract_string(mandat.value, '$.dateDebut') as dateDebut,
		json_extract_string(mandat.value, '$.dateFin') as dateFin,
		json_extract_string(mandat.value, '$.preseance') as preseance,
		json_extract_string(mandat.value, '$.nominPrincipale') as nominPrincipale,
		json_extract_string(mandat.value, '$.infosQualite.codeQualite') as codeQualite,
		json_extract_string(mandat.value, '$.organes.organeRef') as organeRef,
		date_T_insert
	FROM __dbt__cte__stg_acteurs act, json_each(json->'acteur'->'mandats'->'mandat') mandat
)
SELECT * 
FROM mandats


	LEFT JOIN "an_data_pipeline"."main"."int_mandats" AS target ON mandats.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:27:27.136970 [debug] [Thread-1 (]: SQL status: OK in 0.737 seconds
[0m16:27:27.139114 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:27:27.139377 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m16:27:27.140041 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:27:27.140257 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:27:27.140480 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats__b1c6613e09c7'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:27:27.142601 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:27:27.145583 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:27:27.145839 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:27:27.147657 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:27:27.150263 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:27:27.150479 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:27:27.152099 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:27:27.153244 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_mandats"
[0m16:27:27.153736 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:27:27.153944 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

        
            delete from "an_data_pipeline"."main"."int_mandats"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_mandats__b1c6613e09c7"
            );

        
    

    insert into "an_data_pipeline"."main"."int_mandats" ("uid", "acteurRef", "legislature", "typeOrgane", "dateDebut", "dateFin", "preseance", "nominPrincipale", "codeQualite", "organeRef", "date_T_insert")
    (
        select "uid", "acteurRef", "legislature", "typeOrgane", "dateDebut", "dateFin", "preseance", "nominPrincipale", "codeQualite", "organeRef", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_mandats__b1c6613e09c7"
    )
  
[0m16:27:27.358569 [debug] [Thread-1 (]: SQL status: OK in 0.204 seconds
[0m16:27:27.360548 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m16:27:27.361107 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:27:27.361831 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m16:27:27.458616 [debug] [Thread-1 (]: SQL status: OK in 0.096 seconds
[0m16:27:27.466338 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:27:27.470545 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__b1c6613e09c7" cascade
    
[0m16:27:27.687382 [debug] [Thread-1 (]: SQL status: OK in 0.216 seconds
[0m16:27:27.692542 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m16:27:27.693115 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__b1c6613e09c7" cascade
    
[0m16:27:27.794114 [debug] [Thread-1 (]: SQL status: OK in 0.100 seconds
[0m16:27:27.796854 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: Close
[0m16:27:27.797988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf006df3-ec4e-4ee2-9966-eb7d5af6071d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113420770>]}
[0m16:27:27.799305 [info ] [Thread-1 (]: 2 of 11 OK created sql incremental model main.int_mandats ...................... [[32mOK[0m in 1.74s]
[0m16:27:27.800112 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_mandats
[0m16:27:27.800644 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_agenda
[0m16:27:27.801357 [info ] [Thread-1 (]: 3 of 11 START sql incremental model main.int_agenda ............................ [RUN]
[0m16:27:27.802113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_mandats, now model.dbt_an_data.int_agenda)
[0m16:27:27.802646 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_agenda
[0m16:27:27.807383 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_agenda"
[0m16:27:27.808407 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_agenda
[0m16:27:27.812767 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:27:27.813209 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__6674e4ba0956" cascade
    
[0m16:27:27.813588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:27:27.914580 [debug] [Thread-1 (]: SQL status: OK in 0.101 seconds
[0m16:27:27.918998 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:27:27.919495 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:27:27.921277 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:27:27.923099 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:27:27.923571 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m16:27:27.924648 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:27:27.925087 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:27:27.925517 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m16:27:28.022837 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m16:27:28.024768 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:27:28.025238 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    

  
[0m16:27:28.025797 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:27:28.027237 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m16:27:28.027694 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:27:28.028223 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m16:27:28.123779 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m16:27:28.126853 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:27:28.127933 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_agenda__6674e4ba0956"
  
    as (
      

with __dbt__cte__stg_agenda as (
SELECT * 
FROM "database"."stg"."raw_agenda"
) SELECT * 
FROM __dbt__cte__stg_agenda
    );
  
  
  
[0m16:27:28.450319 [debug] [Thread-1 (]: SQL status: OK in 0.321 seconds
[0m16:27:28.453270 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:27:28.453790 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m16:27:28.454744 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:27:28.455080 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:27:28.455425 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda__6674e4ba0956'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:27:28.458883 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:27:28.461605 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:27:28.461941 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:27:28.464435 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:27:28.469021 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:27:28.469342 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:27:28.471658 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:27:28.473094 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_agenda"
[0m16:27:28.473806 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:27:28.474082 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

        
            delete from "an_data_pipeline"."main"."int_agenda" as DBT_INCREMENTAL_TARGET
            using "an_data_pipeline"."dbt_temp"."int_agenda__6674e4ba0956"
            where (
                
                    "an_data_pipeline"."dbt_temp"."int_agenda__6674e4ba0956".Date = DBT_INCREMENTAL_TARGET.Date
                    and 
                
                    "an_data_pipeline"."dbt_temp"."int_agenda__6674e4ba0956".Heure = DBT_INCREMENTAL_TARGET.Heure
                    
                
                
            );
        
    

    insert into "an_data_pipeline"."main"."int_agenda" ("Date", "Heure", "Ordre(s) du jour", "filename", "date_T_insert")
    (
        select "Date", "Heure", "Ordre(s) du jour", "filename", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_agenda__6674e4ba0956"
    )
  
[0m16:27:28.682397 [debug] [Thread-1 (]: SQL status: OK in 0.208 seconds
[0m16:27:28.685298 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m16:27:28.685919 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:27:28.686378 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m16:27:28.799672 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m16:27:28.806165 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:27:28.806998 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__6674e4ba0956" cascade
    
[0m16:27:29.017344 [debug] [Thread-1 (]: SQL status: OK in 0.209 seconds
[0m16:27:29.023423 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m16:27:29.023925 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__6674e4ba0956" cascade
    
[0m16:27:29.126795 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m16:27:29.128811 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: Close
[0m16:27:29.129613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf006df3-ec4e-4ee2-9966-eb7d5af6071d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bf7890>]}
[0m16:27:29.130486 [info ] [Thread-1 (]: 3 of 11 OK created sql incremental model main.int_agenda ....................... [[32mOK[0m in 1.33s]
[0m16:27:29.131220 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_agenda
[0m16:27:29.131726 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements
[0m16:27:29.132336 [info ] [Thread-1 (]: 4 of 11 START sql incremental model main.int_amendements ....................... [RUN]
[0m16:27:29.132877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_agenda, now model.dbt_an_data.int_amendements)
[0m16:27:29.133340 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements
[0m16:27:29.157316 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements"
[0m16:27:29.158158 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements
[0m16:27:29.161210 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:27:29.161517 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__d54fdafb0a9d" cascade
    
[0m16:27:29.161795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:27:29.260243 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m16:27:29.264476 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:27:29.265026 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:27:29.266864 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:27:29.268924 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:27:29.269465 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m16:27:29.270608 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:27:29.271066 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:27:29.271526 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m16:27:29.370395 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m16:27:29.372691 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:27:29.373190 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    

  
[0m16:27:29.373752 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:27:29.376110 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m16:27:29.376649 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:27:29.377115 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m16:27:29.472646 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m16:27:29.475199 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:27:29.476159 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_amendements__d54fdafb0a9d"
  
    as (
      

WITH  __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
), amendements AS (
	SELECT
		json_extract_string(json, '$.amendement.uid') AS uid,
		json_extract_string(json, '$.amendement.chronotag') AS chronotag,
		json_extract_string(json, '$.amendement.examenRef') AS examenRef,
		json_extract_string(json, '$.amendement.amendementParentRef') AS amendementParentRef,
		json_extract_string(json, '$.amendement.signataires.auteur.typeAuteur') AS typeAuteur,
		json_extract_string(json, '$.amendement.signataires.auteur.acteurRef') AS refAuteur,
		json_extract_string(json, '$.amendement.signataires.auteur.groupePolitique') AS groupePolitiqueAuteur,
		json_extract_string(json, '$.amendement.cycleDeVie.dateDepot') AS dateDepot,
		json_extract_string(json, '$.amendement.cycleDeVie.datePublication') AS datePublication,
		json_extract_string(json, '$.amendement.cycleDeVie.soumisArticle40') AS soumisArticle40,
		json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.code') AS codeEtat,
		json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.libelle') AS libelleEtat,
		json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.code') AS codeSousEtat,
		json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
		json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
		json_extract_string(json, '$.amendement.cycleDeVie.dateSort') AS dateSort,
		json_extract_string(json, '$.amendement.cycleDeVie.sort') AS sort,
		split_part(replace(filename, '.json', ''), '/', -1) AS id_amendement,
		split_part(replace(filename, '.json', ''), '/', -2) AS id_texte,
		split_part(replace(filename, '.json', ''), '/', -3) AS id_dossier_legislatif,
		id_texte[:4] AS nature_texte,
		id_texte[5:6] AS source_texte,
		regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 1) AS prefix_bibard,
		regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 2) AS numero_bibard,
		regexp_extract(id_amendement, '(SEA|PO\d*)', 1) AS code_organe,
		regexp_extract(id_amendement, '(P)(\d*)(D)', 2) AS numero_partie,
		regexp_extract(id_amendement, '(D)(\d*)(N)', 2) AS numero_deliberation,
		regexp_extract(id_amendement, '(D)(\d*)(N)(\d*)', 4) AS numero_court,
		date_T_insert
	FROM __dbt__cte__stg_amendements
)
SELECT * 
FROM amendements


	LEFT JOIN "an_data_pipeline"."main"."int_amendements" AS target ON amendements.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:27:36.187335 [debug] [Thread-1 (]: SQL status: OK in 6.711 seconds
[0m16:27:36.189417 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:27:36.189617 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m16:27:36.190140 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:27:36.190312 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:27:36.190483 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements__d54fdafb0a9d'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:27:36.192128 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:27:36.194048 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:27:36.194226 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:27:36.195602 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:27:36.197154 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:27:36.197327 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:27:36.198713 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:27:36.200006 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements"
[0m16:27:36.200394 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:27:36.200591 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

        
            delete from "an_data_pipeline"."main"."int_amendements"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_amendements__d54fdafb0a9d"
            );

        
    

    insert into "an_data_pipeline"."main"."int_amendements" ("uid", "chronotag", "examenRef", "amendementParentRef", "typeAuteur", "refAuteur", "groupePolitiqueAuteur", "dateDepot", "datePublication", "soumisArticle40", "codeEtat", "libelleEtat", "codeSousEtat", "libelleSousEtat", "libelleSousEtat_1", "dateSort", "sort", "id_amendement", "id_texte", "id_dossier_legislatif", "nature_texte", "source_texte", "prefix_bibard", "numero_bibard", "code_organe", "numero_partie", "numero_deliberation", "numero_court", "date_T_insert")
    (
        select "uid", "chronotag", "examenRef", "amendementParentRef", "typeAuteur", "refAuteur", "groupePolitiqueAuteur", "dateDepot", "datePublication", "soumisArticle40", "codeEtat", "libelleEtat", "codeSousEtat", "libelleSousEtat", "libelleSousEtat_1", "dateSort", "sort", "id_amendement", "id_texte", "id_dossier_legislatif", "nature_texte", "source_texte", "prefix_bibard", "numero_bibard", "code_organe", "numero_partie", "numero_deliberation", "numero_court", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_amendements__d54fdafb0a9d"
    )
  
[0m16:27:36.407508 [debug] [Thread-1 (]: SQL status: OK in 0.207 seconds
[0m16:27:36.408419 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m16:27:36.408651 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:27:36.408840 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m16:27:36.504067 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m16:27:36.505763 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:27:36.505982 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__d54fdafb0a9d" cascade
    
[0m16:27:36.707234 [debug] [Thread-1 (]: SQL status: OK in 0.201 seconds
[0m16:27:36.708843 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m16:27:36.709028 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__d54fdafb0a9d" cascade
    
[0m16:27:36.805816 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m16:27:36.807002 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: Close
[0m16:27:36.807497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf006df3-ec4e-4ee2-9966-eb7d5af6071d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ef4410>]}
[0m16:27:36.808034 [info ] [Thread-1 (]: 4 of 11 OK created sql incremental model main.int_amendements .................. [[32mOK[0m in 7.67s]
[0m16:27:36.808484 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements
[0m16:27:36.808799 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements_cosignataires
[0m16:27:36.809326 [info ] [Thread-1 (]: 5 of 11 START sql incremental model main.int_amendements_cosignataires ......... [RUN]
[0m16:27:36.809760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements, now model.dbt_an_data.int_amendements_cosignataires)
[0m16:27:36.810095 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements_cosignataires
[0m16:27:36.818699 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements_cosignataires"
[0m16:27:36.819340 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements_cosignataires
[0m16:27:36.823457 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:27:36.823741 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__d0e57f0345fb" cascade
    
[0m16:27:36.823988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:27:36.920739 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m16:27:36.922882 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:27:36.923194 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:27:36.924245 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:27:36.925245 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:27:36.925513 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m16:27:36.926103 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:27:36.926344 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:27:36.926584 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m16:27:37.023548 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m16:27:37.024995 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:27:37.025483 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    

  
[0m16:27:37.026006 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:27:37.027323 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m16:27:37.027702 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:27:37.028047 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m16:27:37.123008 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m16:27:37.125741 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:27:37.126948 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__d0e57f0345fb"
  
    as (
      

WITH  __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
), cosignataires_arr AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef[*]') AS acteurRef,
    date_T_insert
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') == 'ARRAY' AND acteurRef IS NOT NULL
), cosignataires_str AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef') AS acteurRef,
    date_T_insert
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') <> 'ARRAY' AND acteurRef IS NOT NULL
), cosignataires AS (
	SELECT 
		uid, 
		unnest(acteurRef) as acteurRef,
		date_T_insert
	FROM cosignataires_arr
	UNION ALL
	SELECT 
		uid, 
		acteurRef,
		date_T_insert
	FROM cosignataires_str
)
SELECT * 
FROM cosignataires


	LEFT JOIN "an_data_pipeline"."main"."int_amendements_cosignataires" AS target ON cosignataires.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:27:42.989357 [debug] [Thread-1 (]: SQL status: OK in 5.862 seconds
[0m16:27:42.991145 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:27:42.991330 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m16:27:42.991835 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:27:42.991993 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:27:42.992154 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires__d0e57f0345fb'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:27:42.993726 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:27:42.995943 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:27:42.996124 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:27:42.997473 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:27:42.998784 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:27:42.998957 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:27:43.000335 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:27:43.001333 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements_cosignataires"
[0m16:27:43.001796 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:27:43.001990 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

        
            delete from "an_data_pipeline"."main"."int_amendements_cosignataires" as DBT_INCREMENTAL_TARGET
            using "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__d0e57f0345fb"
            where (
                
                    "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__d0e57f0345fb".uid = DBT_INCREMENTAL_TARGET.uid
                    and 
                
                    "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__d0e57f0345fb".acteurRef = DBT_INCREMENTAL_TARGET.acteurRef
                    
                
                
            );
        
    

    insert into "an_data_pipeline"."main"."int_amendements_cosignataires" ("uid", "acteurRef", "date_T_insert")
    (
        select "uid", "acteurRef", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__d0e57f0345fb"
    )
  
[0m16:27:43.207463 [debug] [Thread-1 (]: SQL status: OK in 0.205 seconds
[0m16:27:43.210362 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m16:27:43.210983 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:27:43.211460 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m16:27:43.307734 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m16:27:43.313508 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:27:43.314518 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__d0e57f0345fb" cascade
    
[0m16:27:43.528701 [debug] [Thread-1 (]: SQL status: OK in 0.213 seconds
[0m16:27:43.534191 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m16:27:43.534809 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__d0e57f0345fb" cascade
    
[0m16:27:43.639805 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m16:27:43.642592 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: Close
[0m16:27:43.643676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf006df3-ec4e-4ee2-9966-eb7d5af6071d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bf7e00>]}
[0m16:27:43.644623 [info ] [Thread-1 (]: 5 of 11 OK created sql incremental model main.int_amendements_cosignataires .... [[32mOK[0m in 6.83s]
[0m16:27:43.645391 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements_cosignataires
[0m16:27:43.645907 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_organes
[0m16:27:43.646597 [info ] [Thread-1 (]: 6 of 11 START sql incremental model main.int_organes ........................... [RUN]
[0m16:27:43.647217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements_cosignataires, now model.dbt_an_data.int_organes)
[0m16:27:43.647719 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_organes
[0m16:27:43.661288 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_organes"
[0m16:27:43.662220 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_organes
[0m16:27:43.666512 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:27:43.666946 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__bffe00d79be6" cascade
    
[0m16:27:43.667280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:27:43.765897 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m16:27:43.769699 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:27:43.770229 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:27:43.772259 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:27:43.774111 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:27:43.774586 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m16:27:43.775652 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:27:43.776079 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:27:43.776449 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m16:27:43.876547 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m16:27:43.879936 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:27:43.880700 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    

  
[0m16:27:43.881564 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:27:43.883946 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m16:27:43.884614 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:27:43.885194 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m16:27:43.984571 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m16:27:43.986737 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:27:43.987430 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_organes__bffe00d79be6"
  
    as (
      

WITH  __dbt__cte__stg_organes as (
SELECT * 
FROM "database"."stg"."raw_organes"
), organes AS (
	SELECT 
		json_extract_string(json, '$.organe.uid') as uid,
		json_extract_string(json, '$.organe.codeType') as codeType,
		json_extract_string(json, '$.organe.libelle') as libelle,
		json_extract_string(json, '$.organe.libelleEdition') as libelleEdition,
		json_extract_string(json, '$.organe.libelleAbrege') as libelleAbrege,
		json_extract_string(json, '$.organe.libelleAbrev') as libelleAbrev,
		json_extract_string(json, '$.organe.viMoDe.dateDebut') as dateDebut,
		json_extract_string(json, '$.organe.viMoDe.dateAgrement') as dateAgrement,
		json_extract_string(json, '$.organe.viMoDe.dateFin') as dateFin,
		json_extract_string(json, '$.organe.organeParent') as organeParent,
		json_extract_string(json, '$.organe.chambre') as chambre,
		json_extract_string(json, '$.organe.regime') as regime,
		json_extract_string(json, '$.organe.legislature') as legislature,
		date_T_insert
	FROM __dbt__cte__stg_organes
)
SELECT * 
FROM organes


	LEFT JOIN "an_data_pipeline"."main"."int_organes" AS target ON organes.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:27:45.029539 [debug] [Thread-1 (]: SQL status: OK in 1.042 seconds
[0m16:27:45.033981 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:27:45.034321 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m16:27:45.035271 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:27:45.035566 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:27:45.035864 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes__bffe00d79be6'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:27:45.038931 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:27:45.041642 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:27:45.041946 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:27:45.044141 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:27:45.046437 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:27:45.046719 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:27:45.048694 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:27:45.050080 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_organes"
[0m16:27:45.051063 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:27:45.051380 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

        
            delete from "an_data_pipeline"."main"."int_organes"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_organes__bffe00d79be6"
            );

        
    

    insert into "an_data_pipeline"."main"."int_organes" ("uid", "codeType", "libelle", "libelleEdition", "libelleAbrege", "libelleAbrev", "dateDebut", "dateAgrement", "dateFin", "organeParent", "chambre", "regime", "legislature", "date_T_insert")
    (
        select "uid", "codeType", "libelle", "libelleEdition", "libelleAbrege", "libelleAbrev", "dateDebut", "dateAgrement", "dateFin", "organeParent", "chambre", "regime", "legislature", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_organes__bffe00d79be6"
    )
  
[0m16:27:45.260423 [debug] [Thread-1 (]: SQL status: OK in 0.209 seconds
[0m16:27:45.262506 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m16:27:45.263055 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:27:45.263530 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m16:27:45.374030 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m16:27:45.380110 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:27:45.380739 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__bffe00d79be6" cascade
    
[0m16:27:45.585390 [debug] [Thread-1 (]: SQL status: OK in 0.204 seconds
[0m16:27:45.587104 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m16:27:45.587291 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__bffe00d79be6" cascade
    
[0m16:27:45.686084 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m16:27:45.687436 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: Close
[0m16:27:45.688011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf006df3-ec4e-4ee2-9966-eb7d5af6071d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113407290>]}
[0m16:27:45.688639 [info ] [Thread-1 (]: 6 of 11 OK created sql incremental model main.int_organes ...................... [[32mOK[0m in 2.04s]
[0m16:27:45.689151 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_organes
[0m16:27:45.689474 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_pays
[0m16:27:45.689894 [info ] [Thread-1 (]: 7 of 11 START sql incremental model main.int_pays .............................. [RUN]
[0m16:27:45.690277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_organes, now model.dbt_an_data.int_pays)
[0m16:27:45.690583 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_pays
[0m16:27:45.699779 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_pays"
[0m16:27:45.700469 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_pays
[0m16:27:45.703133 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:27:45.703399 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__6af40d31fd71" cascade
    
[0m16:27:45.703703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:27:45.802057 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m16:27:45.805099 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:27:45.805577 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:27:45.807098 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:27:45.808561 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:27:45.808959 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m16:27:45.809833 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:27:45.810183 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:27:45.810540 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m16:27:45.909011 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m16:27:45.911608 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:27:45.912439 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    

  
[0m16:27:45.913178 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:27:45.915027 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m16:27:45.915508 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:27:45.915955 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m16:27:46.010921 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m16:27:46.013821 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:27:46.014718 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_pays__6af40d31fd71"
  
    as (
      

WITH  __dbt__cte__stg_pays as (
SELECT * 
FROM "database"."stg"."raw_pays"
), pays AS (
	SELECT
		json_extract_string(json, '$.pays.uid') as uid,
		json_extract_string(json, '$.pays.code_insee') as code_insee,
		json_extract_string(json, '$.pays.libelleInsee') as libelleInsee,
		json_extract_string(json, '$.pays.nomCourant') as nomCourant,
		json_extract_string(json, '$.pays.code_iso2A') as code_iso2A,
		json_extract_string(json, '$.pays.code_iso3A') as code_iso3A,
		json_extract_string(json, '$.pays.code_iso3N') as code_iso3N,
		json_extract_string(json, '$.pays.libelleIso') as libelleIso,
		json_extract_string(json, '$.pays.libelleANCourt') as libelleANCourt,
		json_extract_string(json, '$.pays.libelleANLong') as libelleANLong,
		json_extract_string(json, '$.pays.sourceJuridique') as sourceJuridique,
		json_extract_string(json, '$.pays.activ') as activ,
		date_T_insert
	FROM __dbt__cte__stg_pays source
)
SELECT * 
FROM pays


	LEFT JOIN "an_data_pipeline"."main"."int_pays" AS target ON pays.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:27:46.433126 [debug] [Thread-1 (]: SQL status: OK in 0.418 seconds
[0m16:27:46.436020 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:27:46.436520 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m16:27:46.437443 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:27:46.437753 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:27:46.438108 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays__6af40d31fd71'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:27:46.441291 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:27:46.446028 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:27:46.446369 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:27:46.448854 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:27:46.451387 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:27:46.451674 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:27:46.453819 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:27:46.455400 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_pays"
[0m16:27:46.456020 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:27:46.456298 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

        
            delete from "an_data_pipeline"."main"."int_pays"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_pays__6af40d31fd71"
            );

        
    

    insert into "an_data_pipeline"."main"."int_pays" ("uid", "code_insee", "libelleInsee", "nomCourant", "code_iso2A", "code_iso3A", "code_iso3N", "libelleIso", "libelleANCourt", "libelleANLong", "sourceJuridique", "activ", "date_T_insert")
    (
        select "uid", "code_insee", "libelleInsee", "nomCourant", "code_iso2A", "code_iso3A", "code_iso3N", "libelleIso", "libelleANCourt", "libelleANLong", "sourceJuridique", "activ", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_pays__6af40d31fd71"
    )
  
[0m16:27:46.663843 [debug] [Thread-1 (]: SQL status: OK in 0.207 seconds
[0m16:27:46.665909 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m16:27:46.666511 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:27:46.666967 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m16:27:46.765954 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m16:27:46.770839 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:27:46.771763 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__6af40d31fd71" cascade
    
[0m16:27:46.976479 [debug] [Thread-1 (]: SQL status: OK in 0.204 seconds
[0m16:27:46.978368 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m16:27:46.978559 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__6af40d31fd71" cascade
    
[0m16:27:47.077055 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m16:27:47.078526 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: Close
[0m16:27:47.079091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf006df3-ec4e-4ee2-9966-eb7d5af6071d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113434a10>]}
[0m16:27:47.079621 [info ] [Thread-1 (]: 7 of 11 OK created sql incremental model main.int_pays ......................... [[32mOK[0m in 1.39s]
[0m16:27:47.080057 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_pays
[0m16:27:47.080369 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_reunions
[0m16:27:47.080810 [info ] [Thread-1 (]: 8 of 11 START sql incremental model main.int_reunions .......................... [RUN]
[0m16:27:47.081236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_pays, now model.dbt_an_data.int_reunions)
[0m16:27:47.081553 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_reunions
[0m16:27:47.092942 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_reunions"
[0m16:27:47.093610 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_reunions
[0m16:27:47.096404 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:27:47.096691 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__20272ada3743" cascade
    
[0m16:27:47.096938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:27:47.195675 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m16:27:47.198772 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:27:47.199234 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:27:47.200638 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:27:47.201958 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:27:47.202294 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m16:27:47.203114 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:27:47.203440 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:27:47.203747 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m16:27:47.303994 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m16:27:47.307420 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:27:47.308298 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    

  
[0m16:27:47.309053 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:27:47.310900 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m16:27:47.311392 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:27:47.311831 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m16:27:47.408056 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m16:27:47.410677 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:27:47.411770 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_reunions__20272ada3743"
  
    as (
      

WITH  __dbt__cte__stg_reunions as (
SELECT * 
FROM "database"."stg"."raw_reunions"
), reunions AS (
	SELECT
		json_extract_string(json, '$.reunion.uid') AS uid,
		json_extract_string(json, '$.reunion.timeStampDebut') AS timeStampDebut,
		json_extract_string(json, '$.reunion.lieu.lieuRef') AS lieuRef,
		json_extract_string(json, '$.reunion.lieu.libelleLong') AS lieuLibelle,
		json_extract_string(json, '$.reunion.cycleDeVie.etat') AS cycleDeVieEtat,
		json_extract_string(json, '$.reunion.demandeur') AS demandeur,
		json_extract_string(json, '$.reunion.organeReuniRef') AS organeReuniRef,
		json_extract_string(json, '$.reunion.visioConference') AS visioConference,
		json_extract_string(json, '$.reunion.sessionRef') AS sessionRef,
		json_extract_string(json, '$.reunion.ouverturePresse') AS ouverturePresse,
		json_extract_string(json, '$.reunion.captationVideo') AS captationVideo,
		json_extract_string(json, '$.reunion.ODJ.convocationODJ.item') AS convocationODJ,
		json_extract_string(json, '$.reunion.ODJ.resumeODJ.item') AS resumeODJ,
		json_extract_string(json, '$.reunion.compteRenduRef') AS compteRenduRef,
		json_extract_string(json, '$.reunion.identifiants.numSeanceJO') AS numSeanceJO,
		json_extract_string(json, '$.reunion.identifiants.idJO') AS idJO,
		json_extract_string(json, '$.reunion.identifiants.quantieme') AS quantieme,
		json_extract_string(json, '$.reunion.identifiants.DataSeance') AS DataSeance,
		date_T_insert
	FROM __dbt__cte__stg_reunions source
)
SELECT * 
FROM reunions


	LEFT JOIN "an_data_pipeline"."main"."int_reunions" AS target ON reunions.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:27:48.289980 [debug] [Thread-1 (]: SQL status: OK in 0.877 seconds
[0m16:27:48.292746 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:27:48.293080 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m16:27:48.293923 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:27:48.294222 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:27:48.294519 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions__20272ada3743'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:27:48.297314 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:27:48.299973 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:27:48.300258 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:27:48.302444 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:27:48.304645 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:27:48.304893 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:27:48.306835 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:27:48.308406 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_reunions"
[0m16:27:48.308935 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:27:48.309202 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

        
            delete from "an_data_pipeline"."main"."int_reunions"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_reunions__20272ada3743"
            );

        
    

    insert into "an_data_pipeline"."main"."int_reunions" ("uid", "timeStampDebut", "lieuRef", "lieuLibelle", "cycleDeVieEtat", "demandeur", "organeReuniRef", "visioConference", "sessionRef", "ouverturePresse", "captationVideo", "convocationODJ", "resumeODJ", "compteRenduRef", "numSeanceJO", "idJO", "quantieme", "DataSeance", "date_T_insert")
    (
        select "uid", "timeStampDebut", "lieuRef", "lieuLibelle", "cycleDeVieEtat", "demandeur", "organeReuniRef", "visioConference", "sessionRef", "ouverturePresse", "captationVideo", "convocationODJ", "resumeODJ", "compteRenduRef", "numSeanceJO", "idJO", "quantieme", "DataSeance", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_reunions__20272ada3743"
    )
  
[0m16:27:48.523069 [debug] [Thread-1 (]: SQL status: OK in 0.213 seconds
[0m16:27:48.531906 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m16:27:48.532454 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:27:48.532858 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m16:27:48.629831 [debug] [Thread-1 (]: SQL status: OK in 0.096 seconds
[0m16:27:48.634653 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:27:48.635396 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__20272ada3743" cascade
    
[0m16:27:48.841263 [debug] [Thread-1 (]: SQL status: OK in 0.205 seconds
[0m16:27:48.843104 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m16:27:48.843300 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__20272ada3743" cascade
    
[0m16:27:48.940231 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m16:27:48.941602 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: Close
[0m16:27:48.942179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf006df3-ec4e-4ee2-9966-eb7d5af6071d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134a5b80>]}
[0m16:27:48.942813 [info ] [Thread-1 (]: 8 of 11 OK created sql incremental model main.int_reunions ..................... [[32mOK[0m in 1.86s]
[0m16:27:48.943330 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_reunions
[0m16:27:48.943689 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins
[0m16:27:48.944149 [info ] [Thread-1 (]: 9 of 11 START sql incremental model main.int_scrutins .......................... [RUN]
[0m16:27:48.944591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_reunions, now model.dbt_an_data.int_scrutins)
[0m16:27:48.944918 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins
[0m16:27:48.954202 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins"
[0m16:27:48.954774 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins
[0m16:27:48.957487 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:27:48.957809 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__2593460354f6" cascade
    
[0m16:27:48.958057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:27:49.057078 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m16:27:49.060009 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:27:49.060382 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:27:49.061687 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:27:49.063008 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:27:49.063345 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m16:27:49.064119 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:27:49.064426 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:27:49.064726 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m16:27:49.764602 [debug] [Thread-1 (]: SQL status: OK in 0.699 seconds
[0m16:27:49.767470 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:27:49.768228 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    

  
[0m16:27:49.768966 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:27:49.771058 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m16:27:49.771548 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:27:49.771979 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m16:27:49.868855 [debug] [Thread-1 (]: SQL status: OK in 0.096 seconds
[0m16:27:49.871130 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:27:49.872034 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_scrutins__2593460354f6"
  
    as (
      

WITH  __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
), scrutins AS (
	SELECT
		date_T_insert,
		json_extract_string(json, '$.scrutin.uid') AS uid,
		json_extract_string(json, '$.scrutin.numero') AS numero,
		json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
		json_extract_string(json, '$.scrutin.legislature') AS legislature,
		json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
		json_extract_string(json, '$.scrutin.titre') AS titre,
		json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
		json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
		json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
		json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
		json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
		json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote,
		date_T_insert
	FROM __dbt__cte__stg_scrutins
)
SELECT * 
FROM scrutins


	LEFT JOIN "an_data_pipeline"."main"."int_scrutins" AS target ON scrutins.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:27:51.405355 [debug] [Thread-1 (]: SQL status: OK in 1.532 seconds
[0m16:27:51.412066 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:27:51.412422 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m16:27:51.413297 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:27:51.413572 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:27:51.413855 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins__2593460354f6'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:27:51.416953 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:27:51.419934 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:27:51.420251 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:27:51.422591 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:27:51.424954 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:27:51.425250 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:27:51.427392 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:27:51.429379 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins"
[0m16:27:51.430113 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:27:51.430365 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

        
            delete from "an_data_pipeline"."main"."int_scrutins"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_scrutins__2593460354f6"
            );

        
    

    insert into "an_data_pipeline"."main"."int_scrutins" ("date_T_insert", "uid", "numero", "organeRef", "legislature", "date_scrutin", "titre", "resultat_code", "resultat_libelle", "nb_votants", "suffrages_exprimes", "seuil", "lieu_vote", "date_T_insert_1")
    (
        select "date_T_insert", "uid", "numero", "organeRef", "legislature", "date_scrutin", "titre", "resultat_code", "resultat_libelle", "nb_votants", "suffrages_exprimes", "seuil", "lieu_vote", "date_T_insert_1"
        from "an_data_pipeline"."dbt_temp"."int_scrutins__2593460354f6"
    )
  
[0m16:27:51.644664 [debug] [Thread-1 (]: SQL status: OK in 0.214 seconds
[0m16:27:51.646965 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m16:27:51.647484 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:27:51.647916 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m16:27:51.745581 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m16:27:51.752385 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:27:51.753063 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__2593460354f6" cascade
    
[0m16:27:51.950167 [debug] [Thread-1 (]: SQL status: OK in 0.197 seconds
[0m16:27:51.953080 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m16:27:51.953265 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__2593460354f6" cascade
    
[0m16:27:52.050300 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m16:27:52.051904 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: Close
[0m16:27:52.052778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf006df3-ec4e-4ee2-9966-eb7d5af6071d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134bd100>]}
[0m16:27:52.053643 [info ] [Thread-1 (]: 9 of 11 OK created sql incremental model main.int_scrutins ..................... [[32mOK[0m in 3.11s]
[0m16:27:52.054208 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins
[0m16:27:52.054571 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins_votes
[0m16:27:52.055154 [info ] [Thread-1 (]: 10 of 11 START sql incremental model main.int_scrutins_votes ................... [RUN]
[0m16:27:52.055782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_scrutins, now model.dbt_an_data.int_scrutins_votes)
[0m16:27:52.056190 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins_votes
[0m16:27:52.080992 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins_votes"
[0m16:27:52.081598 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins_votes
[0m16:27:52.083921 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:27:52.084141 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__32b18bf0b7f0" cascade
    
[0m16:27:52.084335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:27:52.182286 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m16:27:52.185065 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:27:52.185443 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m16:27:52.186764 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:27:52.188131 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:27:52.188496 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m16:27:52.189296 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:27:52.189613 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:27:52.189929 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m16:27:52.288698 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m16:27:52.291119 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:27:52.291742 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    

  
[0m16:27:52.292555 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:27:52.294698 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m16:27:52.295236 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:27:52.295687 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m16:27:52.391277 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m16:27:52.393520 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:27:52.394664 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_scrutins_votes__32b18bf0b7f0"
  
    as (
      

WITH  __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
), grp AS (
	-- explode les groupes (1 par groupe)
SELECT
	json_extract_string(j.json, '$.scrutin.uid') AS uid,
	json_extract_string(g.value, '$.organeRef') AS groupe_organe,
	g.value AS groupe_json,
	j.date_T_insert
FROM __dbt__cte__stg_scrutins j,
json_each(json->'scrutin'->'ventilationVotes'->'organe'->'groupes'->'groupe') g
),

positions_array AS (
	-- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
	SELECT
		uid,
		date_T_insert,
		groupe_organe,
		'pour' AS type_vote,
		p.value AS vote_json
	FROM grp,
		json_each(groupe_json->'vote'->'decompteNominatif'->'pours'->'votant') p
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[ARRAY]'

	UNION ALL
	SELECT
		uid,
		date_T_insert,
		groupe_organe,
		'contre' AS type_vote,
		c.value AS vote_json
	FROM grp,
		json_each(groupe_json->'vote'->'decompteNominatif'->'contres'->'votant') c
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[ARRAY]'

	UNION ALL
	SELECT
		uid,
		date_T_insert,
		groupe_organe,
		'abstention' AS type_vote,
		a.value AS vote_json
	FROM grp,
		json_each(groupe_json->'vote'->'decompteNominatif'->'abstentions'->'votant') a
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[ARRAY]'

	UNION ALL
	SELECT
		uid,
		date_T_insert,
		groupe_organe,
		'nonVotant' AS type_vote,
		n.value AS vote_json
	FROM grp,
			json_each(groupe_json->'vote'->'decompteNominatif'->'nonVotants'->'votant') n
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[ARRAY]'
),
positions_object AS (
	-- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
	SELECT
		uid,
		groupe_organe,
		'pour' AS type_vote,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.acteurRef') AS acteurRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.mandatRef') AS mandatRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.parDelegation') AS parDelegation,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.numPlace') AS numPlace,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.causePositionVote') AS cause,
		date_T_insert
	FROM grp
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[OBJECT]'

	UNION ALL
	SELECT
		uid,
		groupe_organe,
		'contre' AS type_vote,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.acteurRef') AS acteurRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.mandatRef') AS mandatRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.parDelegation') AS parDelegation,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.numPlace') AS numPlace,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.causePositionVote') AS cause,
		date_T_insert
	FROM grp
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[OBJECT]'

	UNION ALL
	SELECT
		uid,
		groupe_organe,
		'abstention' AS type_vote,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.acteurRef') AS acteurRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.mandatRef') AS mandatRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.parDelegation') AS parDelegation,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.numPlace') AS numPlace,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.causePositionVote') AS cause,
		date_T_insert
	FROM grp
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[OBJECT]'

	UNION ALL
	SELECT
		uid,
		groupe_organe,
		'nonVotant' AS type_vote,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.acteurRef') AS acteurRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.mandatRef') AS mandatRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.parDelegation') AS parDelegation,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.numPlace') AS numPlace,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.causePositionVote') AS cause,
		date_T_insert
	FROM grp
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[OBJECT]'
),

clean AS (
	-- sécurise les champs (souvent string ou null)
	SELECT
		uid,
		groupe_organe,
		type_vote,
		json_extract_string(vote_json, '$.acteurRef') AS acteurRef,
		json_extract_string(vote_json, '$.mandatRef') AS mandatRef,
		json_extract_string(vote_json, '$.parDelegation') AS parDelegation,
		json_extract_string(vote_json, '$.numPlace') AS numPlace,
		json_extract_string(vote_json, '$.causePositionVote') AS cause,
		date_T_insert
	FROM positions_array
	UNION ALL
	SELECT * 
	FROM positions_object
)

SELECT * FROM clean


	LEFT JOIN "an_data_pipeline"."main"."int_scrutins_votes" AS target ON clean.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m16:28:01.035748 [debug] [Thread-1 (]: SQL status: OK in 8.635 seconds
[0m16:28:01.046779 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:28:01.046996 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m16:28:01.055150 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m16:28:01.055468 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:28:01.055668 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins_votes__32b18bf0b7f0'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:28:01.066817 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m16:28:01.069627 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:28:01.069846 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins_votes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:28:01.071472 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:28:01.073167 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:28:01.073482 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins_votes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m16:28:01.075240 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:28:01.076880 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins_votes"
[0m16:28:01.077552 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:28:01.077752 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

        
            delete from "an_data_pipeline"."main"."int_scrutins_votes" as DBT_INCREMENTAL_TARGET
            using "an_data_pipeline"."dbt_temp"."int_scrutins_votes__32b18bf0b7f0"
            where (
                
                    "an_data_pipeline"."dbt_temp"."int_scrutins_votes__32b18bf0b7f0".uid = DBT_INCREMENTAL_TARGET.uid
                    and 
                
                    "an_data_pipeline"."dbt_temp"."int_scrutins_votes__32b18bf0b7f0".acteurRef = DBT_INCREMENTAL_TARGET.acteurRef
                    
                
                
            );
        
    

    insert into "an_data_pipeline"."main"."int_scrutins_votes" ("uid", "groupe_organe", "type_vote", "acteurRef", "mandatRef", "parDelegation", "numPlace", "cause", "date_T_insert")
    (
        select "uid", "groupe_organe", "type_vote", "acteurRef", "mandatRef", "parDelegation", "numPlace", "cause", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_scrutins_votes__32b18bf0b7f0"
    )
  
[0m16:28:01.317341 [debug] [Thread-1 (]: SQL status: OK in 0.239 seconds
[0m16:28:01.321077 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m16:28:01.321830 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:28:01.322507 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m16:28:01.417767 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m16:28:01.419254 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:28:01.419435 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__32b18bf0b7f0" cascade
    
[0m16:28:01.617238 [debug] [Thread-1 (]: SQL status: OK in 0.198 seconds
[0m16:28:01.620379 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m16:28:01.620577 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__32b18bf0b7f0" cascade
    
[0m16:28:01.718115 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m16:28:01.719707 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: Close
[0m16:28:01.722742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf006df3-ec4e-4ee2-9966-eb7d5af6071d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134caff0>]}
[0m16:28:01.723836 [info ] [Thread-1 (]: 10 of 11 OK created sql incremental model main.int_scrutins_votes .............. [[32mOK[0m in 9.66s]
[0m16:28:01.724419 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins_votes
[0m16:28:01.725000 [debug] [Thread-1 (]: Began running node model.dbt_an_data.mart_check_insert_dates
[0m16:28:01.725617 [info ] [Thread-1 (]: 11 of 11 START sql view model main.mart_check_insert_dates ..................... [RUN]
[0m16:28:01.726035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_scrutins_votes, now model.dbt_an_data.mart_check_insert_dates)
[0m16:28:01.726331 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.mart_check_insert_dates
[0m16:28:01.730865 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.mart_check_insert_dates"
[0m16:28:01.732215 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.mart_check_insert_dates
[0m16:28:01.744992 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.mart_check_insert_dates"
[0m16:28:01.745846 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.mart_check_insert_dates"
[0m16:28:01.746092 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: BEGIN
[0m16:28:01.746290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:01.747301 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:28:01.747538 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.mart_check_insert_dates"
[0m16:28:01.748126 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.mart_check_insert_dates"} */

  
  create view "an_data_pipeline"."main"."mart_check_insert_dates__dbt_tmp" as (
    SELECT DISTINCT
'acteurs' as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_acteurs"

UNION ALL 

SELECT DISTINCT
'agenda' as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_agenda"

UNION ALL 

SELECT DISTINCT
'amendements' as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_amendements"

UNION ALL 

SELECT DISTINCT
'organes' as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_organes"

UNION ALL 

SELECT DISTINCT
'pays' as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_pays"

UNION ALL 

SELECT DISTINCT
'reunions' as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_reunions"

UNION ALL 

SELECT DISTINCT
'scrutins' as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_scrutins"
  );

[0m16:28:01.855461 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m16:28:01.860553 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.mart_check_insert_dates"
[0m16:28:01.860890 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.mart_check_insert_dates"} */
alter view "an_data_pipeline"."main"."mart_check_insert_dates" rename to "mart_check_insert_dates__dbt_backup"
[0m16:28:01.965857 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m16:28:01.970374 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.mart_check_insert_dates"
[0m16:28:01.970899 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.mart_check_insert_dates"} */
alter view "an_data_pipeline"."main"."mart_check_insert_dates__dbt_tmp" rename to "mart_check_insert_dates"
[0m16:28:02.074210 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m16:28:02.083503 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: COMMIT
[0m16:28:02.085003 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.mart_check_insert_dates"
[0m16:28:02.085838 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: COMMIT
[0m16:28:02.292391 [debug] [Thread-1 (]: SQL status: OK in 0.205 seconds
[0m16:28:02.300449 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.mart_check_insert_dates"
[0m16:28:02.301664 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.mart_check_insert_dates"} */

      drop view if exists "an_data_pipeline"."main"."mart_check_insert_dates__dbt_backup" cascade
    
[0m16:28:02.502176 [debug] [Thread-1 (]: SQL status: OK in 0.200 seconds
[0m16:28:02.503070 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: Close
[0m16:28:02.503367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf006df3-ec4e-4ee2-9966-eb7d5af6071d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ef4110>]}
[0m16:28:02.503669 [info ] [Thread-1 (]: 11 of 11 OK created sql view model main.mart_check_insert_dates ................ [[32mOK[0m in 0.78s]
[0m16:28:02.503924 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.mart_check_insert_dates
[0m16:28:02.505390 [debug] [MainThread]: Using duckdb connection "master"
[0m16:28:02.505542 [debug] [MainThread]: On master: BEGIN
[0m16:28:02.505662 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:28:02.506212 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:28:02.506341 [debug] [MainThread]: On master: COMMIT
[0m16:28:02.506458 [debug] [MainThread]: Using duckdb connection "master"
[0m16:28:02.506571 [debug] [MainThread]: On master: COMMIT
[0m16:28:02.506773 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:28:02.506895 [debug] [MainThread]: On master: Close
[0m16:28:02.507053 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:28:02.507168 [debug] [MainThread]: Connection 'model.dbt_an_data.mart_check_insert_dates' was properly closed.
[0m16:28:02.507384 [info ] [MainThread]: 
[0m16:28:02.507538 [info ] [MainThread]: Finished running 10 incremental models, 1 project hook, 1 view model in 0 hours 0 minutes and 40.25 seconds (40.25s).
[0m16:28:02.508354 [debug] [MainThread]: Command end result
[0m16:28:02.523109 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m16:28:02.525428 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m16:28:02.528839 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m16:28:02.529018 [info ] [MainThread]: 
[0m16:28:02.529214 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:28:02.529351 [info ] [MainThread]: 
[0m16:28:02.529516 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m16:28:02.530245 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 40.763187, "process_in_blocks": "0", "process_kernel_time": 9.428251, "process_mem_max_rss": "3624173568", "process_out_blocks": "0", "process_user_time": 34.16439}
[0m16:28:02.530513 [debug] [MainThread]: Command `dbt run` succeeded at 16:28:02.530478 after 40.76 seconds
[0m16:28:02.530749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111304f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea1e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea0170>]}
[0m16:28:02.530902 [debug] [MainThread]: Flushing usage events
[0m16:28:03.032629 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:18:55.064285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055d79e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c739e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c735c0>]}


============================== 19:18:55.067490 | bdaff25a-b8f3-4c78-94ee-3cbb9773a584 ==============================
[0m19:18:55.067490 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:18:55.067818 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'no_print': 'None', 'debug': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/mael/DEV/an-data-pipeline/dbt/logs', 'quiet': 'False', 'introspect': 'True', 'printer_width': '80', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'partial_parse': 'True', 'profiles_dir': '/Users/mael/DEV/an-data-pipeline/dbt'}
[0m19:18:55.184866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdaff25a-b8f3-4c78-94ee-3cbb9773a584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e550a0>]}
[0m19:18:55.212466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdaff25a-b8f3-4c78-94ee-3cbb9773a584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10858b470>]}
[0m19:18:55.213812 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m19:18:55.272178 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:18:55.344845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:18:55.345076 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:18:55.365074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdaff25a-b8f3-4c78-94ee-3cbb9773a584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d62cf0>]}
[0m19:18:55.404375 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m19:18:55.405962 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m19:18:55.422287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdaff25a-b8f3-4c78-94ee-3cbb9773a584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109082210>]}
[0m19:18:55.422616 [info ] [MainThread]: Found 18 models, 1 operation, 9 sources, 469 macros
[0m19:18:55.422800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdaff25a-b8f3-4c78-94ee-3cbb9773a584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d60a40>]}
[0m19:18:55.423989 [info ] [MainThread]: 
[0m19:18:55.424177 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m19:18:55.424321 [info ] [MainThread]: 
[0m19:18:55.424577 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:18:55.427017 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_an_data_pipeline'
[0m19:18:55.542337 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline"
[0m19:18:55.542610 [debug] [ThreadPool]: On list_an_data_pipeline: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"an_data_pipeline"'
    
  
  
[0m19:18:55.542771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:58.196368 [debug] [ThreadPool]: SQL status: OK in 2.654 seconds
[0m19:18:58.198811 [debug] [ThreadPool]: On list_an_data_pipeline: Close
[0m19:18:58.200149 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_an_data_pipeline, now create_an_data_pipeline_main)
[0m19:18:58.201132 [debug] [ThreadPool]: Creating schema "database: "an_data_pipeline"
schema: "main"
"
[0m19:18:58.206264 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m19:18:58.206532 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m19:18:58.206843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:18:58.207993 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:18:58.209028 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m19:18:58.209255 [debug] [ThreadPool]: On create_an_data_pipeline_main: BEGIN
[0m19:18:58.209793 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:18:58.209983 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m19:18:58.210165 [debug] [ThreadPool]: On create_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "create_an_data_pipeline_main"} */

    
    
        create schema if not exists "an_data_pipeline"."main"
    
[0m19:18:58.373319 [debug] [ThreadPool]: SQL status: OK in 0.163 seconds
[0m19:18:58.375586 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m19:18:58.376178 [debug] [ThreadPool]: Using duckdb connection "create_an_data_pipeline_main"
[0m19:18:58.376596 [debug] [ThreadPool]: On create_an_data_pipeline_main: COMMIT
[0m19:18:58.486887 [debug] [ThreadPool]: SQL status: OK in 0.110 seconds
[0m19:18:58.487516 [debug] [ThreadPool]: On create_an_data_pipeline_main: Close
[0m19:18:58.489752 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_an_data_pipeline_main, now list_an_data_pipeline_main)
[0m19:18:58.496363 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m19:18:58.496702 [debug] [ThreadPool]: On list_an_data_pipeline_main: BEGIN
[0m19:18:58.496860 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:18:58.497667 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:18:58.497878 [debug] [ThreadPool]: Using duckdb connection "list_an_data_pipeline_main"
[0m19:18:58.498058 [debug] [ThreadPool]: On list_an_data_pipeline_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "list_an_data_pipeline_main"} */
select
      'an_data_pipeline' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'an_data_pipeline'
  
[0m19:18:58.508360 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m19:18:58.509468 [debug] [ThreadPool]: On list_an_data_pipeline_main: ROLLBACK
[0m19:18:58.510791 [debug] [ThreadPool]: Failed to rollback 'list_an_data_pipeline_main'
[0m19:18:58.511009 [debug] [ThreadPool]: On list_an_data_pipeline_main: Close
[0m19:18:58.512232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdaff25a-b8f3-4c78-94ee-3cbb9773a584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092459a0>]}
[0m19:18:58.513118 [debug] [MainThread]: Using duckdb connection "master"
[0m19:18:58.513482 [debug] [MainThread]: On master: BEGIN
[0m19:18:58.513640 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:18:58.514249 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:18:58.514407 [debug] [MainThread]: On master: COMMIT
[0m19:18:58.514546 [debug] [MainThread]: Using duckdb connection "master"
[0m19:18:58.514674 [debug] [MainThread]: On master: COMMIT
[0m19:18:58.514917 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:18:58.518743 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_an_data.dbt_an_data-on-run-start-0"
[0m19:18:58.521909 [info ] [MainThread]: 1 of 1 START hook: dbt_an_data.on-run-start.0 .................................. [RUN]
[0m19:18:58.522254 [debug] [MainThread]: Using duckdb connection "master"
[0m19:18:58.522515 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "connection_name": "master"} */
ATTACH '../data/database/database.duckdb' AS database (READ_ONLY)
[0m19:18:58.527299 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m19:18:58.527962 [info ] [MainThread]: 1 of 1 OK hook: dbt_an_data.on-run-start.0 ..................................... [[32mOK[0m in 0.01s]
[0m19:18:58.528148 [info ] [MainThread]: 
[0m19:18:58.528687 [debug] [MainThread]: On master: Close
[0m19:18:58.534750 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_acteurs
[0m19:18:58.536206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_an_data_pipeline_main, now model.dbt_an_data.stg_acteurs)
[0m19:18:58.538003 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_acteurs
[0m19:18:58.540602 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_acteurs"
[0m19:18:58.541901 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_acteurs
[0m19:18:58.542148 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_agenda
[0m19:18:58.542722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_acteurs, now model.dbt_an_data.stg_agenda)
[0m19:18:58.543375 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_agenda
[0m19:18:58.547235 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_agenda"
[0m19:18:58.549242 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_agenda
[0m19:18:58.549528 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_amendements
[0m19:18:58.549839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_agenda, now model.dbt_an_data.stg_amendements)
[0m19:18:58.550091 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_amendements
[0m19:18:58.551613 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_amendements"
[0m19:18:58.554002 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_amendements
[0m19:18:58.554665 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_organes
[0m19:18:58.555305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_amendements, now model.dbt_an_data.stg_organes)
[0m19:18:58.555871 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_organes
[0m19:18:58.558841 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_organes"
[0m19:18:58.559602 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_organes
[0m19:18:58.559803 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_pays
[0m19:18:58.560200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_organes, now model.dbt_an_data.stg_pays)
[0m19:18:58.560788 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_pays
[0m19:18:58.564377 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_pays"
[0m19:18:58.566680 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_pays
[0m19:18:58.566981 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_reunions
[0m19:18:58.567276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_pays, now model.dbt_an_data.stg_reunions)
[0m19:18:58.567464 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_reunions
[0m19:18:58.569071 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_reunions"
[0m19:18:58.570216 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_reunions
[0m19:18:58.570432 [debug] [Thread-1 (]: Began running node model.dbt_an_data.stg_scrutins
[0m19:18:58.570628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_reunions, now model.dbt_an_data.stg_scrutins)
[0m19:18:58.570877 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.stg_scrutins
[0m19:18:58.572596 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.stg_scrutins"
[0m19:18:58.573511 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.stg_scrutins
[0m19:18:58.573734 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_acteurs
[0m19:18:58.574111 [info ] [Thread-1 (]: 1 of 11 START sql incremental model main.int_acteurs ........................... [RUN]
[0m19:18:58.574411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.stg_scrutins, now model.dbt_an_data.int_acteurs)
[0m19:18:58.574642 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_acteurs
[0m19:18:58.585120 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_acteurs"
[0m19:18:58.585675 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_acteurs
[0m19:18:58.589998 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m19:18:58.590260 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__8542a9341a0f" cascade
    
[0m19:18:58.590433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:58.703938 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m19:18:58.736351 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m19:18:58.736667 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m19:18:58.737652 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:18:58.738568 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m19:18:58.738800 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m19:18:58.739379 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:18:58.739655 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m19:18:58.739894 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m19:18:58.852179 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m19:18:58.853582 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m19:18:58.853971 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    

  
[0m19:18:58.854401 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:18:58.855562 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m19:18:58.855924 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m19:18:58.856250 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m19:18:58.965445 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m19:18:58.976989 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m19:18:58.977325 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_acteurs__8542a9341a0f"
  
    as (
      

WITH  __dbt__cte__stg_acteurs as (
SELECT * 
FROM "database"."stg"."raw_acteurs"
), acteurs AS (
	SELECT 
		json_extract_string(json, '$.acteur.uid.#text') as uid,
		json_extract_string(json, '$.acteur.etatCivil.ident.civ') as civ,
		json_extract_string(json, '$.acteur.etatCivil.ident.prenom') as prenom,
		json_extract_string(json, '$.acteur.etatCivil.ident.nom') as nom,
		json_extract_string(json, '$.acteur.etatCivil.ident.trigramme') as trigramme,
		json_extract_string(json, '$.acteur.etatCivil.infoNaissance.dateNais') as dateNais,
		json_extract_string(json, '$.acteur.etatCivil.infoNaissance.villeNais') as villeNais,
		json_extract_string(json, '$.acteur.etatCivil.infoNaissance.depNais') as depNais,
		json_extract_string(json, '$.acteur.etatCivil.infoNaissance.paysNais') as paysNais,
		json_extract_string(json, '$.acteur.etatCivil.dateDeces') as dateDeces,
		json_extract_string(json, '$.acteur.profession.libelleCourant') as libelleCourant,
		json_extract_string(json, '$.acteur.profession.socProcINSEE.catSocPro') as catSocPro,
		json_extract_string(json, '$.acteur.profession.socProcINSEE.famSocPro') as famSocPro,
		json_extract_string(json, '$.acteur.uri_hatvp') as uri_hatvp,
		date_T_insert
	FROM __dbt__cte__stg_acteurs
)
SELECT *
FROM acteurs


	LEFT JOIN "an_data_pipeline"."main"."int_acteurs" AS target ON acteurs.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m19:18:59.819506 [debug] [Thread-1 (]: SQL status: OK in 0.842 seconds
[0m19:18:59.829774 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m19:18:59.830278 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: BEGIN
[0m19:18:59.831480 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:18:59.831880 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m19:18:59.832272 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs__8542a9341a0f'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m19:18:59.838106 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:18:59.844924 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m19:18:59.845300 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m19:18:59.848059 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:18:59.855274 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m19:18:59.855673 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_acteurs'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m19:18:59.858219 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:18:59.860510 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m19:18:59.860795 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */
SELECT version()
[0m19:18:59.861405 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:18:59.871705 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_acteurs"
[0m19:18:59.872567 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m19:18:59.872857 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

        
            delete from "an_data_pipeline"."main"."int_acteurs"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_acteurs__8542a9341a0f"
            );

        
    

    insert into "an_data_pipeline"."main"."int_acteurs" ("uid", "civ", "prenom", "nom", "trigramme", "dateNais", "villeNais", "depNais", "paysNais", "dateDeces", "libelleCourant", "catSocPro", "famSocPro", "uri_hatvp", "date_T_insert")
    (
        select "uid", "civ", "prenom", "nom", "trigramme", "dateNais", "villeNais", "depNais", "paysNais", "dateDeces", "libelleCourant", "catSocPro", "famSocPro", "uri_hatvp", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_acteurs__8542a9341a0f"
    )
  
[0m19:19:00.527059 [debug] [Thread-1 (]: SQL status: OK in 0.654 seconds
[0m19:19:00.545229 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m19:19:00.545809 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m19:19:00.546231 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: COMMIT
[0m19:19:00.656536 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m19:19:00.657807 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m19:19:00.657977 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__8542a9341a0f" cascade
    
[0m19:19:00.885044 [debug] [Thread-1 (]: SQL status: OK in 0.227 seconds
[0m19:19:00.886727 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_acteurs"
[0m19:19:00.886913 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_acteurs"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_acteurs__8542a9341a0f" cascade
    
[0m19:19:01.000176 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m19:19:01.003555 [debug] [Thread-1 (]: On model.dbt_an_data.int_acteurs: Close
[0m19:19:01.006132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdaff25a-b8f3-4c78-94ee-3cbb9773a584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109715490>]}
[0m19:19:01.006800 [info ] [Thread-1 (]: 1 of 11 OK created sql incremental model main.int_acteurs ...................... [[32mOK[0m in 2.43s]
[0m19:19:01.007275 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_acteurs
[0m19:19:01.008638 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_mandats
[0m19:19:01.009435 [info ] [Thread-1 (]: 2 of 11 START sql incremental model main.int_mandats ........................... [RUN]
[0m19:19:01.011997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_acteurs, now model.dbt_an_data.int_mandats)
[0m19:19:01.012785 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_mandats
[0m19:19:01.023994 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_mandats"
[0m19:19:01.024658 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_mandats
[0m19:19:01.027338 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m19:19:01.027604 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__baeabb924cdf" cascade
    
[0m19:19:01.027823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:01.139277 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m19:19:01.149741 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m19:19:01.150061 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m19:19:01.150915 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:19:01.151666 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m19:19:01.151858 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m19:19:01.152389 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:19:01.152598 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m19:19:01.152769 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m19:19:01.266765 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m19:19:01.269007 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m19:19:01.269654 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    

  
[0m19:19:01.270348 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:19:01.272670 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m19:19:01.273274 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m19:19:01.273753 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m19:19:01.382739 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m19:19:01.383323 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m19:19:01.383541 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_mandats__baeabb924cdf"
  
    as (
      

WITH  __dbt__cte__stg_acteurs as (
SELECT * 
FROM "database"."stg"."raw_acteurs"
), mandats AS (
	SELECT 
		json_extract_string(mandat.value, '$.uid') as uid,
		json_extract_string(mandat.value, '$.acteurRef') as acteurRef,
		json_extract_string(mandat.value, '$.legislature') as legislature,
		json_extract_string(mandat.value, '$.typeOrgane') as typeOrgane,
		json_extract_string(mandat.value, '$.dateDebut') as dateDebut,
		json_extract_string(mandat.value, '$.dateFin') as dateFin,
		json_extract_string(mandat.value, '$.preseance') as preseance,
		json_extract_string(mandat.value, '$.nominPrincipale') as nominPrincipale,
		json_extract_string(mandat.value, '$.infosQualite.codeQualite') as codeQualite,
		json_extract_string(mandat.value, '$.organes.organeRef') as organeRef,
		date_T_insert
	FROM __dbt__cte__stg_acteurs act, json_each(json->'acteur'->'mandats'->'mandat') mandat
)
SELECT * 
FROM mandats


	LEFT JOIN "an_data_pipeline"."main"."int_mandats" AS target ON mandats.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m19:19:03.729482 [debug] [Thread-1 (]: SQL status: OK in 2.346 seconds
[0m19:19:03.732511 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m19:19:03.732772 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: BEGIN
[0m19:19:03.733461 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:19:03.733640 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m19:19:03.733823 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats__baeabb924cdf'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m19:19:03.735746 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:19:03.738666 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m19:19:03.738890 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m19:19:03.740552 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:19:03.836369 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m19:19:03.836714 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_mandats'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m19:19:03.838799 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:19:03.840181 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_mandats"
[0m19:19:03.840712 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m19:19:03.840915 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

        
            delete from "an_data_pipeline"."main"."int_mandats"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_mandats__baeabb924cdf"
            );

        
    

    insert into "an_data_pipeline"."main"."int_mandats" ("uid", "acteurRef", "legislature", "typeOrgane", "dateDebut", "dateFin", "preseance", "nominPrincipale", "codeQualite", "organeRef", "date_T_insert")
    (
        select "uid", "acteurRef", "legislature", "typeOrgane", "dateDebut", "dateFin", "preseance", "nominPrincipale", "codeQualite", "organeRef", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_mandats__baeabb924cdf"
    )
  
[0m19:19:04.076725 [debug] [Thread-1 (]: SQL status: OK in 0.235 seconds
[0m19:19:04.079365 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m19:19:04.079726 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m19:19:04.080074 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: COMMIT
[0m19:19:04.197903 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m19:19:04.199145 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m19:19:04.199319 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__baeabb924cdf" cascade
    
[0m19:19:04.541092 [debug] [Thread-1 (]: SQL status: OK in 0.341 seconds
[0m19:19:04.546301 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_mandats"
[0m19:19:04.546974 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_mandats"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_mandats__baeabb924cdf" cascade
    
[0m19:19:04.661524 [debug] [Thread-1 (]: SQL status: OK in 0.114 seconds
[0m19:19:04.664179 [debug] [Thread-1 (]: On model.dbt_an_data.int_mandats: Close
[0m19:19:04.665321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdaff25a-b8f3-4c78-94ee-3cbb9773a584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109930f20>]}
[0m19:19:04.666514 [info ] [Thread-1 (]: 2 of 11 OK created sql incremental model main.int_mandats ...................... [[32mOK[0m in 3.65s]
[0m19:19:04.667668 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_mandats
[0m19:19:04.668565 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_agenda
[0m19:19:04.669539 [info ] [Thread-1 (]: 3 of 11 START sql incremental model main.int_agenda ............................ [RUN]
[0m19:19:04.670305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_mandats, now model.dbt_an_data.int_agenda)
[0m19:19:04.670829 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_agenda
[0m19:19:04.675549 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_agenda"
[0m19:19:04.676568 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_agenda
[0m19:19:04.681035 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m19:19:04.681460 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__c7d5ca231298" cascade
    
[0m19:19:04.681839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:04.799312 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m19:19:04.803513 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m19:19:04.804134 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m19:19:04.806072 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:19:04.808070 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m19:19:04.808592 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m19:19:04.809744 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:19:04.810228 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m19:19:04.810680 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m19:19:04.924032 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m19:19:04.926822 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m19:19:04.927593 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    

  
[0m19:19:04.928331 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:19:04.930645 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m19:19:04.931409 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m19:19:04.931892 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m19:19:05.042353 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m19:19:05.044400 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m19:19:05.045209 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_agenda__c7d5ca231298"
  
    as (
      

with __dbt__cte__stg_agenda as (
SELECT * 
FROM "database"."stg"."raw_agenda"
) SELECT * 
FROM __dbt__cte__stg_agenda
    );
  
  
  
[0m19:19:05.397037 [debug] [Thread-1 (]: SQL status: OK in 0.351 seconds
[0m19:19:05.398644 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m19:19:05.398834 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: BEGIN
[0m19:19:05.399354 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:19:05.399515 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m19:19:05.399679 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda__c7d5ca231298'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m19:19:05.401416 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:19:05.402881 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m19:19:05.403067 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m19:19:05.404501 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:19:05.405909 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m19:19:05.406088 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_agenda'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m19:19:05.407515 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:19:05.408444 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_agenda"
[0m19:19:05.408861 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m19:19:05.409038 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

        
            delete from "an_data_pipeline"."main"."int_agenda" as DBT_INCREMENTAL_TARGET
            using "an_data_pipeline"."dbt_temp"."int_agenda__c7d5ca231298"
            where (
                
                    "an_data_pipeline"."dbt_temp"."int_agenda__c7d5ca231298".Date = DBT_INCREMENTAL_TARGET.Date
                    and 
                
                    "an_data_pipeline"."dbt_temp"."int_agenda__c7d5ca231298".Heure = DBT_INCREMENTAL_TARGET.Heure
                    
                
                
            );
        
    

    insert into "an_data_pipeline"."main"."int_agenda" ("Date", "Heure", "Ordre(s) du jour", "filename", "date_T_insert")
    (
        select "Date", "Heure", "Ordre(s) du jour", "filename", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_agenda__c7d5ca231298"
    )
  
[0m19:19:05.727198 [debug] [Thread-1 (]: SQL status: OK in 0.318 seconds
[0m19:19:05.730199 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m19:19:05.730994 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m19:19:05.731468 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: COMMIT
[0m19:19:05.849363 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m19:19:05.850726 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m19:19:05.851766 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__c7d5ca231298" cascade
    
[0m19:19:06.080158 [debug] [Thread-1 (]: SQL status: OK in 0.228 seconds
[0m19:19:06.081701 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_agenda"
[0m19:19:06.081873 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_agenda"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_agenda__c7d5ca231298" cascade
    
[0m19:19:06.194021 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m19:19:06.195428 [debug] [Thread-1 (]: On model.dbt_an_data.int_agenda: Close
[0m19:19:06.195998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdaff25a-b8f3-4c78-94ee-3cbb9773a584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095c7950>]}
[0m19:19:06.196613 [info ] [Thread-1 (]: 3 of 11 OK created sql incremental model main.int_agenda ....................... [[32mOK[0m in 1.53s]
[0m19:19:06.197133 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_agenda
[0m19:19:06.197498 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements
[0m19:19:06.197997 [info ] [Thread-1 (]: 4 of 11 START sql incremental model main.int_amendements ....................... [RUN]
[0m19:19:06.198475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_agenda, now model.dbt_an_data.int_amendements)
[0m19:19:06.198822 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements
[0m19:19:06.216171 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements"
[0m19:19:06.216913 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements
[0m19:19:06.219685 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m19:19:06.219967 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__78b1ac666b17" cascade
    
[0m19:19:06.220206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:06.334300 [debug] [Thread-1 (]: SQL status: OK in 0.114 seconds
[0m19:19:06.338007 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m19:19:06.338529 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m19:19:06.340076 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:19:06.341623 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m19:19:06.342031 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m19:19:06.342943 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:19:06.343300 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m19:19:06.343655 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m19:19:06.456724 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m19:19:06.459566 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m19:19:06.460256 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    

  
[0m19:19:06.461474 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:19:06.463730 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m19:19:06.464308 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m19:19:06.464790 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m19:19:06.576478 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m19:19:06.579493 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m19:19:06.580662 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_amendements__78b1ac666b17"
  
    as (
      

WITH  __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
), amendements AS (
	SELECT
		json_extract_string(json, '$.amendement.uid') AS uid,
		json_extract_string(json, '$.amendement.chronotag') AS chronotag,
		json_extract_string(json, '$.amendement.examenRef') AS examenRef,
		json_extract_string(json, '$.amendement.amendementParentRef') AS amendementParentRef,
		json_extract_string(json, '$.amendement.signataires.auteur.typeAuteur') AS typeAuteur,
		json_extract_string(json, '$.amendement.signataires.auteur.acteurRef') AS refAuteur,
		json_extract_string(json, '$.amendement.signataires.auteur.groupePolitique') AS groupePolitiqueAuteur,
		json_extract_string(json, '$.amendement.cycleDeVie.dateDepot') AS dateDepot,
		json_extract_string(json, '$.amendement.cycleDeVie.datePublication') AS datePublication,
		json_extract_string(json, '$.amendement.cycleDeVie.soumisArticle40') AS soumisArticle40,
		json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.code') AS codeEtat,
		json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.etat.libelle') AS libelleEtat,
		json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.code') AS codeSousEtat,
		json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
		json_extract_string(json, '$.amendement.cycleDeVie.etatDesTraitements.sousEtat.libelle') AS libelleSousEtat,
		json_extract_string(json, '$.amendement.cycleDeVie.dateSort') AS dateSort,
		json_extract_string(json, '$.amendement.cycleDeVie.sort') AS sort,
		split_part(replace(filename, '.json', ''), '/', -1) AS id_amendement,
		split_part(replace(filename, '.json', ''), '/', -2) AS id_texte,
		split_part(replace(filename, '.json', ''), '/', -3) AS id_dossier_legislatif,
		id_texte[:4] AS nature_texte,
		id_texte[5:6] AS source_texte,
		regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 1) AS prefix_bibard,
		regexp_extract(id_texte, '(BTS|BTC|BTG|B)(\d*)', 2) AS numero_bibard,
		regexp_extract(id_amendement, '(SEA|PO\d*)', 1) AS code_organe,
		regexp_extract(id_amendement, '(P)(\d*)(D)', 2) AS numero_partie,
		regexp_extract(id_amendement, '(D)(\d*)(N)', 2) AS numero_deliberation,
		regexp_extract(id_amendement, '(D)(\d*)(N)(\d*)', 4) AS numero_court,
		date_T_insert
	FROM __dbt__cte__stg_amendements
)
SELECT * 
FROM amendements


	LEFT JOIN "an_data_pipeline"."main"."int_amendements" AS target ON amendements.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m19:19:18.531737 [debug] [Thread-1 (]: SQL status: OK in 11.950 seconds
[0m19:19:18.540633 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m19:19:18.540965 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: BEGIN
[0m19:19:18.550942 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m19:19:18.551239 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m19:19:18.551441 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements__78b1ac666b17'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m19:19:18.564030 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m19:19:18.567004 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m19:19:18.567235 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m19:19:18.568967 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:19:18.571134 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m19:19:18.571380 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m19:19:18.573202 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:19:18.575039 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements"
[0m19:19:18.575612 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m19:19:18.575821 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

        
            delete from "an_data_pipeline"."main"."int_amendements"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_amendements__78b1ac666b17"
            );

        
    

    insert into "an_data_pipeline"."main"."int_amendements" ("uid", "chronotag", "examenRef", "amendementParentRef", "typeAuteur", "refAuteur", "groupePolitiqueAuteur", "dateDepot", "datePublication", "soumisArticle40", "codeEtat", "libelleEtat", "codeSousEtat", "libelleSousEtat", "libelleSousEtat_1", "dateSort", "sort", "id_amendement", "id_texte", "id_dossier_legislatif", "nature_texte", "source_texte", "prefix_bibard", "numero_bibard", "code_organe", "numero_partie", "numero_deliberation", "numero_court", "date_T_insert")
    (
        select "uid", "chronotag", "examenRef", "amendementParentRef", "typeAuteur", "refAuteur", "groupePolitiqueAuteur", "dateDepot", "datePublication", "soumisArticle40", "codeEtat", "libelleEtat", "codeSousEtat", "libelleSousEtat", "libelleSousEtat_1", "dateSort", "sort", "id_amendement", "id_texte", "id_dossier_legislatif", "nature_texte", "source_texte", "prefix_bibard", "numero_bibard", "code_organe", "numero_partie", "numero_deliberation", "numero_court", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_amendements__78b1ac666b17"
    )
  
[0m19:19:18.832580 [debug] [Thread-1 (]: SQL status: OK in 0.256 seconds
[0m19:19:18.834826 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m19:19:18.835758 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m19:19:18.836722 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: COMMIT
[0m19:19:18.963400 [debug] [Thread-1 (]: SQL status: OK in 0.126 seconds
[0m19:19:18.970783 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m19:19:18.971769 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__78b1ac666b17" cascade
    
[0m19:19:19.211707 [debug] [Thread-1 (]: SQL status: OK in 0.239 seconds
[0m19:19:19.223421 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements"
[0m19:19:19.224078 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements__78b1ac666b17" cascade
    
[0m19:19:19.340956 [debug] [Thread-1 (]: SQL status: OK in 0.116 seconds
[0m19:19:19.344727 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements: Close
[0m19:19:19.346831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdaff25a-b8f3-4c78-94ee-3cbb9773a584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109952510>]}
[0m19:19:19.348510 [info ] [Thread-1 (]: 4 of 11 OK created sql incremental model main.int_amendements .................. [[32mOK[0m in 13.15s]
[0m19:19:19.349735 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements
[0m19:19:19.350747 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_amendements_cosignataires
[0m19:19:19.352111 [info ] [Thread-1 (]: 5 of 11 START sql incremental model main.int_amendements_cosignataires ......... [RUN]
[0m19:19:19.353183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements, now model.dbt_an_data.int_amendements_cosignataires)
[0m19:19:19.354003 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_amendements_cosignataires
[0m19:19:19.364104 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_amendements_cosignataires"
[0m19:19:19.364622 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_amendements_cosignataires
[0m19:19:19.366633 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m19:19:19.366828 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__a490762bdd1b" cascade
    
[0m19:19:19.366995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:19.593237 [debug] [Thread-1 (]: SQL status: OK in 0.226 seconds
[0m19:19:19.599493 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m19:19:19.600463 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m19:19:19.603462 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:19:19.606641 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m19:19:19.607380 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m19:19:19.609057 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:19:19.609705 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m19:19:19.610322 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m19:19:19.724704 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m19:19:19.727031 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m19:19:19.727697 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    

  
[0m19:19:19.728494 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:19:19.730836 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m19:19:19.731694 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m19:19:19.732453 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m19:19:19.843861 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m19:19:19.845357 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m19:19:19.846310 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__a490762bdd1b"
  
    as (
      

WITH  __dbt__cte__stg_amendements as (
SELECT * 
FROM "database"."stg"."raw_amendements"
), cosignataires_arr AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef[*]') AS acteurRef,
    date_T_insert
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') == 'ARRAY' AND acteurRef IS NOT NULL
), cosignataires_str AS (
  SELECT
    json_extract_string(json, '$.amendement.uid') AS uid,
    json_extract_string(json, '$.amendement.signataires.cosignataires.acteurRef') AS acteurRef,
    date_T_insert
  FROM __dbt__cte__stg_amendements
  WHERE json_type(json, '$.amendement.signataires.cosignataires.acteurRef') <> 'ARRAY' AND acteurRef IS NOT NULL
), cosignataires AS (
	SELECT 
		uid, 
		unnest(acteurRef) as acteurRef,
		date_T_insert
	FROM cosignataires_arr
	UNION ALL
	SELECT 
		uid, 
		acteurRef,
		date_T_insert
	FROM cosignataires_str
)
SELECT * 
FROM cosignataires


	LEFT JOIN "an_data_pipeline"."main"."int_amendements_cosignataires" AS target ON cosignataires.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m19:19:28.356766 [debug] [Thread-1 (]: SQL status: OK in 8.509 seconds
[0m19:19:28.364965 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m19:19:28.365190 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: BEGIN
[0m19:19:28.365955 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:19:28.366176 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m19:19:28.366367 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires__a490762bdd1b'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m19:19:28.368452 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:19:28.370066 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m19:19:28.370252 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m19:19:28.371719 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:19:28.373693 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m19:19:28.373877 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_amendements_cosignataires'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m19:19:28.375303 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:19:28.376521 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_amendements_cosignataires"
[0m19:19:28.377209 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m19:19:28.377413 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

        
            delete from "an_data_pipeline"."main"."int_amendements_cosignataires" as DBT_INCREMENTAL_TARGET
            using "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__a490762bdd1b"
            where (
                
                    "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__a490762bdd1b".uid = DBT_INCREMENTAL_TARGET.uid
                    and 
                
                    "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__a490762bdd1b".acteurRef = DBT_INCREMENTAL_TARGET.acteurRef
                    
                
                
            );
        
    

    insert into "an_data_pipeline"."main"."int_amendements_cosignataires" ("uid", "acteurRef", "date_T_insert")
    (
        select "uid", "acteurRef", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__a490762bdd1b"
    )
  
[0m19:19:28.613057 [debug] [Thread-1 (]: SQL status: OK in 0.235 seconds
[0m19:19:28.616526 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m19:19:28.617281 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m19:19:28.617819 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: COMMIT
[0m19:19:28.748481 [debug] [Thread-1 (]: SQL status: OK in 0.130 seconds
[0m19:19:28.753254 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m19:19:28.754060 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__a490762bdd1b" cascade
    
[0m19:19:28.988468 [debug] [Thread-1 (]: SQL status: OK in 0.234 seconds
[0m19:19:28.990193 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_amendements_cosignataires"
[0m19:19:28.990380 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_amendements_cosignataires"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_amendements_cosignataires__a490762bdd1b" cascade
    
[0m19:19:29.103351 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m19:19:29.105628 [debug] [Thread-1 (]: On model.dbt_an_data.int_amendements_cosignataires: Close
[0m19:19:29.106822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdaff25a-b8f3-4c78-94ee-3cbb9773a584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d61a60>]}
[0m19:19:29.107834 [info ] [Thread-1 (]: 5 of 11 OK created sql incremental model main.int_amendements_cosignataires .... [[32mOK[0m in 9.75s]
[0m19:19:29.108488 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_amendements_cosignataires
[0m19:19:29.109026 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_organes
[0m19:19:29.109872 [info ] [Thread-1 (]: 6 of 11 START sql incremental model main.int_organes ........................... [RUN]
[0m19:19:29.110324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_amendements_cosignataires, now model.dbt_an_data.int_organes)
[0m19:19:29.110670 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_organes
[0m19:19:29.121562 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_organes"
[0m19:19:29.122243 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_organes
[0m19:19:29.127047 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m19:19:29.127576 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__5e6e424a1e1a" cascade
    
[0m19:19:29.127870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:29.241430 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m19:19:29.244682 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m19:19:29.245166 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m19:19:29.246838 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:19:29.248703 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m19:19:29.249179 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m19:19:29.250267 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:19:29.250598 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m19:19:29.250962 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m19:19:29.368673 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m19:19:29.371315 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m19:19:29.372148 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    

  
[0m19:19:29.372445 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:19:29.373534 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m19:19:29.374216 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m19:19:29.374441 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m19:19:29.483282 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m19:19:29.483861 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m19:19:29.484074 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_organes__5e6e424a1e1a"
  
    as (
      

WITH  __dbt__cte__stg_organes as (
SELECT * 
FROM "database"."stg"."raw_organes"
), organes AS (
	SELECT 
		json_extract_string(json, '$.organe.uid') as uid,
		json_extract_string(json, '$.organe.codeType') as codeType,
		json_extract_string(json, '$.organe.libelle') as libelle,
		json_extract_string(json, '$.organe.libelleEdition') as libelleEdition,
		json_extract_string(json, '$.organe.libelleAbrege') as libelleAbrege,
		json_extract_string(json, '$.organe.libelleAbrev') as libelleAbrev,
		json_extract_string(json, '$.organe.viMoDe.dateDebut') as dateDebut,
		json_extract_string(json, '$.organe.viMoDe.dateAgrement') as dateAgrement,
		json_extract_string(json, '$.organe.viMoDe.dateFin') as dateFin,
		json_extract_string(json, '$.organe.organeParent') as organeParent,
		json_extract_string(json, '$.organe.chambre') as chambre,
		json_extract_string(json, '$.organe.regime') as regime,
		json_extract_string(json, '$.organe.legislature') as legislature,
		date_T_insert
	FROM __dbt__cte__stg_organes
)
SELECT * 
FROM organes


	LEFT JOIN "an_data_pipeline"."main"."int_organes" AS target ON organes.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m19:19:30.462859 [debug] [Thread-1 (]: SQL status: OK in 0.977 seconds
[0m19:19:30.476716 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m19:19:30.477145 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: BEGIN
[0m19:19:30.478261 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:19:30.478580 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m19:19:30.478882 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes__5e6e424a1e1a'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m19:19:30.482204 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:19:30.485248 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m19:19:30.485563 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m19:19:30.487891 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:19:30.490368 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m19:19:30.490678 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_organes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m19:19:30.492944 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:19:30.494957 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_organes"
[0m19:19:30.496021 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m19:19:30.496291 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

        
            delete from "an_data_pipeline"."main"."int_organes"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_organes__5e6e424a1e1a"
            );

        
    

    insert into "an_data_pipeline"."main"."int_organes" ("uid", "codeType", "libelle", "libelleEdition", "libelleAbrege", "libelleAbrev", "dateDebut", "dateAgrement", "dateFin", "organeParent", "chambre", "regime", "legislature", "date_T_insert")
    (
        select "uid", "codeType", "libelle", "libelleEdition", "libelleAbrege", "libelleAbrev", "dateDebut", "dateAgrement", "dateFin", "organeParent", "chambre", "regime", "legislature", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_organes__5e6e424a1e1a"
    )
  
[0m19:19:30.738033 [debug] [Thread-1 (]: SQL status: OK in 0.241 seconds
[0m19:19:30.741467 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m19:19:30.742171 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m19:19:30.742663 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: COMMIT
[0m19:19:30.865557 [debug] [Thread-1 (]: SQL status: OK in 0.122 seconds
[0m19:19:30.868234 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m19:19:30.868590 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__5e6e424a1e1a" cascade
    
[0m19:19:31.106764 [debug] [Thread-1 (]: SQL status: OK in 0.238 seconds
[0m19:19:31.114308 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_organes"
[0m19:19:31.115338 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_organes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_organes__5e6e424a1e1a" cascade
    
[0m19:19:31.233959 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m19:19:31.238189 [debug] [Thread-1 (]: On model.dbt_an_data.int_organes: Close
[0m19:19:31.240231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdaff25a-b8f3-4c78-94ee-3cbb9773a584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109931010>]}
[0m19:19:31.242061 [info ] [Thread-1 (]: 6 of 11 OK created sql incremental model main.int_organes ...................... [[32mOK[0m in 2.13s]
[0m19:19:31.243475 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_organes
[0m19:19:31.244459 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_pays
[0m19:19:31.245760 [info ] [Thread-1 (]: 7 of 11 START sql incremental model main.int_pays .............................. [RUN]
[0m19:19:31.248669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_organes, now model.dbt_an_data.int_pays)
[0m19:19:31.250665 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_pays
[0m19:19:31.268119 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_pays"
[0m19:19:31.269104 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_pays
[0m19:19:31.273631 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m19:19:31.274177 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__fc9ad3799031" cascade
    
[0m19:19:31.274620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:31.391922 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m19:19:31.403113 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m19:19:31.404203 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m19:19:31.406620 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:19:31.409265 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m19:19:31.410020 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m19:19:31.411727 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:19:31.412439 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m19:19:31.412815 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m19:19:31.527449 [debug] [Thread-1 (]: SQL status: OK in 0.114 seconds
[0m19:19:31.530703 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m19:19:31.531849 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    

  
[0m19:19:31.533040 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:19:31.535414 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m19:19:31.536166 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m19:19:31.536861 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m19:19:31.648359 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m19:19:31.649553 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m19:19:31.650228 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_pays__fc9ad3799031"
  
    as (
      

WITH  __dbt__cte__stg_pays as (
SELECT * 
FROM "database"."stg"."raw_pays"
), pays AS (
	SELECT
		json_extract_string(json, '$.pays.uid') as uid,
		json_extract_string(json, '$.pays.code_insee') as code_insee,
		json_extract_string(json, '$.pays.libelleInsee') as libelleInsee,
		json_extract_string(json, '$.pays.nomCourant') as nomCourant,
		json_extract_string(json, '$.pays.code_iso2A') as code_iso2A,
		json_extract_string(json, '$.pays.code_iso3A') as code_iso3A,
		json_extract_string(json, '$.pays.code_iso3N') as code_iso3N,
		json_extract_string(json, '$.pays.libelleIso') as libelleIso,
		json_extract_string(json, '$.pays.libelleANCourt') as libelleANCourt,
		json_extract_string(json, '$.pays.libelleANLong') as libelleANLong,
		json_extract_string(json, '$.pays.sourceJuridique') as sourceJuridique,
		json_extract_string(json, '$.pays.activ') as activ,
		date_T_insert
	FROM __dbt__cte__stg_pays source
)
SELECT * 
FROM pays


	LEFT JOIN "an_data_pipeline"."main"."int_pays" AS target ON pays.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m19:19:32.132142 [debug] [Thread-1 (]: SQL status: OK in 0.481 seconds
[0m19:19:32.135981 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m19:19:32.136478 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: BEGIN
[0m19:19:32.137652 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:19:32.138039 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m19:19:32.138425 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays__fc9ad3799031'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m19:19:32.142355 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:19:32.145799 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m19:19:32.146191 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m19:19:32.149123 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:19:32.151959 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m19:19:32.152285 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_pays'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m19:19:32.154766 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:19:32.156685 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_pays"
[0m19:19:32.157401 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m19:19:32.157715 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

        
            delete from "an_data_pipeline"."main"."int_pays"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_pays__fc9ad3799031"
            );

        
    

    insert into "an_data_pipeline"."main"."int_pays" ("uid", "code_insee", "libelleInsee", "nomCourant", "code_iso2A", "code_iso3A", "code_iso3N", "libelleIso", "libelleANCourt", "libelleANLong", "sourceJuridique", "activ", "date_T_insert")
    (
        select "uid", "code_insee", "libelleInsee", "nomCourant", "code_iso2A", "code_iso3A", "code_iso3N", "libelleIso", "libelleANCourt", "libelleANLong", "sourceJuridique", "activ", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_pays__fc9ad3799031"
    )
  
[0m19:19:32.395240 [debug] [Thread-1 (]: SQL status: OK in 0.237 seconds
[0m19:19:32.398955 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m19:19:32.399881 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m19:19:32.400582 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: COMMIT
[0m19:19:32.513288 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m19:19:32.517980 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m19:19:32.518888 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__fc9ad3799031" cascade
    
[0m19:19:32.751918 [debug] [Thread-1 (]: SQL status: OK in 0.232 seconds
[0m19:19:32.754105 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_pays"
[0m19:19:32.754294 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_pays"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_pays__fc9ad3799031" cascade
    
[0m19:19:32.867523 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m19:19:32.868817 [debug] [Thread-1 (]: On model.dbt_an_data.int_pays: Close
[0m19:19:32.869355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdaff25a-b8f3-4c78-94ee-3cbb9773a584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e72540>]}
[0m19:19:32.869951 [info ] [Thread-1 (]: 7 of 11 OK created sql incremental model main.int_pays ......................... [[32mOK[0m in 1.62s]
[0m19:19:32.870451 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_pays
[0m19:19:32.870846 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_reunions
[0m19:19:32.871369 [info ] [Thread-1 (]: 8 of 11 START sql incremental model main.int_reunions .......................... [RUN]
[0m19:19:32.871836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_pays, now model.dbt_an_data.int_reunions)
[0m19:19:32.872153 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_reunions
[0m19:19:32.883567 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_reunions"
[0m19:19:32.884155 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_reunions
[0m19:19:32.886866 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m19:19:32.887223 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__9ea7aed088cd" cascade
    
[0m19:19:32.887464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:33.001288 [debug] [Thread-1 (]: SQL status: OK in 0.114 seconds
[0m19:19:33.005752 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m19:19:33.006229 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m19:19:33.007876 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:19:33.009562 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m19:19:33.009979 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m19:19:33.010904 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:19:33.011267 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m19:19:33.011627 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m19:19:33.124838 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m19:19:33.127544 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m19:19:33.128180 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    

  
[0m19:19:33.128866 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:19:33.130658 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m19:19:33.131304 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m19:19:33.131816 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m19:19:33.242386 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m19:19:33.243068 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m19:19:33.243297 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_reunions__9ea7aed088cd"
  
    as (
      

WITH  __dbt__cte__stg_reunions as (
SELECT * 
FROM "database"."stg"."raw_reunions"
), reunions AS (
	SELECT
		json_extract_string(json, '$.reunion.uid') AS uid,
		json_extract_string(json, '$.reunion.timeStampDebut') AS timeStampDebut,
		json_extract_string(json, '$.reunion.lieu.lieuRef') AS lieuRef,
		json_extract_string(json, '$.reunion.lieu.libelleLong') AS lieuLibelle,
		json_extract_string(json, '$.reunion.cycleDeVie.etat') AS cycleDeVieEtat,
		json_extract_string(json, '$.reunion.demandeur') AS demandeur,
		json_extract_string(json, '$.reunion.organeReuniRef') AS organeReuniRef,
		json_extract_string(json, '$.reunion.visioConference') AS visioConference,
		json_extract_string(json, '$.reunion.sessionRef') AS sessionRef,
		json_extract_string(json, '$.reunion.ouverturePresse') AS ouverturePresse,
		json_extract_string(json, '$.reunion.captationVideo') AS captationVideo,
		json_extract_string(json, '$.reunion.ODJ.convocationODJ.item') AS convocationODJ,
		json_extract_string(json, '$.reunion.ODJ.resumeODJ.item') AS resumeODJ,
		json_extract_string(json, '$.reunion.compteRenduRef') AS compteRenduRef,
		json_extract_string(json, '$.reunion.identifiants.numSeanceJO') AS numSeanceJO,
		json_extract_string(json, '$.reunion.identifiants.idJO') AS idJO,
		json_extract_string(json, '$.reunion.identifiants.quantieme') AS quantieme,
		json_extract_string(json, '$.reunion.identifiants.DataSeance') AS DataSeance,
		date_T_insert
	FROM __dbt__cte__stg_reunions source
)
SELECT * 
FROM reunions


	LEFT JOIN "an_data_pipeline"."main"."int_reunions" AS target ON reunions.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m19:19:34.737325 [debug] [Thread-1 (]: SQL status: OK in 1.494 seconds
[0m19:19:34.742749 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m19:19:34.746129 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: BEGIN
[0m19:19:34.747489 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:19:34.747880 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m19:19:34.748222 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions__9ea7aed088cd'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m19:19:34.751775 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:19:34.754842 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m19:19:34.755215 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m19:19:34.757270 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:19:34.759647 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m19:19:34.759964 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_reunions'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m19:19:34.762091 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:19:34.764156 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_reunions"
[0m19:19:34.765281 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m19:19:34.765756 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

        
            delete from "an_data_pipeline"."main"."int_reunions"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_reunions__9ea7aed088cd"
            );

        
    

    insert into "an_data_pipeline"."main"."int_reunions" ("uid", "timeStampDebut", "lieuRef", "lieuLibelle", "cycleDeVieEtat", "demandeur", "organeReuniRef", "visioConference", "sessionRef", "ouverturePresse", "captationVideo", "convocationODJ", "resumeODJ", "compteRenduRef", "numSeanceJO", "idJO", "quantieme", "DataSeance", "date_T_insert")
    (
        select "uid", "timeStampDebut", "lieuRef", "lieuLibelle", "cycleDeVieEtat", "demandeur", "organeReuniRef", "visioConference", "sessionRef", "ouverturePresse", "captationVideo", "convocationODJ", "resumeODJ", "compteRenduRef", "numSeanceJO", "idJO", "quantieme", "DataSeance", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_reunions__9ea7aed088cd"
    )
  
[0m19:19:35.009507 [debug] [Thread-1 (]: SQL status: OK in 0.243 seconds
[0m19:19:35.012691 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m19:19:35.013619 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m19:19:35.014325 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: COMMIT
[0m19:19:35.138041 [debug] [Thread-1 (]: SQL status: OK in 0.123 seconds
[0m19:19:35.142768 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m19:19:35.143551 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__9ea7aed088cd" cascade
    
[0m19:19:35.386150 [debug] [Thread-1 (]: SQL status: OK in 0.242 seconds
[0m19:19:35.391364 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_reunions"
[0m19:19:35.392036 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_reunions"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_reunions__9ea7aed088cd" cascade
    
[0m19:19:35.510744 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m19:19:35.515261 [debug] [Thread-1 (]: On model.dbt_an_data.int_reunions: Close
[0m19:19:35.516935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdaff25a-b8f3-4c78-94ee-3cbb9773a584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10997c740>]}
[0m19:19:35.518616 [info ] [Thread-1 (]: 8 of 11 OK created sql incremental model main.int_reunions ..................... [[32mOK[0m in 2.64s]
[0m19:19:35.519819 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_reunions
[0m19:19:35.520591 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins
[0m19:19:35.522256 [info ] [Thread-1 (]: 9 of 11 START sql incremental model main.int_scrutins .......................... [RUN]
[0m19:19:35.523482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_reunions, now model.dbt_an_data.int_scrutins)
[0m19:19:35.524831 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins
[0m19:19:35.533992 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins"
[0m19:19:35.534506 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins
[0m19:19:35.536627 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m19:19:35.536929 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__35e1f10dd4f0" cascade
    
[0m19:19:35.537215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:35.654925 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m19:19:35.661223 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m19:19:35.662143 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m19:19:35.664935 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:19:35.667622 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m19:19:35.668263 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m19:19:35.669740 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:19:35.670363 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m19:19:35.670845 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m19:19:35.784982 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m19:19:35.786869 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m19:19:35.787747 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    

  
[0m19:19:35.788609 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:19:35.790355 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m19:19:35.791011 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m19:19:35.791492 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m19:19:35.901696 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m19:19:35.903256 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m19:19:35.903855 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_scrutins__35e1f10dd4f0"
  
    as (
      

WITH  __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
), scrutins AS (
	SELECT
		date_T_insert,
		json_extract_string(json, '$.scrutin.uid') AS uid,
		json_extract_string(json, '$.scrutin.numero') AS numero,
		json_extract_string(json, '$.scrutin.organeRef') AS organeRef,
		json_extract_string(json, '$.scrutin.legislature') AS legislature,
		json_extract_string(json, '$.scrutin.dateScrutin') AS date_scrutin,
		json_extract_string(json, '$.scrutin.titre') AS titre,
		json_extract_string(json, '$.scrutin.sort.code') AS resultat_code,
		json_extract_string(json, '$.scrutin.sort.libelle') AS resultat_libelle,
		json_extract_string(json, '$.scrutin.syntheseVote.nombreVotants') AS nb_votants,
		json_extract_string(json, '$.scrutin.syntheseVote.suffragesExprimes') AS suffrages_exprimes,
		json_extract_string(json, '$.scrutin.syntheseVote.nbrSuffragesRequis') AS seuil,
		json_extract_string(json, '$.scrutin.lieuVote') AS lieu_vote,
		date_T_insert
	FROM __dbt__cte__stg_scrutins
)
SELECT * 
FROM scrutins


	LEFT JOIN "an_data_pipeline"."main"."int_scrutins" AS target ON scrutins.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m19:19:39.157441 [debug] [Thread-1 (]: SQL status: OK in 3.251 seconds
[0m19:19:39.172554 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m19:19:39.173098 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: BEGIN
[0m19:19:39.174553 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:19:39.174941 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m19:19:39.175328 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins__35e1f10dd4f0'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m19:19:39.179857 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:19:39.183362 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m19:19:39.183750 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m19:19:39.186757 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:19:39.192146 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m19:19:39.192494 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m19:19:39.195116 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:19:39.197238 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins"
[0m19:19:39.198343 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m19:19:39.198643 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

        
            delete from "an_data_pipeline"."main"."int_scrutins"
            where (
                uid) in (
                select (uid)
                from "an_data_pipeline"."dbt_temp"."int_scrutins__35e1f10dd4f0"
            );

        
    

    insert into "an_data_pipeline"."main"."int_scrutins" ("date_T_insert", "uid", "numero", "organeRef", "legislature", "date_scrutin", "titre", "resultat_code", "resultat_libelle", "nb_votants", "suffrages_exprimes", "seuil", "lieu_vote", "date_T_insert_1")
    (
        select "date_T_insert", "uid", "numero", "organeRef", "legislature", "date_scrutin", "titre", "resultat_code", "resultat_libelle", "nb_votants", "suffrages_exprimes", "seuil", "lieu_vote", "date_T_insert_1"
        from "an_data_pipeline"."dbt_temp"."int_scrutins__35e1f10dd4f0"
    )
  
[0m19:19:39.659520 [debug] [Thread-1 (]: SQL status: OK in 0.460 seconds
[0m19:19:39.663472 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m19:19:39.664401 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m19:19:39.665142 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: COMMIT
[0m19:19:39.788965 [debug] [Thread-1 (]: SQL status: OK in 0.123 seconds
[0m19:19:39.794600 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m19:19:39.795898 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__35e1f10dd4f0" cascade
    
[0m19:19:40.029652 [debug] [Thread-1 (]: SQL status: OK in 0.233 seconds
[0m19:19:40.031463 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins"
[0m19:19:40.031655 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins__35e1f10dd4f0" cascade
    
[0m19:19:40.678328 [debug] [Thread-1 (]: SQL status: OK in 0.646 seconds
[0m19:19:40.682259 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins: Close
[0m19:19:40.685049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdaff25a-b8f3-4c78-94ee-3cbb9773a584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109958770>]}
[0m19:19:40.687380 [info ] [Thread-1 (]: 9 of 11 OK created sql incremental model main.int_scrutins ..................... [[32mOK[0m in 5.16s]
[0m19:19:40.688990 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins
[0m19:19:40.690073 [debug] [Thread-1 (]: Began running node model.dbt_an_data.int_scrutins_votes
[0m19:19:40.691949 [info ] [Thread-1 (]: 10 of 11 START sql incremental model main.int_scrutins_votes ................... [RUN]
[0m19:19:40.693151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_scrutins, now model.dbt_an_data.int_scrutins_votes)
[0m19:19:40.693774 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.int_scrutins_votes
[0m19:19:40.731339 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.int_scrutins_votes"
[0m19:19:40.732492 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.int_scrutins_votes
[0m19:19:40.735685 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m19:19:40.735982 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__e19ca7fafd55" cascade
    
[0m19:19:40.736236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:40.851593 [debug] [Thread-1 (]: SQL status: OK in 0.115 seconds
[0m19:19:40.856697 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m19:19:40.857562 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
        select type from duckdb_databases()
        where lower(database_name)='an_data_pipeline'
        and type='sqlite'
    
  
[0m19:19:40.860181 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:19:40.862243 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m19:19:40.862765 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m19:19:40.863959 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:19:40.864431 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m19:19:40.864890 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
    
        create schema if not exists "an_data_pipeline"."dbt_temp"
    
[0m19:19:40.990060 [debug] [Thread-1 (]: SQL status: OK in 0.124 seconds
[0m19:19:40.993322 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m19:19:40.994384 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    

  
[0m19:19:40.995540 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:19:40.998411 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m19:19:40.999334 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m19:19:41.000126 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m19:19:41.110182 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m19:19:41.110695 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m19:19:41.111023 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

    
  
    
    

    create  table
      "an_data_pipeline"."dbt_temp"."int_scrutins_votes__e19ca7fafd55"
  
    as (
      

WITH  __dbt__cte__stg_scrutins as (
SELECT * 
FROM "database"."stg"."raw_scrutins"
), grp AS (
	-- explode les groupes (1 par groupe)
SELECT
	json_extract_string(j.json, '$.scrutin.uid') AS uid,
	json_extract_string(g.value, '$.organeRef') AS groupe_organe,
	g.value AS groupe_json,
	j.date_T_insert
FROM __dbt__cte__stg_scrutins j,
json_each(json->'scrutin'->'ventilationVotes'->'organe'->'groupes'->'groupe') g
),

positions_array AS (
	-- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
	SELECT
		uid,
		date_T_insert,
		groupe_organe,
		'pour' AS type_vote,
		p.value AS vote_json
	FROM grp,
		json_each(groupe_json->'vote'->'decompteNominatif'->'pours'->'votant') p
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[ARRAY]'

	UNION ALL
	SELECT
		uid,
		date_T_insert,
		groupe_organe,
		'contre' AS type_vote,
		c.value AS vote_json
	FROM grp,
		json_each(groupe_json->'vote'->'decompteNominatif'->'contres'->'votant') c
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[ARRAY]'

	UNION ALL
	SELECT
		uid,
		date_T_insert,
		groupe_organe,
		'abstention' AS type_vote,
		a.value AS vote_json
	FROM grp,
		json_each(groupe_json->'vote'->'decompteNominatif'->'abstentions'->'votant') a
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[ARRAY]'

	UNION ALL
	SELECT
		uid,
		date_T_insert,
		groupe_organe,
		'nonVotant' AS type_vote,
		n.value AS vote_json
	FROM grp,
			json_each(groupe_json->'vote'->'decompteNominatif'->'nonVotants'->'votant') n
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[ARRAY]'
),
positions_object AS (
	-- 4 types de votes que DuckDB peut trouver : pours, contres, abstentions, nonVotants
	SELECT
		uid,
		groupe_organe,
		'pour' AS type_vote,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.acteurRef') AS acteurRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.mandatRef') AS mandatRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.parDelegation') AS parDelegation,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.numPlace') AS numPlace,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.pours.votant.causePositionVote') AS cause,
		date_T_insert
	FROM grp
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.pours.votant') == '[OBJECT]'

	UNION ALL
	SELECT
		uid,
		groupe_organe,
		'contre' AS type_vote,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.acteurRef') AS acteurRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.mandatRef') AS mandatRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.parDelegation') AS parDelegation,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.numPlace') AS numPlace,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.contres.votant.causePositionVote') AS cause,
		date_T_insert
	FROM grp
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.contres.votant') == '[OBJECT]'

	UNION ALL
	SELECT
		uid,
		groupe_organe,
		'abstention' AS type_vote,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.acteurRef') AS acteurRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.mandatRef') AS mandatRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.parDelegation') AS parDelegation,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.numPlace') AS numPlace,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.abstentions.votant.causePositionVote') AS cause,
		date_T_insert
	FROM grp
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.abstentions.votant') == '[OBJECT]'

	UNION ALL
	SELECT
		uid,
		groupe_organe,
		'nonVotant' AS type_vote,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.acteurRef') AS acteurRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.mandatRef') AS mandatRef,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.parDelegation') AS parDelegation,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.numPlace') AS numPlace,
		json_extract_string(groupe_json, '$.vote.decompteNominatif.nonVotants.votant.causePositionVote') AS cause,
		date_T_insert
	FROM grp
	WHERE json_type(groupe_json, '$..vote.decompteNominatif.nonVotants.votant') == '[OBJECT]'
),

clean AS (
	-- sécurise les champs (souvent string ou null)
	SELECT
		uid,
		groupe_organe,
		type_vote,
		json_extract_string(vote_json, '$.acteurRef') AS acteurRef,
		json_extract_string(vote_json, '$.mandatRef') AS mandatRef,
		json_extract_string(vote_json, '$.parDelegation') AS parDelegation,
		json_extract_string(vote_json, '$.numPlace') AS numPlace,
		json_extract_string(vote_json, '$.causePositionVote') AS cause,
		date_T_insert
	FROM positions_array
	UNION ALL
	SELECT * 
	FROM positions_object
)

SELECT * FROM clean


	LEFT JOIN "an_data_pipeline"."main"."int_scrutins_votes" AS target ON clean.uid = target.uid
	WHERE target.uid IS NULL

    );
  
  
  
[0m19:19:54.859201 [debug] [Thread-1 (]: SQL status: OK in 13.741 seconds
[0m19:19:54.878002 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m19:19:54.878251 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: BEGIN
[0m19:19:54.879077 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:19:54.879291 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m19:19:54.879476 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins_votes__e19ca7fafd55'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m19:19:54.881416 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:19:54.883088 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m19:19:54.883297 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins_votes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m19:19:54.884830 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:19:54.887941 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m19:19:54.888171 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_scrutins_votes'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'an_data_pipeline'
      
      order by ordinal_position

  
[0m19:19:54.889913 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:19:54.891699 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.int_scrutins_votes"
[0m19:19:54.892775 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m19:19:54.892975 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

        
            delete from "an_data_pipeline"."main"."int_scrutins_votes" as DBT_INCREMENTAL_TARGET
            using "an_data_pipeline"."dbt_temp"."int_scrutins_votes__e19ca7fafd55"
            where (
                
                    "an_data_pipeline"."dbt_temp"."int_scrutins_votes__e19ca7fafd55".uid = DBT_INCREMENTAL_TARGET.uid
                    and 
                
                    "an_data_pipeline"."dbt_temp"."int_scrutins_votes__e19ca7fafd55".acteurRef = DBT_INCREMENTAL_TARGET.acteurRef
                    
                
                
            );
        
    

    insert into "an_data_pipeline"."main"."int_scrutins_votes" ("uid", "groupe_organe", "type_vote", "acteurRef", "mandatRef", "parDelegation", "numPlace", "cause", "date_T_insert")
    (
        select "uid", "groupe_organe", "type_vote", "acteurRef", "mandatRef", "parDelegation", "numPlace", "cause", "date_T_insert"
        from "an_data_pipeline"."dbt_temp"."int_scrutins_votes__e19ca7fafd55"
    )
  
[0m19:19:55.133577 [debug] [Thread-1 (]: SQL status: OK in 0.240 seconds
[0m19:19:55.137391 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m19:19:55.138273 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m19:19:55.139022 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: COMMIT
[0m19:19:55.267594 [debug] [Thread-1 (]: SQL status: OK in 0.128 seconds
[0m19:19:55.269180 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m19:19:55.269362 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__e19ca7fafd55" cascade
    
[0m19:19:55.500002 [debug] [Thread-1 (]: SQL status: OK in 0.230 seconds
[0m19:19:55.501729 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.int_scrutins_votes"
[0m19:19:55.501917 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.int_scrutins_votes"} */

      drop table if exists "an_data_pipeline"."dbt_temp"."int_scrutins_votes__e19ca7fafd55" cascade
    
[0m19:19:55.614089 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m19:19:55.616438 [debug] [Thread-1 (]: On model.dbt_an_data.int_scrutins_votes: Close
[0m19:19:55.617800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdaff25a-b8f3-4c78-94ee-3cbb9773a584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099b55b0>]}
[0m19:19:55.618770 [info ] [Thread-1 (]: 10 of 11 OK created sql incremental model main.int_scrutins_votes .............. [[32mOK[0m in 14.92s]
[0m19:19:55.619416 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.int_scrutins_votes
[0m19:19:55.619844 [debug] [Thread-1 (]: Began running node model.dbt_an_data.mart_check_insert_dates
[0m19:19:55.620472 [info ] [Thread-1 (]: 11 of 11 START sql view model main.mart_check_insert_dates ..................... [RUN]
[0m19:19:55.620801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_an_data.int_scrutins_votes, now model.dbt_an_data.mart_check_insert_dates)
[0m19:19:55.621065 [debug] [Thread-1 (]: Began compiling node model.dbt_an_data.mart_check_insert_dates
[0m19:19:55.626386 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_an_data.mart_check_insert_dates"
[0m19:19:55.627226 [debug] [Thread-1 (]: Began executing node model.dbt_an_data.mart_check_insert_dates
[0m19:19:55.644874 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_an_data.mart_check_insert_dates"
[0m19:19:55.645604 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.mart_check_insert_dates"
[0m19:19:55.645833 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: BEGIN
[0m19:19:55.646042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:55.646817 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:19:55.647017 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.mart_check_insert_dates"
[0m19:19:55.647238 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.mart_check_insert_dates"} */

  
  create view "an_data_pipeline"."main"."mart_check_insert_dates__dbt_tmp" as (
    SELECT DISTINCT
'acteurs' as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_acteurs"

UNION ALL 

SELECT DISTINCT
'agenda' as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_agenda"

UNION ALL 

SELECT DISTINCT
'amendements' as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_amendements"

UNION ALL 

SELECT DISTINCT
'organes' as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_organes"

UNION ALL 

SELECT DISTINCT
'pays' as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_pays"

UNION ALL 

SELECT DISTINCT
'reunions' as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_reunions"

UNION ALL 

SELECT DISTINCT
'scrutins' as source,
date_T_insert
FROM "an_data_pipeline"."main"."int_scrutins"
  );

[0m19:19:55.770665 [debug] [Thread-1 (]: SQL status: OK in 0.123 seconds
[0m19:19:55.778521 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.mart_check_insert_dates"
[0m19:19:55.778933 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.mart_check_insert_dates"} */
alter view "an_data_pipeline"."main"."mart_check_insert_dates" rename to "mart_check_insert_dates__dbt_backup"
[0m19:19:55.901926 [debug] [Thread-1 (]: SQL status: OK in 0.122 seconds
[0m19:19:55.909672 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.mart_check_insert_dates"
[0m19:19:55.910697 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.mart_check_insert_dates"} */
alter view "an_data_pipeline"."main"."mart_check_insert_dates__dbt_tmp" rename to "mart_check_insert_dates"
[0m19:19:56.289878 [debug] [Thread-1 (]: SQL status: OK in 0.378 seconds
[0m19:19:56.297499 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: COMMIT
[0m19:19:56.298314 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.mart_check_insert_dates"
[0m19:19:56.298823 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: COMMIT
[0m19:19:56.542189 [debug] [Thread-1 (]: SQL status: OK in 0.243 seconds
[0m19:19:56.545972 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_an_data.mart_check_insert_dates"
[0m19:19:56.547429 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_an_data", "target_name": "prod", "node_id": "model.dbt_an_data.mart_check_insert_dates"} */

      drop view if exists "an_data_pipeline"."main"."mart_check_insert_dates__dbt_backup" cascade
    
[0m19:19:56.784321 [debug] [Thread-1 (]: SQL status: OK in 0.236 seconds
[0m19:19:56.787569 [debug] [Thread-1 (]: On model.dbt_an_data.mart_check_insert_dates: Close
[0m19:19:56.789324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdaff25a-b8f3-4c78-94ee-3cbb9773a584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096e70b0>]}
[0m19:19:56.790945 [info ] [Thread-1 (]: 11 of 11 OK created sql view model main.mart_check_insert_dates ................ [[32mOK[0m in 1.17s]
[0m19:19:56.791822 [debug] [Thread-1 (]: Finished running node model.dbt_an_data.mart_check_insert_dates
[0m19:19:56.808230 [debug] [MainThread]: Using duckdb connection "master"
[0m19:19:56.808697 [debug] [MainThread]: On master: BEGIN
[0m19:19:56.808998 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:19:56.810484 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:19:56.810827 [debug] [MainThread]: On master: COMMIT
[0m19:19:56.811142 [debug] [MainThread]: Using duckdb connection "master"
[0m19:19:56.811430 [debug] [MainThread]: On master: COMMIT
[0m19:19:56.811935 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:19:56.812237 [debug] [MainThread]: On master: Close
[0m19:19:56.812640 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:19:56.812931 [debug] [MainThread]: Connection 'model.dbt_an_data.mart_check_insert_dates' was properly closed.
[0m19:19:56.816371 [info ] [MainThread]: 
[0m19:19:56.817388 [info ] [MainThread]: Finished running 10 incremental models, 1 project hook, 1 view model in 0 hours 1 minutes and 1.39 seconds (61.39s).
[0m19:19:56.821265 [debug] [MainThread]: Command end result
[0m19:19:56.864179 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/manifest.json
[0m19:19:56.879804 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mael/DEV/an-data-pipeline/dbt/target/semantic_manifest.json
[0m19:19:56.889821 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mael/DEV/an-data-pipeline/dbt/target/run_results.json
[0m19:19:56.890351 [info ] [MainThread]: 
[0m19:19:56.890915 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:19:56.891169 [info ] [MainThread]: 
[0m19:19:56.892314 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m19:19:56.895886 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 61.874935, "process_in_blocks": "0", "process_kernel_time": 13.517059, "process_mem_max_rss": "2519842816", "process_out_blocks": "0", "process_user_time": 35.025166}
[0m19:19:56.896620 [debug] [MainThread]: Command `dbt run` succeeded at 19:19:56.896538 after 61.88 seconds
[0m19:19:56.897977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f33590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10896c800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109188bc0>]}
[0m19:19:56.898392 [debug] [MainThread]: Flushing usage events
[0m19:19:57.519073 [debug] [MainThread]: An error was encountered while trying to flush usage events
